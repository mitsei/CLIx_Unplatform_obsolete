var COMPILED=!0,goog=goog||{};goog.global=this;goog.isDef=function(a){return void 0!==a};goog.exportPath_=function(a,b,c){a=a.split(".");c=c||goog.global;a[0]in c||!c.execScript||c.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&goog.isDef(b)?c[e]=b:c=c[e]?c[e]:c[e]={}};
goog.define=function(a,b){var c=b;COMPILED||(goog.global.CLOSURE_UNCOMPILED_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_UNCOMPILED_DEFINES,a)?c=goog.global.CLOSURE_UNCOMPILED_DEFINES[a]:goog.global.CLOSURE_DEFINES&&Object.prototype.hasOwnProperty.call(goog.global.CLOSURE_DEFINES,a)&&(c=goog.global.CLOSURE_DEFINES[a]));goog.exportPath_(a,c)};goog.DEBUG=!0;goog.LOCALE="en";goog.TRUSTED_SITE=!0;goog.STRICT_MODE_COMPATIBLE=!1;goog.DISALLOW_TEST_ONLY_CODE=COMPILED&&!goog.DEBUG;
goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING=!1;goog.provide=function(a){if(!COMPILED&&goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');goog.constructNamespace_(a)};goog.constructNamespace_=function(a,b){if(!COMPILED){delete goog.implicitNamespaces_[a];for(var c=a;(c=c.substring(0,c.lastIndexOf(".")))&&!goog.getObjectByName(c);)goog.implicitNamespaces_[c]=!0}goog.exportPath_(a,b)};goog.VALID_MODULE_RE_=/^[a-zA-Z_$][a-zA-Z0-9._$]*$/;
goog.module=function(a){if(!goog.isString(a)||!a||-1==a.search(goog.VALID_MODULE_RE_))throw Error("Invalid module identifier");if(!goog.isInModuleLoader_())throw Error("Module "+a+" has been loaded incorrectly.");if(goog.moduleLoaderState_.moduleName)throw Error("goog.module may only be called once per module.");goog.moduleLoaderState_.moduleName=a;if(!COMPILED){if(goog.isProvided_(a))throw Error('Namespace "'+a+'" already declared.');delete goog.implicitNamespaces_[a]}};goog.module.get=function(a){return goog.module.getInternal_(a)};
goog.module.getInternal_=function(a){if(!COMPILED)return goog.isProvided_(a)?a in goog.loadedModules_?goog.loadedModules_[a]:goog.getObjectByName(a):null};goog.moduleLoaderState_=null;goog.isInModuleLoader_=function(){return null!=goog.moduleLoaderState_};
goog.module.declareLegacyNamespace=function(){if(!COMPILED&&!goog.isInModuleLoader_())throw Error("goog.module.declareLegacyNamespace must be called from within a goog.module");if(!COMPILED&&!goog.moduleLoaderState_.moduleName)throw Error("goog.module must be called prior to goog.module.declareLegacyNamespace.");goog.moduleLoaderState_.declareLegacyNamespace=!0};
goog.setTestOnly=function(a){if(goog.DISALLOW_TEST_ONLY_CODE)throw a=a||"",Error("Importing test-only code into non-debug environment"+(a?": "+a:"."));};goog.forwardDeclare=function(a){};COMPILED||(goog.isProvided_=function(a){return a in goog.loadedModules_||!goog.implicitNamespaces_[a]&&goog.isDefAndNotNull(goog.getObjectByName(a))},goog.implicitNamespaces_={"goog.module":!0});
goog.getObjectByName=function(a,b){for(var c=a.split("."),e=b||goog.global,f;f=c.shift();)if(goog.isDefAndNotNull(e[f]))e=e[f];else return null;return e};goog.globalize=function(a,b){var c=b||goog.global,e;for(e in a)c[e]=a[e]};goog.addDependency=function(a,b,c,e){if(goog.DEPENDENCIES_ENABLED){var f;a=a.replace(/\\/g,"/");for(var g=goog.dependencies_,h=0;f=b[h];h++)g.nameToPath[f]=a,g.pathIsModule[a]=!!e;for(e=0;b=c[e];e++)a in g.requires||(g.requires[a]={}),g.requires[a][b]=!0}};
goog.ENABLE_DEBUG_LOADER=!0;goog.logToConsole_=function(a){goog.global.console&&goog.global.console.error(a)};
goog.require=function(a){if(!COMPILED){goog.ENABLE_DEBUG_LOADER&&goog.IS_OLD_IE_&&goog.maybeProcessDeferredDep_(a);if(goog.isProvided_(a))return goog.isInModuleLoader_()?goog.module.getInternal_(a):null;if(goog.ENABLE_DEBUG_LOADER){var b=goog.getPathFromDeps_(a);if(b)return goog.included_[b]=!0,goog.writeScripts_(),null}a="goog.require could not find: "+a;goog.logToConsole_(a);throw Error(a);}};goog.basePath="";goog.nullFunction=function(){};
goog.abstractMethod=function(){throw Error("unimplemented abstract method");};goog.addSingletonGetter=function(a){a.getInstance=function(){if(a.instance_)return a.instance_;goog.DEBUG&&(goog.instantiatedSingletons_[goog.instantiatedSingletons_.length]=a);return a.instance_=new a}};goog.instantiatedSingletons_=[];goog.LOAD_MODULE_USING_EVAL=!0;goog.SEAL_MODULE_EXPORTS=goog.DEBUG;goog.loadedModules_={};goog.DEPENDENCIES_ENABLED=!COMPILED&&goog.ENABLE_DEBUG_LOADER;
goog.DEPENDENCIES_ENABLED&&(goog.included_={},goog.dependencies_={pathIsModule:{},nameToPath:{},requires:{},visited:{},written:{},deferred:{}},goog.inHtmlDocument_=function(){var a=goog.global.document;return"undefined"!=typeof a&&"write"in a},goog.findBasePath_=function(){if(goog.isDef(goog.global.CLOSURE_BASE_PATH))goog.basePath=goog.global.CLOSURE_BASE_PATH;else if(goog.inHtmlDocument_())for(var a=goog.global.document.getElementsByTagName("SCRIPT"),b=a.length-1;0<=b;--b){var c=a[b].src,e=c.lastIndexOf("?"),
e=-1==e?c.length:e;if("base.js"==c.substr(e-7,7)){goog.basePath=c.substr(0,e-7);break}}},goog.importScript_=function(a,b){(goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_)(a,b)&&(goog.dependencies_.written[a]=!0)},goog.IS_OLD_IE_=!(goog.global.atob||!goog.global.document||!goog.global.document.all),goog.importModule_=function(a){goog.importScript_("",'goog.retrieveAndExecModule_("'+a+'");')&&(goog.dependencies_.written[a]=!0)},goog.queuedModules_=[],goog.wrapModule_=function(a,b){return goog.LOAD_MODULE_USING_EVAL&&
goog.isDef(goog.global.JSON)?"goog.loadModule("+goog.global.JSON.stringify(b+"\n//# sourceURL="+a+"\n")+");":'goog.loadModule(function(exports) {"use strict";'+b+"\n;return exports});\n//# sourceURL="+a+"\n"},goog.loadQueuedModules_=function(){var a=goog.queuedModules_.length;if(0<a){var b=goog.queuedModules_;goog.queuedModules_=[];for(var c=0;c<a;c++)goog.maybeProcessDeferredPath_(b[c])}},goog.maybeProcessDeferredDep_=function(a){goog.isDeferredModule_(a)&&goog.allDepsAreAvailable_(a)&&(a=goog.getPathFromDeps_(a),
goog.maybeProcessDeferredPath_(goog.basePath+a))},goog.isDeferredModule_=function(a){return(a=goog.getPathFromDeps_(a))&&goog.dependencies_.pathIsModule[a]?goog.basePath+a in goog.dependencies_.deferred:!1},goog.allDepsAreAvailable_=function(a){if((a=goog.getPathFromDeps_(a))&&a in goog.dependencies_.requires)for(var b in goog.dependencies_.requires[a])if(!goog.isProvided_(b)&&!goog.isDeferredModule_(b))return!1;return!0},goog.maybeProcessDeferredPath_=function(a){if(a in goog.dependencies_.deferred){var b=
goog.dependencies_.deferred[a];delete goog.dependencies_.deferred[a];goog.globalEval(b)}},goog.loadModule=function(a){var b=goog.moduleLoaderState_;try{goog.moduleLoaderState_={moduleName:void 0};var c;if(goog.isFunction(a))c=a.call(goog.global,{});else if(goog.isString(a))c=goog.loadModuleFromSource_.call(goog.global,a);else throw Error("Invalid module definition");var e=goog.moduleLoaderState_.moduleName;if(!goog.isString(e)||!e)throw Error('Invalid module name "'+e+'"');goog.moduleLoaderState_.declareLegacyNamespace?
goog.constructNamespace_(e,c):goog.SEAL_MODULE_EXPORTS&&Object.seal&&Object.seal(c);goog.loadedModules_[e]=c}finally{goog.moduleLoaderState_=b}},goog.loadModuleFromSource_=function(a){eval(a);return{}},goog.writeScriptSrcNode_=function(a){goog.global.document.write('<script type="text/javascript" src="'+a+'">\x3c/script>')},goog.appendScriptSrcNode_=function(a){var b=goog.global.document,c=b.createElement("script");c.type="text/javascript";c.src=a;c.defer=!1;c.async=!1;b.head.appendChild(c)},goog.writeScriptTag_=
function(a,b){if(goog.inHtmlDocument_()){var c=goog.global.document;if(!goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING&&"complete"==c.readyState){if(/\bdeps.js$/.test(a))return!1;throw Error('Cannot write "'+a+'" after document load');}var e=goog.IS_OLD_IE_;void 0===b?e?(e=" onreadystatechange='goog.onScriptLoad_(this, "+ ++goog.lastNonModuleScriptIndex_+")' ",c.write('<script type="text/javascript" src="'+a+'"'+e+">\x3c/script>")):goog.ENABLE_CHROME_APP_SAFE_SCRIPT_LOADING?goog.appendScriptSrcNode_(a):
goog.writeScriptSrcNode_(a):c.write('<script type="text/javascript">'+b+"\x3c/script>");return!0}return!1},goog.lastNonModuleScriptIndex_=0,goog.onScriptLoad_=function(a,b){"complete"==a.readyState&&goog.lastNonModuleScriptIndex_==b&&goog.loadQueuedModules_();return!0},goog.writeScripts_=function(){function a(f){if(!(f in e.written)){if(!(f in e.visited)&&(e.visited[f]=!0,f in e.requires))for(var g in e.requires[f])if(!goog.isProvided_(g))if(g in e.nameToPath)a(e.nameToPath[g]);else throw Error("Undefined nameToPath for "+
g);f in c||(c[f]=!0,b.push(f))}}var b=[],c={},e=goog.dependencies_,f;for(f in goog.included_)e.written[f]||a(f);for(var g=0;g<b.length;g++)f=b[g],goog.dependencies_.written[f]=!0;var h=goog.moduleLoaderState_;goog.moduleLoaderState_=null;for(g=0;g<b.length;g++)if(f=b[g])e.pathIsModule[f]?goog.importModule_(goog.basePath+f):goog.importScript_(goog.basePath+f);else throw goog.moduleLoaderState_=h,Error("Undefined script input");goog.moduleLoaderState_=h},goog.getPathFromDeps_=function(a){return a in
goog.dependencies_.nameToPath?goog.dependencies_.nameToPath[a]:null},goog.findBasePath_(),goog.global.CLOSURE_NO_DEPS||goog.importScript_(goog.basePath+"deps.js"));goog.normalizePath_=function(a){a=a.split("/");for(var b=0;b<a.length;)"."==a[b]?a.splice(b,1):b&&".."==a[b]&&a[b-1]&&".."!=a[b-1]?a.splice(--b,2):b++;return a.join("/")};
goog.loadFileSync_=function(a){if(goog.global.CLOSURE_LOAD_FILE_SYNC)return goog.global.CLOSURE_LOAD_FILE_SYNC(a);var b=new goog.global.XMLHttpRequest;b.open("get",a,!1);b.send();return b.responseText};
goog.retrieveAndExecModule_=function(a){if(!COMPILED){var b=a;a=goog.normalizePath_(a);var c=goog.global.CLOSURE_IMPORT_SCRIPT||goog.writeScriptTag_,e=goog.loadFileSync_(a);if(null!=e)e=goog.wrapModule_(a,e),goog.IS_OLD_IE_?(goog.dependencies_.deferred[b]=e,goog.queuedModules_.push(b)):c(a,e);else throw Error("load of "+a+"failed");}};
goog.typeOf=function(a){var b=typeof a;if("object"==b)if(a){if(a instanceof Array)return"array";if(a instanceof Object)return b;var c=Object.prototype.toString.call(a);if("[object Window]"==c)return"object";if("[object Array]"==c||"number"==typeof a.length&&"undefined"!=typeof a.splice&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("splice"))return"array";if("[object Function]"==c||"undefined"!=typeof a.call&&"undefined"!=typeof a.propertyIsEnumerable&&!a.propertyIsEnumerable("call"))return"function"}else return"null";
else if("function"==b&&"undefined"==typeof a.call)return"object";return b};goog.isNull=function(a){return null===a};goog.isDefAndNotNull=function(a){return null!=a};goog.isArray=function(a){return"array"==goog.typeOf(a)};goog.isArrayLike=function(a){var b=goog.typeOf(a);return"array"==b||"object"==b&&"number"==typeof a.length};goog.isDateLike=function(a){return goog.isObject(a)&&"function"==typeof a.getFullYear};goog.isString=function(a){return"string"==typeof a};
goog.isBoolean=function(a){return"boolean"==typeof a};goog.isNumber=function(a){return"number"==typeof a};goog.isFunction=function(a){return"function"==goog.typeOf(a)};goog.isObject=function(a){var b=typeof a;return"object"==b&&null!=a||"function"==b};goog.getUid=function(a){return a[goog.UID_PROPERTY_]||(a[goog.UID_PROPERTY_]=++goog.uidCounter_)};goog.hasUid=function(a){return!!a[goog.UID_PROPERTY_]};goog.removeUid=function(a){"removeAttribute"in a&&a.removeAttribute(goog.UID_PROPERTY_);try{delete a[goog.UID_PROPERTY_]}catch(b){}};
goog.UID_PROPERTY_="closure_uid_"+(1E9*Math.random()>>>0);goog.uidCounter_=0;goog.getHashCode=goog.getUid;goog.removeHashCode=goog.removeUid;goog.cloneObject=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.cloneObject(a[c]);return b}return a};goog.bindNative_=function(a,b,c){return a.call.apply(a.bind,arguments)};
goog.bindJs_=function(a,b,c){if(!a)throw Error();if(2<arguments.length){var e=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);Array.prototype.unshift.apply(c,e);return a.apply(b,c)}}return function(){return a.apply(b,arguments)}};goog.bind=function(a,b,c){Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?goog.bind=goog.bindNative_:goog.bind=goog.bindJs_;return goog.bind.apply(null,arguments)};
goog.partial=function(a,b){var c=Array.prototype.slice.call(arguments,1);return function(){var b=c.slice();b.push.apply(b,arguments);return a.apply(this,b)}};goog.mixin=function(a,b){for(var c in b)a[c]=b[c]};goog.now=goog.TRUSTED_SITE&&Date.now||function(){return+new Date};
goog.globalEval=function(a){if(goog.global.execScript)goog.global.execScript(a,"JavaScript");else if(goog.global.eval){if(null==goog.evalWorksForGlobals_)if(goog.global.eval("var _evalTest_ = 1;"),"undefined"!=typeof goog.global._evalTest_){try{delete goog.global._evalTest_}catch(b){}goog.evalWorksForGlobals_=!0}else goog.evalWorksForGlobals_=!1;if(goog.evalWorksForGlobals_)goog.global.eval(a);else{var c=goog.global.document,e=c.createElement("SCRIPT");e.type="text/javascript";e.defer=!1;e.appendChild(c.createTextNode(a));
c.body.appendChild(e);c.body.removeChild(e)}}else throw Error("goog.globalEval not available");};goog.evalWorksForGlobals_=null;goog.getCssName=function(a,b){var c=function(a){return goog.cssNameMapping_[a]||a},e=function(a){a=a.split("-");for(var b=[],e=0;e<a.length;e++)b.push(c(a[e]));return b.join("-")},e=goog.cssNameMapping_?"BY_WHOLE"==goog.cssNameMappingStyle_?c:e:function(a){return a};return b?a+"-"+e(b):e(a)};
goog.setCssNameMapping=function(a,b){goog.cssNameMapping_=a;goog.cssNameMappingStyle_=b};!COMPILED&&goog.global.CLOSURE_CSS_NAME_MAPPING&&(goog.cssNameMapping_=goog.global.CLOSURE_CSS_NAME_MAPPING);goog.getMsg=function(a,b){b&&(a=a.replace(/\{\$([^}]+)}/g,function(a,e){return e in b?b[e]:a}));return a};goog.getMsgWithFallback=function(a,b){return a};goog.exportSymbol=function(a,b,c){goog.exportPath_(a,b,c)};goog.exportProperty=function(a,b,c){a[b]=c};
goog.inherits=function(a,b){function c(){}c.prototype=b.prototype;a.superClass_=b.prototype;a.prototype=new c;a.prototype.constructor=a;a.base=function(a,c,g){for(var h=Array(arguments.length-2),k=2;k<arguments.length;k++)h[k-2]=arguments[k];return b.prototype[c].apply(a,h)}};
goog.base=function(a,b,c){var e=arguments.callee.caller;if(goog.STRICT_MODE_COMPATIBLE||goog.DEBUG&&!e)throw Error("arguments.caller not defined.  goog.base() cannot be used with strict mode code. See http://www.ecma-international.org/ecma-262/5.1/#sec-C");if(e.superClass_){for(var f=Array(arguments.length-1),g=1;g<arguments.length;g++)f[g-1]=arguments[g];return e.superClass_.constructor.apply(a,f)}f=Array(arguments.length-2);for(g=2;g<arguments.length;g++)f[g-2]=arguments[g];for(var g=!1,h=a.constructor;h;h=
h.superClass_&&h.superClass_.constructor)if(h.prototype[b]===e)g=!0;else if(g)return h.prototype[b].apply(a,f);if(a[b]===e)return a.constructor.prototype[b].apply(a,f);throw Error("goog.base called from a method of one name to a method of a different name");};goog.scope=function(a){a.call(goog.global)};COMPILED||(goog.global.COMPILED=COMPILED);
goog.defineClass=function(a,b){var c=b.constructor,e=b.statics;c&&c!=Object.prototype.constructor||(c=function(){throw Error("cannot instantiate an interface (no constructor defined).");});c=goog.defineClass.createSealingConstructor_(c,a);a&&goog.inherits(c,a);delete b.constructor;delete b.statics;goog.defineClass.applyProperties_(c.prototype,b);null!=e&&(e instanceof Function?e(c):goog.defineClass.applyProperties_(c,e));return c};goog.defineClass.SEAL_CLASS_INSTANCES=goog.DEBUG;
goog.defineClass.createSealingConstructor_=function(a,b){if(goog.defineClass.SEAL_CLASS_INSTANCES&&Object.seal instanceof Function){if(b&&b.prototype&&b.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_])return a;var c=function(){var b=a.apply(this,arguments)||this;b[goog.UID_PROPERTY_]=b[goog.UID_PROPERTY_];this.constructor===c&&Object.seal(b);return b};return c}return a};goog.defineClass.OBJECT_PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");
goog.defineClass.applyProperties_=function(a,b){for(var c in b)Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c]);for(var e=0;e<goog.defineClass.OBJECT_PROTOTYPE_FIELDS_.length;e++)c=goog.defineClass.OBJECT_PROTOTYPE_FIELDS_[e],Object.prototype.hasOwnProperty.call(b,c)&&(a[c]=b[c])};goog.tagUnsealableClass=function(a){!COMPILED&&goog.defineClass.SEAL_CLASS_INSTANCES&&(a.prototype[goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_]=!0)};goog.UNSEALABLE_CONSTRUCTOR_PROPERTY_="goog_defineClass_legacy_unsealable";var bd={modelTag:{}};
bd.modelTag.perPlayer={requiredFields:["entityPerPlayer",{classOrInstance:"instance",fields:["playerId","visibleToPlayerId","playerIdsToChildInstanceIds"]}],provideFields:function(){return[{fields:["entityPerPlayer"],classOrInstance:"instance",providers:["parent"]},{fields:["entityPerPlayer"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["playerId","visibleToPlayerId","playerIdsToChildInstanceIds"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.perPlayer.providePlayerId}]}};
bd.modelTag.shareMode={provideFields:function(){return[{fields:["shareMode"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["shareMode"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"local"},{fields:["playerId","visibleToPlayerId","playerIdsToChildInstanceIds"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.shareMode.providePlayerId}]}};
bd.modelTag.perPlayer.providePlayerId=function(){this.model.playerId=this.playerId;this.model.visibleToPlayerId=this.visibleToPlayerId;null!=this.model.playerId&&null==this.model.visibleToPlayerId&&(this.model.visibleToPlayerId=this.playerId);this.model.playerIdsToChildInstanceIds={};null!=this.model.srcInstanceId&&null==bd.model.entityLookup(this.model.srcInstanceId).playerId&&bd.model.entityLookup(this.model.srcInstanceId).entityPerPlayer&&bd.model.addModelUpdateElement([this.model.srcInstanceId],
"dictionary","playerIdsToChildInstanceIds",{key:this.model.playerId,value:this.model.id},{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});return!0};
bd.modelTag.shareMode.providePlayerId=function(){this.model.playerId=this.playerId;this.model.visibleToPlayerId=this.visibleToPlayerId;null!=this.model.playerId&&null==this.model.visibleToPlayerId&&(this.model.visibleToPlayerId=this.playerId);this.model.playerIdsToChildInstanceIds={};null==this.model.srcInstanceId||null!=bd.model.entityLookup(this.model.srcInstanceId).playerId||"perPlayer"!=bd.model.entityLookup(this.model.srcInstanceId).shareMode&&"local"!=bd.model.entityLookup(this.model.srcInstanceId).shareMode||
bd.model.addModelUpdateElement([this.model.srcInstanceId],"dictionary","playerIdsToChildInstanceIds",{key:this.model.playerId,value:this.model.id},{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});return!0};
bd.modelTag.shareModeNoInstance={provideFields:function(){return[{fields:["shareMode"],classOrInstance:"class",providers:["srcInstance","defaultValue"],defaultValue:"local"},{fields:["playerId","visibleToPlayerId","playerIdsToChildInstanceIds"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.shareMode.providePlayerId}]}};
bd.modelTag.perPlayerNoInstance={requiredFields:["entityPerPlayer","playerId","visibleToPlayerId","playerIdsToChildInstanceIds"],provideFields:function(){return[{fields:["entityPerPlayer"],classOrInstance:"class",providers:["srcInstance","defaultValue"],defaultValue:!1},{fields:["playerId","visibleToPlayerId","playerIdsToChildInstanceIds"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.perPlayer.providePlayerId}]}};bd.msg={};bd.msg.VARIABLE_CLICKED_OBJECT="clicked object";bd.msg.VARIABLE_CREATED_OBJECT="created object";bd.msg.VARIABLE_PLAYER="player";bd.msg.VARIABLE_DROPPED_OBJECT="dropped object";bd.msg.VARIABLE_REMOVED_OBJECT="removed object";bd.msg.VARIABLE_START_X="start x";bd.msg.VARIABLE_START_Y="start y";bd.msg.KEY_PRESSED="key pressed";bd.msg.KEY_PRESSED_CODE="key code of pressed key";bd.msg.VARIABLE_COLLIDEE="collidee";bd.msg.VARIABLE_COLLIDEE_1="collidee 1";bd.msg.VARIABLE_COLLIDEE_2="collidee 2";
bd.msg.VARIABLE_WATCHED_VIDEO="watched video";bd.msg.VARIABLE_PREVIOUS_COLUMN="previous column";bd.msg.VARIABLE_PREVIOUS_ROW="previous row";bd.msg.VARIABLE_TARGET_COLUMN="target column";bd.msg.VARIABLE_TARGET_ROW="target row";bd.msg.VARIABLE_TARGET_X="target x";bd.msg.VARIABLE_TARGET_Y="target y";bd.msg.VARIABLE_PLACED_GRID="placed grid";bd.msg.VARIABLE_REMOVED_GRID="removed grid";bd.msg.VARIABLE_POINTER="pointer";bd.msg.VARIABLE_TRIGGERED_TIMER="triggered timer";bd.msg.VARIABLE_PREVIOUS_VALUE="changed variable's old value";
bd.msg.ANY_POINTER="mouse or any pointer";bd.msg.ACTIVE_POINTER="mouse/active pointer";bd.msg.MOUSE_POINTER="mouse";bd.msg.POINTER_NAME="pointer %1";bd.msg.HELP_PAGE_INDICATOR="%1 of %2";bd.msg.ERROR_ALREADY_DELETED="Error: %1, which you tried to remove, has already been deleted";bd.msg.ERROR_DIVISION_BY_ZERO="Error: You tried to divide %1 by zero! Oh noz! :( :(";bd.msg.ERROR_EMPTY_SOCKET="Error: Empty socket in block '%1'";bd.msg.ERROR_INDEX_OUT_OF_BOUNDS="Error: The index '%1' is out of the range of the list '%2' :(";
bd.msg.ERROR_INDEX_NOT_AN_INTEGER="Error: The index you provided (%1) is not an integer";bd.msg.ERROR_INVALID_DEFINITION="Error: Variable '%1' given invalid definition";bd.msg.ERROR_INVALID_PARAMETER="Error: %1 is not a valid input for the function %2";bd.msg.ERROR_NONEXISTENT_ENTITY="Error: An object you tried to access (%1) does not exist";bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME="Error: An object you tried to access does not exist";bd.msg.ERROR_NOT_IN_LIST="Error: The item you tried to remove (%1) from list %2 is not in the list";
bd.msg.ERROR_NULL="Error: Null was used incorrectly in block '%1'";bd.msg.ERROR_NO_RETURN="Error: Procedure Definition should not return anything";bd.msg.ERROR_NOT_IN_PROCEDURE="Error: Return block should only be in Procedure Definition block";bd.msg.ERROR_STRING_INDEX_OUT_OF_BOUNDS="Error: The index '%1' is out of the range of the string '%2' :(";bd.msg.DEBUG_PRINT_UNNAMED="%1";bd.msg.DEBUG_PRINT_NAMED="%2 : %1";bd.msg.PROPERTY_NAME="name";bd.msg.PROPERTY_COLOR="color";
bd.msg.PROPERTY_FONT_SIZE="font size";bd.msg.PROPERTY_VISIBLE_BLOCK="visibility";bd.msg.PROPERTY_VISIBLE_EDITOR="visible";bd.msg.PROPERTY_DRAGGABLE_BLOCK="dragability";bd.msg.PROPERTY_DRAGGABLE_EDITOR="draggable";bd.msg.PROPERTY_ALLOW_HORIZONTAL_DRAG="horizontal draggability";bd.msg.PROPERTY_ALLOW_VERTICAL_DRAG="vertical draggability";bd.msg.PROPERTY_COSTUME_NUM="costume num";bd.msg.PROPERTY_HEIGHT="height";bd.msg.PROPERTY_WIDTH="width";bd.msg.PROPERTY_TINT="tint";bd.msg.PROPERTY_DRAWING_COLOR="drawing color";
bd.msg.PROPERTY_DRAWING_THICKNESS="drawing thickness";bd.msg.PROPERTY_DRAWING_ENABLED="drawing enabled";bd.msg.PROPERTY_PEN_COLOR="pen color";bd.msg.PROPERTY_PEN_THICKNESS="pen thickness";bd.msg.PROPERTY_PEN_ENABLED="pen enabled";bd.msg.PROPERTY_ALLOW_GRAVITY="allow gravity";bd.msg.PROPERTY_GRAVITY_X="gravity X";bd.msg.PROPERTY_GRAVITY_Y="gravity Y";bd.msg.PROPERTY_DAMPING_X="damping X";bd.msg.PROPERTY_DAMPING_Y="damping Y";bd.msg.PROPERTY_FRICTION="friction";bd.msg.PROPERTY_RESTITUTION="restitution";
bd.msg.PROPERTY_FIXED_ROTATION="fixed rotation";bd.msg.PROPERTY_PASSTHROUGH="passthrough";bd.msg.PROPERTY_COLLIDE_WORLD_BOUNDS="collide with edges";bd.msg.PROPERTY_MOVABLE="reacts to collisions";bd.msg.PROPERTY_DIRECTION="direction";bd.msg.PROPERTY_STOP_AFTER_DRAG="stop after drag";bd.msg.PROPERTY_X="x";bd.msg.PROPERTY_Y="y";bd.msg.PROPERTY_BACKGROUND_COLOR="background color";bd.msg.PROPERTY_BACKGROUND_DRAWING_COLOR="background drawing color";bd.msg.PROPERTY_BACKGROUND_DRAWING_THICKNESS="background drawing thickness";
bd.msg.PROPERTY_BACKGROUND_DRAWING_ENABLED="background drawing enabled";bd.modelTag.hasPosition={requiredFields:[{classOrInstance:"instance",fields:["x","y"]}],provideFields:function(){return[{fields:["x","y"],classOrInstance:"instance",providers:["srcInstance","defaultValue"],defaultValue:200}]},provideProperties:function(){return{X:{modelName:"x",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},Y:{modelName:"y",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}}}}};
bd.modelTag.hasDirection={requiredFields:["direction",{classOrInstance:"instance",fields:["useCenterOffset"]}],provideFields:function(){return[{fields:["direction"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["direction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["rotationStyle"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["rotationStyle"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"rotate"},
{fields:["useCenterOffset"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:!1}]}};
bd.modelTag.hasFlipModes={provideFields:function(){return[{fields:["flipHorizontal"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["flipHorizontal"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["flipVertical"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["flipVertical"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]}};
bd.modelTag.hasHeightWidth={requiredFields:["height","width"],provideFields:function(){return[{fields:["height","width"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["height","width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:50}]},provideProperties:function(){return{HEIGHT:{modelName:"height",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject},validator:bd.validator.ctr.getPropertyValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0)},WIDTH:{modelName:"width",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}}}}};bd.modelTag.hasVisibility={requiredFields:["visible"],provideFields:function(){return[{fields:["visible"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["visible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]},provideProperties:function(){return{VISIBLE:{modelName:"visible",getType:function(){return bd.type.ctr.getBooleanTypeObject}}}}};
bd.modelTag.hasDragability={requiredFields:["draggable"],provideFields:function(){return[{fields:["draggable"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["draggable"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["allowHorizontalDrag"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["allowHorizontalDrag"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["allowVerticalDrag"],classOrInstance:"instance",
providers:["srcInstance","parent"]},{fields:["allowVerticalDrag"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]},provideProperties:function(){return{DRAGGABLE:{modelName:"draggable",getType:function(){return bd.type.ctr.getBooleanTypeObject}},ALLOW_HORIZONTAL_DRAG:{modelName:"allowHorizontalDrag",getType:function(){return bd.type.ctr.getBooleanTypeObject}},ALLOW_VERTICAL_DRAG:{modelName:"allowVerticalDrag",getType:function(){return bd.type.ctr.getBooleanTypeObject}}}}};
bd.modelTag.hasCoordinateOffset={provideFields:function(){return[{fields:["offsetType"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["offsetType"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"percent"},{fields:["offsetX"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["offsetX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:.5},{fields:["offsetY"],classOrInstance:"instance",providers:["srcInstance","parent"]},
{fields:["offsetY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:.5}]}};
bd.modelTag.hasViewId={requiredFields:[{classOrInstance:"instance",fields:["viewId"]}],provideFields:function(){return[{fields:["viewId"],classOrInstance:"instance",providers:["srcInstance","function"],fxn:bd.modelTag.hasViewId.provideViewId}]},afterUpdatingModel:function(){if(null!=this.model.viewId){var a=!0;"local"==this.model.shareMode&&(a=!1);bd.model.addModelUpdateElement([this.model.viewId],"push",this.idListName,this.id,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,
updateUIInEditor:!1,shouldPropagate:a})}}};bd.modelTag.hasViewId.provideViewId=function(){this.model.viewId=bd.inPlayer?null:bd.model.getCurrentViewId();return!0};bd.modelTag.hasLayerId={requiredFields:["layerId"],provideFields:function(){return[{fields:["layerId"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasLayerId.provideLayerId}]}};
bd.modelTag.hasLayerId.provideLayerId=function(){if(bd.inPlayer)this.srcInstance?(this.model.layerId=this.srcInstance.layerId,bd.model.addModelUpdateElement([this.model.layerId],"push","entityIds",this.id,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!0})):this.model.layerId=null;else if(this.srcInstance)this.model.layerId=this.srcInstance.layerId;else{var a=bd.component.lookup(bd.model.getCurrentViewId());this.model.layerId=a.getSelectedLayerId();bd.model.addModelUpdateElement([this.model.layerId],
"push","entityIds",this.id,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!0})}return!0};bd.modelTag.hasTint={provideFields:function(){return[{fields:["tint"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["tint"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"#ffffff"}]},provideProperties:function(){return{TINT:{modelName:"tint",getType:function(){return bd.type.ctr.getColorTypeObject}}}}};
bd.modelTag.hasDrawingProperties={provideFields:function(){return[{fields:["drawingColor"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["drawingColor"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"#000000"},{fields:["drawingThickness"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["drawingThickness"],classOrInstance:"class",providers:["defaultValue"],defaultValue:10},{fields:["drawingEnabled"],classOrInstance:"instance",providers:["srcInstance",
"parent"]},{fields:["drawingEnabled"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]},provideProperties:function(){return{DRAWING_COLOR:{modelName:"drawingColor",getType:function(){return bd.type.ctr.getColorTypeObject}},DRAWING_THICKNESS:{modelName:"drawingThickness",getType:function(){return bd.type.ctr.getNumberTypeObject}},DRAWING_ENABLED:{modelName:"drawingEnabled",getType:function(){return bd.type.ctr.getBooleanTypeObject}}}}};
bd.modelTag.hasPenProperties={provideFields:function(){return[{fields:["penColor"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["penColor"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"#000000"},{fields:["penThickness"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["penThickness"],classOrInstance:"class",providers:["defaultValue"],defaultValue:10},{fields:["penEnabled"],classOrInstance:"instance",providers:["srcInstance","parent"]},
{fields:["penEnabled"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]},provideProperties:function(){return{PEN_COLOR:{modelName:"penColor",getType:function(){return bd.type.ctr.getColorTypeObject}},PEN_THICKNESS:{modelName:"penThickness",getType:function(){return bd.type.ctr.getNumberTypeObject}},PEN_ENABLED:{modelName:"penEnabled",getType:function(){return bd.type.ctr.getBooleanTypeObject}}}}};bd.modelTag.entity={requiredFields:["type","id","name"],afterUpdatingModel:function(){bd.model.getCurrentGame()[this.listName].push(this.model)},provideFields:function(){return[{fields:["type"],providers:["function"],fxn:bd.modelTag.entity.provideType},{fields:["id"],providers:["function"],fxn:bd.modelTag.entity.provideId},{fields:["name"],providers:["srcInstance","function"],fxn:bd.modelTag.entity.provideName}]},provideProperties:function(){return{NAME:{modelName:"name",getType:function(){return bd.type.ctr.getStringTypeObject},
blockWrite:!1}}},applyTagNoModelUpdate:function(){bd.modelTag.entity.addEntityToLookup(this);this.id=this.model.id;bd.inPlayer||(this.componentViewerVisibleToggle=bd.componentViewer.ctr.defaultClassVisibleToggle)}};bd.modelTag.entity.provideType=function(){return this.type?(this.model.type=this.type,!0):!1};
bd.modelTag.entity.provideId=function(){if(bd.isServer||!bd.inPlayer)this.model.id=bd.model.getCurrentGame().nextId++;else if(null==bd.model.getPlayerId())if("player"==this.type)this.model.id=uuid.v4();else throw"Error: No player Id defined";else this.model.id=bd.model.getPlayerId()+"_"+bd.entityLookup[bd.model.getPlayerId()].nextId,bd.entityLookup[bd.model.getPlayerId()].nextId++;return!0};
bd.modelTag.entity.provideName=function(){for(var a=bd.model.getCurrentGame()[this.listName],b={},c=0;c<a.length;c++)b[a[c].name]=!0;c=1;for(a=this.namePrefix+c;1==b[a];)c++,a=this.namePrefix+c;this.model.name=a;return!0};bd.modelTag.entity.addEntityToLookup=function(a){bd.inPlayer||bd.isServer||!bd.preview.ctr.creatingInstance&&!bd.preview.ctr.creatingPreviewPlayer?bd.entityLookup[a.model.id]=a.model:bd.preview.ctr.previewEntityLookup[a.model.id]=a.model;bd.component.addToLookup(a)};
bd.modelTag.hasParentAndInstances={requiredFields:[{classOrInstance:"instance",fields:["parentId"]},{classOrInstance:"class",fields:["instanceIds"]}],provideFields:function(){return[{fields:["parentId"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasParentAndInstances.provideParentId},{fields:["instanceIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]}]}};
bd.modelTag.hasParentAndInstances.provideParentId=function(){this.model.parentId=this.parentId;bd.model.addModelUpdateElement([this.parentId],"push","instanceIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});return!0};bd.modelTag.hasSrcInstanceId={requiredFields:[{classOrInstance:"instance",fields:["srcInstanceId"]}],provideFields:function(){return[{fields:["srcInstanceId"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasSrcInstanceId.provideSrcInstanceId}]}};
bd.modelTag.hasSrcInstanceId.provideSrcInstanceId=function(){this.model.srcInstanceId=this.srcInstance?this.srcInstance.id:null;return!0};bd.modelTag.hasBlockEntityTracking={requiredFields:[{classOrInstance:"class",fields:["blockIdsToUsedEntities"]},"blockReferrers"],provideFields:function(){return[{fields:["blockIdsToUsedEntities"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["blockReferrers"],providers:["defaultValue"],defaultValue:{}}]}};
bd.modelTag.hasScripts={requiredFields:[{classOrInstance:"class",fields:["scripts","scriptObject","procIdToName"]}],provideFields:function(){return[{fields:["scripts"],classOrInstance:"class",providers:["defaultValue"],defaultValue:bd.model.emptyScript},{fields:["scriptObject"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["procIdToName"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}}]}};bd.methodTag={};
bd.modelTag.applyTags=function(a,b){function c(f){f=bd.modelTag[f];if(f.tags)for(var g=0;g<f.tags.length;g++)c(f.tags[g]);if(b){if(f.requiredFields)for(var h,g=0;g<f.requiredFields;g++)if(h=f.requiredFields[g],!h.classOrInstance)e.push(h);else if("class"==h.classOrInstance&&"instance"!=a.classOrInstance||"instance"==h.classOrInstance&&"class"!=a.classOrInstance)e=e.concat(h.fields);h=[];f.provideFields&&(h=f.provideFields());for(g=0;g<h.length;g++){var n=h[g];if(!n.classOrInstance||!("class"==n.classOrInstance&&
"instance"==a.classOrInstance||"instance"==n.classOrInstance&&"class"==a.classOrInstance))for(var q=0;q<n.providers.length;q++){var p=n.providers[q];if("function"==p){n.fxn.call(a);for(var t in n.fields);break}else if("srcInstance"==p&&null!=a.srcInstance){for(p=0;p<n.fields.length;p++)t=n.fields[p],a.model[t]=a.srcInstance[t];break}else if("parent"==p&&null!=a.parentId){for(p=0;p<n.fields.length;p++)t=n.fields[p],a.model[t]=bd.model.entityLookup(a.parentId)[t];break}else if("componentObject"==p)for(p=
0;p<n.fields.length;p++)t=n.fields[p],a.model[t]=a[t];else if("defaultValue"==p){for(p=0;p<n.fields.length;p++)t=n.fields[p],a.model[t]=n.defaultValue;break}}}}f.applyTagNoModelUpdate&&f.applyTagNoModelUpdate.call(a)}var e=[];if(b&&"game"!=a.type)var f=bd.model.addModelUpdateElement("game","addEntity",a.listName,a.model,{updateUIForOrigin:!0,updateModelForOrigin:!1,updateModelInEditor:!1,updateUIInEditor:!1});for(var g=0;g<a.modelTags.length;g++)c(a.modelTags[g]);for(g=0;g<a.modelTags.length;g++){var h=
bd.modelTag[a.modelTags[g]];h&&h.afterUpdatingModel&&b&&h.afterUpdatingModel.call(a)}b&&"game"!=a.type&&(f.value=JSON.stringify(f.value),"local"==a.model.shareMode&&bd.inPlayer&&(f.shouldPropagate=!1));bd.inPlayer||"game"==a.type||bd.model.sendUpdates()};bd.modelTag.componentContainsTag=function(a,b){for(var c=bd.component.lookup(a).modelTags,e=0;e<c.length;e++)if(c[e]==b)return!0;return!1};
bd.modelTag.removeConnections=function(a){var b=bd.component.lookup(a).modelTags;a=bd.component.lookup(a);for(var c=0;c<b.length;c++){var e=bd.modelTag[b[c]],f=[];e.provideFields&&(f=e.provideFields());for(e=0;e<f.length;e++){var g=f[e];g.classOrInstance&&("class"==g.classOrInstance&&"instance"==a.classOrInstance||"instance"==g.classOrInstance&&"class"==a.classOrInstance)||g.removeConnectionFxn&&g.removeConnectionFxn.call(a)}}};
bd.methodTag.componentContainsTag=function(a,b){for(var c=bd.component.lookup(a).methodTags,e=0;e<c.length;e++)if(c[e]==b)return!0;return!1};
bd.methodTag.applyMethodTags=function(a){a.methods={};for(var b=0;b<a.methodTags.length;b++){var c=bd.methodTag[a.methodTags[b]];if(c.tags)for(var e=0;e<c.tags.length;e++)applyTag(c.tags[e]);var f=[];c.provideMethods&&(f=c.provideMethods());for(e=0;e<f.length;e++)c=f[e],c.classOrInstance&&("class"==c.classOrInstance&&"instance"==a.classOrInstance||"instance"==c.classOrInstance&&"class"==a.classOrInstance)||!1===c.inEditor&&!bd.inPlayer||!1===c.inPlayer&&bd.inPlayer||!c.fxn||(a.methods[c.name]=c.fxn,
a[c.name]=c.fxn)}};bd.component={};bd.component.lookupDict={};bd.component.previewLookupDict={};bd.component.categoryToClassInstance={};bd.component.typeNameToComponent={};bd.component.childNameToParentName={};bd.component.parentNameToChildName={};bd.component.viewTypes=[];bd.component.assetTypes=[];bd.component.assetThumbnailUrlsToIds={};
bd.component.initializeComponents=function(){for(var a in bd.component.childNameToParentName)bd.component.parentNameToChildName[bd.component.childNameToParentName[a]]=a;for(var b in bd.component.typeNameToComponent)bd.component.typeNameToComponent[b].componentProperties.isView&&bd.component.viewTypes.push(b),bd.component.typeNameToComponent[b].componentProperties.isAsset&&bd.component.assetTypes.push(b),bd.component.typeNameToComponent[b].initializeComponent&&bd.component.typeNameToComponent[b].initializeComponent(),
bd.component.typeNameToComponent[b].componentProperties.componentViewerVisibleToggle=!0,bd.component.populateProperties(b)};bd.component.lookup=function(a){return bd.component.lookupDict[a]};bd.component.addToLookup=function(a){bd.component.lookupDict[a.model.id]=a};
bd.component.handleInstanceParameters=function(a,b,c,e,f){this.model=null!=a?a:{};this.parentId="undefined"==typeof b?null:b;this.srcInstance="undefined"==typeof c?null:c;this.playerId="undefined"==typeof e?null:e;this.visibleToPlayerId="undefined"==typeof f?null:f};bd.component.handleCommand=function(a,b){for(var c=a.methodTags.length-1;0<=c&&(!bd.methodTag[a.methodTags[c]].handleCommand||!bd.methodTag[a.methodTags[c]].handleCommand.call(a,b));c--);};
bd.component.addComponentListToComponent=function(a,b,c){if(null==b){b=[];for(var e in bd.component.typeNameToComponent)b.push(e)}for(e=0;e<b.length;e++)a.model[bd.component.typeNameToComponent[b[e]].componentProperties[c]]=[]};bd.component.isComponentClass=function(a){return null!=bd.component.parentNameToChildName[a]};bd.component.whenGameCreated=function(){for(var a in bd.component.typeNameToComponent)bd.component.typeNameToComponent[a].whenGameCreated&&bd.component.typeNameToComponent[a].whenGameCreated()};
bd.component.whenGameLoadedInEditor=function(){for(var a in bd.component.typeNameToComponent)bd.component.typeNameToComponent[a].whenGameLoadedInEditor&&bd.component.typeNameToComponent[a].whenGameLoadedInEditor()};
bd.component.setDefaultAssetVariables=function(){for(var a=bd.component.assetTypes,b=0;b<a.length;b++)for(var c=bd.component.typeNameToComponent[a[b]],e=0;e<bd.model.getCurrentGame()[c.componentProperties.listName].length;e++){var f=bd.model.getCurrentGame()[c.componentProperties.listName][e];null==bd.component.assetThumbnailFileNameToIds[f.thumbnailFileName]?bd.component.assetThumbnailFileNameToIds[f.thumbnailFileName]=[f.id]:bd.component.assetThumbnailFileNameToIds[f.thumbnailFileName].push(f.id)}};
bd.component.getEntityNameToIdDictionary=function(){var a={},b;for(b in bd.component.lookupDict)a[bd.component.lookupDict[b].model.name]=b;return a};
bd.component.getDefaultAssetIdForComponent=function(a){var b=bd.defaultPieceAsset.id,c=bd.component.getComponentByType(a);if(c.getDefaultAssetId)b=c.getDefaultAssetId();else switch(a){case "player":b=bd.defaultPlayerAsset.id;break;case "video":b=bd.defaultVideoAsset.id;break;case "phaserPiece":case "phaserPhysicsPiece":case "grid":case "table":case "tmxImageLayer":b=bd.defaultPieceAsset.id;break;case "sound":b=bd.defaultSoundAsset.id}return b};bd.component.getComponentByType=function(a){return bd.component.typeNameToComponent[a]};
bd.component.populateProperties=function(a){a=bd.component.getComponentByType(a);for(var b=0,c;c=a.componentProperties.modelTags[b];b++){c=bd.modelTag[c];var e=[];c.provideProperties&&(e=c.provideProperties());for(var f in e)a.propertyNameToObject||(a.propertyNameToObject={}),a.propertyNameToObject[f]=e[f]}};bd.modelTag.hasTableProperties={provideFields:function(){return[{fields:["columnIds"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.hasTableProperties.provideColumnIds,removeConnectionFxn:bd.modelTag.hasTableProperties.removeColumnIds},{fields:["rowIds"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:[]},{fields:["editorRowData"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasTableProperties.editorData},{fields:["playerRowData"],classOrInstance:"instance",
providers:["defaultValue"],defaultValue:[]}]}};bd.modelTag.hasTableProperties.provideColumnIds=function(){this.model.columnIds=[];var a=bd.component.tableColumn.componentProperties.columnTypes;new bd.component.tableColumn.constructor(null,this.id,null,a[0]);new bd.component.tableColumn.constructor(null,this.id,null,a[0])};
bd.modelTag.hasTableProperties.editorData=function(){for(var a=bd.component.lookup(this.model.parentId).model.columnIds,b=[[]],c=0;c<a.length;c++)b[0].push("");this.model.editorRowData=b;return!0};bd.modelTag.hasTableProperties.removeColumnIds=function(){if(0!=this.model.columnIds.length)for(var a=0;a<this.model.columnIds.length;a++)bd.component.lookup(this.model.columnIds[a]).deleteEntity()};bd.modelTag.hasTraits={requiredFields:[{classOrInstance:"class",fields:["traitDefIds"]},{classOrInstance:"instance",fields:["traitIds"]}],provideFields:function(){return[{fields:["traitDefIds"],classOrInstance:"class",providers:["defaultValue"],removeConnectionFxn:bd.modelTag.hasTraits.removeTraitDefIds,defaultValue:[]},{fields:["traitIds"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:[]}]}};
bd.modelTag.hasTraits.removeTraitDefIds=function(){if(0!=this.model.traitDefIds.length)for(var a=0;a<this.model.traitDefIds.length;a++)bd.component.lookup(this.model.traitDefIds[a]).deleteEntity()};bd.modelTag.hasTraitsNoInstance={requiredFields:["traitDefIds","traitIds"],provideFields:function(){return[{fields:["traitDefIds"],providers:["defaultValue"],defaultValue:[]},{fields:["traitIds"],providers:["defaultValue"],defaultValue:[]}]}};
bd.modelTag.hasTraitDefCommonProperties={requiredFields:"traitType listDepth listType traitScope reporterVisible traitIds sharedDefault".split(" "),provideFields:function(){return[{fields:["value"],providers:["srcInstance","defaultValue"],defaultValue:0},{fields:["traitType"],providers:["srcInstance","defaultValue"],defaultValue:"value"},{fields:["listDepth"],providers:["srcInstance","defaultValue"],defaultValue:0},{fields:["listType"],providers:["srcInstance","defaultValue"],defaultValue:"value"},
{fields:["reporterVisible"],providers:["srcInstance","defaultValue"],defaultValue:!1},{fields:["traitIds"],providers:["defaultValue"],defaultValue:[]},{fields:["sharedDefault"],providers:["defaultValue"],defaultValue:!0}]}};
bd.modelTag.hasTraitDefProperties={requiredFields:["entityId","traitScope","reporterVisible","traitIds","commonTraitDefId"],provideFields:function(){return[{fields:["entityId"],providers:["function"],fxn:bd.modelTag.hasTraitDefProperties.provideEntityId},{fields:["traitScope"],providers:["defaultValue"],defaultValue:"local"},{fields:["commonTraitDefId"],providers:["defaultValue"],defaultValue:null}]}};bd.modelTag.hasTraitDefProperties.provideEntityId=function(){this.model.entityId=this.entityId;bd.entityLookup[this.entityId].traitDefIds.push(this.id)};
bd.modelTag.hasCommonTraitDefProperties={requiredFields:["entityIdToTraitDefId","entityType","traitScope"],provideFields:function(){return[{fields:["entityIdToTraitDefId"],providers:["srcInstance","defaultValue"],defaultValue:{}},{fields:["entityType"],providers:["function"],fxn:bd.modelTag.hasCommonTraitDefProperties.provideEntityType},{fields:["traitScope"],providers:["defaultValue"],defaultValue:"global"}]},afterUpdatingModel:function(){for(var a=bd.component[this.model.entityType].componentProperties.listName,
b=0;b<bd.model.getCurrentGame()[a].length;b++)bd.model.getCurrentGame()[a][b].traitDefIds.push(this.id)}};bd.modelTag.hasCommonTraitDefProperties.provideEntityType=function(){this.model.entityType=this.entityType};
bd.modelTag.hasTraitProperties={requiredFields:["traitDefId","instanceId","value"],provideFields:function(){return[{fields:["traitDefId","instanceId"],providers:["componentObject"]},{fields:["value"],providers:["function"],fxn:bd.modelTag.hasTraitProperties.provideValue},{fields:["shareMode"],providers:["function"],fxn:bd.modelTag.hasTraitProperties.provideShareMode}]},afterUpdatingModel:function(){bd.model.addModelUpdateElement([this.model.traitDefId],"push","traitIds",this.id,{updateUIForOrigin:!1,
updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([this.model.instanceId],"push","traitIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})}};bd.modelTag.hasTraitProperties.provideValue=function(){this.model.value=null==this.value?JSON.parse(JSON.stringify(bd.entityLookup[this.model.traitDefId].value)):JSON.parse(JSON.stringify(this.value))};
bd.modelTag.hasTraitProperties.provideShareMode=function(){this.model.shareMode=bd.model.entityLookup(this.model.instanceId).shareMode};bd.methodTag.table={provideMethods:function(){return[{name:"sortTable",fxn:bd.methodTag.table.sortTable,classOrInstance:"instance"},{name:"filterTable",fxn:bd.methodTag.table.filterTable,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.table.updateSideBar,classOrInstance:"class"},{name:"removeConnections",fxn:bd.methodTag.table.removeConnections,classOrInstance:"instance"},{name:"setupTableEditor",fxn:bd.methodTag.table.setupTableEditor,classOrInstance:"instance"},{name:"setTableObject",
fxn:bd.methodTag.table.setTableObject},{name:"getTableObject",fxn:bd.methodTag.table.getTableObject},{name:"getHandsOnTableObject",fxn:bd.methodTag.table.getHandsOnTableObject},{name:"getRowData",fxn:bd.methodTag.table.getRowData},{name:"getHandsOnTableColumnTypes",fxn:bd.methodTag.table.getHandsOnTableColumnTypes,classOrInstance:"class"},{name:"setupSideBarClassTableEditor",fxn:bd.methodTag.table.setupSideBarClassTableEditor,classOrInstance:"class"},{name:"setSidebarTableSelection",fxn:bd.methodTag.table.setSidebarTableSelection,
classOrInstance:"instance"},{name:"getColumnIds",fxn:bd.methodTag.table.getColumnIds,classOrInstance:"instance"},{name:"setCellValue",fxn:bd.methodTag.table.setCellValue,classOrInstance:"instance"},{name:"getCellValue",fxn:bd.methodTag.table.getCellValue,classOrInstance:"instance"},{name:"addDataRow",fxn:bd.methodTag.table.addDataRow,classOrInstance:"instance"},{name:"getNumberOfRows",fxn:bd.methodTag.table.getNumberOfRows,classOrInstance:"instance"},{name:"getNumberOfColumns",fxn:bd.methodTag.table.getNumberOfColumns,
classOrInstance:"instance"},{name:"colorHTMLRenderer",fxn:bd.methodTag.table.colorHTMLRenderer}]}};
bd.methodTag.table.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);b.getElementsByClassName("columnEditorLink")[0].onclick=function(a){bd.overlay.ctr.showOverlay("columnEditor");return!1};c=b.getElementsByClassName("tableDropDown")[0];if(c.options[c.selectedIndex])var e=
parseInt(c.options[c.selectedIndex].value);c.innerHTML="";for(var a=a.instanceIds,f=[],g=0;g<a.length;g++){var h=bd.component.lookup(a[g]),k=document.createElement("option");c.options.add(k);k.text=h.model.name;k.value=h.model.id;f.push(h.model.id)}e&&-1!=f.indexOf(e)&&(c.value=e);var l=this;c.onchange=function(a){l.setupSideBarClassTableEditor()};0==a.length?(b.getElementsByClassName("tableEditorContainer")[0].innerHTML="",b.getElementsByClassName("sideBarTableSelectionContainer")[0].style.visibility=
"hidden",b.getElementsByClassName("sideBarTablePreviewContainer")[0].style.visibility="hidden"):(b.getElementsByClassName("sideBarTableSelectionContainer")[0].style.visibility="visible",b.getElementsByClassName("sideBarTablePreviewContainer")[0].style.visibility="visible",this.setupSideBarClassTableEditor())};
bd.methodTag.table.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.table.setupSideBarClassTableEditor=function(){var a=document.getElementById(this.sideBarPanelName),b=parseInt(a.getElementsByClassName("tableDropDown")[0].value),b=bd.component.lookup(b),a=a.getElementsByClassName("tableEditorContainer")[0];b.setupTableEditor(a)};bd.methodTag.table.setSidebarTableSelection=function(){var a=bd.component.lookup(this.model.parentId);document.getElementById(a.sideBarPanelName).getElementsByClassName("tableDropDown")[0].value=this.id;a.setupSideBarClassTableEditor()};
bd.methodTag.table.setupTableEditor=function(a){for(var b=bd.component.lookup(this.model.parentId),c=[],e=0;e<b.model.columnIds.length;e++){var f=bd.component.lookup(b.model.columnIds[e]).model.name;c.push(f)}e=this.getRowData();a.innerHTML="";var f=this.getHandsOnTableObject(),g=!1;bd.inPlayer&&this.model.readOnly&&(g=!0);a=new f(a,{data:e,minSpareRows:1,colHeaders:c,columns:b.getHandsOnTableColumnTypes(),readOnly:g,contextMenu:["row_above","row_below","remove_row","undo","redo"]});this.setTableObject(a)};
bd.methodTag.table.colorHTMLRenderer=function(a,b,c,e,f,g,h){""==g&&(g="#ffffff");b.onclick=function(){bd.inPlayer||bd.overlay.ctr.showOverlay("colorSelect",function(f){b.style.background=f;a.setDataAtCell(c,e,f)})};b.innerHTML="";b.style.background=g;return b};bd.methodTag.table.setTableObject=function(a){this.tableObject=a};bd.methodTag.table.getTableObject=function(){return this.tableObject};bd.methodTag.table.getHandsOnTableObject=function(){return Handsontable};
bd.methodTag.table.getRowData=function(){return bd.inPlayer?this.model.playerRowData:this.model.editorRowData};
bd.methodTag.table.getHandsOnTableColumnTypes=function(){for(var a=[],b=this.model.columnIds,c,e=0;e<b.length;e++){c={};var f=bd.component.lookup(b[e]).model.columnType;c.type=bd.component.tableColumn.componentProperties.columnTypeToInfo[f].typeHot;bd.inPlayer&&(c.data="data."+e+".value");"Color"==bd.component.tableColumn.componentProperties.columnTypeToInfo[f].typeBlock[0]&&(c.renderer=this.colorHTMLRenderer);a.push(c)}return a};
bd.methodTag.table.sortTable=function(a,b,c){for(var e=bd.component.lookup(a.model.parentId).model.columnIds,f,g=0;g<e.length;g++)if(e[g]==b.id){f=g;break}var h=a.model.rowIds;a=[];e=[];for(g=0;g<h.length;g++){var k=bd.component.lookup(h[g]).model.data[f];e.push(k);a.push({row:h[g],data:k})}switch(b.model.columnType){case "String":e.sort();break;case "Number":e.sort(function(a,b){return a-b})}"decreasing"==c&&e.reverse();b=[];for(g=0;g<e.length;g++)for(c=e[g],f=0;f<a.length;f++)a[f].data==c&&-1==
b.indexOf(a[f].row)&&b.push(a[f].row);return b};
bd.methodTag.table.filterTable=function(a,b){var c=a.model.rowIds,e=[];switch(b.type){case "num_compare":var f=b.params[0].id,g=bd.component.lookup(a.model.parentId),h;for(i=0;i<g.model.columnIds.length;i++)if(g.model.columnIds[i]==f){h=i;break}f=b.operation;g=b.params[1];for(i=0;i<c.length;i++){var k=bd.component.lookup(c[i]).model.data[h];bd.evaluator.ctr.configs.logic_compare.conditionEval(f,k,g)&&e.push(c[i])}break;case "and":for(c=b.params[1],filteredIds1=a.filterTable(a,b.params[0]),filteredIds2=
a.filterTable(a,c),filteredConcat=filteredIds1.concat(filteredIds2),i=0;i<filteredConcat.length;i++)e.indexOf(-1==filteredConcat[i])&&e.push(filteredConcat[i])}return e};bd.methodTag.table.getColumnIds=function(){return bd.component.lookup(this.model.parentId).model.columnIds};
bd.methodTag.table.getCellValue=function(a,b){var c=this.model.playerRowData.length;this.hasExtraRowInPlayer&&--c;if(b<c&&(c=this.model.playerRowData[b])&&a<c.data.length)return c.data[a]?c.data[a].value:"";bd.errorLog.ctr.printError("Error: Invalid row or column, returning null.");return bd.model.nullBlockString};
bd.methodTag.table.setCellValue=function(a,b,c){var e=!1,f=this.model.playerRowData.length;this.hasExtraRowInPlayer&&--f;b<f&&0<=b&&(b=this.model.playerRowData[b],a<b.data.length&&0<=a&&(b.data[a].value=c,e=!0));e||bd.errorLog.ctr.printError("Error: Invalid row or column, value not set.");this.renderTable&&this.renderTable()};
bd.methodTag.table.addDataRow=function(a,b){var c=new bd.component.tableRow.constructor(null,this.id);-1==b?this.hasExtraRowInPlayer?this.model.playerRowData.splice(this.model.playerRowData.length-1,0,{id:c.id,data:a}):this.model.playerRowData.push({id:c.id,data:a}):(this.hasExtraRowInPlayer&&b>=this.model.playerRowData.length&&(b=this.model.playerRowData.length-1),this.model.playerRowData.splice(b,0,{id:c.id,data:a}));bd.model.sendUpdates();this.renderTable&&this.renderTable()};
bd.methodTag.table.getNumberOfRows=function(){var a=this.model.playerRowData.length;this.hasExtraRowInPlayer&&--a;return a};bd.methodTag.table.getNumberOfColumns=function(){return bd.component.lookup(this.model.parentId).model.columnIds.length};bd.methodTag.entity={provideMethods:function(){return[{name:"updateInstanceName",fxn:bd.methodTag.entity.updateInstanceName,classOrInstance:"instance"},{name:"updateClassName",fxn:bd.methodTag.entity.updateClassName,classOrInstance:"class"},{name:"deleteInstance",fxn:bd.methodTag.entity.deleteInstance,classOrInstance:"instance"},{name:"deleteEntityCheck",fxn:bd.methodTag.entity.deleteEntityCheck,classOrInstance:"class"},{name:"deleteEntity",fxn:bd.methodTag.entity.deleteEntity,classOrInstance:"class"},
{name:"afterComponentCreated",fxn:bd.methodTag.entity.afterComponentCreated,classOrInstance:"class"},{name:"removeConnections",fxn:bd.methodTag.entity.removeConnections},{name:"storeDeletedIdToName",fxn:bd.methodTag.entity.storeDeletedIdToName}]}};bd.methodTag.entity.handleCommand=function(a){return"gameName"==a.property||"name"==a.property?(bd.model.isInstance(this.id)?this.updateInstanceName():this.updateClassName(),!0):"deleteInstance"==a.property?(this.deleteInstance(!0),!0):!1};
bd.methodTag.entity.updateInstanceName=function(){if(bd.editor.ctr.getSelectedInstanceId()==this.id&&this.instancePanelName){var a=document.getElementById(this.instancePanelName);0!=a.getElementsByClassName("nameInput").length&&(a=a.getElementsByClassName("nameInput")[0],a.hasFocus||(a.value=this.model.name))}(a=document.getElementById("componentViewerNameInput"+this.id))&&!a.hasFocus&&(a.value=this.model.name);bd.script.ctr.renameEntityInFields(this.id)};
bd.methodTag.entity.updateClassName=function(){bd.updateSelections();if(bd.editor.ctr.getSelectedEntity().id==this.id){var a=document.getElementById(this.sideBarPanelName).getElementsByClassName("nameInput")[0];a.hasFocus||(a.value=this.model.name)}(a=document.getElementById("componentViewerNameInput"+this.id))&&!a.hasFocus&&(a.value=this.model.name);bd.script.ctr.renameEntityInFields(this.id)};bd.methodTag.entity.deleteComponent=function(){var a=this.shouldDeleteComponent();1!=a&&(bd.inPlayer||alert(a.message))};
bd.methodTag.entity.shouldDeleteComponent=function(){};
bd.methodTag.entity.deleteInstance=function(a){a=bd.model.entityLookup(this.id);this.removeInstanceFromView&&this.removeInstanceFromView();this.removeConnections();bd.model.addModelUpdateElement("game","deleteEntity",a.type+"s",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1,shouldPropagate:!1});bd.model.sendUpdates();delete bd.entityLookup[this.id];bd.inPlayer||(bd.sideBar.ctr.updateSideBar(),bd.componentViewer.ctr.setup(),bd.script.ctr.updateToolbox(),
this.storeDeletedIdToName())};
bd.methodTag.entity.storeDeletedIdToName=function(){bd.model.getGameInfo().deletedEntityIdToName[this.id]=this.model.name;for(var a=bd.script.ctr.getAllBlocks(),b=0;b<a.length;b++){var c=a[b],e=bd.blocks.ctr.getEntityTitles(c);if(null!=e)for(var f=0;f<e.length;f++){if(null!=c.getFieldValue(e[f])){var g=bd.util.removePrefix(c.getFieldValue(e[f]),"id");if(bd.util.containsPrefix(g,"msg"))continue}g==this.id&&null==bd.model.entityLookup(g)&&c.getField_(e[f])&&(null==c.mutators.fieldNameToEntityName&&(c.mutators.fieldNameToEntityName=
{}),c.mutators.fieldNameToEntityName[e[f]]=c.getField_(e[f]).getText(),c.setFieldValue(bd.blocks.ctr.deletedEntityId,e[f]))}}bd.script.ctr.checkAllWarningsAndErrors()};
bd.methodTag.entity.deleteEntityCheck=function(a){"undefined"==typeof a&&(a=!0);var b=bd.model.entityLookup(this.id),c;for(c in b.blockReferrers)if(c!=this.id&&a||!a)throw a=new bd.error.CannotDeleteEntityError(this.id,c),a;if(null!=b.instanceIds)for(var e=0;e<b.instanceIds.length;e++){var f=bd.model.entityLookup(b.instanceIds[e]);for(c in f.blockReferrers)if(c!=this.id&&a||!a)throw a=new bd.error.CannotDeleteEntityError(this.id,c,f.id),a;}};
bd.methodTag.entity.deleteEntity=function(){var a=bd.model.entityLookup(this.id);null==bd.methodTag.entity.deleteEntity.currentlyDeleting&&(bd.methodTag.entity.deleteEntity.currentlyDeleting=this.id);if(null!=a.instanceIds)for(var b=JSON.parse(JSON.stringify(a.instanceIds)),c=0;c<b.length;c++)bd.component.lookup(b[c]).deleteInstance(!0);bd.modelTag.removeConnections(this.id);this.removeConnections();bd.model.addModelUpdateElement("game","deleteEntity",a.type+"s",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,
updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();delete bd.entityLookup[this.id];bd.methodTag.entity.deleteEntity.currentlyDeleting==this.id&&(a=bd.editor.ctr.getEntityTabObject().model.entityIds,bd.editor.ctr.getEntityTabObject().selectedEntityIndex>=a.length&&(bd.editor.ctr.getEntityTabObject().selectedEntityIndex=a.length-1),bd.updateSelections(),bd.sideBar.ctr.updateSideBar(),bd.componentViewer.ctr.setup(),bd.script.ctr.updateToolbox(),bd.methodTag.entity.deleteEntity.currentlyDeleting=
null);this.storeDeletedIdToName()};bd.methodTag.entity.afterComponentCreated=function(){};bd.methodTag.entity.removeConnections=function(){};bd.methodTag.canvasObject={provideMethods:function(){return[{name:"hide",fxn:bd.methodTag.canvasObject.hide,classOrInstance:"instance"},{name:"show",fxn:bd.methodTag.canvasObject.show,classOrInstance:"instance"},{name:"setWidthHeight",fxn:bd.methodTag.canvasObject.setWidthHeight,classOrInstance:"instance"},{name:"getCostumeIds",fxn:bd.methodTag.canvasObject.getCostumeIds,classOrInstance:"instance"},{name:"switchCostume",fxn:bd.methodTag.canvasObject.switchCostume,classOrInstance:"instance"},{name:"updatePosition",
fxn:bd.methodTag.canvasObject.updatePosition,classOrInstance:"instance"},{name:"getXOrY",fxn:bd.methodTag.canvasObject.getXOrY,classOrInstance:"instance"},{name:"getDirection",fxn:bd.methodTag.canvasObject.getDirection,classOrInstance:"instance"},{name:"getAngleToEntity",fxn:bd.methodTag.canvasObject.getAngleToEntity,classOrInstance:"instance"},{name:"setDirection",fxn:bd.methodTag.canvasObject.setDirection,classOrInstance:"instance",inEditor:!0,inPlayer:!1},{name:"setDraggable",fxn:bd.methodTag.canvasObject.setDraggable,
classOrInstance:"instance"},{name:"removeInstanceFromView",fxn:bd.methodTag.canvasObject.removeInstanceFromView,classOrInstance:"instance"},{name:"addEntity",fxn:bd.methodTag.canvasObject.addEntity,classOrInstance:"instance"},{name:"addBox",fxn:bd.methodTag.canvasObject.addBox,classOrInstance:"instance"},{name:"removeBox",fxn:bd.methodTag.canvasObject.removeBox,classOrInstance:"instance"},{name:"drawLayer",fxn:bd.methodTag.canvasObject.drawLayer,classOrInstance:"instance"},{name:"getLayer",fxn:bd.methodTag.canvasObject.getLayer,
classOrInstance:"instance"},{name:"getLayerName",fxn:bd.methodTag.canvasObject.getLayerName,classOrInstance:"instance"},{name:"getOffsetXY",fxn:bd.methodTag.canvasObject.getOffsetXY,classOrInstance:"instance"},{name:"selectInstanceInEditor",fxn:bd.methodTag.canvasObject.selectInstanceInEditor,classOrInstance:"instance"},{name:"createSelectionBorder",fxn:bd.methodTag.canvasObject.createSelectionBorder,classOrInstance:"instance"},{name:"createKineticEditorObject",fxn:bd.methodTag.canvasObject.createKineticEditorObject,
classOrInstance:"instance"},{name:"createKineticEditorObjectOnLayer",fxn:bd.methodTag.canvasObject.createKineticEditorObjectOnLayer,classOrInstance:"instance"},{name:"createEditorDisplayObjectFromXY",fxn:bd.methodTag.canvasObject.createEditorDisplayObjectFromXY,classOrInstance:"instance"},{name:"createEditorDisplayObject",fxn:bd.methodTag.canvasObject.createEditorDisplayObject,classOrInstance:"instance"},{name:"setDragEndOnEditorDisplayObject",fxn:bd.methodTag.canvasObject.setDragEndOnEditorDisplayObject,
classOrInstance:"instance"},{name:"setDisplayObject",fxn:bd.methodTag.canvasObject.setDisplayObject,classOrInstance:"instance"},{name:"getDisplayObject",fxn:bd.methodTag.canvasObject.getDisplayObject,classOrInstance:"instance"},{name:"getClassCanvasImageAssetId",fxn:bd.methodTag.canvasObject.getClassCanvasImageAssetId,classOrInstance:"class"},{name:"getInstanceCanvasImageAssetId",fxn:bd.methodTag.canvasObject.getInstanceCanvasImageAssetId,classOrInstance:"instance"}]}};
bd.methodTag.canvasObject.handleCommand=function(a){if(bd.model.isInstance(this.id)){if("visible"==a.property&&bd.inPlayer)return 1==a.value?this.show():this.hide(),!0;if("x"==a.property||"y"==a.property)return this.updatePosition(),!0;if("height"==a.property||"width"==a.property)return this.setWidthHeight(),!0;if("costumeId"==a.property)return this.switchCostume(a.value),!0;if("direction"==a.property)return this.setDirection&&this.setDirection(),!0;"flipHorizontal"!=a.property&&"flipVertical"!=a.property||
this.updateFlip();if("draggable"==a.property&&bd.inPlayer)return this.setDraggable(),!0;if(("allowHorizontalDrag"==a.property||"allowVerticalDrag"==a.property)&&bd.inPlayer)return this.setDragRestriction(),!0;if("offsetX"==a.property||"offsetY"==a.property)return this.setWidthHeight(),!0;if("tint"==a.property)return this.setTint(),!0;if("layerId"==a.property&&bd.inPlayer)return this.afterLayerChanged&&this.afterLayerChanged(),!0}return!1};
bd.methodTag.canvasObject.selectInstanceInEditor=function(){this.createSelectionBorder();bd.layerSelect.ctr.selectLayer("component")};
bd.methodTag.canvasObject.createSelectionBorder=function(){var a=this.getDisplayObject(),b=bd.component.lookup(bd.model.getCurrentViewId()),c=this.model.offsetX,e=this.model.offsetY;if(null!=bd.editor.ctr.getSelectedInstanceId()){var f=bd.component.lookup(bd.editor.ctr.getSelectedInstanceId()).getDisplayObject();f.selectedInstanceBorder.destroy();f.parent.draw()}bd.editor.ctr.setSelectedInstanceId(a.instanceId);f=new Konva.Group;a.selectedInstanceBorder=f;var g=new Konva.Rect({x:a.x()-a.width()*c,
y:a.y()-a.height()*e,width:a.width(),height:a.height(),stroke:"black",strokeWidth:2});g.circles=[];g.moveCircles=function(){for(var a=0;9>a;a++)4!==a&&(g.circles[a].setX(a%3*g.width()/2+g.x()),g.circles[a].setY(Math.floor(a/3)*g.height()/2+g.y()))};f.add(g);for(var h=0;9>h;h++)if(4===h)g.circles.push(null);else{var k=new Konva.Circle({radius:6,x:h%3*g.width()/2+g.x(),y:Math.floor(h/3)*g.height()/2+g.y(),fill:"red",draggable:!0,id:String(h),dragBoundFunc:function(a){return 1===parseInt(this.id())%
3?(newx=parseInt(this.id())%3*g.width()/2+g.x(),newy=a.y,{x:newx,y:newy}):1===Math.floor(parseInt(this.id())/3)?(newx=a.x,newy=Math.floor(parseInt(this.id())/3)*g.height()/2+g.y(),{x:newx,y:newy}):{x:a.x,y:a.y}}});g.circles.push(k);k.on("dragmove",function(){0===parseInt(this.id())%3&&this.getX()+5<=g.x()+g.width()?(g.setWidth(g.width()+g.x()-this.getX()),g.setX(this.getX())):2===parseInt(this.id())%3&&this.getX()-5>=g.x()&&g.setWidth(this.getX()-g.x());0===Math.floor(parseInt(this.id())/3)&&this.getY()+
5<=g.y()+g.height()?(g.setHeight(g.height()+g.y()-this.getY()),g.setY(this.getY())):2===Math.floor(parseInt(this.id())/3)&&this.getY()-5>=g.y()&&g.setHeight(this.getY()-g.y());g.moveCircles();a.setWidth(g.width());a.setHeight(g.height());a.setOffsetX(g.width()*c);a.setOffsetY(g.height()*e);a.setX(g.x()+g.width()*c);a.setY(g.y()+g.height()*e);g.getLayer().batchDraw()});k.on("dragend",function(){bd.model.addModelUpdateElement([a.instanceId],"set","x",a.getX()-b.getCanvasViewLeft(),{updateUIForOrigin:!1,
updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.instanceId],"set","y",a.getY()-b.getCanvasViewTop(),{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.instanceId],"set","width",a.getWidth(),{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.instanceId],"set","height",a.getHeight(),{updateUIForOrigin:!1,
updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();bd.instanceProperty.ctr.setup()});f.add(k)}a.on("dragmove",function(){g.setX(a.x()-a.width()*c);g.setY(a.y()-a.height()*e);g.moveCircles()});a.selectionBorder=g;h=this.getLayer();h.add(f);a.moveToTop();h.batchDraw()};
bd.methodTag.canvasObject.createEditorDisplayObjectFromXY=function(a,b){bd.model.addModelUpdateElement([this.id],"set","x",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([this.id],"set","y",b,{updateUIForOrigin:!0,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();this.createEditorDisplayObject()};
bd.methodTag.canvasObject.createEditorDisplayObject=function(){bd.component.lookup(bd.model.getCurrentViewId()).getWindow();var a=this.createKineticEditorObject();a.instanceId=this.id;var b=this.getOffsetXY();a.offsetX(b.x);a.offsetY(b.y);this.setDisplayObject(a);this.setDragEndOnEditorDisplayObject();this.getLayer().add(a);a.setX(this.model.x);a.setY(this.model.y);a.on("mousedown click tap",function(){bd.component.lookup(this.instanceId).selectInstanceInEditor()});a.on("dragstart",function(){this.dragStartX=
this.getX();this.dragStartY=this.getY()});a.on("mouseover",function(){document.body.style.cursor="pointer"});a.on("mouseout",function(){document.body.style.cursor="default"});return a};bd.methodTag.canvasObject.createKineticEditorObject=function(){return this.createKineticEditorObjectOnLayer(this.getLayer())};
bd.methodTag.canvasObject.createKineticEditorObjectOnLayer=function(a){var b=new Konva.Image({width:this.model.width,height:this.model.height,draggable:!0});bd.imageLoader.ctr.getImage(b,a,this.getInstanceCanvasImageAssetId());return b};
bd.methodTag.canvasObject.setDragEndOnEditorDisplayObject=function(){this.getDisplayObject().on("dragend",function(){bd.component.lookup(bd.model.getCurrentViewId());var a=this.getX(),b=this.getY(),c=bd.model.entityLookup(this.instanceId).offsetX,c=null==c?0:c;"percent"==bd.model.entityLookup(this.instanceId).offsetType&&(c=bd.model.entityLookup(this.instanceId).width*bd.model.entityLookup(this.instanceId).offsetX);c=a-c;if(0>parseFloat(this.getWidth())+c){a=bd.model.entityLookup(this.instanceId);
try{bd.component.lookup(a.id).deleteInstance()}catch(e){if("CannotDeleteEntityError"==e.type)alert(e.getDeleteErrorString()),this.setX(this.dragStartX),this.setY(this.dragStartY),bd.component.lookup(a.id).drawLayer();else throw e;}}else bd.model.addModelUpdateElement([this.instanceId],"set","x",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.addModelUpdateElement([this.instanceId],"set","y",b,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,
updateUIInEditor:!1}),bd.model.sendUpdates(),bd.instanceProperty.ctr.setup();bd.updateSelections()})};bd.methodTag.canvasObject.getOffsetXY=function(){var a=0,b=0;"percent"==this.model.offsetType?(a=this.model.offsetX*this.model.width,b=this.model.offsetY*this.model.height):"pixel"==this.model.offsetType&&(a=this.model.offsetX,b=this.model.offsetY);return{x:a,y:b}};bd.methodTag.canvasObject.setDisplayObject=function(a){this.displayObject=a};bd.methodTag.canvasObject.getDisplayObject=function(){return this.displayObject};
bd.methodTag.canvasObject.hide=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().hide(),this.drawLayer())};bd.methodTag.canvasObject.show=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().show(),this.drawLayer())};
bd.methodTag.canvasObject.setWidthHeight=function(){if(null!=this.getDisplayObject()){var a=this.getDisplayObject();a.setHeight(this.model.height);a.setWidth(this.model.width);null!=a.selectionBorder&&(a.selectionBorder.setWidth(this.model.width),a.selectionBorder.setHeight(this.model.height),a.selectionBorder.setX(a.x()-a.width()*this.model.offsetX),a.selectionBorder.setY(a.y()-a.height()*this.model.offsetY),a.selectionBorder.moveCircles());var b=a=0;"percent"==this.model.offsetType?(a=this.model.offsetX*
this.model.width,b=this.model.offsetY*this.model.height):"pixel"==this.model.offsetType&&(a=this.model.offsetX,b=this.model.offsetY);this.getDisplayObject().offsetX(a);this.getDisplayObject().offsetY(b);this.drawLayer()}};
bd.methodTag.canvasObject.switchCostume=function(){if(null!=this.getDisplayObject()){var a=this.getDisplayObject();bd.imageLoader.ctr.getImage(a,this.getLayer(),bd.model.entityLookup(this.model.costumeId).assetId);bd.editor.ctr.getSelectedInstanceId()==this.id&&bd.instanceProperty.ctr.setup()}bd.inPlayer||null==document.getElementById("componentThumbnail"+this.id)||(document.getElementById("componentThumbnail"+this.id).src=bd.component.lookup(bd.model.entityLookup(this.model.costumeId).assetId).getThumbnailUrl())};
bd.methodTag.canvasObject.getCostumeIds=function(){return bd.entityLookup[bd.entityLookup[this.id].parentId].costumeIds};
bd.methodTag.canvasObject.updatePosition=function(){if(null!=this.getDisplayObject()){var a=this.getDisplayObject();bd.component.lookup(bd.model.getCurrentViewId());a.setX(this.model.x);a.setY(this.model.y);if(a.selectedInstanceBorder){var b=this.model.offsetX,c=this.model.offsetY,e=a.selectionBorder;e.setX(a.x()-a.width()*b);e.setY(a.y()-a.height()*c);e.moveCircles&&e.moveCircles()}this.model.canRotate&&this.getDisplayObject().setRotation(Math.PI/180*this.model.direction);this.drawLayer()}};
bd.methodTag.canvasObject.getXOrY=function(a){return bd.inPlayer&&"local"==this.model.shareMode?this.getLocalXY(a):this.model[a]};bd.methodTag.canvasObject.getDirection=function(){return bd.inPlayer&&"local"==this.model.shareMode?this.getLocalDirection():this.model.direction};bd.methodTag.canvasObject.getAngleToEntity=function(a){var b=bd.component.lookup(a);a=b.getXOrY("y")-this.getXOrY("y");b=b.getXOrY("x")-this.getXOrY("x");return 180/Math.PI*Math.atan2(a,b)};
bd.methodTag.canvasObject.setDirection=function(){var a=bd.component.lookup(this.id).getDisplayObject(),b=bd.entityLookup[this.id].direction;null!=a&&(bd.entityLookup[a.instanceId].useCenterOffset||(a.setOffset([a.getWidth()/2,a.getHeight()/2]),bd.entityLookup[a.instanceId].useCenterOffset=!0,newX=a.getX()+a.getWidth()/2,newY=a.getY()+a.getHeight()/2,a.setX(newX),a.setY(newY)),a.setRotation(Math.PI/180*(b-90)));this.drawLayer()};
bd.methodTag.canvasObject.setDraggable=function(){if(null!=this.getDisplayObject()&&bd.inPlayer){var a=bd.model.entityLookup(this.model.id);this.getDisplayObject().setDraggable(a.draggable);this.drawLayer()}};bd.methodTag.canvasObject.removeInstanceFromView=function(){var a=bd.component.lookup(this.id).getDisplayObject();if(null!=a){var b=a.getLayer();a.destroy();null!=a.selectedInstanceBorder&&a.selectedInstanceBorder.destroy();bd.editor.ctr.setSelectedInstanceId(null);b.batchDraw();bd.component.lookup(this.id).setDisplayObject(null)}};
bd.methodTag.canvasObject.addEntity=function(){var a=this.model,b=a.id;(!a.entityPerPlayer||a.entityPerPlayer&&a.playerId==bd.player.ctr.playerId)&&bd.component.lookup(a.viewId).isInitialized&&(bd.pieces.ctr.setupPiece("board",b,"image"),this.drawLayer())};bd.methodTag.canvasObject.addBox=function(){null==bd.component.lookup(this.id).getDisplayObject()&&bd.pieces.ctr.setupPiece("board",this.id,"image")};
bd.methodTag.canvasObject.removeBox=function(){var a=bd.component.lookup(this.id).getDisplayObject();if(null!=a){var b=a.getLayer();a.remove();b.batchDraw();bd.component.lookup(this.id).setDisplayObject(null)}};bd.methodTag.canvasObject.getLayer=function(){return bd.inPlayer||"gameView"!=bd.component.lookup(this.model.viewId).type?bd.component.lookup(this.model.viewId).getLayer(this.getLayerName()):bd[this.layerName]};bd.methodTag.canvasObject.getLayerName=function(){return"tmxLayer"+this.model.layerId};
bd.methodTag.canvasObject.drawLayer=function(){this.getLayer().batchDraw()};bd.methodTag.canvasObject.getClassCanvasImageAssetId=function(){return bd.component.getComponentByType(this.type).getDefaultCanvasAssetId?bd.component.getComponentByType(this.type).getDefaultCanvasAssetId():bd.model.entityLookup(this.model.costumeIds[0]).assetId};
bd.methodTag.canvasObject.getInstanceCanvasImageAssetId=function(){var a=bd.model.entityLookup(this.model.parentId).type;return(a=bd.component.getComponentByType(a).getDefaultCanvasAssetId)?a():bd.model.entityLookup(this.model.costumeId).assetId};bd.component.table={constructor:function(a,b){goog.mixin(this,bd.component.table.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};var c=null==a;bd.modelTag.applyTags(this,c);bd.methodTag.applyMethodTags(this);c&&new bd.component.tableInstance.constructor(null,this.id)},componentProperties:{classOrInstance:"class",type:"table",listName:"tables",idName:"tableId",idListName:"tableIds",editorDisplayObjectType:"image",
sideBarPanelName:"sideBarTablePanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-list.png",possibleLayerTypes:["tmxEntityLayer"],hasTraitTab:!1,namePrefix:"Data Table Class ",typeName:"Table",tabName:"Tables",entityName:"Data Table Class",entityNamePlural:"Data Table Classes",thisName:"this table class",allName:"all table classes",anyName:"any table class",randomName:"random table class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasCoordinateOffset hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasTargetId hasTableProperties".split(" "),
methodTags:["entity","canvasObject","table"]},beforeCreateEntity:function(){bd.overlay.ctr.showOverlay("tableSelect")},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"table.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"table.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.tableInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.tableInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"tableInstance",listName:"tableInstances",idName:"tableInstanceId",idListName:"tableInstanceIds",editorDisplayObjectType:"image",namePrefix:"data table ",entityName:"Data Table",thisName:"this table",
allName:"all tables",anyName:"any table",randomName:"random table",modelTags:bd.component.table.componentProperties.modelTags,methodTags:bd.component.table.componentProperties.methodTags}};bd.component.typeNameToComponent.table=bd.component.table;bd.component.typeNameToComponent.tableInstance=bd.component.tableInstance;bd.component.childNameToParentName.tableInstance="table";bd.modelTag.hasMelonTMXLayerProperties={requiredFields:[],provideFields:function(){return[{fields:["viewId"],classOrInstance:"class",providers:["componentObject"]},{fields:["tmxMapId"],classOrInstance:"class",providers:["componentObject"]},{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:15},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:20},{fields:["assetId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},
{fields:["opacity"],classOrInstance:"class",providers:["defaultValue"],defaultValue:1},{fields:["visible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["layerType"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""},{fields:["x"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["y"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["isCameraLayer"],classOrInstance:"class",providers:["defaultValue"],
defaultValue:!1}]}};bd.modelTag.hasMelonTMXEntityLayerProperties={requiredFields:[],provideFields:function(){return[{fields:["entityIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[],removeConnectionFxn:bd.modelTag.hasMelonTMXEntityLayerProperties.removeEntityIds},{fields:["isEditorEntitiesDragLocked"],providers:["defaultValue"],defaultValue:!1}]}};bd.modelTag.hasMelonTMXEntityLayerProperties.removeEntityIds=function(){for(;0!=this.model.entityIds.length;)bd.component.lookup(this.model.entityIds[0]).deleteInstance()};
bd.modelTag.hasMelonTMXTileLayerProperties={requiredFields:[],provideFields:function(){return[{fields:["gridTileIndexToTileSetTile"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["isCollisionLayer"],classOrInstance:"class",providers:["componentObject"]}]}};
bd.modelTag.hasMelonTMXImageLayerProperties={requiredFields:[],provideFields:function(){return[{fields:["assetId"],classOrInstance:"class",providers:["componentObject"]},{fields:["tileSpriteVisible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]}};
bd.modelTag.hasUILayerProperties={requiredFields:[],provideFields:function(){return[{fields:["entityIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[],removeConnectionFxn:bd.modelTag.hasMelonTMXEntityLayerProperties.removeEntityIds},{fields:["isEditorEntitiesDragLocked"],providers:["defaultValue"],defaultValue:!1}]}};bd.dictionary={};bd.dictionary.ctr={};bd.dictionary.ctr.wordList={};bd.dictionary.ctr.defaultDict="intermediate_english";bd.dictionary.ctr.currDict=bd.dictionary.ctr.defaultDict;bd.dictionary.ctr.currDictByFirstLetter=bd.dictionary.ctr.currDict+"_by_first_letter.js";bd.dictionary.ctr.currDictByLength=bd.dictionary.ctr.currDict+"_by_length.js";bd.dictionary.ctr.numWords={};bd.dictionary.ctr.numWordsPerKey={};bd.dictionary.ctr.numDictsToLoad=0;bd.dictionary.ctr.dictBlocksNames="dictionary_is_word dictionary_anagrams dictionary_rand_word_with_length dictionary_rand_word dictionary_words_in_string dictionary_words_using_letters_in_string dictionary_set_dictionary".split(" ");
bd.dictionary.ctr.setDictionary=function(a){bd.dictionary.ctr.currDict=a;bd.dictionary.ctr.currDictByFirstLetter=a+"_by_first_letter.js";bd.dictionary.ctr.currDictByLength=a+"_by_length.js"};bd.dictionary.ctr.getPermutations=function(a,b){b=b||"";if(1==a.length)return[b.concat(a[0])];for(var c=[],e=0;e<a.length;e++)-1==a.slice(0,e).indexOf(a[e])&&(c=c.concat(bd.dictionary.ctr.getPermutations(a.slice(0,e).concat(a.slice(e+1)),b.concat(a[e]))));return c};
bd.dictionary.ctr.getCombinations=function(a,b){b=b||"";if(1==a.length)return[b.concat(a[0])];for(var c=[],e=0;e<a.length;e++)-1==a.slice(0,e).indexOf(a[e])&&(c.push(b.concat(a[e])),c=c.concat(bd.dictionary.ctr.getCombinations(a.slice(e+1),b.concat(a[e]))));return c};bd.dictionary.ctr.isWord=function(a){a=a.toLowerCase();var b=a.charAt(0);return-1<bd.dictionary.ctr.wordList[bd.dictionary.ctr.currDictByFirstLetter][b].indexOf(a)};
bd.dictionary.ctr.getRandWordGivenLength=function(a){var b=bd.dictionary.ctr.wordList[bd.dictionary.ctr.currDictByLength];if(!(a.toString()in b))return bd.model.nullBlockString;a=b[a.toString()];return a[Math.floor(Math.random()*a.length)]};
bd.dictionary.ctr.getRandWord=function(){var a=bd.dictionary.ctr.currDictByFirstLetter,b=bd.dictionary.ctr.wordList[a];if(!(a in bd.dictionary.ctr.numWords)){bd.dictionary.ctr.numWords[a]=0;bd.dictionary.ctr.numWordsPerKey[a]={};for(var c in b)bd.dictionary.ctr.numWordsPerKey[a][c]=b[c].length,bd.dictionary.ctr.numWords[a]+=b[c].length}var e=bd.dictionary.ctr.numWords[a],a=bd.dictionary.ctr.numWordsPerKey[a],e=Math.floor(Math.random()*e);for(c in a){if(e<a[c])return b[c][e];e-=a[c]}};
bd.dictionary.ctr.getWordsInString=function(a){for(var b=[],c=0;c<a.length;c++)for(var e=c+1;e<a.length+1;e++)bd.dictionary.ctr.isWord(a.substr(c,e))&&-1==b.indexOf(a.substr(c,e))&&b.push(a.substr(c,e));return b};bd.dictionary.ctr.getWordsUsingLettersInString=function(a){var b=[];a=bd.dictionary.ctr.getCombinations(a);for(var c=0;c<a.length;c++)for(var e=bd.dictionary.ctr.getPermutations(a[c]),f=0;f<e.length;f++)bd.dictionary.ctr.isWord(e[f])&&-1==b.indexOf(e[f])&&b.push(e[f]);return b};
bd.dictionary.ctr.getDictsForGame=function(a){a=[];for(var b=bd.script.ctr.getAllBlocks(),c=0;c<b.length;c++){var e=!(b[c].getRootBlock().isEvent||b[c].getRootBlock().isProcedure||b[c].getRootBlock().isGlobalVariableDefintion);b[c].isDictionaryBlock&&!e&&(e=bd.dictionary.ctr.defaultDict,-1==a.indexOf(e)&&a.push(e),"dictionary_set_dictionary"==b[c].type&&(e=b[c].getFieldValue("DICT").toLowerCase(),-1==a.indexOf(e)&&a.push(e)))}return a};
bd.dictionary.ctr.loadDictionaries=function(a){var b=bd.model.getGameInfo().dictionaries;0==b.length&&a.call();bd.dictionary.ctr.numDictsToLoad=2*b.length;for(var c=0;c<b.length;c++)bd.util.ajaxGet("/static/scripts/libraries/dictionaries/"+b[c]+"_by_first_letter.js",bd.dictionary.ctr.loadDictionariesCallback(a,b[c]+"_by_first_letter.js")),bd.util.ajaxGet("/static/scripts/libraries/dictionaries/"+b[c]+"_by_length.js",bd.dictionary.ctr.loadDictionariesCallback(a,b[c]+"_by_length.js"))};
bd.dictionary.ctr.loadDictionariesCallback=function(a,b){return function(c,e,f){e=e||b;c=JSON.parse(c);bd.dictionary.ctr.wordList[e]=c;1==bd.dictionary.ctr.numDictsToLoad?a.call():bd.dictionary.ctr.numDictsToLoad--}};bd.methodTag.melonView={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.melonView.updateSideBar},{name:"removeEditorDisplayObjects",fxn:bd.methodTag.melonView.removeEditorDisplayObjects,classOrInstance:"class"},{name:"populateEditorDisplayObjects",fxn:bd.methodTag.melonView.populateEditorDisplayObjects,classOrInstance:"class"},{name:"populateDisplayObjects",fxn:bd.methodTag.melonView.populateDisplayObjects,classOrInstance:"class"},{name:"setLayer",fxn:bd.methodTag.melonView.setLayer,
classOrInstance:"class"},{name:"getLayer",fxn:bd.methodTag.melonView.getLayer,classOrInstance:"class"},{name:"setTargetHighlightSquare",fxn:bd.methodTag.melonView.setTargetHighlightSquare,classOrInstance:"class"},{name:"getTargetHighlightSquare",fxn:bd.methodTag.melonView.getTargetHighlightSquare,classOrInstance:"class"},{name:"setupEditorFrame",fxn:bd.methodTag.melonView.setupEditorFrame,classOrInstance:"class"},{name:"setupPlayerFrame",fxn:bd.methodTag.melonView.setupPlayerFrame,classOrInstance:"class"},
{name:"setupEditorKineticView",fxn:bd.methodTag.melonView.setupEditorKineticView,classOrInstance:"class"},{name:"removeEditorKineticView",fxn:bd.methodTag.melonView.removeEditorKineticView,classOrInstance:"class"},{name:"addEntityToView",fxn:bd.methodTag.melonView.addEntityToView,classOrInstance:"class"},{name:"getSelectedLayerId",fxn:bd.methodTag.melonView.getSelectedLayerId,classOrInstance:"class"},{name:"setSelectedLayerId",fxn:bd.methodTag.melonView.setSelectedLayerId,classOrInstance:"class"},
{name:"getReverseLayerIds",fxn:bd.methodTag.melonView.getReverseLayerIds,classOrInstance:"class"},{name:"getLayerIds",fxn:bd.methodTag.melonView.getLayerIds,classOrInstance:"class"},{name:"getTMXFile",fxn:bd.methodTag.melonView.getTMXFile,classOrInstance:"class"},{name:"getResourcesArray",fxn:bd.methodTag.melonView.getResourcesArray,classOrInstance:"class"},{name:"getMelonObject",fxn:bd.methodTag.melonView.getMelonObject,classOrInstance:"class"},{name:"afterComponentCreated",fxn:bd.methodTag.melonView.afterComponentCreated,
classOrInstance:"class"}]}};bd.methodTag.melonView.handleCommand=function(a){return this.isPropertyFromComponentOnView(a.property)&&"push"==a.updateType?(this.addEntityToView(a.value),!0):!1};
bd.methodTag.melonView.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName).getElementsByClassName("nameInput")[0];b.value=a.name;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);document.getElementById("followInstanceMelonViewSelect").innerHTML="";b=a[bd.component.melonPieceInstance.componentProperties.idListName];document.getElementById("followInstanceMelonViewSelect").options[document.getElementById("followInstanceMelonViewSelect").options.length]=
new Option("none","none");null==a.instanceIdToFollow&&(document.getElementById("followInstanceMelonViewSelect").selectedIndex=0);for(var c=0;c<b.length;c++){var e=bd.model.entityLookup(b[c]);document.getElementById("followInstanceMelonViewSelect").options[document.getElementById("followInstanceMelonViewSelect").options.length]=new Option(e.name,e.id);e.id==a.instanceIdToFollow&&(document.getElementById("followInstanceMelonViewSelect").selectedIndex=document.getElementById("followInstanceMelonViewSelect").options.length-
1)}};bd.methodTag.melonView.addEntityToView=function(a){bd.component.lookup(a).addEntity()};bd.methodTag.melonView.setLayer=function(a,b){this.layerNameToObject[a]=b};bd.methodTag.melonView.getLayer=function(a){return this.layerNameToObject[a]};
bd.methodTag.melonView.setupEditorFrame=function(){var a=this.getWindow().Kinetic,b=this.model.tileHeight*this.model.gridHeight+30,c=this.model.tileWidth*this.model.gridWidth+30;this.getWindow().document.getElementById("tilePanel").style.height=b+"px";this.getWindow().document.getElementById("tilePanel").style.width=c+"px";this.stage=new a.Stage({container:"tilePanel",width:c,height:b});bd.component.melonView.setupTileGrid.call(this);bd.layerPanel.ctr.setupLayerPanel();this.populateEditorDisplayObjects();
this.isInitialized=!0};bd.methodTag.melonView.setupPlayerFrame=function(){};bd.methodTag.melonView.setHeightWidth=function(){};
bd.methodTag.melonView.removeEditorDisplayObjects=function(){document.getElementById("melonjsPanelContainer").style.display="none";for(var a=0;a<this.componentsOnView.length;a++)for(var b=this.model[bd.component.typeNameToComponent[this.componentsOnView[a]].componentProperties.idListName],c=0;c<b.length;c++){var e=bd.component.lookup(b[c]).getDisplayObject();if(null!=e){var f=e.getLayer();e.remove();f.batchDraw();bd.component.lookup(b[c]).setDisplayObject(null)}}};
bd.methodTag.melonView.populateDisplayObjects=function(){};
bd.methodTag.melonView.setupEditorKineticView=function(){var a=this.model.gridWidth*this.model.tileWidth+2*this.xTileOffset,b=this.model.gridHeight*this.model.tileHeight+2*this.yTileOffset;bd.stage.setWidth(a+bd.editorSettings.viewOffsetX);bd.stage.setHeight(Math.max(bd.editorSettings.entitySelectorHeight,b+bd.editorSettings.viewOffsetY));bd.editor.ui.backgroundColorRect.x(bd.editorSettings.viewOffsetX+this.xTileOffset);bd.editor.ui.backgroundColorRect.y(bd.editorSettings.viewOffsetY+this.yTileOffset);
b=this.getPlayerViewHeightWidth();bd.editor.ui.backgroundColorRect.height(b.height);bd.editor.ui.backgroundColorRect.width(b.width);bd.editor.ui.backgroundColorRect.fill(this.model.backgroundColor);bd.bgLayer.batchDraw();document.getElementById("gameWorkspace").style.width=a+bd.editorSettings.viewOffsetX+bd.component.melonView.componentProperties.melonjsPanelWidth;document.getElementById("melonjsPanelContainer").style.display="block";document.getElementById("melonjsPanelContainer").style.left=a+bd.editorSettings.viewOffsetX;
document.getElementById("melonjsPanelContainer").style.top=bd.editorSettings.viewOffsetY;this.stage=bd.stage;bd.component.melonView.setupCanvasView(this.id);bd.component.melonView.setupTileGrid.call(this);this.setDefaultLastUsedLayerIds();bd.layerPanel.ctr.setupLayerPanel()};bd.methodTag.melonView.removeEditorKineticView=function(){document.getElementById("melonjsPanelContainer").style.display="none";bd.component.melonView.removeTileGrid.call(this);bd.component.melonView.removeCanvasView.call(this)};
bd.methodTag.melonView.populateEditorDisplayObjects=function(){};bd.methodTag.melonView.getSelectedLayerId=function(){if(null!=this.selectedLayerId)return this.selectedLayerId;var a=this.getReverseLayerIds(!0);return 0!=a.length?this.selectedLayerId=a[0]:null};bd.methodTag.melonView.setSelectedLayerId=function(a){this.selectedLayerId=a};bd.methodTag.melonView.getReverseLayerIds=function(){for(var a=this.getLayerIds(),b=[],c=a.length-1;0<=c;c--)b.push(a[c]);return b};
bd.methodTag.melonView.getLayerIds=function(){return bd.component.lookup(this.model.tmxMapId).model.layerIds};bd.methodTag.melonView.getMelonObject=function(){return bd.inPlayer&&this.isInitialized?this.getWindow().me:null};
bd.methodTag.melonView.afterComponentCreated=function(){var a=new bd.component.assetImage.constructor(null,"images/melonDemoImages/area01_bkg0.png",!0,!0),b=new bd.component.assetImage.constructor(null,"images/melonDemoImages/area01_bkg1.png",!0,!0);bd.imageLoader.ctr.loadAsset(a.id);bd.imageLoader.ctr.loadAsset(b.id);new bd.component.assetImage.constructor(null,"images/melonDemoImages/sprite/gripe_run_right.png",!0,!0);var c=new bd.component.melonView.tmxMap.constructor;this.model.tmxMapId=c.id;
new bd.component.melonView.tmxImageLayer.constructor(null,this.id,c.id,a.id);new bd.component.melonView.tmxImageLayer.constructor(null,this.id,c.id,b.id);new bd.component.melonView.tmxTileLayer.constructor(null,this.id,c.id,!1);new bd.component.melonView.tmxEntityLayer.constructor(null,this.id,c.id);new bd.component.melonView.tmxTileLayer.constructor(null,this.id,c.id,!0)};
bd.methodTag.melonView.getTMXFile=function(){var a=bd.component.lookup(this.model.tmxMapId),b={};b.height=a.model.gridHeight;b.orientation="orthogonal";b.properties=a.model.properties;b.tileheight=a.model.tileHeight;b.tilewidth=a.model.tileWidth;b.version=a.model.version;b.width=a.model.gridWidth;b.tilesets=[];for(var c={},e=1,f=0;f<bd.model.getCurrentGame()[bd.component.melonView.tmxTileSet.componentProperties.listName].length;f++){var g=bd.model.getCurrentGame()[bd.component.melonView.tmxTileSet.componentProperties.listName][f],
h=bd.imageLoader.ctr.getImageObject(g.assetId),k=h.height,l=h.width,m={};m.firstgid=e;m.image=h.src;m.imageheight=k;m.imagewidth=l;m.margin=g.tileMargin;m.name="tilesetId:"+g.id;m.properties={};m.spacing=g.tileSpacing;m.tileheight=g.tileHeight;m.tilewidth=g.tileWidth;m.tileproperties=g.tileProperties;c[g.id]=e;h=Math.floor(l/g.tileWidth);e+=h*Math.floor(k/g.tileHeight);b.tilesets.push(m)}b.layers=[];for(f=0;f<a.model.layerIds.length;f++){g=bd.component.lookup(a.model.layerIds[f]);e={};e.height=g.model.height;
e.width=g.model.width;e.opacity=g.model.opacity;e.visible=g.model.visible;e.x=g.model.x;e.y=g.model.y;e.name="layerId:"+g.id;if("tmxImageLayer"==g.type)e.type="imagelayer",h=bd.component.lookup(g.model.assetId),e.image=h.getThumbnailUrl();else if("tmxTileLayer"==g.type){e.type="tilelayer";e.data=[];for(k=0;k<g.model.height*g.model.width;k++)if(m=g.model.gridTileIndexToTileSetTile[k],null==m)e.data.push(0);else{var n=bd.component.lookup(m.tileSetId),h=bd.imageLoader.ctr.getImageObject(n.model.assetId),
l=h.width,h=Math.floor(l/n.model.tileWidth);e.data.push(c[n.id]+(m.tileSetColumn+m.tileSetRow*h))}g.model.isCollisionLayer&&(e.name="collision")}else"tmxEntityLayer"==g.type&&(e.type="objectgroup",e.objects=[]);b.layers.push(e)}return b};
bd.methodTag.melonView.getResourcesArray=function(){var a=[],b={};b.name="mapResourceViewId"+this.id;b.type="tmx";b.format="json";b.data=this.getTMXFile();a.push(b);for(var b=bd.model.getCurrentGameAssets(),c=0;c<b.length;c++){var e=bd.component.lookup(b[c].id).getThumbnailUrl(),f=e.substring(e.lastIndexOf("/")+1,e.lastIndexOf(".")),g={};g.name=f;g.type="image";g.src=e;a.push(g)}return a};bd.methodTag.frameView={provideMethods:function(){return[{name:"removeEditorDisplayObjects",fxn:bd.methodTag.frameView.removeEditorDisplayObjects,classOrInstance:"class"},{name:"populateEditorDisplayObjects",fxn:bd.methodTag.frameView.populateEditorDisplayObjects,classOrInstance:"class"},{name:"populateDisplayObjects",fxn:bd.methodTag.frameView.populateDisplayObjects,classOrInstance:"class"},{name:"setupEditorFrame",fxn:bd.methodTag.frameView.setupEditorFrame,classOrInstance:"class"}]}};
bd.methodTag.frameView.handleCommand=function(a){return!1};
bd.methodTag.frameView.setupEditorFrame=function(){var a=this.getWindow().Kinetic;this.stage=new a.Stage({container:"editorPanel",width:this.model.width,height:this.model.height});this.setLayer("bgLayer",new a.Layer);this.stage.add(this.getLayer("bgLayer"));this.setLayer("mainLayer",new a.Layer);this.setLayer("targetHighlightLayer",new a.Layer);this.setLayer("targetLayer",new a.Layer);this.setLayer("pieceLayer",new a.Layer);this.stage.add(this.getLayer("targetHighlightLayer"));this.stage.add(this.getLayer("targetLayer"));
this.stage.add(this.getLayer("pieceLayer"));this.stage.add(this.getLayer("mainLayer"));this.populateEditorDisplayObjects();this.isInitialized=!0};bd.methodTag.frameView.removeEditorDisplayObjects=function(){};bd.methodTag.frameView.populateDisplayObjects=function(){};bd.methodTag.frameView.populateEditorDisplayObjects=function(){bd.methodTag.gameView.populateEditorDisplayObjects.call(this)};goog.fs={};goog.fs.url={};goog.fs.url.createObjectUrl=function(a){return goog.fs.url.getUrlObject_().createObjectURL(a)};goog.fs.url.revokeObjectUrl=function(a){goog.fs.url.getUrlObject_().revokeObjectURL(a)};goog.fs.url.getUrlObject_=function(){var a=goog.fs.url.findUrlObject_();if(null!=a)return a;throw Error("This browser doesn't seem to support blob URLs");};
goog.fs.url.findUrlObject_=function(){return goog.isDef(goog.global.URL)&&goog.isDef(goog.global.URL.createObjectURL)?goog.global.URL:goog.isDef(goog.global.webkitURL)&&goog.isDef(goog.global.webkitURL.createObjectURL)?goog.global.webkitURL:goog.isDef(goog.global.createObjectURL)?goog.global:null};goog.fs.url.browserSupportsObjectUrls=function(){return null!=goog.fs.url.findUrlObject_()};goog.dom={};goog.dom.NodeType={ELEMENT:1,ATTRIBUTE:2,TEXT:3,CDATA_SECTION:4,ENTITY_REFERENCE:5,ENTITY:6,PROCESSING_INSTRUCTION:7,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,NOTATION:12};goog.debug={};goog.debug.Error=function(a){if(Error.captureStackTrace)Error.captureStackTrace(this,goog.debug.Error);else{var b=Error().stack;b&&(this.stack=b)}a&&(this.message=String(a));this.reportErrorToServer=!0};goog.inherits(goog.debug.Error,Error);goog.debug.Error.prototype.name="CustomError";goog.string={};goog.string.DETECT_DOUBLE_ESCAPING=!1;goog.string.FORCE_NON_DOM_HTML_UNESCAPING=!1;goog.string.Unicode={NBSP:"\u00a0"};goog.string.startsWith=function(a,b){return 0==a.lastIndexOf(b,0)};goog.string.endsWith=function(a,b){var c=a.length-b.length;return 0<=c&&a.indexOf(b,c)==c};goog.string.caseInsensitiveStartsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(0,b.length))};
goog.string.caseInsensitiveEndsWith=function(a,b){return 0==goog.string.caseInsensitiveCompare(b,a.substr(a.length-b.length,b.length))};goog.string.caseInsensitiveEquals=function(a,b){return a.toLowerCase()==b.toLowerCase()};goog.string.subs=function(a,b){for(var c=a.split("%s"),e="",f=Array.prototype.slice.call(arguments,1);f.length&&1<c.length;)e+=c.shift()+f.shift();return e+c.join("%s")};goog.string.collapseWhitespace=function(a){return a.replace(/[\s\xa0]+/g," ").replace(/^\s+|\s+$/g,"")};
goog.string.isEmptyOrWhitespace=function(a){return/^[\s\xa0]*$/.test(a)};goog.string.isEmptyString=function(a){return 0==a.length};goog.string.isEmpty=goog.string.isEmptyOrWhitespace;goog.string.isEmptyOrWhitespaceSafe=function(a){return goog.string.isEmptyOrWhitespace(goog.string.makeSafe(a))};goog.string.isEmptySafe=goog.string.isEmptyOrWhitespaceSafe;goog.string.isBreakingWhitespace=function(a){return!/[^\t\n\r ]/.test(a)};goog.string.isAlpha=function(a){return!/[^a-zA-Z]/.test(a)};
goog.string.isNumeric=function(a){return!/[^0-9]/.test(a)};goog.string.isAlphaNumeric=function(a){return!/[^a-zA-Z0-9]/.test(a)};goog.string.isSpace=function(a){return" "==a};goog.string.isUnicodeChar=function(a){return 1==a.length&&" "<=a&&"~">=a||"\u0080"<=a&&"\ufffd">=a};goog.string.stripNewlines=function(a){return a.replace(/(\r\n|\r|\n)+/g," ")};goog.string.canonicalizeNewlines=function(a){return a.replace(/(\r\n|\r|\n)/g,"\n")};
goog.string.normalizeWhitespace=function(a){return a.replace(/\xa0|\s/g," ")};goog.string.normalizeSpaces=function(a){return a.replace(/\xa0|[ \t]+/g," ")};goog.string.collapseBreakingSpaces=function(a){return a.replace(/[\t\r\n ]+/g," ").replace(/^[\t\r\n ]+|[\t\r\n ]+$/g,"")};goog.string.trim=goog.TRUSTED_SITE&&String.prototype.trim?function(a){return a.trim()}:function(a){return a.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")};goog.string.trimLeft=function(a){return a.replace(/^[\s\xa0]+/,"")};
goog.string.trimRight=function(a){return a.replace(/[\s\xa0]+$/,"")};goog.string.caseInsensitiveCompare=function(a,b){var c=String(a).toLowerCase(),e=String(b).toLowerCase();return c<e?-1:c==e?0:1};goog.string.numerateCompareRegExp_=/(\.\d+)|(\d+)|(\D+)/g;
goog.string.numerateCompare=function(a,b){if(a==b)return 0;if(!a)return-1;if(!b)return 1;for(var c=a.toLowerCase().match(goog.string.numerateCompareRegExp_),e=b.toLowerCase().match(goog.string.numerateCompareRegExp_),f=Math.min(c.length,e.length),g=0;g<f;g++){var h=c[g],k=e[g];if(h!=k)return c=parseInt(h,10),!isNaN(c)&&(e=parseInt(k,10),!isNaN(e)&&c-e)?c-e:h<k?-1:1}return c.length!=e.length?c.length-e.length:a<b?-1:1};goog.string.urlEncode=function(a){return encodeURIComponent(String(a))};
goog.string.urlDecode=function(a){return decodeURIComponent(a.replace(/\+/g," "))};goog.string.newLineToBr=function(a,b){return a.replace(/(\r\n|\r|\n)/g,b?"<br />":"<br>")};
goog.string.htmlEscape=function(a,b){if(b)a=a.replace(goog.string.AMP_RE_,"&amp;").replace(goog.string.LT_RE_,"&lt;").replace(goog.string.GT_RE_,"&gt;").replace(goog.string.QUOT_RE_,"&quot;").replace(goog.string.SINGLE_QUOTE_RE_,"&#39;").replace(goog.string.NULL_RE_,"&#0;"),goog.string.DETECT_DOUBLE_ESCAPING&&(a=a.replace(goog.string.E_RE_,"&#101;"));else{if(!goog.string.ALL_RE_.test(a))return a;-1!=a.indexOf("&")&&(a=a.replace(goog.string.AMP_RE_,"&amp;"));-1!=a.indexOf("<")&&(a=a.replace(goog.string.LT_RE_,
"&lt;"));-1!=a.indexOf(">")&&(a=a.replace(goog.string.GT_RE_,"&gt;"));-1!=a.indexOf('"')&&(a=a.replace(goog.string.QUOT_RE_,"&quot;"));-1!=a.indexOf("'")&&(a=a.replace(goog.string.SINGLE_QUOTE_RE_,"&#39;"));-1!=a.indexOf("\x00")&&(a=a.replace(goog.string.NULL_RE_,"&#0;"));goog.string.DETECT_DOUBLE_ESCAPING&&-1!=a.indexOf("e")&&(a=a.replace(goog.string.E_RE_,"&#101;"))}return a};goog.string.AMP_RE_=/&/g;goog.string.LT_RE_=/</g;goog.string.GT_RE_=/>/g;goog.string.QUOT_RE_=/"/g;
goog.string.SINGLE_QUOTE_RE_=/'/g;goog.string.NULL_RE_=/\x00/g;goog.string.E_RE_=/e/g;goog.string.ALL_RE_=goog.string.DETECT_DOUBLE_ESCAPING?/[\x00&<>"'e]/:/[\x00&<>"']/;goog.string.unescapeEntities=function(a){return goog.string.contains(a,"&")?!goog.string.FORCE_NON_DOM_HTML_UNESCAPING&&"document"in goog.global?goog.string.unescapeEntitiesUsingDom_(a):goog.string.unescapePureXmlEntities_(a):a};
goog.string.unescapeEntitiesWithDocument=function(a,b){return goog.string.contains(a,"&")?goog.string.unescapeEntitiesUsingDom_(a,b):a};
goog.string.unescapeEntitiesUsingDom_=function(a,b){var c={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"'},e;e=b?b.createElement("div"):goog.global.document.createElement("div");return a.replace(goog.string.HTML_ENTITY_PATTERN_,function(a,b){var h=c[a];if(h)return h;if("#"==b.charAt(0)){var k=Number("0"+b.substr(1));isNaN(k)||(h=String.fromCharCode(k))}h||(e.innerHTML=a+" ",h=e.firstChild.nodeValue.slice(0,-1));return c[a]=h})};
goog.string.unescapePureXmlEntities_=function(a){return a.replace(/&([^;]+);/g,function(a,c){switch(c){case "amp":return"&";case "lt":return"<";case "gt":return">";case "quot":return'"';default:if("#"==c.charAt(0)){var e=Number("0"+c.substr(1));if(!isNaN(e))return String.fromCharCode(e)}return a}})};goog.string.HTML_ENTITY_PATTERN_=/&([^;\s<&]+);?/g;goog.string.whitespaceEscape=function(a,b){return goog.string.newLineToBr(a.replace(/  /g," &#160;"),b)};
goog.string.preserveSpaces=function(a){return a.replace(/(^|[\n ]) /g,"$1"+goog.string.Unicode.NBSP)};goog.string.stripQuotes=function(a,b){for(var c=b.length,e=0;e<c;e++){var f=1==c?b:b.charAt(e);if(a.charAt(0)==f&&a.charAt(a.length-1)==f)return a.substring(1,a.length-1)}return a};goog.string.truncate=function(a,b,c){c&&(a=goog.string.unescapeEntities(a));a.length>b&&(a=a.substring(0,b-3)+"...");c&&(a=goog.string.htmlEscape(a));return a};
goog.string.truncateMiddle=function(a,b,c,e){c&&(a=goog.string.unescapeEntities(a));if(e&&a.length>b){e>b&&(e=b);var f=a.length-e;a=a.substring(0,b-e)+"..."+a.substring(f)}else a.length>b&&(e=Math.floor(b/2),f=a.length-e,a=a.substring(0,e+b%2)+"..."+a.substring(f));c&&(a=goog.string.htmlEscape(a));return a};goog.string.specialEscapeChars_={"\x00":"\\0","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\x0B":"\\x0B",'"':'\\"',"\\":"\\\\"};goog.string.jsEscapeCache_={"'":"\\'"};
goog.string.quote=function(a){a=String(a);if(a.quote)return a.quote();for(var b=['"'],c=0;c<a.length;c++){var e=a.charAt(c),f=e.charCodeAt(0);b[c+1]=goog.string.specialEscapeChars_[e]||(31<f&&127>f?e:goog.string.escapeChar(e))}b.push('"');return b.join("")};goog.string.escapeString=function(a){for(var b=[],c=0;c<a.length;c++)b[c]=goog.string.escapeChar(a.charAt(c));return b.join("")};
goog.string.escapeChar=function(a){if(a in goog.string.jsEscapeCache_)return goog.string.jsEscapeCache_[a];if(a in goog.string.specialEscapeChars_)return goog.string.jsEscapeCache_[a]=goog.string.specialEscapeChars_[a];var b=a,c=a.charCodeAt(0);if(31<c&&127>c)b=a;else{if(256>c){if(b="\\x",16>c||256<c)b+="0"}else b="\\u",4096>c&&(b+="0");b+=c.toString(16).toUpperCase()}return goog.string.jsEscapeCache_[a]=b};goog.string.contains=function(a,b){return-1!=a.indexOf(b)};
goog.string.caseInsensitiveContains=function(a,b){return goog.string.contains(a.toLowerCase(),b.toLowerCase())};goog.string.countOf=function(a,b){return a&&b?a.split(b).length-1:0};goog.string.removeAt=function(a,b,c){var e=a;0<=b&&b<a.length&&0<c&&(e=a.substr(0,b)+a.substr(b+c,a.length-b-c));return e};goog.string.remove=function(a,b){var c=new RegExp(goog.string.regExpEscape(b),"");return a.replace(c,"")};
goog.string.removeAll=function(a,b){var c=new RegExp(goog.string.regExpEscape(b),"g");return a.replace(c,"")};goog.string.regExpEscape=function(a){return String(a).replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")};goog.string.repeat=function(a,b){return Array(b+1).join(a)};goog.string.padNumber=function(a,b,c){a=goog.isDef(c)?a.toFixed(c):String(a);c=a.indexOf(".");-1==c&&(c=a.length);return goog.string.repeat("0",Math.max(0,b-c))+a};
goog.string.makeSafe=function(a){return null==a?"":String(a)};goog.string.buildString=function(a){return Array.prototype.join.call(arguments,"")};goog.string.getRandomString=function(){return Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^goog.now()).toString(36)};
goog.string.compareVersions=function(a,b){for(var c=0,e=goog.string.trim(String(a)).split("."),f=goog.string.trim(String(b)).split("."),g=Math.max(e.length,f.length),h=0;0==c&&h<g;h++){var k=e[h]||"",l=f[h]||"",m=RegExp("(\\d*)(\\D*)","g"),n=RegExp("(\\d*)(\\D*)","g");do{var q=m.exec(k)||["","",""],p=n.exec(l)||["","",""];if(0==q[0].length&&0==p[0].length)break;var c=0==q[1].length?0:parseInt(q[1],10),t=0==p[1].length?0:parseInt(p[1],10),c=goog.string.compareElements_(c,t)||goog.string.compareElements_(0==
q[2].length,0==p[2].length)||goog.string.compareElements_(q[2],p[2])}while(0==c)}return c};goog.string.compareElements_=function(a,b){return a<b?-1:a>b?1:0};goog.string.HASHCODE_MAX_=4294967296;goog.string.hashCode=function(a){for(var b=0,c=0;c<a.length;++c)b=31*b+a.charCodeAt(c),b%=goog.string.HASHCODE_MAX_;return b};goog.string.uniqueStringCounter_=2147483648*Math.random()|0;goog.string.createUniqueString=function(){return"goog_"+goog.string.uniqueStringCounter_++};
goog.string.toNumber=function(a){var b=Number(a);return 0==b&&goog.string.isEmptyOrWhitespace(a)?NaN:b};goog.string.isLowerCamelCase=function(a){return/^[a-z]+([A-Z][a-z]*)*$/.test(a)};goog.string.isUpperCamelCase=function(a){return/^([A-Z][a-z]*)+$/.test(a)};goog.string.toCamelCase=function(a){return String(a).replace(/\-([a-z])/g,function(a,c){return c.toUpperCase()})};goog.string.toSelectorCase=function(a){return String(a).replace(/([A-Z])/g,"-$1").toLowerCase()};
goog.string.toTitleCase=function(a,b){var c=goog.isString(b)?goog.string.regExpEscape(b):"\\s";return a.replace(new RegExp("(^"+(c?"|["+c+"]+":"")+")([a-z])","g"),function(a,b,c){return b+c.toUpperCase()})};goog.string.capitalize=function(a){return String(a.charAt(0)).toUpperCase()+String(a.substr(1)).toLowerCase()};goog.string.parseInt=function(a){isFinite(a)&&(a=String(a));return goog.isString(a)?/^\s*-?0x/i.test(a)?parseInt(a,16):parseInt(a,10):NaN};
goog.string.splitLimit=function(a,b,c){a=a.split(b);for(var e=[];0<c&&a.length;)e.push(a.shift()),c--;a.length&&e.push(a.join(b));return e};goog.string.editDistance=function(a,b){var c=[],e=[];if(a==b)return 0;if(!a.length||!b.length)return Math.max(a.length,b.length);for(var f=0;f<b.length+1;f++)c[f]=f;for(f=0;f<a.length;f++){e[0]=f+1;for(var g=0;g<b.length;g++)e[g+1]=Math.min(e[g]+1,c[g+1]+1,c[g]+(a[f]!=b[g]));for(g=0;g<c.length;g++)c[g]=e[g]}return e[b.length]};goog.asserts={};goog.asserts.ENABLE_ASSERTS=goog.DEBUG;goog.asserts.AssertionError=function(a,b){b.unshift(a);goog.debug.Error.call(this,goog.string.subs.apply(null,b));b.shift();this.messagePattern=a};goog.inherits(goog.asserts.AssertionError,goog.debug.Error);goog.asserts.AssertionError.prototype.name="AssertionError";goog.asserts.DEFAULT_ERROR_HANDLER=function(a){throw a;};goog.asserts.errorHandler_=goog.asserts.DEFAULT_ERROR_HANDLER;
goog.asserts.doAssertFailure_=function(a,b,c,e){var f="Assertion failed";if(c)var f=f+(": "+c),g=e;else a&&(f+=": "+a,g=b);a=new goog.asserts.AssertionError(""+f,g||[]);goog.asserts.errorHandler_(a)};goog.asserts.setErrorHandler=function(a){goog.asserts.ENABLE_ASSERTS&&(goog.asserts.errorHandler_=a)};goog.asserts.assert=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!a&&goog.asserts.doAssertFailure_("",null,b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.fail=function(a,b){goog.asserts.ENABLE_ASSERTS&&goog.asserts.errorHandler_(new goog.asserts.AssertionError("Failure"+(a?": "+a:""),Array.prototype.slice.call(arguments,1)))};goog.asserts.assertNumber=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isNumber(a)&&goog.asserts.doAssertFailure_("Expected number but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertString=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isString(a)&&goog.asserts.doAssertFailure_("Expected string but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertFunction=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isFunction(a)&&goog.asserts.doAssertFailure_("Expected function but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertObject=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isObject(a)&&goog.asserts.doAssertFailure_("Expected object but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertArray=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isArray(a)&&goog.asserts.doAssertFailure_("Expected array but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertBoolean=function(a,b,c){goog.asserts.ENABLE_ASSERTS&&!goog.isBoolean(a)&&goog.asserts.doAssertFailure_("Expected boolean but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};goog.asserts.assertElement=function(a,b,c){!goog.asserts.ENABLE_ASSERTS||goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT||goog.asserts.doAssertFailure_("Expected Element but got %s: %s.",[goog.typeOf(a),a],b,Array.prototype.slice.call(arguments,2));return a};
goog.asserts.assertInstanceof=function(a,b,c,e){!goog.asserts.ENABLE_ASSERTS||a instanceof b||goog.asserts.doAssertFailure_("Expected instanceof %s but got %s.",[goog.asserts.getType_(b),goog.asserts.getType_(a)],c,Array.prototype.slice.call(arguments,3));return a};goog.asserts.assertObjectPrototypeIsIntact=function(){for(var a in Object.prototype)goog.asserts.fail(a+" should not be enumerable in Object.prototype.")};
goog.asserts.getType_=function(a){return a instanceof Function?a.displayName||a.name||"unknown type name":a instanceof Object?a.constructor.displayName||a.constructor.name||Object.prototype.toString.call(a):null===a?"null":typeof a};goog.string.TypedString=function(){};goog.string.Const=function(){this.stringConstValueWithSecurityContract__googStringSecurityPrivate_="";this.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_=goog.string.Const.TYPE_MARKER_};goog.string.Const.prototype.implementsGoogStringTypedString=!0;goog.string.Const.prototype.getTypedStringValue=function(){return this.stringConstValueWithSecurityContract__googStringSecurityPrivate_};
goog.string.Const.prototype.toString=function(){return"Const{"+this.stringConstValueWithSecurityContract__googStringSecurityPrivate_+"}"};goog.string.Const.unwrap=function(a){if(a instanceof goog.string.Const&&a.constructor===goog.string.Const&&a.STRING_CONST_TYPE_MARKER__GOOG_STRING_SECURITY_PRIVATE_===goog.string.Const.TYPE_MARKER_)return a.stringConstValueWithSecurityContract__googStringSecurityPrivate_;goog.asserts.fail("expected object of type Const, got '"+a+"'");return"type_error:Const"};
goog.string.Const.from=function(a){return goog.string.Const.create__googStringSecurityPrivate_(a)};goog.string.Const.TYPE_MARKER_={};goog.string.Const.create__googStringSecurityPrivate_=function(a){var b=new goog.string.Const;b.stringConstValueWithSecurityContract__googStringSecurityPrivate_=a;return b};goog.i18n={};goog.i18n.bidi={};goog.i18n.bidi.FORCE_RTL=!1;
goog.i18n.bidi.IS_RTL=goog.i18n.bidi.FORCE_RTL||("ar"==goog.LOCALE.substring(0,2).toLowerCase()||"fa"==goog.LOCALE.substring(0,2).toLowerCase()||"he"==goog.LOCALE.substring(0,2).toLowerCase()||"iw"==goog.LOCALE.substring(0,2).toLowerCase()||"ps"==goog.LOCALE.substring(0,2).toLowerCase()||"sd"==goog.LOCALE.substring(0,2).toLowerCase()||"ug"==goog.LOCALE.substring(0,2).toLowerCase()||"ur"==goog.LOCALE.substring(0,2).toLowerCase()||"yi"==goog.LOCALE.substring(0,2).toLowerCase())&&(2==goog.LOCALE.length||
"-"==goog.LOCALE.substring(2,3)||"_"==goog.LOCALE.substring(2,3))||3<=goog.LOCALE.length&&"ckb"==goog.LOCALE.substring(0,3).toLowerCase()&&(3==goog.LOCALE.length||"-"==goog.LOCALE.substring(3,4)||"_"==goog.LOCALE.substring(3,4));goog.i18n.bidi.Format={LRE:"\u202a",RLE:"\u202b",PDF:"\u202c",LRM:"\u200e",RLM:"\u200f"};goog.i18n.bidi.Dir={LTR:1,RTL:-1,NEUTRAL:0};goog.i18n.bidi.RIGHT="right";goog.i18n.bidi.LEFT="left";goog.i18n.bidi.I18N_RIGHT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.LEFT:goog.i18n.bidi.RIGHT;
goog.i18n.bidi.I18N_LEFT=goog.i18n.bidi.IS_RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT;goog.i18n.bidi.toDir=function(a,b){return"number"==typeof a?0<a?goog.i18n.bidi.Dir.LTR:0>a?goog.i18n.bidi.Dir.RTL:b?null:goog.i18n.bidi.Dir.NEUTRAL:null==a?null:a?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};goog.i18n.bidi.ltrChars_="A-Za-z\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u02b8\u0300-\u0590\u0800-\u1fff\u200e\u2c00-\ufb1c\ufe00-\ufe6f\ufefd-\uffff";goog.i18n.bidi.rtlChars_="\u0591-\u06ef\u06fa-\u07ff\u200f\ufb1d-\ufdff\ufe70-\ufefc";
goog.i18n.bidi.htmlSkipReg_=/<[^>]*>|&[^;]+;/g;goog.i18n.bidi.stripHtmlIfNeeded_=function(a,b){return b?a.replace(goog.i18n.bidi.htmlSkipReg_,""):a};goog.i18n.bidi.rtlCharReg_=new RegExp("["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.ltrCharReg_=new RegExp("["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.hasAnyRtl=function(a,b){return goog.i18n.bidi.rtlCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.hasRtlChar=goog.i18n.bidi.hasAnyRtl;
goog.i18n.bidi.hasAnyLtr=function(a,b){return goog.i18n.bidi.ltrCharReg_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.ltrRe_=new RegExp("^["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlRe_=new RegExp("^["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.isRtlChar=function(a){return goog.i18n.bidi.rtlRe_.test(a)};goog.i18n.bidi.isLtrChar=function(a){return goog.i18n.bidi.ltrRe_.test(a)};goog.i18n.bidi.isNeutralChar=function(a){return!goog.i18n.bidi.isLtrChar(a)&&!goog.i18n.bidi.isRtlChar(a)};
goog.i18n.bidi.ltrDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.rtlChars_+"]*["+goog.i18n.bidi.ltrChars_+"]");goog.i18n.bidi.rtlDirCheckRe_=new RegExp("^[^"+goog.i18n.bidi.ltrChars_+"]*["+goog.i18n.bidi.rtlChars_+"]");goog.i18n.bidi.startsWithRtl=function(a,b){return goog.i18n.bidi.rtlDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isRtlText=goog.i18n.bidi.startsWithRtl;
goog.i18n.bidi.startsWithLtr=function(a,b){return goog.i18n.bidi.ltrDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isLtrText=goog.i18n.bidi.startsWithLtr;goog.i18n.bidi.isRequiredLtrRe_=/^http:\/\/.*/;goog.i18n.bidi.isNeutralText=function(a,b){a=goog.i18n.bidi.stripHtmlIfNeeded_(a,b);return goog.i18n.bidi.isRequiredLtrRe_.test(a)||!goog.i18n.bidi.hasAnyLtr(a)&&!goog.i18n.bidi.hasAnyRtl(a)};
goog.i18n.bidi.ltrExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.ltrChars_+"][^"+goog.i18n.bidi.rtlChars_+"]*$");goog.i18n.bidi.rtlExitDirCheckRe_=new RegExp("["+goog.i18n.bidi.rtlChars_+"][^"+goog.i18n.bidi.ltrChars_+"]*$");goog.i18n.bidi.endsWithLtr=function(a,b){return goog.i18n.bidi.ltrExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isLtrExitText=goog.i18n.bidi.endsWithLtr;
goog.i18n.bidi.endsWithRtl=function(a,b){return goog.i18n.bidi.rtlExitDirCheckRe_.test(goog.i18n.bidi.stripHtmlIfNeeded_(a,b))};goog.i18n.bidi.isRtlExitText=goog.i18n.bidi.endsWithRtl;goog.i18n.bidi.rtlLocalesRe_=/^(ar|ckb|dv|he|iw|fa|nqo|ps|sd|ug|ur|yi|.*[-_](Arab|Hebr|Thaa|Nkoo|Tfng))(?!.*[-_](Latn|Cyrl)($|-|_))($|-|_)/i;goog.i18n.bidi.isRtlLanguage=function(a){return goog.i18n.bidi.rtlLocalesRe_.test(a)};goog.i18n.bidi.bracketGuardHtmlRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(&lt;.*?(&gt;)+)/g;
goog.i18n.bidi.bracketGuardTextRe_=/(\(.*?\)+)|(\[.*?\]+)|(\{.*?\}+)|(<.*?>+)/g;goog.i18n.bidi.guardBracketInHtml=function(a,b){return(void 0===b?goog.i18n.bidi.hasAnyRtl(a):b)?a.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=rtl>$&</span>"):a.replace(goog.i18n.bidi.bracketGuardHtmlRe_,"<span dir=ltr>$&</span>")};
goog.i18n.bidi.guardBracketInText=function(a,b){var c=(void 0===b?goog.i18n.bidi.hasAnyRtl(a):b)?goog.i18n.bidi.Format.RLM:goog.i18n.bidi.Format.LRM;return a.replace(goog.i18n.bidi.bracketGuardTextRe_,c+"$&"+c)};goog.i18n.bidi.enforceRtlInHtml=function(a){return"<"==a.charAt(0)?a.replace(/<\w+/,"$& dir=rtl"):"\n<span dir=rtl>"+a+"</span>"};goog.i18n.bidi.enforceRtlInText=function(a){return goog.i18n.bidi.Format.RLE+a+goog.i18n.bidi.Format.PDF};
goog.i18n.bidi.enforceLtrInHtml=function(a){return"<"==a.charAt(0)?a.replace(/<\w+/,"$& dir=ltr"):"\n<span dir=ltr>"+a+"</span>"};goog.i18n.bidi.enforceLtrInText=function(a){return goog.i18n.bidi.Format.LRE+a+goog.i18n.bidi.Format.PDF};goog.i18n.bidi.dimensionsRe_=/:\s*([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)\s+([.\d][.\w]*)/g;goog.i18n.bidi.leftRe_=/left/gi;goog.i18n.bidi.rightRe_=/right/gi;goog.i18n.bidi.tempRe_=/%%%%/g;
goog.i18n.bidi.mirrorCSS=function(a){return a.replace(goog.i18n.bidi.dimensionsRe_,":$1 $4 $3 $2").replace(goog.i18n.bidi.leftRe_,"%%%%").replace(goog.i18n.bidi.rightRe_,goog.i18n.bidi.LEFT).replace(goog.i18n.bidi.tempRe_,goog.i18n.bidi.RIGHT)};goog.i18n.bidi.doubleQuoteSubstituteRe_=/([\u0591-\u05f2])"/g;goog.i18n.bidi.singleQuoteSubstituteRe_=/([\u0591-\u05f2])'/g;
goog.i18n.bidi.normalizeHebrewQuote=function(a){return a.replace(goog.i18n.bidi.doubleQuoteSubstituteRe_,"$1\u05f4").replace(goog.i18n.bidi.singleQuoteSubstituteRe_,"$1\u05f3")};goog.i18n.bidi.wordSeparatorRe_=/\s+/;goog.i18n.bidi.hasNumeralsRe_=/[\d\u06f0-\u06f9]/;goog.i18n.bidi.rtlDetectionThreshold_=.4;
goog.i18n.bidi.estimateDirection=function(a,b){for(var c=0,e=0,f=!1,g=goog.i18n.bidi.stripHtmlIfNeeded_(a,b).split(goog.i18n.bidi.wordSeparatorRe_),h=0;h<g.length;h++){var k=g[h];goog.i18n.bidi.startsWithRtl(k)?(c++,e++):goog.i18n.bidi.isRequiredLtrRe_.test(k)?f=!0:goog.i18n.bidi.hasAnyLtr(k)?e++:goog.i18n.bidi.hasNumeralsRe_.test(k)&&(f=!0)}return 0==e?f?goog.i18n.bidi.Dir.LTR:goog.i18n.bidi.Dir.NEUTRAL:c/e>goog.i18n.bidi.rtlDetectionThreshold_?goog.i18n.bidi.Dir.RTL:goog.i18n.bidi.Dir.LTR};
goog.i18n.bidi.detectRtlDirectionality=function(a,b){return goog.i18n.bidi.estimateDirection(a,b)==goog.i18n.bidi.Dir.RTL};goog.i18n.bidi.setElementDirAndAlign=function(a,b){a&&(b=goog.i18n.bidi.toDir(b))&&(a.style.textAlign=b==goog.i18n.bidi.Dir.RTL?goog.i18n.bidi.RIGHT:goog.i18n.bidi.LEFT,a.dir=b==goog.i18n.bidi.Dir.RTL?"rtl":"ltr")};
goog.i18n.bidi.setElementDirByTextDirectionality=function(a,b){switch(goog.i18n.bidi.estimateDirection(b)){case goog.i18n.bidi.Dir.LTR:a.dir="ltr";break;case goog.i18n.bidi.Dir.RTL:a.dir="rtl";break;default:a.removeAttribute("dir")}};goog.i18n.bidi.DirectionalString=function(){};goog.html={};goog.html.SafeUrl=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeUrl.INNOCUOUS_STRING="about:invalid#zClosurez";goog.html.SafeUrl.prototype.implementsGoogStringTypedString=!0;goog.html.SafeUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};
goog.html.SafeUrl.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.SafeUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.DEBUG&&(goog.html.SafeUrl.prototype.toString=function(){return"SafeUrl{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"});
goog.html.SafeUrl.unwrap=function(a){if(a instanceof goog.html.SafeUrl&&a.constructor===goog.html.SafeUrl&&a.SAFE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeHtmlWrappedValue_;goog.asserts.fail("expected object of type SafeUrl, got '"+a+"'");return"type_error:SafeUrl"};goog.html.SafeUrl.fromConstant=function(a){return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(a))};
goog.html.SAFE_MIME_TYPE_PATTERN_=/^(?:image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp)|video\/(?:mpeg|mp4|ogg|webm))$/i;goog.html.SafeUrl.fromBlob=function(a){a=goog.html.SAFE_MIME_TYPE_PATTERN_.test(a.type)?goog.fs.url.createObjectUrl(a):goog.html.SafeUrl.INNOCUOUS_STRING;return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};goog.html.DATA_URL_PATTERN_=/^data:([^;,]*);base64,[a-z0-9+\/]+=*$/i;
goog.html.SafeUrl.fromDataUrl=function(a){var b=a.match(goog.html.DATA_URL_PATTERN_),b=b&&goog.html.SAFE_MIME_TYPE_PATTERN_.test(b[1]);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(b?a:goog.html.SafeUrl.INNOCUOUS_STRING)};goog.html.SAFE_URL_PATTERN_=/^(?:(?:https?|mailto|ftp):|[^&:/?#]*(?:[/?#]|$))/i;
goog.html.SafeUrl.sanitize=function(a){if(a instanceof goog.html.SafeUrl)return a;a=a.implementsGoogStringTypedString?a.getTypedStringValue():String(a);goog.html.SAFE_URL_PATTERN_.test(a)||(a=goog.html.SafeUrl.INNOCUOUS_STRING);return goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse(a)};goog.html.SafeUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.SafeUrl.createSafeUrlSecurityPrivateDoNotAccessOrElse=function(a){var b=new goog.html.SafeUrl;b.privateDoNotAccessOrElseSafeHtmlWrappedValue_=a;return b};goog.object={};goog.object.forEach=function(a,b,c){for(var e in a)b.call(c,a[e],e,a)};goog.object.filter=function(a,b,c){var e={},f;for(f in a)b.call(c,a[f],f,a)&&(e[f]=a[f]);return e};goog.object.map=function(a,b,c){var e={},f;for(f in a)e[f]=b.call(c,a[f],f,a);return e};goog.object.some=function(a,b,c){for(var e in a)if(b.call(c,a[e],e,a))return!0;return!1};goog.object.every=function(a,b,c){for(var e in a)if(!b.call(c,a[e],e,a))return!1;return!0};
goog.object.getCount=function(a){var b=0,c;for(c in a)b++;return b};goog.object.getAnyKey=function(a){for(var b in a)return b};goog.object.getAnyValue=function(a){for(var b in a)return a[b]};goog.object.contains=function(a,b){return goog.object.containsValue(a,b)};goog.object.getValues=function(a){var b=[],c=0,e;for(e in a)b[c++]=a[e];return b};goog.object.getKeys=function(a){var b=[],c=0,e;for(e in a)b[c++]=e;return b};
goog.object.getValueByKeys=function(a,b){for(var c=goog.isArrayLike(b),e=c?b:arguments,c=c?0:1;c<e.length&&(a=a[e[c]],goog.isDef(a));c++);return a};goog.object.containsKey=function(a,b){return b in a};goog.object.containsValue=function(a,b){for(var c in a)if(a[c]==b)return!0;return!1};goog.object.findKey=function(a,b,c){for(var e in a)if(b.call(c,a[e],e,a))return e};goog.object.findValue=function(a,b,c){return(b=goog.object.findKey(a,b,c))&&a[b]};
goog.object.isEmpty=function(a){for(var b in a)return!1;return!0};goog.object.clear=function(a){for(var b in a)delete a[b]};goog.object.remove=function(a,b){var c;(c=b in a)&&delete a[b];return c};goog.object.add=function(a,b,c){if(b in a)throw Error('The object already contains the key "'+b+'"');goog.object.set(a,b,c)};goog.object.get=function(a,b,c){return b in a?a[b]:c};goog.object.set=function(a,b,c){a[b]=c};goog.object.setIfUndefined=function(a,b,c){return b in a?a[b]:a[b]=c};
goog.object.setWithReturnValueIfNotSet=function(a,b,c){if(b in a)return a[b];c=c();return a[b]=c};goog.object.equals=function(a,b){for(var c in a)if(!(c in b)||a[c]!==b[c])return!1;for(c in b)if(!(c in a))return!1;return!0};goog.object.clone=function(a){var b={},c;for(c in a)b[c]=a[c];return b};goog.object.unsafeClone=function(a){var b=goog.typeOf(a);if("object"==b||"array"==b){if(a.clone)return a.clone();var b="array"==b?[]:{},c;for(c in a)b[c]=goog.object.unsafeClone(a[c]);return b}return a};
goog.object.transpose=function(a){var b={},c;for(c in a)b[a[c]]=c;return b};goog.object.PROTOTYPE_FIELDS_="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");goog.object.extend=function(a,b){for(var c,e,f=1;f<arguments.length;f++){e=arguments[f];for(c in e)a[c]=e[c];for(var g=0;g<goog.object.PROTOTYPE_FIELDS_.length;g++)c=goog.object.PROTOTYPE_FIELDS_[g],Object.prototype.hasOwnProperty.call(e,c)&&(a[c]=e[c])}};
goog.object.create=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.create.apply(null,arguments[0]);if(b%2)throw Error("Uneven number of arguments");for(var c={},e=0;e<b;e+=2)c[arguments[e]]=arguments[e+1];return c};goog.object.createSet=function(a){var b=arguments.length;if(1==b&&goog.isArray(arguments[0]))return goog.object.createSet.apply(null,arguments[0]);for(var c={},e=0;e<b;e++)c[arguments[e]]=!0;return c};
goog.object.createImmutableView=function(a){var b=a;Object.isFrozen&&!Object.isFrozen(a)&&(b=Object.create(a),Object.freeze(b));return b};goog.object.isImmutableView=function(a){return!!Object.isFrozen&&Object.isFrozen(a)};goog.dom.tags={};goog.dom.tags.VOID_TAGS_={area:!0,base:!0,br:!0,col:!0,command:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0};goog.dom.tags.isVoidTag=function(a){return!0===goog.dom.tags.VOID_TAGS_[a]};goog.array={};goog.NATIVE_ARRAY_PROTOTYPES=goog.TRUSTED_SITE;goog.array.ASSUME_NATIVE_FUNCTIONS=!1;goog.array.peek=function(a){return a[a.length-1]};goog.array.last=goog.array.peek;goog.array.ARRAY_PROTOTYPE_=Array.prototype;
goog.array.indexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.indexOf)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.indexOf.call(a,b,c)}:function(a,b,c){c=null==c?0:0>c?Math.max(0,a.length+c):c;if(goog.isString(a))return goog.isString(b)&&1==b.length?a.indexOf(b,c):-1;for(;c<a.length;c++)if(c in a&&a[c]===b)return c;return-1};
goog.array.lastIndexOf=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.lastIndexOf)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.lastIndexOf.call(a,b,null==c?a.length-1:c)}:function(a,b,c){c=null==c?a.length-1:c;0>c&&(c=Math.max(0,a.length+c));if(goog.isString(a))return goog.isString(b)&&1==b.length?a.lastIndexOf(b,c):-1;for(;0<=c;c--)if(c in a&&a[c]===b)return c;return-1};
goog.array.forEach=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.forEach)?function(a,b,c){goog.asserts.assert(null!=a.length);goog.array.ARRAY_PROTOTYPE_.forEach.call(a,b,c)}:function(a,b,c){for(var e=a.length,f=goog.isString(a)?a.split(""):a,g=0;g<e;g++)g in f&&b.call(c,f[g],g,a)};goog.array.forEachRight=function(a,b,c){for(var e=a.length,f=goog.isString(a)?a.split(""):a,e=e-1;0<=e;--e)e in f&&b.call(c,f[e],e,a)};
goog.array.filter=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.filter)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.filter.call(a,b,c)}:function(a,b,c){for(var e=a.length,f=[],g=0,h=goog.isString(a)?a.split(""):a,k=0;k<e;k++)if(k in h){var l=h[k];b.call(c,l,k,a)&&(f[g++]=l)}return f};
goog.array.map=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.map)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.map.call(a,b,c)}:function(a,b,c){for(var e=a.length,f=Array(e),g=goog.isString(a)?a.split(""):a,h=0;h<e;h++)h in g&&(f[h]=b.call(c,g[h],h,a));return f};
goog.array.reduce=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.reduce)?function(a,b,c,e){goog.asserts.assert(null!=a.length);e&&(b=goog.bind(b,e));return goog.array.ARRAY_PROTOTYPE_.reduce.call(a,b,c)}:function(a,b,c,e){var f=c;goog.array.forEach(a,function(c,h){f=b.call(e,f,c,h,a)});return f};
goog.array.reduceRight=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.reduceRight)?function(a,b,c,e){goog.asserts.assert(null!=a.length);e&&(b=goog.bind(b,e));return goog.array.ARRAY_PROTOTYPE_.reduceRight.call(a,b,c)}:function(a,b,c,e){var f=c;goog.array.forEachRight(a,function(c,h){f=b.call(e,f,c,h,a)});return f};
goog.array.some=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.some)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.some.call(a,b,c)}:function(a,b,c){for(var e=a.length,f=goog.isString(a)?a.split(""):a,g=0;g<e;g++)if(g in f&&b.call(c,f[g],g,a))return!0;return!1};
goog.array.every=goog.NATIVE_ARRAY_PROTOTYPES&&(goog.array.ASSUME_NATIVE_FUNCTIONS||goog.array.ARRAY_PROTOTYPE_.every)?function(a,b,c){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.every.call(a,b,c)}:function(a,b,c){for(var e=a.length,f=goog.isString(a)?a.split(""):a,g=0;g<e;g++)if(g in f&&!b.call(c,f[g],g,a))return!1;return!0};goog.array.count=function(a,b,c){var e=0;goog.array.forEach(a,function(a,g,h){b.call(c,a,g,h)&&++e},c);return e};
goog.array.find=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};goog.array.findIndex=function(a,b,c){for(var e=a.length,f=goog.isString(a)?a.split(""):a,g=0;g<e;g++)if(g in f&&b.call(c,f[g],g,a))return g;return-1};goog.array.findRight=function(a,b,c){b=goog.array.findIndexRight(a,b,c);return 0>b?null:goog.isString(a)?a.charAt(b):a[b]};
goog.array.findIndexRight=function(a,b,c){for(var e=a.length,f=goog.isString(a)?a.split(""):a,e=e-1;0<=e;e--)if(e in f&&b.call(c,f[e],e,a))return e;return-1};goog.array.contains=function(a,b){return 0<=goog.array.indexOf(a,b)};goog.array.isEmpty=function(a){return 0==a.length};goog.array.clear=function(a){if(!goog.isArray(a))for(var b=a.length-1;0<=b;b--)delete a[b];a.length=0};goog.array.insert=function(a,b){goog.array.contains(a,b)||a.push(b)};
goog.array.insertAt=function(a,b,c){goog.array.splice(a,c,0,b)};goog.array.insertArrayAt=function(a,b,c){goog.partial(goog.array.splice,a,c,0).apply(null,b)};goog.array.insertBefore=function(a,b,c){var e;2==arguments.length||0>(e=goog.array.indexOf(a,c))?a.push(b):goog.array.insertAt(a,b,e)};goog.array.remove=function(a,b){var c=goog.array.indexOf(a,b),e;(e=0<=c)&&goog.array.removeAt(a,c);return e};
goog.array.removeAt=function(a,b){goog.asserts.assert(null!=a.length);return 1==goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1).length};goog.array.removeIf=function(a,b,c){b=goog.array.findIndex(a,b,c);return 0<=b?(goog.array.removeAt(a,b),!0):!1};goog.array.removeAllIf=function(a,b,c){var e=0;goog.array.forEachRight(a,function(f,g){b.call(c,f,g,a)&&goog.array.removeAt(a,g)&&e++});return e};goog.array.concat=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};
goog.array.join=function(a){return goog.array.ARRAY_PROTOTYPE_.concat.apply(goog.array.ARRAY_PROTOTYPE_,arguments)};goog.array.toArray=function(a){var b=a.length;if(0<b){for(var c=Array(b),e=0;e<b;e++)c[e]=a[e];return c}return[]};goog.array.clone=goog.array.toArray;goog.array.extend=function(a,b){for(var c=1;c<arguments.length;c++){var e=arguments[c];if(goog.isArrayLike(e)){var f=a.length||0,g=e.length||0;a.length=f+g;for(var h=0;h<g;h++)a[f+h]=e[h]}else a.push(e)}};
goog.array.splice=function(a,b,c,e){goog.asserts.assert(null!=a.length);return goog.array.ARRAY_PROTOTYPE_.splice.apply(a,goog.array.slice(arguments,1))};goog.array.slice=function(a,b,c){goog.asserts.assert(null!=a.length);return 2>=arguments.length?goog.array.ARRAY_PROTOTYPE_.slice.call(a,b):goog.array.ARRAY_PROTOTYPE_.slice.call(a,b,c)};
goog.array.removeDuplicates=function(a,b,c){b=b||a;var e=function(a){return goog.isObject(a)?"o"+goog.getUid(a):(typeof a).charAt(0)+a};c=c||e;for(var e={},f=0,g=0;g<a.length;){var h=a[g++],k=c(h);Object.prototype.hasOwnProperty.call(e,k)||(e[k]=!0,b[f++]=h)}b.length=f};goog.array.binarySearch=function(a,b,c){return goog.array.binarySearch_(a,c||goog.array.defaultCompare,!1,b)};goog.array.binarySelect=function(a,b,c){return goog.array.binarySearch_(a,b,!0,void 0,c)};
goog.array.binarySearch_=function(a,b,c,e,f){for(var g=0,h=a.length,k;g<h;){var l=g+h>>1,m;m=c?b.call(f,a[l],l,a):b(e,a[l]);0<m?g=l+1:(h=l,k=!m)}return k?g:~g};goog.array.sort=function(a,b){a.sort(b||goog.array.defaultCompare)};goog.array.stableSort=function(a,b){for(var c=0;c<a.length;c++)a[c]={index:c,value:a[c]};var e=b||goog.array.defaultCompare;goog.array.sort(a,function(a,b){return e(a.value,b.value)||a.index-b.index});for(c=0;c<a.length;c++)a[c]=a[c].value};
goog.array.sortByKey=function(a,b,c){var e=c||goog.array.defaultCompare;goog.array.sort(a,function(a,c){return e(b(a),b(c))})};goog.array.sortObjectsByKey=function(a,b,c){goog.array.sortByKey(a,function(a){return a[b]},c)};goog.array.isSorted=function(a,b,c){b=b||goog.array.defaultCompare;for(var e=1;e<a.length;e++){var f=b(a[e-1],a[e]);if(0<f||0==f&&c)return!1}return!0};
goog.array.equals=function(a,b,c){if(!goog.isArrayLike(a)||!goog.isArrayLike(b)||a.length!=b.length)return!1;var e=a.length;c=c||goog.array.defaultCompareEquality;for(var f=0;f<e;f++)if(!c(a[f],b[f]))return!1;return!0};goog.array.compare3=function(a,b,c){c=c||goog.array.defaultCompare;for(var e=Math.min(a.length,b.length),f=0;f<e;f++){var g=c(a[f],b[f]);if(0!=g)return g}return goog.array.defaultCompare(a.length,b.length)};goog.array.defaultCompare=function(a,b){return a>b?1:a<b?-1:0};
goog.array.inverseDefaultCompare=function(a,b){return-goog.array.defaultCompare(a,b)};goog.array.defaultCompareEquality=function(a,b){return a===b};goog.array.binaryInsert=function(a,b,c){c=goog.array.binarySearch(a,b,c);return 0>c?(goog.array.insertAt(a,b,-(c+1)),!0):!1};goog.array.binaryRemove=function(a,b,c){b=goog.array.binarySearch(a,b,c);return 0<=b?goog.array.removeAt(a,b):!1};
goog.array.bucket=function(a,b,c){for(var e={},f=0;f<a.length;f++){var g=a[f],h=b.call(c,g,f,a);goog.isDef(h)&&(e[h]||(e[h]=[])).push(g)}return e};goog.array.toObject=function(a,b,c){var e={};goog.array.forEach(a,function(f,g){e[b.call(c,f,g,a)]=f});return e};goog.array.range=function(a,b,c){var e=[],f=0,g=a;c=c||1;void 0!==b&&(f=a,g=b);if(0>c*(g-f))return[];if(0<c)for(a=f;a<g;a+=c)e.push(a);else for(a=f;a>g;a+=c)e.push(a);return e};
goog.array.repeat=function(a,b){for(var c=[],e=0;e<b;e++)c[e]=a;return c};goog.array.flatten=function(a){for(var b=[],c=0;c<arguments.length;c++){var e=arguments[c];if(goog.isArray(e))for(var f=0;f<e.length;f+=8192)for(var g=goog.array.slice(e,f,f+8192),g=goog.array.flatten.apply(null,g),h=0;h<g.length;h++)b.push(g[h]);else b.push(e)}return b};
goog.array.rotate=function(a,b){goog.asserts.assert(null!=a.length);a.length&&(b%=a.length,0<b?goog.array.ARRAY_PROTOTYPE_.unshift.apply(a,a.splice(-b,b)):0>b&&goog.array.ARRAY_PROTOTYPE_.push.apply(a,a.splice(0,-b)));return a};goog.array.moveItem=function(a,b,c){goog.asserts.assert(0<=b&&b<a.length);goog.asserts.assert(0<=c&&c<a.length);b=goog.array.ARRAY_PROTOTYPE_.splice.call(a,b,1);goog.array.ARRAY_PROTOTYPE_.splice.call(a,c,0,b[0])};
goog.array.zip=function(a){if(!arguments.length)return[];for(var b=[],c=0;;c++){for(var e=[],f=0;f<arguments.length;f++){var g=arguments[f];if(c>=g.length)return b;e.push(g[c])}b.push(e)}};goog.array.shuffle=function(a,b){for(var c=b||Math.random,e=a.length-1;0<e;e--){var f=Math.floor(c()*(e+1)),g=a[e];a[e]=a[f];a[f]=g}};goog.array.copyByIndex=function(a,b){var c=[];goog.array.forEach(b,function(b){c.push(a[b])});return c};goog.html.SafeStyle=function(){this.privateDoNotAccessOrElseSafeStyleWrappedValue_="";this.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyle.prototype.implementsGoogStringTypedString=!0;goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.SafeStyle.fromConstant=function(a){a=goog.string.Const.unwrap(a);if(0===a.length)return goog.html.SafeStyle.EMPTY;goog.html.SafeStyle.checkStyle_(a);goog.asserts.assert(goog.string.endsWith(a,";"),"Last character of style string is not ';': "+a);goog.asserts.assert(goog.string.contains(a,":"),"Style string must contain at least one ':', to specify a \"name: value\" pair: "+a);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(a)};
goog.html.SafeStyle.checkStyle_=function(a){goog.asserts.assert(!/[<>]/.test(a),"Forbidden characters in style string: "+a)};goog.html.SafeStyle.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleWrappedValue_};goog.DEBUG&&(goog.html.SafeStyle.prototype.toString=function(){return"SafeStyle{"+this.privateDoNotAccessOrElseSafeStyleWrappedValue_+"}"});
goog.html.SafeStyle.unwrap=function(a){if(a instanceof goog.html.SafeStyle&&a.constructor===goog.html.SafeStyle&&a.SAFE_STYLE_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyle.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeStyleWrappedValue_;goog.asserts.fail("expected object of type SafeStyle, got '"+a+"'");return"type_error:SafeStyle"};goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse=function(a){return(new goog.html.SafeStyle).initSecurityPrivateDoNotAccessOrElse_(a)};
goog.html.SafeStyle.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a){this.privateDoNotAccessOrElseSafeStyleWrappedValue_=a;return this};goog.html.SafeStyle.EMPTY=goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse("");goog.html.SafeStyle.INNOCUOUS_STRING="zClosurez";
goog.html.SafeStyle.create=function(a){var b="",c;for(c in a){if(!/^[-_a-zA-Z0-9]+$/.test(c))throw Error("Name allows only [-_a-zA-Z0-9], got: "+c);var e=a[c];null!=e&&(e instanceof goog.string.Const?(e=goog.string.Const.unwrap(e),goog.asserts.assert(!/[{;}]/.test(e),"Value does not allow [{;}].")):goog.html.SafeStyle.VALUE_RE_.test(e)?goog.html.SafeStyle.hasBalancedQuotes_(e)||(goog.asserts.fail("String value requires balanced quotes, got: "+e),e=goog.html.SafeStyle.INNOCUOUS_STRING):(goog.asserts.fail("String value allows only [-,.\"'%_!# a-zA-Z0-9], got: "+
e),e=goog.html.SafeStyle.INNOCUOUS_STRING),b+=c+":"+e+";")}if(!b)return goog.html.SafeStyle.EMPTY;goog.html.SafeStyle.checkStyle_(b);return goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b)};goog.html.SafeStyle.hasBalancedQuotes_=function(a){for(var b=!0,c=!0,e=0;e<a.length;e++){var f=a.charAt(e);"'"==f&&c?b=!b:'"'==f&&b&&(c=!c)}return b&&c};goog.html.SafeStyle.VALUE_RE_=/^[-,."'%_!# a-zA-Z0-9]+$/;
goog.html.SafeStyle.concat=function(a){var b="",c=function(a){goog.isArray(a)?goog.array.forEach(a,c):b+=goog.html.SafeStyle.unwrap(a)};goog.array.forEach(arguments,c);return b?goog.html.SafeStyle.createSafeStyleSecurityPrivateDoNotAccessOrElse(b):goog.html.SafeStyle.EMPTY};goog.dom.TagName={A:"A",ABBR:"ABBR",ACRONYM:"ACRONYM",ADDRESS:"ADDRESS",APPLET:"APPLET",AREA:"AREA",ARTICLE:"ARTICLE",ASIDE:"ASIDE",AUDIO:"AUDIO",B:"B",BASE:"BASE",BASEFONT:"BASEFONT",BDI:"BDI",BDO:"BDO",BIG:"BIG",BLOCKQUOTE:"BLOCKQUOTE",BODY:"BODY",BR:"BR",BUTTON:"BUTTON",CANVAS:"CANVAS",CAPTION:"CAPTION",CENTER:"CENTER",CITE:"CITE",CODE:"CODE",COL:"COL",COLGROUP:"COLGROUP",COMMAND:"COMMAND",DATA:"DATA",DATALIST:"DATALIST",DD:"DD",DEL:"DEL",DETAILS:"DETAILS",DFN:"DFN",DIALOG:"DIALOG",DIR:"DIR",DIV:"DIV",
DL:"DL",DT:"DT",EM:"EM",EMBED:"EMBED",FIELDSET:"FIELDSET",FIGCAPTION:"FIGCAPTION",FIGURE:"FIGURE",FONT:"FONT",FOOTER:"FOOTER",FORM:"FORM",FRAME:"FRAME",FRAMESET:"FRAMESET",H1:"H1",H2:"H2",H3:"H3",H4:"H4",H5:"H5",H6:"H6",HEAD:"HEAD",HEADER:"HEADER",HGROUP:"HGROUP",HR:"HR",HTML:"HTML",I:"I",IFRAME:"IFRAME",IMG:"IMG",INPUT:"INPUT",INS:"INS",ISINDEX:"ISINDEX",KBD:"KBD",KEYGEN:"KEYGEN",LABEL:"LABEL",LEGEND:"LEGEND",LI:"LI",LINK:"LINK",MAP:"MAP",MARK:"MARK",MATH:"MATH",MENU:"MENU",META:"META",METER:"METER",
NAV:"NAV",NOFRAMES:"NOFRAMES",NOSCRIPT:"NOSCRIPT",OBJECT:"OBJECT",OL:"OL",OPTGROUP:"OPTGROUP",OPTION:"OPTION",OUTPUT:"OUTPUT",P:"P",PARAM:"PARAM",PRE:"PRE",PROGRESS:"PROGRESS",Q:"Q",RP:"RP",RT:"RT",RUBY:"RUBY",S:"S",SAMP:"SAMP",SCRIPT:"SCRIPT",SECTION:"SECTION",SELECT:"SELECT",SMALL:"SMALL",SOURCE:"SOURCE",SPAN:"SPAN",STRIKE:"STRIKE",STRONG:"STRONG",STYLE:"STYLE",SUB:"SUB",SUMMARY:"SUMMARY",SUP:"SUP",SVG:"SVG",TABLE:"TABLE",TBODY:"TBODY",TD:"TD",TEMPLATE:"TEMPLATE",TEXTAREA:"TEXTAREA",TFOOT:"TFOOT",
TH:"TH",THEAD:"THEAD",TIME:"TIME",TITLE:"TITLE",TR:"TR",TRACK:"TRACK",TT:"TT",U:"U",UL:"UL",VAR:"VAR",VIDEO:"VIDEO",WBR:"WBR"};goog.html.TrustedResourceUrl=function(){this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_="";this.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.TrustedResourceUrl.prototype.implementsGoogStringTypedString=!0;goog.html.TrustedResourceUrl.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_};
goog.html.TrustedResourceUrl.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.TrustedResourceUrl.prototype.getDirection=function(){return goog.i18n.bidi.Dir.LTR};goog.DEBUG&&(goog.html.TrustedResourceUrl.prototype.toString=function(){return"TrustedResourceUrl{"+this.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_+"}"});
goog.html.TrustedResourceUrl.unwrap=function(a){if(a instanceof goog.html.TrustedResourceUrl&&a.constructor===goog.html.TrustedResourceUrl&&a.TRUSTED_RESOURCE_URL_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_;goog.asserts.fail("expected object of type TrustedResourceUrl, got '"+a+"'");return"type_error:TrustedResourceUrl"};goog.html.TrustedResourceUrl.fromConstant=function(a){return goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse(goog.string.Const.unwrap(a))};
goog.html.TrustedResourceUrl.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.TrustedResourceUrl.createTrustedResourceUrlSecurityPrivateDoNotAccessOrElse=function(a){var b=new goog.html.TrustedResourceUrl;b.privateDoNotAccessOrElseTrustedResourceUrlWrappedValue_=a;return b};goog.html.SafeStyleSheet=function(){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_="";this.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_};goog.html.SafeStyleSheet.prototype.implementsGoogStringTypedString=!0;goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};
goog.html.SafeStyleSheet.concat=function(a){var b="",c=function(a){goog.isArray(a)?goog.array.forEach(a,c):b+=goog.html.SafeStyleSheet.unwrap(a)};goog.array.forEach(arguments,c);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(b)};
goog.html.SafeStyleSheet.fromConstant=function(a){a=goog.string.Const.unwrap(a);if(0===a.length)return goog.html.SafeStyleSheet.EMPTY;goog.asserts.assert(!goog.string.contains(a,"<"),"Forbidden '<' character in style sheet string: "+a);return goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse(a)};goog.html.SafeStyleSheet.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_};
goog.DEBUG&&(goog.html.SafeStyleSheet.prototype.toString=function(){return"SafeStyleSheet{"+this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_+"}"});
goog.html.SafeStyleSheet.unwrap=function(a){if(a instanceof goog.html.SafeStyleSheet&&a.constructor===goog.html.SafeStyleSheet&&a.SAFE_SCRIPT_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeStyleSheet.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_;goog.asserts.fail("expected object of type SafeStyleSheet, got '"+a+"'");return"type_error:SafeStyleSheet"};goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse=function(a){return(new goog.html.SafeStyleSheet).initSecurityPrivateDoNotAccessOrElse_(a)};
goog.html.SafeStyleSheet.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a){this.privateDoNotAccessOrElseSafeStyleSheetWrappedValue_=a;return this};goog.html.SafeStyleSheet.EMPTY=goog.html.SafeStyleSheet.createSafeStyleSheetSecurityPrivateDoNotAccessOrElse("");goog.html.SafeHtml=function(){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_="";this.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_=goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_;this.dir_=null};goog.html.SafeHtml.prototype.implementsGoogI18nBidiDirectionalString=!0;goog.html.SafeHtml.prototype.getDirection=function(){return this.dir_};goog.html.SafeHtml.prototype.implementsGoogStringTypedString=!0;goog.html.SafeHtml.prototype.getTypedStringValue=function(){return this.privateDoNotAccessOrElseSafeHtmlWrappedValue_};
goog.DEBUG&&(goog.html.SafeHtml.prototype.toString=function(){return"SafeHtml{"+this.privateDoNotAccessOrElseSafeHtmlWrappedValue_+"}"});goog.html.SafeHtml.unwrap=function(a){if(a instanceof goog.html.SafeHtml&&a.constructor===goog.html.SafeHtml&&a.SAFE_HTML_TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_===goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_)return a.privateDoNotAccessOrElseSafeHtmlWrappedValue_;goog.asserts.fail("expected object of type SafeHtml, got '"+a+"'");return"type_error:SafeHtml"};
goog.html.SafeHtml.htmlEscape=function(a){if(a instanceof goog.html.SafeHtml)return a;var b=null;a.implementsGoogI18nBidiDirectionalString&&(b=a.getDirection());a=a.implementsGoogStringTypedString?a.getTypedStringValue():String(a);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.htmlEscape(a),b)};
goog.html.SafeHtml.htmlEscapePreservingNewlines=function(a){if(a instanceof goog.html.SafeHtml)return a;a=goog.html.SafeHtml.htmlEscape(a);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.newLineToBr(goog.html.SafeHtml.unwrap(a)),a.getDirection())};
goog.html.SafeHtml.htmlEscapePreservingNewlinesAndSpaces=function(a){if(a instanceof goog.html.SafeHtml)return a;a=goog.html.SafeHtml.htmlEscape(a);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(goog.string.whitespaceEscape(goog.html.SafeHtml.unwrap(a)),a.getDirection())};goog.html.SafeHtml.from=goog.html.SafeHtml.htmlEscape;goog.html.SafeHtml.VALID_NAMES_IN_TAG_=/^[a-zA-Z0-9-]+$/;
goog.html.SafeHtml.URL_ATTRIBUTES_={action:!0,cite:!0,data:!0,formaction:!0,href:!0,manifest:!0,poster:!0,src:!0};goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_=goog.object.createSet(goog.dom.TagName.EMBED,goog.dom.TagName.IFRAME,goog.dom.TagName.LINK,goog.dom.TagName.OBJECT,goog.dom.TagName.SCRIPT,goog.dom.TagName.STYLE,goog.dom.TagName.TEMPLATE);
goog.html.SafeHtml.create=function(a,b,c){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(a))throw Error("Invalid tag name <"+a+">.");if(a.toUpperCase()in goog.html.SafeHtml.NOT_ALLOWED_TAG_NAMES_)throw Error("Tag name <"+a+"> is not allowed for SafeHtml.");return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse(a,b,c)};
goog.html.SafeHtml.createIframe=function(a,b,c,e){var f={};f.src=a||null;f.srcdoc=b||null;a=goog.html.SafeHtml.combineAttributes(f,{sandbox:""},c);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("iframe",a,e)};
goog.html.SafeHtml.createStyle=function(a,b){var c=goog.html.SafeHtml.combineAttributes({type:"text/css"},{},b),e="";a=goog.array.concat(a);for(var f=0;f<a.length;f++)e+=goog.html.SafeStyleSheet.unwrap(a[f]);e=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(e,goog.i18n.bidi.Dir.NEUTRAL);return goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse("style",c,e)};
goog.html.SafeHtml.getAttrNameAndValue_=function(a,b,c){if(c instanceof goog.string.Const)c=goog.string.Const.unwrap(c);else if("style"==b.toLowerCase())c=goog.html.SafeHtml.getStyleValue_(c);else{if(/^on/i.test(b))throw Error('Attribute "'+b+'" requires goog.string.Const value, "'+c+'" given.');if(b.toLowerCase()in goog.html.SafeHtml.URL_ATTRIBUTES_)if(c instanceof goog.html.TrustedResourceUrl)c=goog.html.TrustedResourceUrl.unwrap(c);else if(c instanceof goog.html.SafeUrl)c=goog.html.SafeUrl.unwrap(c);
else if(goog.isString(c))c=goog.html.SafeUrl.sanitize(c).getTypedStringValue();else throw Error('Attribute "'+b+'" on tag "'+a+'" requires goog.html.SafeUrl, goog.string.Const, or string, value "'+c+'" given.');}c.implementsGoogStringTypedString&&(c=c.getTypedStringValue());goog.asserts.assert(goog.isString(c)||goog.isNumber(c),"String or number value expected, got "+typeof c+" with value: "+c);return b+'="'+goog.string.htmlEscape(String(c))+'"'};
goog.html.SafeHtml.getStyleValue_=function(a){if(!goog.isObject(a))throw Error('The "style" attribute requires goog.html.SafeStyle or map of style properties, '+typeof a+" given: "+a);a instanceof goog.html.SafeStyle||(a=goog.html.SafeStyle.create(a));return goog.html.SafeStyle.unwrap(a)};goog.html.SafeHtml.createWithDir=function(a,b,c,e){b=goog.html.SafeHtml.create(b,c,e);b.dir_=a;return b};
goog.html.SafeHtml.concat=function(a){var b=goog.i18n.bidi.Dir.NEUTRAL,c="",e=function(a){goog.isArray(a)?goog.array.forEach(a,e):(a=goog.html.SafeHtml.htmlEscape(a),c+=goog.html.SafeHtml.unwrap(a),a=a.getDirection(),b==goog.i18n.bidi.Dir.NEUTRAL?b=a:a!=goog.i18n.bidi.Dir.NEUTRAL&&b!=a&&(b=null))};goog.array.forEach(arguments,e);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(c,b)};
goog.html.SafeHtml.concatWithDir=function(a,b){var c=goog.html.SafeHtml.concat(goog.array.slice(arguments,1));c.dir_=a;return c};goog.html.SafeHtml.TYPE_MARKER_GOOG_HTML_SECURITY_PRIVATE_={};goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse=function(a,b){return(new goog.html.SafeHtml).initSecurityPrivateDoNotAccessOrElse_(a,b)};goog.html.SafeHtml.prototype.initSecurityPrivateDoNotAccessOrElse_=function(a,b){this.privateDoNotAccessOrElseSafeHtmlWrappedValue_=a;this.dir_=b;return this};
goog.html.SafeHtml.createSafeHtmlTagSecurityPrivateDoNotAccessOrElse=function(a,b,c){var e=null,f="<"+a;if(b)for(var g in b){if(!goog.html.SafeHtml.VALID_NAMES_IN_TAG_.test(g))throw Error('Invalid attribute name "'+g+'".');var h=b[g];goog.isDefAndNotNull(h)&&(f+=" "+goog.html.SafeHtml.getAttrNameAndValue_(a,g,h))}goog.isDefAndNotNull(c)?goog.isArray(c)||(c=[c]):c=[];goog.dom.tags.isVoidTag(a.toLowerCase())?(goog.asserts.assert(!c.length,"Void tag <"+a+"> does not allow content."),f+=">"):(e=goog.html.SafeHtml.concat(c),
f+=">"+goog.html.SafeHtml.unwrap(e)+"</"+a+">",e=e.getDirection());(a=b&&b.dir)&&(e=/^(ltr|rtl|auto)$/i.test(a)?goog.i18n.bidi.Dir.NEUTRAL:null);return goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse(f,e)};
goog.html.SafeHtml.combineAttributes=function(a,b,c){var e={},f;for(f in a)goog.asserts.assert(f.toLowerCase()==f,"Must be lower case"),e[f]=a[f];for(f in b)goog.asserts.assert(f.toLowerCase()==f,"Must be lower case"),e[f]=b[f];for(f in c){var g=f.toLowerCase();if(g in a)throw Error('Cannot override "'+g+'" attribute, got "'+f+'" with value "'+c[f]+'"');g in b&&delete e[g];e[f]=c[f]}return e};
goog.html.SafeHtml.DOCTYPE_HTML=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("<!DOCTYPE html>",goog.i18n.bidi.Dir.NEUTRAL);goog.html.SafeHtml.EMPTY=goog.html.SafeHtml.createSafeHtmlSecurityPrivateDoNotAccessOrElse("",goog.i18n.bidi.Dir.NEUTRAL);bd.evaluator={};bd.evaluator.ctr={};bd.evaluator.ctr.configs={};bd.evaluator.ctr.callStack=[];bd.evaluator.ctr.context={};bd.evaluator.ctr.stopEval=!1;bd.evaluator.ctr.runEvalScript=!1;bd.evaluator.ctr.evalCounter=0;bd.evaluator.ctr.MAX_CALLS=150;bd.evaluator.ctr.isSpeaking=!1;bd.evaluator.ctr.gameStarted=!1;bd.evaluator.ctr.callStackObjectsForTick=[];bd.evaluator.ctr.stacksToEvaluate=[];bd.evaluator.ctr.activeTimerIds={};var d=new Date;bd.evaluator.ctr.timerStart=d.getTime();
bd.evaluator.ctr.nullBlockString="nullObject";bd.evaluator.ctr.currentCallStackId=null;bd.evaluator.ctr.stackIdsForThisTick=[];bd.evaluator.ctr.stackIdsForNextTick=[];bd.evaluator.ctr.setupEvaluator=function(){};bd.evaluator.ctr.setStackObjectContextVariable=function(a,b,c){"undefined"==typeof c&&(c=bd.evaluator.ctr.getCurrentStackObject());c.context[a]=b};
bd.evaluator.ctr.setDefinedContextVariable=function(a,b,c,e,f){if("undefined"==typeof c||null==c||"undefined"==typeof e||null==e)c=bd.evaluator.ctr.getCurrentCallStack(),e=c.getLength()-1;"undefined"==typeof f&&(f=!1);c=c.getStackArray();for(var g;g=c[e];e--)if(null!=g.context[a]){g.context[a].type&&"value"==g.context[a].type?g.context[a].value=f?g.context[a].value+b:b:g.context[a]=f?g.context[a]+b:b;return}c=bd.component.lookup(bd.model.getGameInfo().id);e=c.getGlobalVariable(a);null!=e&&c.setGlobalVariable(a,
b,"value"==e.type,f)};bd.evaluator.ctr.getStackObjectContextVariable=function(a,b,c){if("undefined"==typeof b||"undefined"==typeof c)b=bd.evaluator.ctr.getCurrentCallStack(),c=b.getLength()-1;b=b.getStackArray();for(var e;e=b[c];c--)if(null!=e.context[a])return e.context[a];return bd.component.lookup(bd.model.getGameInfo().id).getGlobalVariable(a)};
bd.evaluator.ctr.evaluatePossibleVariableName=function(a){if("object"==typeof a&&"name"==a.type){var b=bd.evaluator.ctr.getStackObjectContextVariable(a.value);if(null==b||"object"==typeof b&&"value"==b.type&&void 0==b.value)bd.errorLog.ctr.printError(bd.msg.ERROR_INVALID_DEFINITION,[a.value]);else return"object"==typeof b&&"value"==b.type?b.value:b}else return a};
bd.evaluator.ctr.isEventTriggeredByPointerId=function(a,b,c){b=bd.evaluator.ctr.getTitleTextFromBlock(c,b);if(bd.util.containsPrefix(b,"pointer:")){b=bd.util.removePrefix(b,"pointer");if("any"==b)return!0;"active"==b&&(c=bd.component.lookup(bd.model.getCurrentViewId()).getPhaserGameObject(),c.input.activePointer&&(b=c.input.activePointer.id));return b==a}return!1};
bd.evaluator.ctr.addEventToEvaluate=function(a,b,c){a=bd.evaluator.ctr.findMatchingTopLevelBlocks(a,b);for(b=0;b<a.length;b++){var e=new bd.stack.ctr.callStack;e.createStackObjectAndAddToStack(a[b],c);bd.evaluator.ctr.stackIdsForNextTick.push(e.id)}};bd.evaluator.ctr.findMatchingTopLevelBlocks=function(a,b){for(var c=[],e=bd.model.getEntityList("scriptPage"),f=0;f<e.length;f++)c=c.concat(bd.evaluator.ctr.getMatchingTopLevelBlocksFromEntityId(e[f].id,a,b));return c};
bd.evaluator.ctr.getMatchingTopLevelBlocksFromEntityId=function(a,b,c){var e=[],f=bd.model.entityLookup(a);if(null!=f.scriptObject&&""!=f.scriptObject&&null!=f.scriptObject.xml&&null!=f.scriptObject.xml.block)for(var f=null==f.scriptObject.xml.block.length?[f.scriptObject.xml.block]:f.scriptObject.xml.block,g=0;g<f.length;g++)if(f[g]._type==b){for(var h=!0,k=0;k<c.length;k++){var l=c[k].titleIndex,m=c[k].titleName;a=c[k].entityId;var n=c[k].value,q=c[k].pointerId;if(null!=a)if(n="",null!=l){if(n=
f[g].field[l].__text,!bd.evaluator.ctr.isEventTriggeredByEntity(n,a)){h=!1;break}}else{m=bd.evaluator.ctr.entityTitleToEntityIdArray(m,f[g]);if(null==bd.model.entityLookup(a)){h=!1;break}if(!bd.evaluator.ctr.isEventTriggeredByEntityNEW(m,a)){h=!1;break}}else if(null!=q){if(!bd.evaluator.ctr.isEventTriggeredByPointerId(q,f[g],m)){h=!1;break}}else if(null!=l)if(null!=f[g].field.length&&f[g].field[l].__text!=n){h=!1;break}else{if(null==f[g].field.length&&f[g].field.__text!=n){h=!1;break}}else if(null!=
m)for(a=bd.util.convertToArray(f[g].field),l=0;l<a.length;l++)if(a[l]._name==m){a[l].__text!=n&&(h=!1);break}}h&&e.push(f[g])}return e};bd.evaluator.ctr.getCurrentCallStack=function(){return null==bd.evaluator.ctr.currentCallStackId?null:bd.stack.ctr.getCallStackById(bd.evaluator.ctr.currentCallStackId)};bd.evaluator.ctr.getCurrentStackObject=function(){var a=bd.evaluator.ctr.getCurrentCallStack();if(a)return a.getCurrentStackObject()};
bd.evaluator.ctr.evalEntityScripts=function(a,b,c,e,f,g,h,k){a=bd.entityLookup[a];if(null!=a.scriptObject&&""!=a.scriptObject&&null!=a.scriptObject.xml&&null!=a.scriptObject.xml.block){a=null==a.scriptObject.xml.block.length?[a.scriptObject.xml.block]:a.scriptObject.xml.block;for(var l=0;l<a.length;l++)if(a[l]._type==b){for(var m=!0,n=0;n<c.length;n++){var q=c[n].titleIndex,p=c[n].titleName,t=c[n].entityId,v=c[n].value,r=c[n].pointerId;if(null!=t)if(v="",null!=q){if(v=a[l].field[q].__text,!bd.evaluator.ctr.isEventTriggeredByEntity(v,
t)){m=!1;break}}else{p=bd.evaluator.ctr.entityTitleToEntityIdArray(p,a[l]);if(null==bd.model.entityLookup(t)){m=!1;break}if(!bd.evaluator.ctr.isEventTriggeredByEntityNEW(p,t)){m=!1;break}}else if(null!=r){if(!bd.evaluator.ctr.isEventTriggeredByPointerId(r,a[l],p)){m=!1;break}}else if(null!=q)if(null!=a[l].field.length&&a[l].field[q].__text!=v){m=!1;break}else{if(null==a[l].field.length&&a[l].field.__text!=v){m=!1;break}}else if(null!=p)for(t=bd.util.convertToArray(a[l].field),q=0;q<t.length;q++)if(t[q]._name==
p){t[q].__text!=v&&(m=!1);break}}if(m&&k)return a[l];"undefined"!=typeof h&&h?m&&(m=[],n=a[l],p=e,n.next&&n.next.block&&(nextBlock=n.next.block),m.push({block:nextBlock,context:p}),bd.evaluator.ctr.stacksToEvaluate.push(m)):m&&(f?bd.evaluator.ctr.startNewStackWhileContinuingPrevious([{block:a[l],context:e,callingFunction:g}]):bd.evaluator.ctr.runEvalScript?(m=[{block:a[l],context:e,callingFunction:null}],bd.evaluator.ctr.makeStackEvaluatable(m),bd.evaluator.ctr.callStackObjectsForTick.push(m)):(bd.evaluator.ctr.addToCallStack({block:a[l],
context:e,callingFunction:null},!1),bd.evaluator.ctr.runEvalScript=!0));if(bd.evaluator.ctr.stopEval)break}}};bd.evaluator.ctr.addToCallStack=function(a,b,c){b?(bd.evaluator.ctr.callStack.push(a),bd.evaluator.ctr.initializeStack()):c?bd.evaluator.ctr.callStack.splice(bd.evaluator.ctr.callStack.length-1,0,a):bd.evaluator.ctr.callStack.push(a)};bd.evaluator.ctr.initializeStack=function(){bd.evaluator.ctr.makeStackEvaluatable(bd.evaluator.ctr.callStack);bd.evaluator.ctr.evaluateStack()};
bd.evaluator.ctr.makeStackEvaluatable=function(a){var b=a[a.length-1];b.hasEvaluated=!0;bd.evaluator.ctr.context=b.context;var c=null;"animation_def"==b.block._type||"forever_procedure"==b.block._type||"forever_loop"==b.block._type||"procedures_def"==b.block._type||"game_start_statement"==b.block._type||"when_player_join_statement"==b.block._type||"entity_clicked_statement"==b.block._type||"key_pressed_statement"==b.block._type||"custom_key_pressed_statement"==b.block._type||"when_phaser_physics_collide_statement"==
b.block._type||"when_collide_edge_statement"==b.block._type||"when_phaser_piece_dropped_statement"==b.block._type||"when_timer_goes_off"==b.block._type||"when_input_event_statement"==b.block._type?b.block.statement&&b.block.statement.block&&(c=b.block.statement.block):b.block.next&&b.block.next.block&&(c=b.block.next.block);a.push({block:c,context:{}});return a};bd.evaluator.ctr.addNewStackForTick=function(a){bd.evaluator.ctr.makeStackEvaluatable(a);bd.evaluator.ctr.callStackObjectsForTick.push(a)};
bd.evaluator.ctr.evaluateStack=function(){var a=bd.evaluator.ctr.getCurrentStackObject();a&&bd.evaluator.ctr.evaluateBlock(a.getBlock())};bd.evaluator.ctr.nextBlockInCallStack=function(a,b){var c=null;a&&a.block&&(c=a.block);bd.evaluator.ctr.getCurrentStackObject().resetStackObject(c);b||bd.evaluator.ctr.evaluateStack()};
bd.evaluator.ctr.nextBlockInCallStackNoEvaluation=function(a){var b=null;a&&a.block&&(b=a.block);bd.evaluator.ctr.callStack[bd.evaluator.ctr.callStack.length-1].block=b;bd.evaluator.ctr.callStack[bd.evaluator.ctr.callStack.length-1].params=null};bd.evaluator.ctr.startNewStackWhileContinuingPrevious=function(a){0!=bd.evaluator.ctr.callStack.length&&bd.evaluator.ctr.callStackObjectsForTick.push(bd.evaluator.ctr.callStack);bd.evaluator.ctr.callStack=a;bd.evaluator.ctr.initializeStack()};
bd.evaluator.ctr.continuePreviousStack=function(){if(0!=bd.evaluator.ctr.stackIdsForThisTick.length){var a=bd.evaluator.ctr.stackIdsForThisTick.shift();bd.evaluator.ctr.currentCallStackId=a;bd.evaluator.ctr.evaluateStack()}else bd.evaluator.ctr.evalCounter=0};bd.evaluator.ctr.evalValue=function(a){if(null==a)return null;a.block&&(a=a.block);if(a._type)bd.evaluator.ctr.evaluateBlock(a);else return console.log("case statements failed in evalValue"),""};
bd.evaluator.ctr.isEntityIdOfParentEntity=function(a,b){var c=bd.evaluator.ctr.getTitleTextFromBlock(a,b);return null!=c&&bd.util.containsPrefix(c,"id")?(c=bd.util.removeIdPrefix(c),null!=bd.entityLookup[c].instanceIds?!0:!1):!1};bd.evaluator.ctr.stopAllTimers=function(){for(var a in bd.evaluator.ctr.activeTimerIds)clearTimeout(a)};bd.evaluator.ctr.stopAllSprites=function(){for(var a=bd.model.getEntityList("phaserPhysicsPieceInstance"),b,c=0;c<a.length;c++)(b=bd.component.lookup(a[c].id))&&b.stopMovement()};
bd.evaluator.ctr.stopAllScripts=function(a){bd.evaluator.ctr.stopAllTimers();bd.stack.ctr.deleteAllCallStacks(a);a||(bd.evaluator.ctr.currentCallStackId=null);bd.evaluator.ctr.stackIdsForThisTick=[];bd.evaluator.ctr.stackIdsForNextTick=[]};
bd.evaluator.ctr.resetEvaluatorForNewGame=function(){bd.evaluator.ctr.stopAllTimers();bd.stack.ctr.deleteAllCallStacks();bd.evaluator.ctr.currentCallStackId=null;bd.evaluator.ctr.stackIdsForThisTick=[];bd.evaluator.ctr.stackIdsForNextTick=[];window.ondeviceorientation=null};
bd.evaluator.ctr.resetJSCallStack=function(){null!=bd.evaluator.ctr.currentCallStackId&&(bd.evaluator.ctr.stackIdsForThisTick.push(bd.evaluator.ctr.currentCallStackId),bd.evaluator.ctr.currentCallStackId=null);setTimeout(function(){bd.evaluator.ctr.evaluateStack()},0)};bd.evaluator.ctr.returnHandler=function(a,b){bd.evaluator.ctr.getCurrentCallStack().removeLastStackObject();var c=bd.evaluator.ctr.getCurrentStackObject();c.params[c.currentParam]=b?[a]:a;bd.evaluator.ctr.evaluateStack()};
bd.evaluator.ctr.evaluateBlock=function(a){bd.evaluator.ctr.evalCounter+=1;if(bd.evaluator.ctr.evalCounter>=bd.evaluator.ctr.MAX_CALLS)bd.evaluator.ctr.evalCounter=0,bd.evaluator.ctr.resetJSCallStack();else if(null==a)a=bd.evaluator.ctr.getCurrentCallStack(),a.removeLastStackObject(),0==a.getLength()?(bd.evaluator.ctr.currentCallStackId=null,bd.stack.ctr.deleteCallStack(a.id),bd.evaluator.ctr.continuePreviousStack()):bd.evaluator.ctr.evaluateStack();else{var b=bd.evaluator.ctr.configs[a._type],c=
bd.evaluator.ctr.getCurrentStackObject();c.params=null==c.params?{}:c.params;b.getParams&&(b.paramsInfo=b.getParams(a));if(b.paramsInfo)for(var e=0,f;f=b.paramsInfo[e];e++)if(null==c.params[f.name])switch(f.type){case "entity":var g=[],h;a.value&&(g=bd.util.isArray(a.value)?a.value:[a.value]);for(var k=0;k<g.length;k++)if(g[k]._name==f.fieldName+"_SOCKET"){h=g[k].block;break}if(void 0!==h){h.returnsEntity=!0;c.currentParam=f.name;a=bd.evaluator.ctr.getCurrentCallStack();a.createStackObjectAndAddToStack(h,
{});bd.evaluator.ctr.evaluateStack();return}c.params[f.name]=bd.evaluator.ctr.entityTitleToEntityIdArray(f.fieldName,a);if(void 0==c.params[f.name]){a=JSON.parse(a.mutation._field_name_to_entity_name)[f.fieldName];a=goog.html.SafeHtml.htmlEscape(a);a=goog.html.SafeHtml.unwrap(a);bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY,[a]);return}0==c.params[f.name].length&&bd.errorLog.ctr.printError(bd.msg.ERROR_EMPTY_SOCKET,[a._type]);break;case "entityClass":c.params[f.name]=[];k=bd.evaluator.ctr.getTitleTextFromBlock(f.fieldName,
a);k=bd.util.removeIdPrefix(k);g=bd.model.entityLookup(k).instanceIds;for(k=0;k<g.length;k++)c.params[f.name].push(g[k]);break;case "value":k=bd.evaluator.ctr.getValueFromBlock(f.valueName,a);if(null==k)c.params[f.name]="nullObject",bd.errorLog.ctr.printError(bd.msg.ERROR_EMPTY_SOCKET,[a._type]);else if("null_block"==k.block._type)c.params[f.name]="nullObject";else{h=k.block;c.currentParam=f.name;a=bd.evaluator.ctr.getCurrentCallStack();a.createStackObjectAndAddToStack(h,{});bd.evaluator.ctr.evaluateStack();
return}break;case "field":c.params[f.name]=bd.evaluator.ctr.getTitleTextFromBlock(f.fieldName,a);break;case "fieldVariable":c.params[f.name]=bd.evaluator.ctr.getTitleFromBlock(f.fieldName,a);break;case "variableName":k=bd.evaluator.ctr.getValueFromBlock(f.valueName,a),c.params[f.name]=bd.evaluator.ctr.getTitleFromBlock(k._name,k.block)}if(b.paramsInfo)for(e=0;f=b.paramsInfo[e];e++)if(!(1!=f.evaluateName&&null!=f.evaluateName||"value"!=f.type&&"entity"!=f.type))if(h=c.params[f.name],"value"==f.type)g=
bd.evaluator.ctr.evaluatePossibleVariableName(h),c.params[f.name]=g;else if("entity"==f.type){for(var l=[],k=0;k<h.length;k++)g=bd.evaluator.ctr.evaluatePossibleVariableName(h[k]),l.push(g);c.params[f.name]=l}b.evalFunc(a)}};bd.evaluator.ctr.getTraitIds=function(a,b){for(var c=[],e=0;e<a.length;e++)for(var f=bd.entityLookup[a[e]],g=0;g<f.traitIds.length;g++)if(bd.entityLookup[f.traitIds[g]].traitDefId==b){c.push(f.traitIds[g]);break}return c};
bd.evaluator.ctr.isEventTriggeredByEntity=function(a,b){var c=bd.entityLookup[b].parentId;return bd.util.isAnyOrAll(a)?!0:bd.util.removeIdPrefix(a)==b?!0:bd.util.removeIdPrefix(a)==c?!0:!1};bd.evaluator.ctr.isEventTriggeredByEntityNEW=function(a,b){for(var c=bd.entityLookup[b].parentId,e=0;e<a.length;e++)if(a[e]==b||a[e]==c)return!0;return!1};
bd.evaluator.ctr.entityTitleToEntityIdArray=function(a,b){var c=[],e,f=[],g;null!=b.field&&(c=bd.util.isArray(b.field)?b.field:[b.field]);var h=[];b.value&&(h=bd.util.isArray(b.value)?b.value:[b.value]);for(var k=0;k<c.length;k++)if(c[k]._name==a){e=c[k].__text;break}for(k=0;k<h.length;k++)if(h[k]._name==a+"_SOCKET"){g=bd.evaluator.ctr.evalValue(h[k]);break}if(void 0!==e){if(bd.util.containsPrefix(e,"id")){if(-1<e.indexOf("not found"))return;g=bd.util.removeIdPrefix(e)}else if(!bd.util.isAnyOrAll(e))return bd.util.containsPrefix(e,
"pointer:")?[e]:[{type:"name",value:e}];if("object"==typeof g&&"value"==g.type)return[g.value];if(k=bd.util.isAnyOrAll(e)){if("random"==k[0])g=bd.model.getEntityList(k[1]),f.push(g[Math.floor(Math.random()*g.length)].id);else for(g=bd.model.getEntityList(k[1]),k=0;k<g.length;k++)f.push(g[k].id);return f}}if(void 0===g)return f;k=bd.model.entityLookup(g);if(null==k)return[g];if("local"==k.shareMode&&null==k.playerId&&"instance"==bd.component.lookup(g).classOrInstance)return[k.playerIdsToChildInstanceIds[bd.player.ctr.playerId]];
if("perPlayer"==bd.entityLookup[g].shareMode&&bd.model.isInstance(g)&&null==bd.entityLookup[g].playerId){var c=[],l;if(b.mutation&&b.mutation["_"+a.toLowerCase()+"_entity_player"]){e=b.mutation["_"+a.toLowerCase()+"_entity_player"];bd.util.containsPrefix(e,"id")?l=bd.util.removeIdPrefix(e):bd.util.isAnyOrAll(e)||(l=bd.evaluator.ctr.context[e]);void 0!==l&&(c=[l]);if(k=bd.util.isAnyOrAll(e))if("random"==k[0])f=bd.model.getEntityList(k[1]),c.push(f[Math.floor(Math.random()*f.length)].id);else for(f=
bd.model.getEntityList(k[1]),k=0;k<f.length;k++)c.push(f[k].id);f=bd.evaluator.ctr.getEntityPlayerInstanceIds(c,g)}else if(b.mutation&&b.mutation["_"+a.toLowerCase()+"_entity_player_type"]){h=bd.util.isArray(b.value)?b.value:[b.value];for(k=0;k<h.length;k++)if(h[k]._name==a+"_PLAYER_SOCKET"){l=bd.evaluator.ctr.evalValue(h[k]);c=[l];break}f=bd.evaluator.ctr.getEntityPlayerInstanceIds(c,g)}}else f=[g];return f};
bd.evaluator.ctr.getEntityPlayerInstanceIds=function(a,b){var c=[];if(null==bd.entityLookup[b].playerIdsToChildInstanceIds&&bd.entityLookup[b].instanceIds){for(var e=0;e<bd.entityLookup[b].instanceIds.length;e++)for(var f=bd.entityLookup[b].instanceIds[e],g=0;g<a.length;g++)if(a[g]==bd.entityLookup[f].playerId){c.push(f);break}return c}if(1<a.length)for(e in bd.entityLookup[b].playerIdsToChildInstanceIds)c.push(bd.entityLookup[b].playerIdsToChildInstanceIds[e]);else c=[bd.entityLookup[b].playerIdsToChildInstanceIds[a[0]]];
return c};bd.evaluator.ctr.getTitleFromBlock=function(a,b){var c;c=bd.util.isArray(b.field)?b.field:[b.field];for(var e=0;e<c.length;e++)if(c[e]._name==a)return c[e];return null};bd.evaluator.ctr.getTitleTextFromBlock=function(a,b){var c=bd.evaluator.ctr.getTitleFromBlock(a,b);return null==c?null:c.__text};bd.evaluator.ctr.getInputFromBlock=function(a,b,c){valueArray=bd.util.isArray(b[c])?b[c]:[b[c]];for(b=0;b<valueArray.length;b++)if(valueArray[b]&&valueArray[b]._name==a)return valueArray[b];return null};
bd.evaluator.ctr.getStatementFromBlock=function(a,b){return bd.evaluator.ctr.getInputFromBlock(a,b,"statement")};bd.evaluator.ctr.getDictionariesFromBlocks=function(){for(var a=bd.model.getAllEvaluatorBlocks(),b=[],c=0;c<a.length;c++)if(0<=bd.dictionary.ctr.dictBlocksNames.indexOf(a[c]._type)&&(-1==b.indexOf(bd.dictionary.ctr.defaultDict)&&b.push(bd.dictionary.ctr.defaultDict),"dictionary_set_dictionary"==a[c]._type)){var e=a[c].field.__text.toLowerCase();-1==b.indexOf(e)&&b.push(e)}return b};
bd.evaluator.ctr.arrayOrObject=function(a){return bd.util.isArray(a)?a:a?[a]:[]};bd.evaluator.ctr.getValueFromBlock=function(a,b){var c;c=bd.util.isArray(b.value)?b.value:[b.value];for(var e=0;e<c.length;e++)if(c[e]&&c[e]._name==a)return c[e];return null};bd.evaluator.ctr.getNextBlock=function(a){a=a.block.next;var b=null;a&&a.block&&(b=a.block);return b};
bd.evaluator.ctr.getLocalAndPropagatedEntityIds=function(a){for(var b=[],c=[],e,f=0;f<a.length;f++)null!=bd.model.entityLookup(a[f])&&(e=bd.model.entityLookup(a[f]).shareMode,"local"==e?b.push(a[f]):c.push(a[f]));return{localEntityIds:b,propagatedEntityIds:c}};
bd.evaluator.ctr.entityIdTextToAngle=function(a,b){for(var c=[a,b],e=[{x:0,y:0},{x:0,y:0}],f=0,g;g=c[f];f++)bd.util.containsPrefix(g,"pointer:")?(g=bd.phaser.ctr.entityTextToPointerObject(g),e[f].x=g.worldX,e[f].y=g.worldY):(g=bd.component.lookup(g),e[f].x=g.getXOrY("x"),e[f].y=g.getXOrY("y"));return 180/Math.PI*Math.atan2(e[1].y-e[0].y,e[1].x-e[0].x)};
bd.evaluator.ctr.handleWaitTime=function(a,b,c,e,f){if(a.hasWaited)a.hasWaited=!1,f&&f();else{a.hasWaited=!0;e&&e();var g=setTimeout(function(a){delete bd.evaluator.ctr.activeTimerIds[g];bd.evaluator.ctr.stackIdsForNextTick.push(a)},b,c);bd.evaluator.ctr.currentCallStackId=null;bd.evaluator.ctr.activeTimerIds[g]=!0;bd.evaluator.ctr.continuePreviousStack()}};bd.evaluator.ctr.blocks={};bd.evaluator.ctr.blocks.math={};bd.evaluator.ctr.configs.math_number={evalFunc:function(a){bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.returnHandler(parseFloat(a.field.__text),a.returnsEntity)}};
bd.evaluator.ctr.configs.math_arithmetic={getParams:function(a){return[{name:"operation",type:"field",fieldName:a.field._name},{name:"val1",type:"value",valueName:"A"},{name:"val2",type:"value",valueName:"B"}]},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.operation;if("nullObject"==b.params.val1&&"nullObject"==b.params.val2)bd.evaluator.ctr.returnHandler(0,a.returnsEntity);else{"nullObject"==b.params.val1&&(b.params.val1=0);"nullObject"==b.params.val2&&(b.params.val2=
0);switch(c){case "ADD":var e=b.params.val1+b.params.val2;break;case "MINUS":e=b.params.val1-b.params.val2;break;case "MULTIPLY":e=b.params.val1*b.params.val2;break;case "DIVIDE":e=b.params.val1/b.params.val2;0==b.params.val2&&(bd.errorLog.ctr.printError(bd.msg.ERROR_DIVISION_BY_ZERO,[b.params.val1]),e=0);break;case "POWER":e=Math.pow(b.params.val1,b.params.val2);break;case "MOD":e=b.params.val1%b.params.val2}bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}}};
bd.evaluator.ctr.configs.math_round={paramsInfo:[{name:"roundDirection",type:"field",fieldName:"OP"},{name:"val",type:"value",valueName:"NUM"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.roundDirection,e=b.params.val;if("nullObject"==b.params.val)bd.evaluator.ctr.returnHandler(0,a.returnsEntity);else{switch(c){case "ROUNDDOWN":var f=Math.floor(e);break;case "ROUNDUP":f=Math.ceil(e);break;case "ROUND":f=Math.round(e);break;case "ABSOLUTE":f=Math.abs(e);break;case "NEGATIVE":f=
-e;break;case "ROOT":f=0>e?"nullObject":Math.sqrt(e)}bd.evaluator.ctr.returnHandler(f,a.returnsEntity)}}};
bd.evaluator.ctr.configs.math_trig={getParams:function(a){var b=[];b.push({name:"operation",type:"field",fieldName:a.field._name});a.value&&b.push({name:"val1",type:"value",valueName:a.value._name});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.operation;if("nullObject"==b.params.val1)bd.evaluator.ctr.returnHandler(0,a.returnsEntity);else{switch(c){case "SIN":var e=Math.sin(b.params.val1*Math.PI/180);break;case "COS":e=Math.cos(b.params.val1*Math.PI/180);
break;case "TAN":e=Math.tan(b.params.val1*Math.PI/180);break;case "ASIN":e=Math.asin(b.params.val1)/Math.PI*180;break;case "ACOS":e=Math.acos(b.params.val1)/Math.PI*180;break;case "ATAN":e=Math.atan(b.params.val1)/Math.PI*180}bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}}};
bd.evaluator.ctr.configs.math_random_int={paramsInfo:[{name:"low",type:"value",valueName:"FROM"},{name:"high",type:"value",valueName:"TO"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.low,b=b.params.high;c>b?bd.evaluator.ctr.returnHandler(Math.floor(c),a.returnsEntity):bd.evaluator.ctr.returnHandler(Math.floor(Math.random()*(b-c+1)+c),a.returnsEntity)}};
bd.evaluator.ctr.configs.math_max_min={getParams:function(a){for(var b=[],c=0;c<parseInt(a.mutation._nums);c++){var e=a.value[c];b.push({name:e._name,type:"value",valueName:e._name})}b.push({name:"operation",type:"field",fieldName:"OP"});return b},evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.operation,e=[],f=0;f<parseInt(a.mutation._nums);f++){var g=a.value[f];null!=b.params[g._name]&&e.push(b.params[g._name])}if(e==[])bd.evaluator.ctr.returnHandler(0,a.returnsEntity);
else switch(c){case "MAX":bd.evaluator.ctr.returnHandler(Math.max.apply(null,e),a.returnsEntity);break;case "MIN":bd.evaluator.ctr.returnHandler(Math.min.apply(null,e),a.returnsEntity)}}};bd.methodTag.physicsRectangle={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.label.removeConnections,classOrInstance:"instance"},{name:"hide",fxn:bd.methodTag.physicsRectangle.hide,classOrInstance:"instance"},{name:"show",fxn:bd.methodTag.physicsRectangle.show,classOrInstance:"instance"},{name:"show",fxn:bd.methodTag.physicsRectangle.show,classOrInstance:"instance"},{name:"applyImpulse",fxn:bd.methodTag.physicsRectangle.applyImpulse,classOrInstance:"instance"},{name:"updatePosition",
fxn:bd.methodTag.physicsRectangle.updatePosition,classOrInstance:"instance"},{name:"setSpeed",fxn:bd.methodTag.physicsRectangle.setSpeed,classOrInstance:"instance"},{name:"setVelocity",fxn:bd.methodTag.physicsRectangle.setVelocity,classOrInstance:"instance"},{name:"setDirection",fxn:bd.methodTag.physicsRectangle.setDirection,classOrInstance:"instance"},{name:"setActive",fxn:bd.methodTag.physicsRectangle.setActive,classOrInstance:"instance"}]}};
bd.methodTag.physicsRectangle.handleCommand=function(a){return"applyImpulse"==a.property?(this.applyImpulse(a.value.power,a.value.direction),!0):"setVelocity"==a.property?(this.setVelocity(a.value.speed,a.value.direction),!0):"active"==a.property?(this.setActive(a.value),!0):"direction"==a.property?(this.setDirection(),!0):!1};
bd.methodTag.physicsRectangle.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue","physicsRectangleInstanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.physicsRectangle.hide=function(){bd.methodTag.canvasObject.hide.call(this);var a=bd.component.physicsRectangleInstance;a.viewVars[this.model.viewId].world.DestroyBody(a.viewVars[this.model.viewId].entityIdToBody[this.id]);a.viewVars[this.model.viewId].entityIdToBody[this.id]=null;a=bd.component.lookup(this.id).getDisplayObject();a.setPosition(a.getPosition().x-a.getWidth()/2,a.getPosition().y-a.getHeight()/2);a.setOffset(0,0)};
bd.methodTag.physicsRectangle.show=function(){bd.methodTag.canvasObject.show.call(this);null==bd.component.physicsRectangleInstance.viewVars[this.model.viewId].entityIdToBody[this.id]&&bd.component.physicsRectangle.createNewBody(this.id)};
bd.methodTag.physicsRectangle.applyImpulse=function(a,b){var c=bd.component.physicsRectangleInstance,e=bd.component.lookup(this.model.viewId),f=e.getWindow().Box2D,g=c.viewVars[this.model.viewId].entityIdToBody[this.id];g.ApplyImpulse(new f.Common.Math.b2Vec2(Math.cos(Math.PI/180*b)*a,Math.sin(Math.PI/180*b)*a),g.GetWorldCenter());c.viewVars[this.model.viewId].updateRunning||bd.component.physicsRectangle.update.call(e.getWindow())};
bd.methodTag.physicsRectangle.updatePosition=function(){bd.methodTag.canvasObject.updatePosition.call(this);var a=bd.component.physicsRectangleInstance,b=bd.component.lookup(this.model.viewId),c=b.getWindow().Box2D,e=a.viewVars[this.model.viewId].entityIdToBody[this.id],f=bd.entityLookup[this.id],c=c.Common.Math.b2Vec2;if(null!=e){var g=a.viewVars[this.model.viewId].scale;e.SetPosition(new c(f.x/g,f.y/g));a.viewVars[this.model.viewId].updateRunning||bd.component.physicsRectangle.update.call(b.getWindow())}};
bd.methodTag.physicsRectangle.setSpeed=function(a){var b=bd.component.physicsRectangleInstance,c=b.viewVars[this.model.viewId].entityIdToBody[this.id].GetLinearVelocity();c.Normalize();c.Multiply(a);b.viewVars[this.model.viewId].updateRunning||(a=bd.component.lookup(this.model.viewId),bd.component.physicsRectangle.update.call(a.getWindow()))};
bd.methodTag.physicsRectangle.setVelocity=function(a,b){var c=bd.component.physicsRectangleInstance,e=bd.component.lookup(this.model.viewId).getWindow().Box2D.Common.Math.b2Vec2,c=c.viewVars[this.model.viewId].entityIdToBody[this.id],f=.01;c.SetLinearVelocity(new e(0,0));c.ApplyImpulse(new e(Math.cos(Math.PI/180*b)*f,Math.sin(Math.PI/180*b)*f),c.GetWorldCenter());f=a;c.SetLinearVelocity(new e(Math.cos(Math.PI/180*b)*f,Math.sin(Math.PI/180*b)*f))};
bd.methodTag.physicsRectangle.setDirection=function(){var a=bd.component.physicsRectangleInstance,b=bd.component.lookup(this.model.viewId).getWindow().Box2D,a=a.viewVars[this.model.viewId].entityIdToBody[this.id],c=bd.entityLookup[this.id].direction,e=a.GetLinearVelocity().Length();a.SetLinearVelocity(new b.Common.Math.b2Vec2(Math.cos(Math.PI/180*c)*e,Math.sin(Math.PI/180*c)*e))};
bd.methodTag.physicsRectangle.setActive=function(a){var b=bd.component.physicsRectangleInstance,c=bd.component.lookup(this.model.viewId),e=c.getWindow().Box2D,f=b.viewVars[this.model.viewId].entityIdToBody[this.id];a?f.SetActive(!0):(f.SetLinearVelocity(new e.Common.Math.b2Vec2(0,0)),f.SetAngularVelocity(0),f.SetActive(!1));b.viewVars[this.model.viewId].updateRunning||bd.component.physicsRectangle.update.call(c.getWindow())};bd.modelTag.hasPhysics={provideFields:function(){return[{fields:["bounciness"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["bounciness"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["friction"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["friction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:.2},{fields:["active"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["active"],
classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["canRotate"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["canRotate"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["movementType"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["movementType"],classOrInstance:"class",providers:["defaultValue"],defaultValue:bd.blocks.ctr.emptyFieldBox},{fields:["speed"],classOrInstance:"instance",providers:["srcInstance",
"parent"]},{fields:["speed"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["collidingInstanceIds"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:[]},{fields:["entityPerPlayer"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:!0}]}};
bd.modelTag.hasPhysicsDirection={requiredFields:["direction",{classOrInstance:"instance",fields:["useCenterOffset"]}],provideFields:function(){return[{fields:["direction"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["direction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["useCenterOffset"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:!1}]}};bd.modelTag.hasCostume={requiredFields:[{classOrInstance:"class",fields:["costumeIds"]},{classOrInstance:"instance",fields:["costumeId"]}],provideFields:function(){return[{fields:["costumeIds"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.hasCostume.provideCostumeIds,removeConnectionFxn:bd.modelTag.hasCostume.removeCostumeIds},{fields:["costumeId"],classOrInstance:"instance",providers:["srcInstance","function"],fxn:bd.modelTag.hasCostume.provideCostumeId}]},provideProperties:function(){return{COSTUME_NUM:{modelName:"costumeId",
isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject},getFxn:function(){if(!bd.model.entityLookup(this.id))return bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),1;for(var a=bd.entityLookup[this.id].costumeId,b=bd.component.lookup(this.id).getCostumeIds(),c=0,e=0;e<b.length;e++)if(a==b[e]){c=e+1;break}return c},setFxn:function(a){if(0<a){var b=this.id;bd.model.entityLookup(b);var c=bd.component.lookup(b).getCostumeIds();c.length>a-1&&bd.model.addModelUpdateElement([b],
"set","costumeId",c[a-1],{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates()}}}}}};bd.modelTag.hasCostume.provideCostumeIds=function(){this.model.costumeIds=[];return null!=this.defaultImageId?(new bd.component.costume.constructor(null,this.model.id,this.defaultImageId),!0):!1};bd.modelTag.hasCostume.removeCostumeIds=function(){if(0!=this.model.costumeIds.length)for(var a=0;a<this.model.costumeIds.length;a++)bd.component.lookup(this.model.costumeIds[a]).deleteEntity()};
bd.modelTag.hasCostume.provideCostumeId=function(){this.model.costumeId=bd.entityLookup[this.parentId].costumeIds[0];return!0};bd.modelTag.hasCostumeNoInstance={requiredFields:["costumeIds","costumeId"],provideFields:function(){return[{fields:["costumeIds"],providers:["srcInstance","function"],fxn:bd.modelTag.hasCostume.provideCostumeIds},{fields:["costumeId"],providers:["srcInstance","function"],fxn:bd.modelTag.hasCostume.provideCostumeIdNoInstance}]}};
bd.modelTag.hasCostume.provideCostumeIdNoInstance=function(){this.model.costumeId=this.model.costumeIds[0];return!0};bd.modelTag.hasCostumeProperties={requiredFields:["assetId","entityId"],provideFields:function(){return[{fields:["entityId"],providers:["componentObject"]},{fields:["assetId"],providers:["function"],fxn:bd.modelTag.hasCostumeProperties.provideAssetId,removeConnectionFxn:bd.modelTag.hasCostumeProperties.removeCostumeIdFromAsset}]},afterUpdatingModel:function(){bd.entityLookup[this.model.entityId].costumeIds.push(this.id)}};
bd.modelTag.hasCostumeProperties.provideAssetId=function(){this.model.assetId=this.assetId;bd.model.addModelUpdateElement([this.model.assetId],"push","costumeIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.modelTag.hasCostumeProperties.removeCostumeIdFromAsset=function(){-1!=bd.component.lookup(bd.component.lookup(this.id).model.assetId).model.costumeIds.indexOf(this.id)&&bd.model.addModelUpdateElement([this.model.assetId],"removeValue","costumeIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.component.physicsRectangle={constructor:function(a){goog.mixin(this,bd.component.physicsRectangle.componentProperties);null==a&&(this.defaultImageId=bd.defaultPieceAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"physicsRectangle",listName:"physicsRectangles",idName:"physicsRectangleId",idListName:"physicsRectangleIds",sideBarPanelName:"sideBarPhysicsRectanglePanel",defaultImageUrlObject:{url:"images/qmarksq.png",
internal:!0},editorDisplayObjectType:"image",namePrefix:"Physics Piece Class",typeName:"Physics Piece",tabName:"Physics Pieces",entityName:"Physics Piece Class",entityNamePlural:"Physics Piece Classes",thisName:"this physics piece class",allName:"all physics piece classes",anyName:"any physics piece class",randomName:"random physics piece class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasHeightWidth hasVisibility hasDragability hasViewId hasCostume perPlayer hasTraits hasScripts hasPhysics hasPhysicsDirection".split(" "),
methodTags:["entity","canvasObject","physicsRectangle"]}};
bd.component.physicsRectangleInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.physicsRectangleInstance.componentProperties);this.layer=function(){return bd.pieceLayer};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"physicsRectangleInstance",listName:"physicsRectangleInstances",idName:"physicsRectangleInstanceId",idListName:"physicsRectangleInstanceIds",
editorDisplayObjectType:"image",namePrefix:"physics piece",entityName:"Physics Piece Class",thisName:"this physics piece",allName:"all physics pieces",anyName:"any physics piece",randomName:"random physics piece",modelTags:bd.component.physicsRectangle.componentProperties.modelTags,methodTags:bd.component.physicsRectangle.componentProperties.methodTags}};bd.component.typeNameToComponent.physicsRectangle=bd.component.physicsRectangle;bd.component.typeNameToComponent.physicsRectangleInstance=bd.component.physicsRectangleInstance;
bd.component.childNameToParentName.physicsRectangleInstance="physicsRectangle";bd.component.physicsRectangleInstance.viewVars={};
bd.component.physicsRectangle.onStartUp=function(a){var b=bd.component.lookup(a),c=bd.component.physicsRectangleInstance;null==c.viewVars[a]&&(c.viewVars[a]={});c.viewVars[a].updateRunning=!1;c.viewVars[a].collisionObjects=[];c.viewVars[a].entityIdToBody={};var e=b.getWindow().Box2D,f=e.Common.Math.b2Vec2,g=e.Dynamics.b2World,h=e.Dynamics.b2DebugDraw;c.viewVars[a].context=b.getLayer("pieceLayer").getContext();c.viewVars[a].world=new g(new f(b.model.gravityX,b.model.gravityY),!0);c.viewVars[a].scale=
20;for(var k=c.viewVars[a].scale,f=0;f<bd.model.getCurrentGame().physicsRectangleInstances.length;f++)g=bd.model.getCurrentGame().physicsRectangleInstances[f],g.viewId==a&&bd.component.physicsRectangle.createNewBody(g.id);b.getWindow().requestAnimFrame=function(a){return a.requestAnimationFrame||a.webkitRequestAnimationFrame||a.mozRequestAnimationFrame||a.oRequestAnimationFrame||a.msRequestAnimationFrame||function(b,c){a.setTimeout(b,1E3/60)}}(b.getWindow());bd.component.physicsRectangle.update=function(a){a=
this.viewId;var b=bd.component.lookup(a);b.getWindow();var c=bd.component.physicsRectangleInstance;c.viewVars[a].world.Step(1/60,3,3);c.viewVars[a].updateRunning=!0;var e=0;c.viewVars[a].world.ClearForces();for(var f=0,g=0;g<bd.model.getCurrentGame().physicsRectangleInstances.length;g++){var h=bd.model.getCurrentGame().physicsRectangleInstances[g];if(h.playerId==bd.player.ctr.playerId){var r=c.viewVars[a].entityIdToBody[h.id];if(null!=r){f++;r.IsAwake()||e++;var x=bd.component.lookup(h.id).getDisplayObject(),
w=r.GetPosition(),r=r.GetLinearVelocity(),u=0;bd.util.closeToEqual(r.x,0)&&bd.util.closeToEqual(r.y,0)?u=0:bd.util.closeToEqual(r.x,0)?u=0<r.y?Math.PI/2:3*Math.PI/2:bd.util.closeToEqual(r.y,0)?u=0<r.x?0:Math.PI:0<r.x&&0<r.y?u=Math.atan(r.y/r.x):0>r.x&&0>r.y?(u=Math.atan(r.y/r.x),u+=Math.PI):0>r.x&&0<r.y?(u=Math.atan(r.y/r.x),u=-1*u+Math.PI/2):(u=Math.atan(r.y/r.x),u=-1*u+3*Math.PI/2);h.canRotate&&x.setRotation(u);x.setPosition(w.x*k,w.y*k);h.direction=180/Math.PI*u;h.x=w.x*k;h.y=w.y*k}}}for(b.getLayer("pieceLayer").batchDraw();0!=
c.viewVars[a].collisionObjects.length;)if(g=c.viewVars[a].collisionObjects.shift(),g.beginContact)bd.evaluator.ctr.onCollision(g.entityId1,g.entityId2);e!=f?b.getWindow().requestAnimFrame(bd.component.physicsRectangle.update):c.viewVars[a].updateRunning=!1};e=new e.Dynamics.b2ContactListener;e.viewId=a;e.BeginContact=function(a){c.viewVars[this.viewId].collisionObjects.push({entityId1:a.GetFixtureA().GetBody().GetUserData().entityId,entityId2:a.GetFixtureB().GetBody().GetUserData().entityId,beginContact:!0})};
e.EndContact=function(a){c.viewVars[this.viewId].collisionObjects.push({entityId1:a.GetFixtureA().GetBody().GetUserData().entityId,entityId2:a.GetFixtureB().GetBody().GetUserData().entityId,beginContact:!1})};c.viewVars[a].world.SetContactListener(e);c.viewVars[a].updateRunning=!0;b.getWindow().requestAnimFrame(bd.component.physicsRectangle.update);b=new h;b.SetSprite(c.viewVars[a].context);b.SetDrawScale(c.viewVars[a].scale);b.SetFillAlpha(.5);b.SetLineThickness(1);b.SetFlags(h.e_shapeBit|h.e_jointBit|
h.e_centerOfMassBit);c.viewVars[a].world.SetDebugDraw(b)};
bd.component.physicsRectangle.createNewBody=function(a){var b=bd.component.physicsRectangleInstance,c=bd.model.entityLookup(a).viewId,e=bd.component.lookup(c).getWindow().Box2D,f=e.Dynamics.b2BodyDef,g=e.Dynamics.b2Body,h=e.Dynamics.b2FixtureDef,k=e.Collision.Shapes.b2PolygonShape,e=b.viewVars[c].scale;a=bd.entityLookup[a];a.playerId==bd.player.ctr.playerId&&(h=new h,h.density=2,h.friction=.05,h.restitution=parseFloat(a.bounciness),f=new f,"wall"==a.movementType?f.type=g.b2_staticBody:(f.type=g.b2_dynamicBody,
f.fixedRotation=a.canRotate),g=bd.component.lookup(a.id).getDisplayObject(),g.setOffset(g.getWidth()/2,g.getHeight()/2),h.shape=new k,k=g.getOffset(),h.shape.SetAsBox(k.x/e,k.y/e),g=g.getAbsolutePosition(),f.position.Set((g.x+k.x)/e,(g.y+k.y)/e),e=b.viewVars[c].world.CreateBody(f),e.CreateFixture(h),e.SetUserData({entityId:a.id}),b.viewVars[c].entityIdToBody[a.id]=e)};bd.modelTag.hasVideoProperties={requiredFields:["height","width"],provideFields:function(){return[{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:200},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:328},{fields:["entityPerPlayer"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["entityPerPlayer"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:!0}]}};bd.methodTag.phaserPhysicsPiece={provideMethods:function(){return[{name:"addEntity",fxn:bd.methodTag.phaserPhysicsPiece.addEntity,classOrInstance:"instance"},{name:"onInputUpFunction",fxn:bd.methodTag.phaserPhysicsPiece.onInputUpFunction,classOrInstance:"instance"},{name:"onInputDownFunction",fxn:bd.methodTag.phaserPhysicsPiece.onInputDownFunction,classOrInstance:"instance"},{name:"mouseDragStart",fxn:bd.methodTag.phaserPhysicsPiece.mouseDragStart,classOrInstance:"instance"},{name:"mouseDragMove",
fxn:bd.methodTag.phaserPhysicsPiece.mouseDragMove,classOrInstance:"instance"},{name:"mouseDragEnd",fxn:bd.methodTag.phaserPhysicsPiece.mouseDragEnd,classOrInstance:"instance"},{name:"getVelocityFromAngleAndSpeed",fxn:bd.methodTag.phaserPhysicsPiece.getVelocityFromAngleAndSpeed,classOrInstance:"instance"},{name:"localSetSpeed",fxn:bd.methodTag.phaserPhysicsPiece.localSetSpeed,classOrInstance:"instance"},{name:"localSetXYSpeed",fxn:bd.methodTag.phaserPhysicsPiece.localSetXYSpeed,classOrInstance:"instance"},
{name:"localGetXYSpeed",fxn:bd.methodTag.phaserPhysicsPiece.localGetXYSpeed,classOrInstance:"instance"},{name:"localGetSpeed",fxn:bd.methodTag.phaserPhysicsPiece.localGetSpeed,classOrInstance:"instance"},{name:"localGetAngularVelocity",fxn:bd.methodTag.phaserPhysicsPiece.localGetAngularVelocity,classOrInstance:"instance"},{name:"applyFriction",fxn:bd.methodTag.phaserPhysicsPiece.applyFriction,classOrInstance:"instance"},{name:"getXorYFriction",fxn:bd.methodTag.phaserPhysicsPiece.getXorYFriction,classOrInstance:"instance"},
{name:"stopMovement",fxn:bd.methodTag.phaserPhysicsPiece.stopMovement,classOrInstance:"instance"},{name:"localSetSpeedAtAngle",fxn:bd.methodTag.phaserPhysicsPiece.localSetSpeedAtAngle,classOrInstance:"instance"},{name:"localSetAngularVelocity",fxn:bd.methodTag.phaserPhysicsPiece.localSetAngularVelocity,classOrInstance:"instance"},{name:"localChangeAngularVelocity",fxn:bd.methodTag.phaserPhysicsPiece.localChangeAngularVelocity,classOrInstance:"instance"},{name:"isTouching",fxn:bd.methodTag.phaserPhysicsPiece.isTouching,
classOrInstance:"instance"},{name:"isTouchingEdge",fxn:bd.methodTag.phaserPhysicsPiece.isTouchingEdge,classOrInstance:"instance"},{name:"isTouchingPhaserPhysicsPieceEdge",fxn:bd.methodTag.phaserPhysicsPiece.isTouchingPhaserPhysicsPieceEdge,classOrInstance:"instance"},{name:"getMovingDirection",fxn:bd.methodTag.phaserPhysicsPiece.getMovingDirection,classOrInstance:"instance"},{name:"localDirection",fxn:bd.methodTag.phaserPhysicsPiece.localDirection,classOrInstance:"instance"},{name:"getLocalDirection",
fxn:bd.methodTag.phaserPhysicsPiece.getLocalDirection,classOrInstance:"instance"},{name:"getBoundary",fxn:bd.methodTag.phaserPhysicsPiece.getBoundary,classOrInstance:"instance"},{name:"updateMovable",fxn:bd.methodTag.phaserPhysicsPiece.updateMovable,classOrInstance:"instance"},{name:"updateInstancePanel",fxn:bd.methodTag.phaserPhysicsPiece.updateInstancePanel,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.phaserPhysicsPiece.updateSideBar,classOrInstance:"class"},{name:"presolveContactCallback",
fxn:bd.methodTag.phaserPhysicsPiece.presolveContactCallback,classOrInstance:"instance"},{name:"kinematicPresolveContactCallback",fxn:bd.methodTag.phaserPhysicsPiece.kinematicPresolveContactCallback,classOrInstance:"instance"},{name:"contactCallback",fxn:bd.methodTag.phaserPhysicsPiece.contactCallback,classOrInstance:"instance"},{name:"kinematicContactCallback",fxn:bd.methodTag.phaserPhysicsPiece.kinematicContactCallback,classOrInstance:"instance"},{name:"updateFriction",fxn:bd.methodTag.phaserPhysicsPiece.updateFriction,
classOrInstance:"instance"},{name:"updateRestitution",fxn:bd.methodTag.phaserPhysicsPiece.updateRestitution,classOrInstance:"instance"},{name:"updateFixedRotation",fxn:bd.methodTag.phaserPhysicsPiece.updateFixedRotation,classOrInstance:"instance"},{name:"updateCollideWorldBounds",fxn:bd.methodTag.phaserPhysicsPiece.updateCollideWorldBounds,classOrInstance:"instance"},{name:"changeReactsToCollisions",fxn:bd.methodTag.phaserPhysicsPiece.changeReactsToCollisions,classOrInstance:"instance"},{name:"getWallCollideSprite",
fxn:bd.methodTag.phaserPhysicsPiece.getWallCollideSprite,classOrInstance:"instance"},{name:"setWallCollideSprite",fxn:bd.methodTag.phaserPhysicsPiece.setWallCollideSprite,classOrInstance:"instance"},{name:"localMoveToXY",fxn:bd.methodTag.phaserPhysicsPiece.localMoveToXY,classOrInstance:"instance"},{name:"localSetXY",fxn:bd.methodTag.phaserPhysicsPiece.localSetXY,classOrInstance:"instance"},{name:"setWidthHeightForBody",fxn:bd.methodTag.phaserPhysicsPiece.setWidthHeightForBody,classOrInstance:"instance"},
{name:"moveToWallCollideSprite",fxn:bd.methodTag.phaserPhysicsPiece.moveToWallCollideSprite,classOrInstance:"instance"},{name:"updateMovable",fxn:bd.methodTag.phaserPhysicsPiece.updateMovable,classOrInstance:"instance"},{name:"updatePosition",fxn:bd.methodTag.phaserPhysicsPiece.updatePosition,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"localChangeXY",fxn:bd.methodTag.phaserPhysicsPiece.localChangeXY,classOrInstance:"instance"},{name:"getLocalXY",fxn:bd.methodTag.phaserPhysicsPiece.getLocalXY,
classOrInstance:"instance"},{name:"updatePassthrough",fxn:bd.methodTag.phaserPhysicsPiece.updatePassthrough,classOrInstance:"instance"},{name:"wallContactCallback",fxn:bd.methodTag.phaserPhysicsPiece.wallContactCallback,classOrInstance:"instance"},{name:"presolveWallContactCallback",fxn:bd.methodTag.phaserPhysicsPiece.presolveWallContactCallback,classOrInstance:"instance"},{name:"removeDisplayObject",fxn:bd.methodTag.phaserPhysicsPiece.removeDisplayObject,classOrInstance:"instance"}]}};
bd.methodTag.phaserPhysicsPiece.handleCommand=function(a){if(bd.model.isInstance(this.id)){if("restitution"==a.property)return this.updateRestitution(),!0;if("friction"==a.property)return this.updateFriction(),!0;if("fixedRotation"==a.property)return this.updateFixedRotation(),!0;if("collideWorldBounds"==a.property)return this.updateCollideWorldBounds(),!0;if("passthrough"==a.property)return this.updatePassthrough(),!0;if("movable"==a.property)return this.updateMovable(),!0}return!1};
bd.methodTag.phaserPhysicsPiece.updateInstancePanel=function(){var a=this.model,b=document.getElementById(this.instancePanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0},
bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("xInput")[0];
c.value=a.x;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("yInput")[0];c.value=a.y;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"y",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),
bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b.getElementsByClassName("costumeImage")[0].src=bd.component.lookup(bd.model.entityLookup(a.costumeId).assetId).getThumbnailUrl();b.getElementsByClassName("instanceImageContainer")[0].onclick=function(a){return function(){bd.overlay.ctr.showOverlay("imageSelection",["assetImage"],a)}}(a.id)};
bd.methodTag.phaserPhysicsPiece.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",
isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,
bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("gravityXInput")[0];c.value=a.gravityX;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"gravityX",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("gravityYInput")[0];c.value=a.gravityY;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,
{entityId:a.id,propertyName:"gravityY",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("frictionXInput")[0];c.value=a.frictionX;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"frictionX",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("frictionYInput")[0];c.value=a.frictionY;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"frictionY",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("stopAfterDragCheckbox")[0];
c.checked=a.stopAfterDrag?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"stopAfterDrag",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("isDraggableCheckbox")[0];c.checked=a.draggable?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"draggable",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("isVisibleCheckbox")[0];c.checked=a.visible?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,
{entityId:a.id,propertyName:"visible",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("isMovableCheckbox")[0];c.checked=a.movable?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"movable",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("passthroughCheckbox")[0];c.checked=a.passthrough?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"passthrough",updateInstances:!0},
null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("restitutionInput")[0];c.value=a.bounciness;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"bounciness",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("allowGravityCheckbox")[0];c.checked=a.allowGravity?
!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"allowGravity",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("collideWithBoundsCheckbox")[0];c.checked=a.collideWorldBounds?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"collideWorldBounds",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("fixedRotationCheckbox")[0];c.checked=a.fixedRotation?!0:!1;
bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"fixedRotation",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=document.getElementsByName("phaserPhysicsPieceRotate");b=b.getElementsByClassName("frictionInput")[0];b.value=a.friction;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"friction",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);null==a.rotationStyle&&(a.rotationStyle="rotate");bd.util.setRadioValue(c,a.rotationStyle);bd.util.setupRadioChangeEventHandlers(c,{entityId:a.id,propertyName:"rotationStyle",updateInstances:!0},null,bd.sideBar.ctr.radioUpdateSuccess,null);document.getElementById("phaserPhysicsPieceImageSelector").src=bd.component.lookup(bd.entityLookup[a.costumeIds[0]].assetId).getThumbnailUrl()};
bd.methodTag.phaserPhysicsPiece.addEntity=function(){if(bd.methodTag.phaserObject.addEntity.call(this)){for(var a=bd.component.lookup(this.model.viewId),b=a.getPhaserGameObject(),c=a.getPhaserObject(),e=bd.model.getEntityList("phaserPhysicsPieceInstance"),f=this.getDisplayObject(),g=b.physics.box2d.walls.top,h=b.physics.box2d.walls.left,k=b.physics.box2d.walls.right,l=b.physics.box2d.walls.bottom,m=0;m<e.length;m++){var n=bd.component.lookup(e[m].id);if(null!=n&&null!=n.getDisplayObject()){b.physics.box2d.enable(n.getDisplayObject());
var q=n.getDisplayObject().body;q.data.SetUserData(n.id);null!=b.physics.box2d.walls.left&&(n={id:n.id},g.setBodyContactCallback(q,this.wallContactCallback,n),h.setBodyContactCallback(q,this.wallContactCallback,n),k.setBodyContactCallback(q,this.wallContactCallback,n),l.setBodyContactCallback(q,this.wallContactCallback,n))}}f.body.collideWorldBounds=this.model.collideWorldBounds;f.body.fixedRotation=this.model.fixedRotation;f.body.restitution=this.model.bounciness/100;f.body.friction=this.model.friction;
f.body.angle=this.model.direction;this.stopLeftwardMovement=this.stopDownwardMovement=this.stopRightwardMovement=this.stopUpwardMovement=!1;this.model.movable||this.model.passthrough?this.setWallCollideSprite(null):(f.body.kinematic=!0,m=bd.model.entityLookup(this.model.costumeId).assetId,m=new c.Sprite(b,this.model.x,this.model.y,"assetId:"+m),m.alpha=0,this.setWallCollideSprite(m),this.setWidthHeight(m),b.physics.box2d.enable(m),m.body.data.SetUserData(this.id),g.setBodyContactCallback(m.body,this.wallContactCallback,
{id:this.id}),h.setBodyContactCallback(m.body,this.wallContactCallback,{id:this.id}),k.setBodyContactCallback(m.body,this.wallContactCallback,{id:this.id}),l.setBodyContactCallback(m.body,this.wallContactCallback,{id:this.id}),g.setBodyPresolveCallback(m.body,this.presolveWallContactCallback,{id:this.id}),h.setBodyPresolveCallback(m.body,this.presolveWallContactCallback,{id:this.id}),k.setBodyPresolveCallback(m.body,this.presolveWallContactCallback,{id:this.id}),l.setBodyPresolveCallback(m.body,this.presolveWallContactCallback,
{id:this.id}),m.body.collideWorldBounds=!0,m.body.restitution=this.model.bounciness/100,m.visible=!0,m.body.dynamic=!0,a.getLayer(this.model.layerId).add(m),b.physics.box2d.weldJoint(m,f));f.events&&(f.events.onInputDown.add(this.onInputDownFunction,this),f.events.onInputUp.add(this.onInputUpFunction,this));for(m=0;m<e.length;m++)null!=this.getDisplayObject()&&(a=this.getDisplayObject().body,e[m].id!=this.id&&(b=bd.component.lookup(e[m].id),null!=b&&null!=b.getDisplayObject()&&(f=b.getDisplayObject().body,
g={id1:this.id,id2:b.id},h={id1:b.id,id2:this.id},a.setBodyPresolveCallback(f,this.presolveContactCallback,g),f.setBodyPresolveCallback(a,this.presolveContactCallback,h),a.setBodyContactCallback(f,this.contactCallback,g),f.setBodyContactCallback(a,this.contactCallback,h),null!=this.getWallCollideSprite()&&(a.setBodyPresolveCallback(this.getWallCollideSprite().body,this.presolveContactCallback,g),f.setBodyPresolveCallback(this.getWallCollideSprite().body,this.presolveContactCallback,h),this.getWallCollideSprite().body.setBodyContactCallback(a,
this.contactCallback,g),this.getWallCollideSprite().body.setBodyContactCallback(f,this.contactCallback,g),this.getWallCollideSprite().body.setBodyPresolveCallback(a,this.presolveContactCallback,g),this.getWallCollideSprite().body.setBodyPresolveCallback(f,this.presolveContactCallback,g)),null!=b.getWallCollideSprite()&&(b.getWallCollideSprite().body.setBodyContactCallback(a,this.contactCallback,h),b.getWallCollideSprite().body.setBodyContactCallback(f,this.contactCallback,h),a.setBodyPresolveCallback(b.getWallCollideSprite().body,
this.presolveContactCallback,g),f.setBodyPresolveCallback(b.getWallCollideSprite().body,this.presolveContactCallback,h),b.getWallCollideSprite().body.setBodyPresolveCallback(a,this.presolveContactCallback,h),b.getWallCollideSprite().body.setBodyPresolveCallback(f,this.presolveContactCallback,h)))))}};
bd.methodTag.phaserPhysicsPiece.onInputDownFunction=function(a,b){var c=bd.model.entityLookup(bd.player.ctr.playerId),e=bd.component.lookup(c.viewId),c=e.getPhaserGameObject(),f=e.getWindow().box2d;e.getPhaserObject();if(!(1>c.physics.box2d.getFixturesAtPoint(b.x,b.y,!0,!0).length)&&this.model.draggable){null!=this.getWallCollideSprite()&&(this.getDisplayObject().body.dynamic=!0);this.getDisplayObject().dragStartX=this.getLocalXY("x");this.getDisplayObject().dragStartY=this.getLocalXY("y");this.pointerDragOffsetX=
b.x-this.getLocalXY("x");this.pointerDragOffsetY=b.y-this.getLocalXY("y");c.physics.box2d.getFixturesAtPoint(b.x,b.y,!0,!0);var e=c.physics.box2d.pxm(-c.input.activePointer.x),g=c.physics.box2d.pxm(-c.input.activePointer.y),e=new f.b2Vec2(e,g),f=new f.b2MouseJointDef;f.bodyA=c.physics.box2d.mouseJointBody;f.bodyB=this.getDisplayObject().body.data;f.target.Copy(e);f.maxForce=1E3*f.bodyB.GetMass();bd.phaser.ctr.mouseJoints[b.id]=c.physics.box2d.world.CreateJoint(f);f.bodyB.SetAwake(!0);c.input.addMoveCallback(this.mouseDragMove,
this)}};
bd.methodTag.phaserPhysicsPiece.onInputUpFunction=function(a,b){var c=bd.model.entityLookup(bd.player.ctr.playerId),c=bd.component.lookup(c.viewId).getPhaserGameObject(),e=b.positionUp.y-b.positionDown.y,e=Math.sqrt(Math.pow(b.positionUp.x-b.positionDown.x,2)+Math.pow(e,2));if(this.model.draggable)if(null!=this.getWallCollideSprite()&&(this.getDisplayObject().body.kinematic=!0),5<e)c.input.deleteMoveCallback(this.mouseDragMove,this),this.mouseDragEnd(b.id),bd.evaluator.ctr.whenPhaserPhysicsPlaced(a.instanceId,a.dragStartX,
a.dragStartY);else{bd.evaluator.ctr.phaserPieceInstanceClicked(a.instanceId);for(var f in bd.phaser.ctr.mouseJoints)bd.phaser.ctr.mouseJoints.hasOwnProperty(f)&&f==b.id&&(c.physics.box2d.world.DestroyJoint(bd.phaser.ctr.mouseJoints[f]),delete bd.phaser.ctr.mouseJoints[f])}else bd.evaluator.ctr.phaserPieceInstanceClicked(a.instanceId)};
bd.methodTag.phaserPhysicsPiece.mouseDragEnd=function(a){var b=bd.model.entityLookup(bd.player.ctr.playerId),b=bd.component.lookup(b.viewId),c=b.getPhaserGameObject();b.getWindow();for(var e in bd.phaser.ctr.mouseJoints)bd.phaser.ctr.mouseJoints.hasOwnProperty(e)&&e==a&&(c.physics.box2d.world.DestroyJoint(bd.phaser.ctr.mouseJoints[e]),this.model.movable||this.model.passthrough||!this.model.collideWorldBounds||(this.getDisplayObject().body.kinematic=!0,delete bd.phaser.ctr.mouseJoints[e]));this.model.stopAfterDrag&&
(this.getDisplayObject().body.velocity.x=0,this.getDisplayObject().body.velocity.y=0)};
bd.methodTag.phaserPhysicsPiece.mouseDragMove=function(a){var b=bd.model.entityLookup(bd.player.ctr.playerId),b=bd.component.lookup(b.viewId),c=b.getPhaserGameObject(),e=b.getWindow().box2d,b=c.input.activePointer;if(bd.phaser.ctr.mouseJoints[b.id]){var f=-a.x;a=-a.y;this.model.allowHorizontalDrag||(f=-1*this.getLocalXY("x")-this.pointerDragOffsetX);this.model.allowVerticalDrag||(a=-1*this.getLocalXY("y")-this.pointerDragOffsetY);f=c.physics.box2d.pxm(f);c=c.physics.box2d.pxm(a);c=new e.b2Vec2(f,
c);bd.phaser.ctr.mouseJoints[b.id].SetTarget(c)}};bd.methodTag.phaserPhysicsPiece.getVelocityFromAngleAndSpeed=function(a,b){var c=bd.component.lookup(this.model.viewId);c.getPhaserGameObject();c.getPhaserObject();c={};"undefined"==typeof b&&(b=0);c.x=b*Math.cos(Math.PI/180*a);c.y=b*Math.sin(Math.PI/180*a);return c};bd.methodTag.phaserPhysicsPiece.getLocalXY=function(a){return null!=this.getDisplayObject()?this.getDisplayObject().body[a]:this.model[a]};
bd.methodTag.phaserPhysicsPiece.localSetSpeed=function(a,b,c){if(null!=this.getDisplayObject()&&null!=this.getDisplayObject().body){var e=bd.component.lookup(this.model.viewId);e.getPhaserGameObject();e.getPhaserObject();e=this.getDisplayObject().body.angle;"MOVING"==c&&(e=this.getMovingDirection());b=this.getVelocityFromAngleAndSpeed(e,b);"set"==a?(this.getDisplayObject().body.velocity.x=b.x,this.getDisplayObject().body.velocity.y=b.y):(this.getDisplayObject().body.velocity.x+=b.x,this.getDisplayObject().body.velocity.y+=
b.y)}};bd.methodTag.phaserPhysicsPiece.localSetXYSpeed=function(a,b,c){null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&("undefined"==typeof c&&(c="set"),"change"==c?this.getDisplayObject().body.velocity[a]+=b:this.getDisplayObject().body.velocity[a]=b)};bd.methodTag.phaserPhysicsPiece.localGetXYSpeed=function(a){return null!=this.getDisplayObject()?this.getDisplayObject().body.velocity[a]:0};
bd.methodTag.phaserPhysicsPiece.localGetSpeed=function(){if(null!=this.getDisplayObject()){var a=this.getDisplayObject().body.velocity;return Math.sqrt(Math.pow(a.x,2)+Math.pow(a.y,2))}return 0};bd.methodTag.phaserPhysicsPiece.applyFriction=function(){if(null!=this.getDisplayObject())for(var a=["x","y"],b=0,c;c=a[b];b++){var e=this.getXorYFriction(c);if(null!=e&&0!=e){var f=this.localGetXYSpeed(c);0<f?f=Math.max(0,f-e):0>f&&(f=Math.min(0,f+e));this.localSetXYSpeed(c,f,"set")}}};
bd.methodTag.phaserPhysicsPiece.getXorYFriction=function(a){if("x"==a)return this.model.frictionX;if("y"==a)return this.model.frictionY;throw"Didn't input x or y";};bd.methodTag.phaserPhysicsPiece.stopMovement=function(a){this.localSetSpeedAtAngle("set",0,0)};
bd.methodTag.phaserPhysicsPiece.localSetSpeedAtAngle=function(a,b,c){null!=this.getDisplayObject()&&(bd.component.lookup(this.model.viewId).getPhaserGameObject(),b=this.getVelocityFromAngleAndSpeed(c,b),"set"==a?(this.getDisplayObject().body.velocity.x=b.x,this.getDisplayObject().body.velocity.y=b.y):(this.getDisplayObject().body.velocity.x+=b.x,this.getDisplayObject().body.velocity.y+=b.y))};
bd.methodTag.phaserPhysicsPiece.localSetAngularVelocity=function(a){null!=this.getDisplayObject()&&(this.getDisplayObject().body.angularVelocity=a)};bd.methodTag.phaserPhysicsPiece.localGetAngularVelocity=function(){return null!=this.getDisplayObject()?this.getDisplayObject().body.angularVelocity:0};bd.methodTag.phaserPhysicsPiece.localChangeAngularVelocity=function(a){null!=this.getDisplayObject()&&(this.getDisplayObject().body.angularVelocity+=parseFloat(a))};
bd.methodTag.phaserPhysicsPiece.getBoundary=function(){var a={};"percent"===this.model.offsetType?(a.left=-parseFloat(this.model.width)*this.model.offsetX+this.getLocalXY("x"),a.top=-parseFloat(this.model.height)*this.model.offsetY+this.getLocalXY("y")):"pixel"===component.model.offsetType&&(a.left=-this.model.offsetX+this.getLocalXY("x"),a.top=-this.model.offsetY+this.getLocalXY("y"));a.right=parseFloat(this.model.width)+a.left;a.bottom=parseFloat(this.model.height)+a.top;return a};
bd.methodTag.phaserPhysicsPiece.isTouching=function(a){collisionObject=this.model.collisionObject;for(var b=0;b<a.length;b++)if(null!=collisionObject[a[b]])return!0;return!1};bd.methodTag.phaserPhysicsPiece.presolveContactCallback=function(a,b,c,e,f,g){a=bd.component.lookup(this.id1);b=bd.component.lookup(this.id2);(a.model.passthrough||b.model.passthrough)&&f.SetEnabled(!1);a.model.movable||b.model.movable||f.SetEnabled(!1)};
bd.methodTag.phaserPhysicsPiece.kinematicPresolveContactCallback=function(a,b,c,e,f,g){c=bd.model.entityLookup(bd.player.ctr.playerId);c=bd.component.lookup(c.viewId);c.getPhaserGameObject();c.getWindow();a.dynamic?(a=bd.component.lookup(a.data.GetUserData()).getDisplayObject().body,a.velocity.x=0,a.velocity.y=0):b.dynamic&&(a=bd.component.lookup(b.data.GetUserData()).getDisplayObject().body,a.velocity.x=0,a.velocity.y=0)};bd.methodTag.phaserPhysicsPiece.getWallCollideSprite=function(){return this.wallCollideSprite};
bd.methodTag.phaserPhysicsPiece.setWallCollideSprite=function(a){this.wallCollideSprite=a};bd.methodTag.phaserPhysicsPiece.kinematicContactCallback=function(a,b,c,e,f,g){a=bd.model.entityLookup(bd.player.ctr.playerId);a=bd.component.lookup(a.viewId);a.getPhaserGameObject();a.getWindow()};
bd.methodTag.phaserPhysicsPiece.contactCallback=function(a,b,c,e,f,g){e=a.data.GetUserData();var h=b.data.GetUserData();a.data.GetUserData();b.data.GetUserData();a=bd.component.lookup(e);b=bd.component.lookup(h);var k=1;c!=g.GetFixtureA()&&(k=-1);c=k*g.GetManifold().localNormal.x;var k=k*g.GetManifold().localNormal.y,l=-1*c,m=-1*k;if(f){(bd.component.lookup(e).model.passthrough||bd.component.lookup(h).model.passthrough)&&g.SetEnabled(!1);null==bd.phaser.ctr.instanceIdToCollidees[e]&&(bd.phaser.ctr.instanceIdToCollidees[e]=
[]);f=bd.phaser.ctr.instanceIdToCollidees[e];g=!1;for(var n=0;n<f.length;n++)if(f[n]==h){g=!0;break}g||(bd.phaser.ctr.instanceIdToCollidees[e].push(h),bd.evaluator.ctr.onPhaserPhysicsCollision(e,h));null==a.model.collisionObject[h]&&(1==c&&(a.model.collisionObject[h]={edge:1}),-1==c&&(a.model.collisionObject[h]={edge:3}),1==k&&(a.model.collisionObject[h]={edge:2}),-1==k&&(a.model.collisionObject[h]={edge:4}));null==b.model.collisionObject[e]&&(1==l&&(b.model.collisionObject[e]={edge:1}),-1==l&&(b.model.collisionObject[e]=
{edge:3}),1==m&&(b.model.collisionObject[e]={edge:2}),-1==m&&(b.model.collisionObject[e]={edge:4}))}else null!=a.model.collisionObject[h]&&delete a.model.collisionObject[h],null!=b.model.collisionObject[e]&&delete b.model.collisionObject[e],bd.phaser.ctr.instanceIdToCollidees[e]&&(1==bd.phaser.ctr.instanceIdToCollidees[e].length?delete bd.phaser.ctr.instanceIdToCollidees[e]:bd.phaser.ctr.instanceIdToCollidees[e].splice(bd.phaser.ctr.instanceIdToCollidees[e].indexOf(h),1)),bd.phaser.ctr.instanceIdToCollidees[h]&&
(1==bd.phaser.ctr.instanceIdToCollidees[h].length?delete bd.phaser.ctr.instanceIdToCollidees[h]:bd.phaser.ctr.instanceIdToCollidees[h].splice(bd.phaser.ctr.instanceIdToCollidees[h].indexOf(e),1))};bd.methodTag.phaserPhysicsPiece.presolveWallContactCallback=function(a,b,c,e,f,g,h){a.data.GetUserData();bd.component.lookup(this.id);bd.component.lookup(this.id).model.collideWorldBounds||f.SetEnabled(!1)};
bd.methodTag.phaserPhysicsPiece.wallContactCallback=function(a,b,c,e,f,g){b=a.data.GetUserData();c=[this.id];a=bd.component.lookup(c);var h;e={1:{edge:"LEFT",stopMovementVariable:"stopLeftwardMovement"},2:{edge:"TOP",stopMovementVariable:"stopUpwardMovement"},3:{edge:"RIGHT",stopMovementVariable:"stopRightwardMovement"},4:{edge:"BOTTOM",stopMovementVariable:"stopDownwardMovement"}};e[b]&&(h=e[b].edge,null!=a.getWallCollideSprite()&&a.model.collideWorldBounds&&(f?(a.localMoveToXY(a.getWallCollideSprite().x,
a.getWallCollideSprite().y),a[e[b].stopMovementVariable]=!0):a[e[b].stopMovementVariable]=!1));f?(bd.evaluator.ctr.onEdgeCollision(this.id,h),bd.evaluator.ctr.onEdgeCollision(this.id,"ANY"),bd.model.addModelUpdateElement(c,"push","wallCollisionIds",b,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1})):bd.model.addModelUpdateElement(c,"removeValue","wallCollisionIds",b,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});
bd.model.sendUpdates();null!=a.getWallCollideSprite()&&a.model.collideWorldBounds&&(f=a.getWallCollideSprite(),a.getDisplayObject().x==f.x&&a.getDisplayObject().y==f.y||bd.phaser.ctr.compromisedBodies.push(a.id))};
bd.methodTag.phaserPhysicsPiece.isTouchingEdge=function(a){var b=this.model.wallCollisionIds;if(null!=this.getDisplayObject()&&null!=this.getDisplayObject().body){var c={},e=!1;if(-1!=b.indexOf(1)){if("LEFT"==a)return!0;"DICTIONARY"==a&&(c.LEFT=!0);e=!0}if(-1!=b.indexOf(3)){if("RIGHT"==a)return!0;"DICTIONARY"==a&&(c.RIGHT=!0);e=!0}if(-1!=b.indexOf(2)){if("TOP"==a)return!0;"DICTIONARY"==a&&(c.TOP=!0);e=!0}if(-1!=b.indexOf(4)){if("BOTTOM"==a)return!0;"DICTIONARY"==a&&(c.BOTTOM=!0);e=!0}if("ANY"==a)return e}return"DICTIONARY"==
a?c:!1};bd.methodTag.phaserPhysicsPiece.isTouchingPhaserPhysicsPieceEdge=function(a,b){if(null!=this.getDisplayObject())for(var c=this.model.collisionObject,e=!1,f=0;f<a.length;f++)if(this.isTouching([a[f]])){bd.component.lookup(a[f]);if(3==c[a[f]].edge){if("LEFT"==b)return!0;e=!0}if(4==c[a[f]].edge){if("TOP"==b)return!0;e=!0}if(1==c[a[f]].edge){if("RIGHT"==b)return!0;e=!0}if(2==c[a[f]].edge){if("BOTTOM"==b)return!0;e=!0}if("ANY"==b&&e)return e}return!1};
bd.methodTag.phaserPhysicsPiece.localDirection=function(a,b){if(null!=this.getDisplayObject()){if("rotate"==this.model.rotationStyle||null==this.model.rotationStyle)"set"==b?this.getDisplayObject().body.angle=parseFloat(a):"change"==b&&(this.getDisplayObject().body.angle+=parseFloat(a))}else bd.model.addModelUpdateElement([this.model.id],b,"direction",a,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates()};
bd.methodTag.phaserPhysicsPiece.getLocalDirection=function(){return null!=this.getDisplayObject()?"flip"==this.model.rotationStyle||"none"==this.model.rotationStyle?this.getDisplayObject().body.rotationAngle%360:this.getDisplayObject().body.angle%360:this.model.direction%360};
bd.methodTag.phaserPhysicsPiece.getMovingDirection=function(){if(null!=this.getDisplayObject()){var a=this.getDisplayObject().body.velocity;if(0==a.x)return 0==a.y?0:0<a.y?90:270;if(0==a.y)return 0<a.x?0:180;var b=180/Math.PI*Math.atan(a.y/a.x);0>a.x&&0<a.y?b+=180:0>a.x&&0>a.y?b+=180:0<a.x&&0>a.y&&(b+=360);return b}return 0};
bd.methodTag.phaserPhysicsPiece.localMoveToXY=function(a,b){null!=this.getDisplayObject()&&(this.getDisplayObject().body.x=parseFloat(a),this.getDisplayObject().body.y=parseFloat(b),this.getWallCollideSprite()&&(this.getWallCollideSprite().body.x=parseFloat(a),this.getWallCollideSprite().body.y=parseFloat(b)));bd.model.addModelUpdateElement([this.model.id],"set","x",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.addModelUpdateElement([this.model.id],
"set","y",b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.phaserPhysicsPiece.localSetXY=function(a,b){null!=this.getDisplayObject()&&null!=this.getDisplayObject().body?"x"==a?(this.getDisplayObject().body.x=parseFloat(b),this.getWallCollideSprite()&&(this.getWallCollideSprite().body.x=parseFloat(b))):"y"==a&&(this.getDisplayObject().body.y=parseFloat(b),this.getWallCollideSprite()&&(this.getWallCollideSprite().body.y=parseFloat(b))):(bd.model.addModelUpdateElement([this.model.id],"set",a,b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,
updateUIInEditor:!1}),bd.model.sendUpdates())};bd.methodTag.phaserPhysicsPiece.setWidthHeightForBody=function(){var a=bd.model.entityLookup(bd.player.ctr.playerId),a=bd.component.lookup(a.viewId);a.getPhaserGameObject();a.getWindow();a.getPhaserObject();a=this.getDisplayObject().body;null!=a&&a.data.GetFixtureList().GetShape().SetAsBox(this.model.width/100,this.model.height/100)};
bd.methodTag.phaserPhysicsPiece.localChangeXY=function(a,b){null!=this.getDisplayObject()&&null!=this.getDisplayObject().body?"x"==a?this.getDisplayObject().body.x+=parseFloat(b):"y"==a&&(this.getDisplayObject().body.y+=parseFloat(b)):(bd.model.addModelUpdateElement([this.model.id],"change",a,b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates())};
bd.methodTag.phaserPhysicsPiece.updatePosition=function(){null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject().body.x=this.model.x,this.getDisplayObject().body.y=this.model.y)};
bd.methodTag.phaserPhysicsPiece.updateMovable=function(){bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject(),this.model.movable||this.model.passthrough||null!=this.getWallCollideSprite()?null!=this.getWallCollideSprite()&&this.changeReactsToCollisions():this.changeReactsToCollisions())};
bd.methodTag.phaserPhysicsPiece.updateFriction=function(){bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject().body.friction=this.model.friction)};bd.methodTag.phaserPhysicsPiece.updateRestitution=function(){bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject().body.restitution=this.model.restitution)};
bd.methodTag.phaserPhysicsPiece.updateFixedRotation=function(){bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject().body.fixedRotation=this.model.fixedRotation)};bd.methodTag.phaserPhysicsPiece.updateCollideWorldBounds=function(){bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject().body.collideWorldBounds=this.model.collideWorldBounds)};
bd.methodTag.phaserPhysicsPiece.updatePassthrough=function(){bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(this.getDisplayObject(),this.model.movable||this.model.passthrough||null!=this.getWallCollideSprite()?null!=this.getWallCollideSprite()&&this.changeReactsToCollisions():this.changeReactsToCollisions())};
bd.methodTag.phaserPhysicsPiece.moveToWallCollideSprite=function(){if(bd.inPlayer&&null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&null!=this.getWallCollideSprite()){var a=this.getWallCollideSprite();this.localMoveToXY(a.x,a.y)}};
bd.methodTag.phaserPhysicsPiece.changeReactsToCollisions=function(){if(null!=this.getWallCollideSprite()||this.model.movable)this.model.movable&&(this.getWallCollideSprite().destroy(),this.setWallCollideSprite(null),this.getDisplayObject().body.dynamic=!0);else if(bd.inPlayer){var a=bd.component.lookup(this.model.viewId),b=a.getPhaserGameObject(),c=a.getPhaserObject(),e=this.getDisplayObject(),f=b.physics.box2d.walls.top,g=b.physics.box2d.walls.left,h=b.physics.box2d.walls.right,k=b.physics.box2d.walls.bottom;
if(null!=this.getDisplayObject()&&null!=this.getDisplayObject().body&&(e=this.getDisplayObject(),e.body.kinematic=!0,this.model.collideWorldBounds)){var l=bd.model.entityLookup(this.model.costumeId).assetId,c=new c.Sprite(b,this.model.x,this.model.y,"assetId:"+l);this.setWallCollideSprite(c);this.setWidthHeight(c);b.physics.box2d.enable(c);c.body.data.SetUserData(this.id);f.setBodyContactCallback(c.body,this.wallContactCallback,{id:this.id});g.setBodyContactCallback(c.body,this.wallContactCallback,
{id:this.id});h.setBodyContactCallback(c.body,this.wallContactCallback,{id:this.id});k.setBodyContactCallback(c.body,this.wallContactCallback,{id:this.id});c.body.collideWorldBounds=!0;c.body.restitution=this.model.bounciness/100;c.visible=!0;c.body.dynamic=!0;a.getLayer(this.model.layerId).add(c);b.physics.box2d.weldJoint(c,e)}}};
bd.methodTag.phaserPhysicsPiece.removeDisplayObject=function(){null!=this.getDisplayObject()&&(null!=this.getWallCollideSprite()&&(this.getWallCollideSprite().destroy(),this.setWallCollideSprite(null)),this.getDisplayObject().destroy(),this.setDisplayObject(null),-1!=bd.phaser.ctr.compromisedBodies.indexOf(this.id)&&bd.phaser.ctr.compromisedBodies.splice(this.id))};bd.methodTag.phaserPiece={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.phaserPiece.updateSideBar,classOrInstance:"class"}]}};
bd.methodTag.phaserPiece.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0,
updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,
bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("isDraggableCheckbox")[0];c.checked=a.draggable?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"draggable",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);c=b.getElementsByClassName("isVisibleCheckbox")[0];c.checked=a.visible?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"visible",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);b=b.getElementsByClassName("shareModeName")[0];
"local"==a.shareMode?b.innerHTML="local":"perPlayer"==a.shareMode?b.innerHTML="per player":"share"==a.shareMode&&(b.innerHTML="shared");document.getElementById("phaserPieceImageSelector").src=bd.component.lookup(bd.entityLookup[a.costumeIds[0]].assetId).getThumbnailUrl()};bd.methodTag.phaserObject={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.phaserObject.removeConnections,classOrInstance:"instance"},{name:"removeInstanceFromView",fxn:bd.methodTag.phaserObject.removeInstanceFromView,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"canCreateInstance",fxn:bd.methodTag.phaserObject.canCreateInstance,classOrInstance:"class"},{name:"addEntity",fxn:bd.methodTag.phaserObject.addEntity,classOrInstance:"instance"},{name:"moveCallback",
fxn:bd.methodTag.phaserObject.moveCallback,classOrInstance:"instance"},{name:"saveStateInModel",fxn:bd.methodTag.phaserObject.saveStateInModel,classOrInstance:"instance"},{name:"getImageObject",fxn:bd.methodTag.phaserObject.getImageObject,classOrInstance:"instance"},{name:"setWidthHeight",fxn:bd.methodTag.phaserObject.setWidthHeight,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"updateFlip",fxn:bd.methodTag.phaserObject.updateFlip,classOrInstance:"instance"},{name:"setAnchor",fxn:bd.methodTag.phaserObject.setAnchor,
classOrInstance:"instance"},{name:"hide",fxn:bd.methodTag.phaserObject.hide,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"show",fxn:bd.methodTag.phaserObject.show,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"afterLayerChanged",fxn:bd.methodTag.phaserObject.afterLayerChanged,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"moveToLayerXY",fxn:bd.methodTag.phaserObject.moveToLayerXY,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"setDraggable",fxn:bd.methodTag.phaserObject.setDraggable,
classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"setDragRestriction",fxn:bd.methodTag.phaserObject.setDragRestriction,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"switchCostume",fxn:bd.methodTag.phaserObject.switchCostume,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"updatePosition",fxn:bd.methodTag.phaserObject.updatePosition,classOrInstance:"instance",inEditor:!1,inPlayer:!0},{name:"createDisplayObject",fxn:bd.methodTag.phaserObject.createDisplayObject,classOrInstance:"instance"},
{name:"onInputUpFunction",fxn:bd.methodTag.phaserObject.onInputUpFunction,classOrInstance:"instance"},{name:"onInputDownFunction",fxn:bd.methodTag.phaserObject.onInputDownFunction,classOrInstance:"instance"},{name:"localChangeXY",fxn:bd.methodTag.phaserObject.localChangeXY,classOrInstance:"instance"},{name:"localSetXY",fxn:bd.methodTag.phaserObject.localSetXY,classOrInstance:"instance"},{name:"localMoveToXY",fxn:bd.methodTag.phaserObject.localMoveToXY,classOrInstance:"instance"},{name:"localDirection",
fxn:bd.methodTag.phaserObject.localDirection,classOrInstance:"instance"},{name:"getLocalDirection",fxn:bd.methodTag.phaserObject.getLocalDirection,classOrInstance:"instance"},{name:"getLocalXY",fxn:bd.methodTag.phaserObject.getLocalXY,classOrInstance:"instance"},{name:"getCurrentGrid",fxn:bd.methodTag.phaserObject.getCurrentGrid,classOrInstance:"instance"},{name:"getPreviousGrid",fxn:bd.methodTag.phaserObject.getPreviousGrid,classOrInstance:"instance"},{name:"getCurrentColumnOrRow",fxn:bd.methodTag.phaserObject.getCurrentColumnOrRow,
classOrInstance:"instance"},{name:"getStageId",fxn:bd.methodTag.phaserObject.getStageId,classOrInstance:"instance"},{name:"removeDisplayObject",fxn:bd.methodTag.phaserObject.removeDisplayObject,classOrInstance:"instance"},{name:"setTint",fxn:bd.methodTag.phaserObject.setTint,classOrInstance:"instance"},{name:"drawSpriteOnBitMap",fxn:bd.methodTag.phaserObject.drawSpriteOnBitMap,classOrInstance:"instance"}]}};
bd.methodTag.phaserObject.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});if(null!=a.viewId){bd.model.addModelUpdateElement([a.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});var b=bd.component.lookup(a.viewId);b.model.instanceIdToFollow==
this.id&&bd.model.addModelUpdateElement([b.id],"set","instanceIdToFollow",null,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})}bd.model.addModelUpdateElement([a.layerId],"removeValue","entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.methodTag.phaserObject.removeInstanceFromView=function(){this.removeDisplayObject()};
bd.methodTag.phaserObject.canCreateInstance=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()).getSelectedLayerId(),b=bd.component.melonView.tmxEntityLayer.componentProperties.type;return bd.component.lookup(a).type==b};
bd.methodTag.phaserObject.addEntity=function(){var a=bd.component.lookup(this.model.viewId),b=this.createDisplayObject(),a=bd.model.entityLookup(bd.player.ctr.playerId),a=bd.component.lookup(a.viewId);a.getPhaserGameObject();b.instanceId=this.id;b.inputEnabled=!0;this.model.draggable&&b.input.enableDrag();b.visible=this.model.visible;b.tint=parseInt(this.model.tint.substr(1),16);if("flip"==this.model.rotationStyle||"none"==this.model.rotationStyle)b.rotationAngle=this.model.direction;this.setAnchor(b);
b.events&&(b.events.onInputDown.add(this.onInputDownFunction,this),b.events.onInputUp.add(this.onInputUpFunction,this));bd.component.lookup(this.model.layerId).model.isCameraLayer&&(b.fixedToCamera=!0);this.setDisplayObject(b);this.setDragRestriction();this.setWidthHeight();a.getLayer(this.model.layerId).add(b);return!0};
bd.methodTag.phaserObject.saveStateInModel=function(){this.getDisplayObject().x!=this.model.x&&bd.model.addModelUpdateElement([this.id],"set","x",this.getDisplayObject().x,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});this.getDisplayObject().y!=this.model.y&&bd.model.addModelUpdateElement([this.id],"set","y",this.getDisplayObject().y,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});this.getDisplayObject().angle!=
this.model.direction&&bd.model.addModelUpdateElement([this.id],"set","direction",this.getDisplayObject().angle,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1})};bd.methodTag.phaserObject.setAnchor=function(a){"percent"==this.model.offsetType&&a.anchor.setTo(this.model.offsetX,this.model.offsetY)};
bd.methodTag.phaserObject.createDisplayObject=function(){var a=bd.component.lookup(this.model.viewId),b=a.getPhaserGameObject(),a=a.getPhaserObject(),c=bd.model.entityLookup(this.model.costumeId).assetId;return new a.Sprite(b,this.model.x,this.model.y,"assetId:"+c)};
bd.methodTag.phaserObject.onInputUpFunction=function(a,b){var c=bd.component.lookup(bd.model.getCurrentViewId());c.getPhaserGameObject();if(c.pointerIdsDown[b.id]&&c.pointerIdsDown[b.id].mouseMove&&a.input.draggable){if(null!=this.getCurrentGrid()){var c=null===this.getCurrentColumnOrRow().COLUMN?"nullObject":this.getCurrentColumnOrRow().COLUMN+1,e=null===this.getCurrentColumnOrRow().ROW?"nullObject":this.getCurrentColumnOrRow().ROW+1;bd.evaluator.ctr.beforeWhenDroppedOnGrid("BEFORE",a.instanceId,
this.getCurrentGrid().id,c,e)}else null!=this.getPreviousGrid()&&bd.evaluator.ctr.beforeWhenRemovedFromGrid("BEFORE",a.instanceId,this.getPreviousGrid().id,a.x,a.y);bd.model.addModelUpdateElement([a.instanceId],"set","x",a.x,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.instanceId],"set","y",a.y,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.whenPhaserPhysicsPlaced(a.instanceId,
a.dragStartX,a.dragStartY);null!=this.getCurrentGrid()?(e=bd.component.lookup(this.getCurrentGrid().id),c=null===e.getColumnRowByXY(a.dragStartX,a.dragStartY).COLUMN?"nullObject":e.getColumnRowByXY(a.dragStartX,a.dragStartY).COLUMN+1,e=null===e.getColumnRowByXY(a.dragStartX,a.dragStartY).ROW?"nullObject":e.getColumnRowByXY(a.dragStartX,a.dragStartY).ROW+1,bd.evaluator.ctr.beforeWhenDroppedOnGrid("WHEN",a.instanceId,this.getCurrentGrid().id,c,e)):null!=this.getPreviousGrid()&&(e=bd.component.lookup(this.getPreviousGrid().id),
c=null===e.getColumnRowByXY(a.dragStartX,a.dragStartY).COLUMN?"nullObject":e.getColumnRowByXY(a.dragStartX,a.dragStartY).COLUMN+1,e=null===e.getColumnRowByXY(a.dragStartX,a.dragStartY).ROW?"nullObject":e.getColumnRowByXY(a.dragStartX,a.dragStartY).ROW+1,bd.evaluator.ctr.beforeWhenRemovedFromGrid("WHEN",a.instanceId,this.getPreviousGrid().id,c,e))}else bd.evaluator.ctr.phaserPieceInstanceClicked(a.instanceId);bd.phaser.ctr.handlePointerUpDragMove(b)};
bd.methodTag.phaserObject.onInputDownFunction=function(a,b){var c=bd.component.lookup(bd.model.getCurrentViewId()),e=c.getPhaserGameObject();a.dragStartX=a.x;a.dragStartY=a.y;var f=!1;for(b in c.pointerIdsDown){f=!0;break}c.pointerIdsDown[b.id]={mouseMove:!1};f||e.input.addMoveCallback(this.moveCallback)};bd.methodTag.phaserObject.moveCallback=function(a){if(a=bd.component.lookup(bd.model.getCurrentViewId()).pointerIdsDown[a.id])a.mouseMove=!0;bd.methodTag.phaserObject.removeMoveCallbackIfNeeded()};
bd.methodTag.phaserObject.removeMoveCallbackIfNeeded=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()),b=a.getPhaserGameObject(),c=!1,e;for(e in a.pointerIdsDown)if(!a.pointerIdsDown[e].mouseMove){c=!0;break}c||b.input.deleteMoveCallback(this.moveCallback)};
bd.methodTag.phaserObject.getImageObject=function(){var a=bd.component.lookup(this.model.viewId).getPhaserGameObject(),b=bd.model.entityLookup(this.model.costumeId).assetId,c=bd.component.lookup(b);return c.spriteIdToBitMapData&&c.spriteIdToBitMapData[this.id]&&c.spriteIdToBitMapData[this.id].isUsingBitMapData?c.getBitMapData(this.id):imageObject=a.cache.getImage("assetId:"+b)};
bd.methodTag.phaserObject.setWidthHeight=function(a){var b=this.getImageObject(),c=b.height,b=b.width,e=1,f=1,g=bd.model.entityLookup(bd.player.ctr.playerId),g=bd.component.lookup(g.viewId);g.getPhaserGameObject();g.getWindow();g.getPhaserObject();this.model.flipHorizontal&&(e=-1);this.model.flipVertical&&(f=-1);"undefined"==typeof a&&(a=this.getDisplayObject());a.scale.setTo(e*this.model.width/b,f*this.model.height/c);this.setWidthHeightForBody&&this.setWidthHeightForBody()};
bd.methodTag.phaserObject.updateFlip=function(){var a=1,b=1,c=this.getDisplayObject();if(this.model.flipHorizontal&&0<c.scale.x||!this.model.flipHorizontal&&0>c.scale.x)a=-1;if(this.model.flipVertical&&0<c.scale.y||!this.model.flipVertical&&0>c.scale.y)b=-1;c.scale.setTo(a*c.scale.x,b*c.scale.y)};
bd.methodTag.phaserObject.hide=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().visible=!1);this.getWallCollideSprite&&null!=this.getWallCollideSprite()&&(this.getWallCollideSprite().visible=!1)};bd.methodTag.phaserObject.show=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().visible=!0);this.getWallCollideSprite&&null!=this.getWallCollideSprite()&&(this.getWallCollideSprite().visible=!0)};
bd.methodTag.phaserObject.afterLayerChanged=function(){var a=bd.model.entityLookup(bd.player.ctr.playerId).viewId;-1!=bd.component.lookup(a).getLayerIds().indexOf(parseInt(this.model.layerId))?null==this.getDisplayObject()&&this.addEntity():null!=this.getDisplayObject()&&this.removeInstanceFromView()};
bd.methodTag.phaserObject.moveToLayerXY=function(a,b,c){var e=!0;"local"==this.model.shareMode&&(e=!1);var f=!1;if(a!=this.model.layerId&&null!=a){bd.model.addModelUpdateElement([a],"push","entityIds",this.id,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!0,shouldPropagate:e});null!=this.model.layerId&&bd.model.addModelUpdateElement([this.model.layerId],"removeValue","entityIds",this.id,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!0,
shouldPropagate:e});var f=!0,g=bd.model.entityLookup(a).viewId;g!=this.model.viewId&&(bd.model.addModelUpdateElement([g],"push",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1,shouldPropagate:e}),null!=this.model.viewId&&bd.model.addModelUpdateElement([this.model.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1,shouldPropagate:e}),bd.model.addModelUpdateElement([this.id],
"set","viewId",g,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1,shouldPropagate:e}));bd.model.addModelUpdateElement([this.id],"set","layerId",a,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1,shouldPropagate:e})}if(e||f)a=e,bd.model.addModelUpdateElement([this.id],"set","x",b,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1,shouldPropagate:e}),bd.model.addModelUpdateElement([this.id],
"set","y",c,{updateUIForOrigin:a,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1,shouldPropagate:e});e||this.localMoveToXY(b,c);bd.model.sendUpdates()};bd.methodTag.phaserObject.setDraggable=function(){null!=this.getDisplayObject()&&(this.model.draggable?this.getDisplayObject().input.enableDrag():this.getDisplayObject().input.disableDrag())};
bd.methodTag.phaserObject.setDragRestriction=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().input.allowHorizontalDrag=this.model.allowHorizontalDrag,this.getDisplayObject().input.allowVerticalDrag=this.model.allowVerticalDrag)};
bd.methodTag.phaserObject.switchCostume=function(a){if(null!=this.getDisplayObject()){a=bd.model.entityLookup(a).assetId;var b=bd.component.lookup(a);b.spriteIdToBitMapData&&b.spriteIdToBitMapData[this.id]&&b.spriteIdToBitMapData[this.id].isUsingBitMapData?this.getDisplayObject().loadTexture(b.getBitMapData(this.id)):this.getDisplayObject().loadTexture("assetId:"+a);this.setWidthHeight()}};
bd.methodTag.phaserObject.updatePosition=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().x=this.model.x,this.getDisplayObject().y=this.model.y)};bd.methodTag.phaserObject.localChangeXY=function(a,b){null!=this.getDisplayObject()?"x"==a?this.getDisplayObject().x+=parseFloat(b):"y"==a&&(this.getDisplayObject().y+=parseFloat(b)):(bd.model.addModelUpdateElement([this.model.id],"change",a,b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates())};
bd.methodTag.phaserObject.localSetXY=function(a,b){null!=this.getDisplayObject()&&null!=this.getDisplayObject().body?"x"==a?this.getDisplayObject().x=parseFloat(b):"y"==a&&(this.getDisplayObject().y=parseFloat(b)):(bd.model.addModelUpdateElement([this.model.id],"set",a,b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates())};
bd.methodTag.phaserObject.localMoveToXY=function(a,b){null!=this.getDisplayObject()&&null!=this.getDisplayObject().body?(this.getDisplayObject().x=parseFloat(a),this.getDisplayObject().y=parseFloat(b)):(bd.model.addModelUpdateElement([this.model.id],"set","x",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.addModelUpdateElement([this.model.id],"set","y",b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),
bd.model.sendUpdates())};
bd.methodTag.phaserObject.localDirection=function(a,b){if(null!=this.getDisplayObject()){var c=this.getDisplayObject();if("flip"==this.model.rotationStyle||"none"==this.model.rotationStyle)"set"==b?this.getDisplayObject().rotationAngle=parseFloat(a):"change"==b&&(this.getDisplayObject().rotationAngle+=parseFloat(a));if("flip"==this.model.rotationStyle){var e=this.getDisplayObject().rotationAngle%360;((90>e||270<=e)&&0>c.scale.x||90<=e&&270>e&&0<c.scale.x)&&c.scale.setTo(-1*c.scale.x,c.scale.y)}if("rotate"==
this.model.rotationStyle||null==this.model.rotationStyle)"set"==b?this.getDisplayObject().angle=parseFloat(a):"change"==b&&(this.getDisplayObject().angle+=parseFloat(a))}else bd.model.addModelUpdateElement([this.model.id],b,"direction",a,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates()};
bd.methodTag.phaserObject.getLocalDirection=function(){return null!=this.getDisplayObject()?"flip"==this.model.rotationStyle||"none"==this.model.rotationStyle?this.getDisplayObject().rotationAngle%360:this.getDisplayObject().angle%360:this.model.direction%360};bd.methodTag.phaserObject.getLocalXY=function(a){return null!=this.getDisplayObject()?this.getDisplayObject()[a]:this.model[a]};
bd.methodTag.phaserObject.getCurrentGrid=function(){for(var a=bd.model.getEntityList("gridInstance"),b=0;b<a.length;b++)if(null!=a[b].playerId||"share"==a[b].shareMode){var c=a[b],e=this.model,f=c.x,g=c.y;if(null!=e&&e.x>=f&&e.x<=f+c.width&&e.y>=g&&e.y<=g+c.height)return c}return null};
bd.methodTag.phaserObject.getPreviousGrid=function(){for(var a=bd.model.getEntityList("gridInstance"),b=0;b<a.length;b++)if(null!=a[b].playerId||"share"==a[b].shareMode){var c=a[b],e=this.getDisplayObject(),f=c.x,g=c.y;if(null!=e&&e.dragStartX>=f&&e.dragStartX<=f+c.width&&e.dragStartY>=g&&e.dragStartY<=g+c.height)return c}return null};
bd.methodTag.phaserObject.getCurrentColumnOrRow=function(){var a=this.getCurrentGrid(),b=this.model;if(null!=a){for(var c=a.x-a.horizontalMargin,e=a.y-a.verticalMargin,f=0===this.model.horizontalMargin?1:2,g=0===this.model.horizontalMargin?1:2,h=1;h<=a.numColumns;h++)if(b.x<c+h*(a.tileWidth+a.horizontalMargin+f*a.borderThickness)){var k=h-1;break}for(h=1;h<=a.numRows;h++)if(b.y<e+h*(a.tileHeight+a.verticalMargin+g*a.borderThickness)){var l=h-1;break}return{COLUMN:k,ROW:l}}return{COLUMN:null,ROW:null}};
bd.methodTag.phaserObject.getStageId=function(){return bd.component.lookup(this.model.layerId).model.viewId};bd.methodTag.phaserObject.removeDisplayObject=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().kill(),this.setDisplayObject(null))};bd.methodTag.phaserObject.setTint=function(){if(null!=this.getDisplayObject()){var a=parseInt(this.model.tint.substr(1),16);isNaN(a)&&(a=16777215);this.getDisplayObject().tint=a}};
bd.methodTag.phaserObject.drawSpriteOnBitMap=function(a,b){if(!(0>=b.alpha.current||0===b.scale.x||0===b.scale.y||0===b.texture.crop.width||0===b.texture.crop.height)){var c=b.x,e=b.y;b.texture.trim&&(c+=b.texture.trim.x-b.anchor.x*b.texture.trim.width,e+=b.texture.trim.y-b.anchor.y*b.texture.trim.height);var f=b.texture.baseTexture.source;16777215!==b.tint&&(b.cachedTint!==b.tint&&(b.cachedTint=b.tint,b.tintedTexture=PIXI.CanvasTinter.getTintedTexture(b,b.tint)),f=b.tintedTexture);var g=a.context,
h=g.globalAlpha;g.save();g.globalAlpha=b.alpha;g.translate(c,e);g.rotate(b.rotation);g.scale(b.scale.x,b.scale.y);g.drawImage(f,-b.texture.crop.width*b.anchor.x,-b.texture.crop.height*b.anchor.y,b.texture.crop.width,b.texture.crop.height);g.restore();g.globalAlpha=h;a.dirty=!0}};bd.modelTag.tab={provideFields:function(){return[{fields:["name"],providers:["componentObject"]},{fields:["tabKey"],providers:["componentObject"]},{fields:["flexidorKey"],providers:["componentObject"]},{fields:["tabListContainerId"],providers:["function"],fxn:bd.modelTag.tab.provideTabListContainerId},{fields:["entityTypesToCreate"],providers:["componentObject"]},{fields:["overlayOnEntityCreate"],providers:["componentObject"]},{fields:["entityIds"],providers:["function"],fxn:bd.modelTag.tab.provideEntityIds},
{fields:["canCreateEntities"],providers:["componentObject"]},{fields:["minEntityNum"],providers:["componentObject"]},{fields:["maxEntityNum"],providers:["defaultValue"],defaultValue:null},{fields:["visible"],providers:["defaultValue"],defaultValue:!0}]}};
bd.modelTag.tab.provideTabListContainerId=function(){this.model.tabListContainerId=this.tabListContainerId;bd.model.addModelUpdateElement([this.tabListContainerId],"push","tabListIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});return!0};
bd.modelTag.tab.provideEntityIds=function(){this.model.entityIds=this.entityIds;0!=this.entityIds.length&&bd.model.addModelUpdateElement([this.entityIds],"push","tabIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});return!0};bd.modelTag.hasTabContainer={provideFields:function(){return[{fields:["tabIds"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.hasTabContainer.provideTabIds,removeConnectionFxn:bd.modelTag.hasTabContainer.removeTabIdsConnection}]}};
bd.modelTag.hasTabContainer.provideTabIds=function(){null==this.tabId?this.model.tabIds=[]:(this.model.tabIds=[this.tabId],bd.model.addModelUpdateElement(this.model.tabIds,"push","entityIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}));return!0};
bd.modelTag.hasTabContainer.removeTabIdsConnection=function(){var a=this.model;0!=a.tabIds.length&&bd.model.addModelUpdateElement(a.tabIds,"removeValue","entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.component.phaserPiece={constructor:function(a,b){goog.mixin(this,bd.component.phaserPiece.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.defaultPieceAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"phaserPiece",listName:"phaserPieces",idName:"phaserPieceId",idListName:"phaserPieceIds",editorDisplayObjectType:"image",sideBarPanelName:"sideBarPhaserPiecePanel",defaultImageUrlObject:{url:"images/qmarksq.png",
internal:!0},tabIconFileName:"class-icon-sprite.png",possibleLayerTypes:["tmxEntityLayer"],namePrefix:"Shared Sprite Class",typeName:"Shared Sprite",tabName:"Shared Sprites",entityName:"Shared Sprite Class",entityNamePlural:"Shared Sprite Classes",thisName:"this shared sprite class",allName:"all shared sprite classes",anyName:"any shared sprite class",randomName:"random shared sprite class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasCoordinateOffset hasViewId hasLayerId hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasTargetId".split(" "),
methodTags:["entity","canvasObject","phaserObject","phaserPiece"]},beforeCreateEntity:function(){bd.shareModeSelector.ctr.setupShareModeSelector()}};
bd.component.phaserPieceInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.phaserPieceInstance.componentProperties);this.layer=function(){return bd.pieceLayer};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"phaserPieceInstance",listName:"phaserPieceInstances",idName:"phaserPieceInstanceId",idListName:"phaserPieceInstanceIds",editorDisplayObjectType:"image",
hasPlayerEntitySelection:!0,namePrefix:"phaserPiece",entityName:"Shared Sprite",thisName:"this shared sprite",allName:"all shared sprites",anyName:"any shared sprite",randomName:"random shared sprite",modelTags:bd.component.phaserPiece.componentProperties.modelTags,methodTags:bd.component.phaserPiece.componentProperties.methodTags}};bd.component.typeNameToComponent.phaserPiece=bd.component.phaserPiece;bd.component.typeNameToComponent.phaserPieceInstance=bd.component.phaserPieceInstance;
bd.component.childNameToParentName.phaserPieceInstance="phaserPiece";bd.evaluator.ctr.blocks.control={};bd.evaluator.ctr.configs.wait={paramsInfo:[{name:"waitTime",type:"value",valueName:"SECONDS"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=1E3*b.params.waitTime,e=bd.evaluator.ctr.getCurrentCallStack().id;bd.evaluator.ctr.handleWaitTime(b,c,e,null,function(){bd.evaluator.ctr.nextBlockInCallStack(a.next)})}};
bd.evaluator.ctr.configs.controls_flow_statements={paramsInfo:[{name:"titleText",type:"field",fieldName:"FLOW"}],evalFunc:function(a){a=bd.evaluator.ctr.getCurrentStackObject().params.titleText;for(var b=bd.evaluator.ctr.getCurrentCallStack().getStackArray(),c=null,e=0;e<b.length;e++){var f=b[b.length-1-e];if(f.block&&bd.evaluator.ctr.configs[f.block._type]&&bd.evaluator.ctr.configs[f.block._type].isLoop){c=b.length-1-e+1;break}}null!=c&&(b.splice(c,b.length),"BREAK"==a&&(bd.evaluator.ctr.getCurrentStackObject().breakOutOfLoop=
!0),bd.evaluator.ctr.evaluateStack())}};
bd.evaluator.ctr.configs.forever_loop={isLoop:!0,evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.evaluator.ctr.getCurrentCallStack();b.breakOutOfLoop?(b.breakOutOfLoop=!1,b.hasRunThisTick=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next)):b.hasRunThisTick?(b.hasRunThisTick=!1,bd.evaluator.ctr.stackIdsForNextTick.push(c.id),bd.evaluator.ctr.currentCallStackId=null,bd.evaluator.ctr.continuePreviousStack()):(b.hasRunThisTick=!0,a.statement&&a.statement.block&&c.createStackObjectAndAddToStack(a.statement.block,
{}),bd.evaluator.ctr.evaluateStack())}};
bd.evaluator.ctr.configs.controls_for_each_list={paramsInfo:[{name:"loopList",type:"value",valueName:"LIST"},{name:"varTitle",type:"variableName",valueName:"VAR"}],isLoop:!0,evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.evaluator.ctr.getCurrentCallStack();if(b.breakOutOfLoop)b.breakOutOfLoop=!1,b.loopContext=null,bd.evaluator.ctr.nextBlockInCallStack(a.next);else{var e=b.loopContext;null==e?(b.loopContext={},e=b.loopContext,e.loopIndexNum=0,e.loopList=b.params.loopList):
e.loopIndexNum+=1;e.loopIndexNum<e.loopList.length?(b.context[b.params.varTitle.__text]={type:"value",value:e.loopList[e.loopIndexNum]},a.statement&&a.statement.block&&c.createStackObjectAndAddToStack(a.statement.block,{}),bd.evaluator.ctr.evaluateStack()):(b.loopContext=null,bd.evaluator.ctr.nextBlockInCallStack(a.next))}}};
bd.evaluator.ctr.configs.controls_for_count={paramsInfo:[{name:"startNumber",type:"value",valueName:"FROM"},{name:"endNumber",type:"value",valueName:"TO"},{name:"step",type:"value",valueName:"STEP"},{name:"varTitle",type:"variableName",valueName:"VAR"}],isLoop:!0,evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.evaluator.ctr.getCurrentCallStack();if(b.breakOutOfLoop)b.breakOutOfLoop=!1,b.loopContext=null,bd.evaluator.ctr.nextBlockInCallStack(a.next);else{var e=b.loopContext;
if(null==e){b.loopContext={};var e=b.loopContext,f=b.params.startNumber,g=b.params.endNumber,h=b.params.step;if(g<f&&0<h||g>f&&0>h)g=f;e.startNumber=f;e.endNumber=g;e.step=h;e.currentNum=e.startNumber}else e.currentNum+=e.step;e.currentNum>e.endNumber&&0<e.step||e.currentNum<e.endNumber&&0>e.step||0==e.step?(b.loopContext=null,bd.evaluator.ctr.nextBlockInCallStack(a.next)):(b.context[b.params.varTitle.__text]={type:"value",value:e.currentNum},a.statement&&a.statement.block&&c.createStackObjectAndAddToStack(a.statement.block,
{}),bd.evaluator.ctr.evaluateStack())}}};
bd.evaluator.ctr.configs.controls_if={evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.evaluator.ctr.getCurrentCallStack();b.currentParam="conditionValue";if(!b.conditionContext){b.conditionContext={};var e=b.conditionContext,f=1;a.mutation&&a.mutation._elseif&&(f+=parseInt(a.mutation._elseif));e.numberOfConditions=f}b.conditionContext.statementEvaluated?(b.conditionContext=null,bd.evaluator.ctr.nextBlockInCallStack(a.next)):(e=b.conditionContext,null!=e.currentCondition&&
b.params.conditionValue&&bd.evaluator.ctr.evaluatePossibleVariableName(b.params.conditionValue)?((e=bd.evaluator.ctr.getStatementFromBlock("DO"+e.currentCondition,a))&&c.createStackObjectAndAddToStack(e.block,{}),b.conditionContext.statementEvaluated=!0,bd.evaluator.ctr.evaluateStack()):(e.currentCondition=null==e.currentCondition?0:e.currentCondition+1,e.currentCondition<e.numberOfConditions?((e=bd.evaluator.ctr.getValueFromBlock("IF"+e.currentCondition,a))?c.createStackObjectAndAddToStack(e.block,
{}):bd.errorLog.ctr.printError(bd.msg.ERROR_EMPTY_SOCKET,[a._type]),b.params.conditionValue=!1,bd.evaluator.ctr.evaluateStack()):a.mutation&&a.mutation._else?((e=bd.evaluator.ctr.getStatementFromBlock("ELSE",a))&&c.createStackObjectAndAddToStack(e.block,{}),b.conditionContext.statementEvaluated=!0,bd.evaluator.ctr.evaluateStack()):(b.conditionContext=null,bd.evaluator.ctr.nextBlockInCallStack(a.next))))}};
bd.evaluator.ctr.configs.stop_blocks={paramsInfo:[{name:"stopType",type:"field",fieldName:"STOP_TYPE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.stopType;"ALL_SCRIPTS_SPRITES"!=b&&"ALL_SPRITES"!=b||bd.evaluator.ctr.stopAllSprites();"ALL_SCRIPTS_SPRITES"!=b&&"ALL_SCRIPTS"!=b&&"OTHER_SCRIPTS"!=b||bd.evaluator.ctr.stopAllScripts("OTHER_SCRIPTS"==b);"OTHER_SCRIPTS"!=b&&"ALL_SPRITES"!=b||bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.blocks.sounds={};bd.evaluator.ctr.configs.stop_sound={paramsInfo:[{name:"assetIdArray",type:"entity",fieldName:"SOUND"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.assetIdArray[0];(b=bd.component.lookup(b).getSoundObject())&&b.stop();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.play_sound={paramsInfo:[{name:"assetIdArray",type:"entity",fieldName:"SOUND"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.assetIdArray[0],c;c=bd.component.lookup(bd.model.getCurrentViewId()).getPhaserGameObject();if(bd.player.ctr.isCordova)b=bd.component.lookup(b),c=b.getSoundUrl(),b.model.isDefaultAsset&&(c=bd.util.getPhoneGapPath()+c),(new Media(c)).play();else{var e=bd.component.lookup(b).getSoundObject();e&&e.isPlaying||(c=c.add.audio("assetId:"+
b),bd.component.lookup(b).setSoundObject(c),bd.component.lookup(b).getSoundObject().play())}bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.configs.stop_all_sounds={paramsInfo:[],evalFunc:function(a){a=bd.model.getEntityList("assetSound");for(var b=0;b<a.length;b++){var c=bd.component.lookup(a[b].id).getSoundObject();c&&c.stop()}}};
bd.evaluator.ctr.configs.play_note={getParams:function(a){var b=[];b.push();b.push({name:"entityIdArray",type:"entity",fieldName:"CHANNEL"});"1"==a.mutation._has_note_input?b.push({name:"note",type:"value",valueName:"NOTE"}):b.push({name:"note",type:"field",fieldName:"NOTE"});b.push({name:"beats",type:"value",valueName:"BEATS"});b.push({name:"shouldWait",type:"field",fieldName:"SHOULD_WAIT"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.note,e=b.params.beats,
f=bd.component.lookup(b.params.entityIdArray[0]),g=60/f.model.tempo*e*1E3,h=bd.evaluator.ctr.getCurrentCallStack().id,k=function(){f.play(c,e)},l=function(){bd.evaluator.ctr.nextBlockInCallStack(a.next)};"NO_WAIT"==b.params.shouldWait?(k(),l()):bd.evaluator.ctr.handleWaitTime(b,g,h,k,l)}};bd.evaluator.ctr.configs.play_stop_all_notes={paramsInfo:[],evalFunc:function(a){MIDI.stopAllNotes();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.play_set_volume={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"CHANNEL"},{name:"volume",type:"value",valueName:"VOLUME"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,b=parseInt(1.27*b.params.volume);bd.model.addModelUpdateElement(c,"set","volume",b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.play_set_tempo={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"CHANNEL"},{name:"tempo",type:"value",valueName:"TEMPO"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","tempo",b.params.tempo,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.play_set_instrument={getParams:function(a){var b=[];b.push({name:"entityIdArray",type:"entity",fieldName:"CHANNEL"});"number"==a.mutation._instrument_number_or_name?b.push({name:"instrument",type:"value",valueName:"INSTRUMENT"}):b.push({name:"instrument",type:"field",fieldName:"INSTRUMENT"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,b=b.params.instrument,e=bd.component.lookup(c[0]),b=parseInt(b)-1;e.setInstrument(b);
bd.model.addModelUpdateElement(c,"set","instrument",b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.methodTag.gridTile={provideMethods:function(){return[{name:"hide",fxn:bd.methodTag.phaserObject.hide},{name:"show",fxn:bd.methodTag.phaserObject.show},{name:"switchCostume",fxn:bd.methodTag.gridTile.switchCostume},{name:"getCostumeIds",fxn:bd.methodTag.gridTile.getCostumeIds},{name:"setWidthHeight",fxn:bd.methodTag.gridTile.setWidthHeight},{name:"setDisplayObject",fxn:bd.methodTag.canvasObject.setDisplayObject},{name:"getDisplayObject",fxn:bd.methodTag.canvasObject.getDisplayObject}]}};
bd.methodTag.gridTile.setWidthHeight=function(){if(bd.inPlayer){var a=bd.component.lookup(bd.entityLookup[this.id].gridId),b=bd.component.lookup(a.model.viewId).getPhaserGameObject(),c=bd.model.entityLookup(this.model.costumeId).assetId,c=b.cache.getImage("assetId:"+c),b=c.height,c=c.width;this.getDisplayObject().children[0].scale.setTo(a.model.tileWidth/c,a.model.tileHeight/b)}else bd.methodTag.canvasObject.setWidthHeight.call(this)};bd.methodTag.gridTile.getCostumeIds=function(){return bd.entityLookup[bd.entityLookup[bd.entityLookup[this.id].gridId].parentId].costumeIds};
bd.methodTag.gridTile.switchCostume=function(a){bd.inPlayer?null!=this.getDisplayObject()&&(this.getDisplayObject().children[0].loadTexture("assetId:"+bd.model.entityLookup(a).assetId),this.setWidthHeight()):bd.methodTag.canvasObject.switchCostume.call(this,a)};bd.modelTag.hasTileProperties={provideFields:function(){return[{fields:["costumeId"],providers:["srcInstance","componentObject"]},{fields:["visible"],providers:["srcInstance","componentObject"]},{fields:["gridId"],providers:["function"],fxn:bd.modelTag.hasTileProperties.gridTileId},{fields:["row"],providers:["srcInstance","componentObject"]},{fields:["column"],providers:["srcInstance","componentObject"]}]}};
bd.modelTag.hasTileProperties.gridTileId=function(){this.model.gridId=this.gridId;bd.model.addModelUpdateElement([this.gridId],"push","gridTiles",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});return!0};bd.component.gridTile={constructor:function(a,b,c,e,f,g){goog.mixin(this,bd.component.gridTile.componentProperties);this.gridId=b;this.row=c;this.column=e;this.visible=f;this.costumeId=g;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"gridTile",listName:"gridTiles",idName:"gridTileId",idListName:"gridTileIds",editorDisplayObjectType:"image",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},
possibleLayerTypes:["tmxEntityLayer"],namePrefix:"Grid Tile Class",typeName:"Grid Tile",tabName:"Grid Tiles",entityName:"Grid Tile Class",entityNamePlural:"Grid Tile Classes",thisName:"this grid tile class",allName:"all grid tile classes",anyName:"any grid tile class",randomName:"random grid tile class",modelTags:["entity","hasTileProperties"],methodTags:["entity","canvasObject","phaserObject","gridTile"]}};
bd.component.gridTile.showEntitySelectionRow=function(a,b,c,e){document.getElementById("gridTileEntitySelction"+e).style.display="block"};bd.component.gridTile.shouldShowEntitySelectionRow=function(){return 0!=bd.model.getEntityList("grid").length};bd.component.typeNameToComponent.gridTile=bd.component.gridTile;bd.methodTag.scriptPage={provideMethods:function(){return[{name:"setBlockly",fxn:bd.methodTag.scriptPage.setBlockly},{name:"getBlockly",fxn:bd.methodTag.scriptPage.getBlockly},{name:"hide",fxn:bd.methodTag.scriptPage.hide},{name:"show",fxn:bd.methodTag.scriptPage.show},{name:"addToView",fxn:bd.methodTag.scriptPage.addToView},{name:"saveScriptToEntity",fxn:bd.methodTag.scriptPage.saveScriptToEntity},{name:"loadScript",fxn:bd.methodTag.scriptPage.loadScript}]}};
bd.methodTag.scriptPage.setBlockly=function(a){this.Blockly=a;this.Blockly.bd=bd;this.loadScript();this.firstChangeEventFired=!1;this.Blockly.bindEvent_(this.Blockly.mainWorkspace.getCanvas(),"blocklyWorkspaceChange",this,function(){this.firstChangeEventFired?(this.saveScriptToEntity(),bd.mobileConnect.ctr.gameUpdatedHandler()):(bd.editor.ctr.ignoreChangesInSaveFileCheck(function(){this.saveScriptToEntity()},this),this.firstChangeEventFired=!0,bd.script.ctr.updateWarningsAfterAllScriptPagesLoaded())})};
bd.methodTag.scriptPage.getBlockly=function(){return this.Blockly};bd.methodTag.scriptPage.hide=function(){document.getElementById("scriptFrame"+this.id).style.display="none"};bd.methodTag.scriptPage.show=function(){document.getElementById("scriptFrame"+this.id).style.display="block";var a=this.getBlockly();this.isInitialized||(a&&a.mainWorkspace.render(),this.isInitialized=!0);a&&(a.mainWorkspace.scriptPageFlyout.updateFlyoutUI(),1!=bd.script.ctr.switchMode&&2!=bd.script.ctr.switchMode||a.WarningHandler.checkAllBlocksForWarningsAndErrors())};
bd.methodTag.scriptPage.addToView=function(){var a=document.getElementById("scriptPanelContainer");if(window.IS_CHROME_APP){var b=goog.dom.createDom("div"),c=bd.chrome_app.ctr.scriptContent("scriptFrame"+this.id,this.id);b.innerHTML=c}else{var b=goog.dom.createDom("iframe"),c=bd.gitRevision,e="/blocklyFrame/?scriptPageId="+this.id;""!=c&&(e+="&rev="+c);b.src=e}b.id="scriptFrame"+this.id;b.style.height="100%";b.style.width="calc(100% - 290px)";b.style.position="absolute";b.style.top="0px";b.style.left=
"250px";b.style.zIndex=5;b.style.display="none";a.appendChild(b)};bd.methodTag.scriptPage.saveScriptToEntity=function(){var a=this.Blockly.Xml.workspaceToDom(this.Blockly.mainWorkspace);this.model.scripts=this.Blockly.Xml.domToText(a);this.model.scriptObject=bd.script.ctr.X2JS.xml_str2json(this.Blockly.Xml.domToText(a))};
bd.methodTag.scriptPage.loadScript=function(){bd.script.ctr.oldBlockIdToNewBlockId={};var a=this.Blockly.Xml.textToDom(this.model.scripts);this.Blockly.Xml.domToWorkspace(this.Blockly.mainWorkspace,a);bd.editor.ctr.ignoreChangesInSaveFileCheck(function(){for(var a in bd.model.getGameInfo().keyCodeToEntityAndBlockId){var c=bd.model.getGameInfo().keyCodeToEntityAndBlockId[a],e=c[this.id];if(null!=e){var f={},g;for(g in e)f[bd.script.ctr.oldBlockIdToNewBlockId[g]]=!0;c[this.id]=f}}a=this.Blockly.mainWorkspace.getAllBlocks();
for(c=0;c<a.length;c++)null!=bd.blocks.ctr.getEntityTitles(a[c])&&(bd.blocks.ctr.updateTitleOptions(bd.blocks.ctr.getEntityTitles(a[c]),a[c],!0),this.Blockly.WarningHandler.checkIOForWarningsAndErrors.call(a[c]));bd.model.switchEntityBlockIds(this.id,bd.script.ctr.oldBlockIdToNewBlockId)},this)};bd.modelTag.hasTutorialStepProperties={provideFields:function(){return[{fields:["tutorialObjectIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]}]}};
bd.modelTag.hasTutorialObjProperties={provideFields:function(){return[{fields:["marginTop"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["marginLeft"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["objWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:250},{fields:["objHeight"],classOrInstance:"class",providers:["defaultValue"],defaultValue:100}]}};
bd.modelTag.hasOvalProperties={provideFields:function(){return[{fields:["color"],classOrInstance:"class",providers:["defaultValue"],defaultValue:16777215}]}};bd.modelTag.hasTextboxProperties={provideFields:function(){return[{fields:["textboxText"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""}]}};bd.modelTag.hasGravity={requiredFields:["gravityX","gravityY"],provideFields:function(){return[{fields:["gravityX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["gravityY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:10}]}};
bd.modelTag.hasViewHeightWidth={requiredFields:["height","width"],provideFields:function(){return[{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:480},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:640}]}};bd.stack={};bd.stack.ctr={};bd.stack.ctr.nextId=1;bd.stack.ctr.callStackIdToCallStack={};bd.stack.ctr.getCallStackById=function(a){return bd.stack.ctr.callStackIdToCallStack[a]};bd.stack.ctr.deleteCallStack=function(a){delete bd.stack.ctr.callStackIdToCallStack[a]};bd.stack.ctr.deleteAllCallStacks=function(a){var b=bd.evaluator.ctr.getCurrentCallStack(),c=null;null!=b&&(c=b.id);for(var e in bd.stack.ctr.callStackIdToCallStack)a&&null!=c&&e==c||bd.stack.ctr.deleteCallStack(e)};
bd.stack.ctr.callStack=function(){this.id=bd.stack.ctr.nextId++;bd.stack.ctr.callStackIdToCallStack[this.id]=this;this.stackArray=[]};bd.stack.ctr.callStack.prototype.getCurrentStackObject=function(){return 0==this.stackArray.length?null:this.stackArray[this.stackArray.length-1]};bd.stack.ctr.callStack.prototype.removeLastStackObject=function(){this.stackArray.pop()};bd.stack.ctr.callStack.prototype.createStackObjectAndAddToStack=function(a,b){var c=new bd.stack.ctr.stackObject(a,b);this.addStackObject(c)};
bd.stack.ctr.callStack.prototype.addStackObject=function(a){this.stackArray.push(a)};bd.stack.ctr.callStack.prototype.getLength=function(){return this.stackArray.length};bd.stack.ctr.callStack.prototype.getStackArray=function(){return this.stackArray};bd.stack.ctr.stackObject=function(a,b){this.block=a;this.context=b;this.params={}};bd.stack.ctr.stackObject.prototype.getBlock=function(){return this.block};bd.stack.ctr.stackObject.prototype.setBlock=function(a){this.block=a};
bd.stack.ctr.stackObject.prototype.resetStackObject=function(a,b){this.block=a;this.context={};b&&(this.context=b);this.params={}};bd.modelTag.hasPieceInstanceIds={requiredFields:["pieceInstanceIds"],provideFields:function(){return[{fields:["pieceInstanceIds"],classOrInstance:"instance",providers:["srcInstance","defaultValue"],defaultValue:[]}]}};bd.component.path={constructor:function(a){goog.mixin(this,bd.component.path.componentProperties);null==a&&(this.defaultImageId=bd.defaultPathAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"path",listName:"paths",idName:"pathId",idListName:"pathIds",sideBarPanelName:"sideBarPathPanel",defaultImageUrlObject:{url:"images/greensq.png",internal:!0},editorDisplayObjectType:"image",namePrefix:"Target Class",
typeName:"Target",tabName:"Targets",entityName:"Target Class",entityNamePlural:"Target Classes",thisName:"this target class",allName:"all target classes",anyName:"any target class",randomName:"random target class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasViewId hasCostume perPlayer hasTraits hasScripts hasPieceInstanceIds".split(" "),methodTags:["entity","canvasObject"]}};
bd.component.target={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.target.componentProperties);this.layer=function(){return bd.targetLayer};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"target",listName:"targets",idName:"targetId",idListName:"targetIds",editorDisplayObjectType:"image",namePrefix:"target",entityName:"Target",thisName:"this target",
allName:"all targets",anyName:"any target",randomName:"random target",modelTags:bd.component.path.componentProperties.modelTags,methodTags:bd.component.path.componentProperties.methodTags}};bd.component.typeNameToComponent.path=bd.component.path;bd.component.typeNameToComponent.target=bd.component.target;bd.component.childNameToParentName.target="path";bd.methodTag.tmxLayer={provideMethods:function(){return[{name:"updateEditorVisibility",fxn:bd.methodTag.tmxLayer.updateEditorVisibility,classOrInstance:"class"},{name:"afterComponentCreated",fxn:bd.methodTag.tmxLayer.afterComponentCreated,classOrInstance:"class"},{name:"addLayerToMap",fxn:bd.methodTag.tmxLayer.addLayerToMap,classOrInstance:"class"},{name:"moveLayer",fxn:bd.methodTag.tmxLayer.moveLayer,classOrInstance:"class"},{name:"removeEntitiesFromEditorLayer",fxn:bd.methodTag.tmxLayer.removeEntitiesFromEditorLayer},
{name:"removeEntitiesFromLayer",fxn:bd.methodTag.tmxLayer.removeEntitiesFromLayer},{name:"saveStateInModelForEntitiesFromLayer",fxn:bd.methodTag.tmxLayer.saveStateInModelForEntitiesFromLayer},{name:"getEntityIdsOnLocalLayer",fxn:bd.methodTag.tmxLayer.getEntityIdsOnLocalLayer},{name:"getEditorLayer",fxn:bd.methodTag.tmxLayer.getEditorLayer},{name:"getBlockName",fxn:bd.methodTag.tmxLayer.getBlockName}]}};
bd.methodTag.tmxLayer.handleCommand=function(a){return bd.inPlayer||"visible"!=a.property?!1:(this.updateEditorVisibility(),!0)};bd.methodTag.tmxLayer.afterComponentCreated=function(){this.addLayerToMap()};
bd.methodTag.tmxLayer.addLayerToMap=function(){if(null!=this.model.tmxMapId){var a=bd.model.entityLookup(this.model.tmxMapId).layerIds;0!=a.length&&"uiLayer"==bd.component.lookup(a[a.length-1]).type?(a.splice(a.length-1,0,this.id),bd.model.addModelUpdateElement([this.model.tmxMapId],"set","layerIds",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1})):bd.model.addModelUpdateElement([this.model.tmxMapId],"push","layerIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!1,
updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();this.model.viewId==bd.model.getCurrentViewId()&&bd.component.melonView.setupCanvasView(this.model.viewId)}};
bd.methodTag.tmxLayer.moveLayer=function(a){var b=bd.model.entityLookup(this.model.tmxMapId).layerIds,c=b.indexOf(this.id);if(-1!=c){var e=b[b.length-1];0==c&&"down"==a||c==b.length-1&&"up"==a||c==b.length-1&&"uiLayer"==bd.model.entityLookup(e).type||c==b.length-2&&"up"==a&&"uiLayer"==bd.model.entityLookup(e).type||("up"==a?(b[c]=b[c+1],b[c+1]=this.id):"down"==a&&(b[c]=b[c-1],b[c-1]=this.id),bd.model.addModelUpdateElement([this.model.tmxMapId],"set","layerIds",b,{updateUIForOrigin:!1,updateModelForOrigin:!1,
updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.sendUpdates(),this.model.viewId==bd.model.getCurrentViewId()&&bd.component.melonView.setupCanvasView(this.model.viewId),bd.layerPanel.ctr.setupLayerPanel())}};bd.methodTag.tmxLayer.removeEntitiesFromEditorLayer=function(){if(this.model.entityIds)for(var a=this.model.entityIds,b,c=0;c<a.length;c++)if(b=bd.component.lookup(a[c]).getDisplayObject(),null!=b){var e=b.getLayer();b.remove();e.batchDraw();bd.component.lookup(a[c]).setDisplayObject(null)}};
bd.methodTag.tmxLayer.saveStateInModelForEntitiesFromLayer=function(){var a=this.getEntityIdsOnLocalLayer();if(a)for(var b=0,c;c=a[b];b++)c=bd.component.lookup(c),c.getDisplayObject()&&c.saveStateInModel&&c.saveStateInModel()};bd.methodTag.tmxLayer.removeEntitiesFromLayer=function(){var a=this.getEntityIdsOnLocalLayer();if(a)for(var b=0,c;c=a[b];b++)c=bd.component.lookup(c),c.getDisplayObject()&&(c.removeEntityFromView&&c.removeEntityFromView(),c.setDisplayObject(null))};
bd.methodTag.tmxLayer.getEntityIdsOnLocalLayer=function(){var a=[];if(!this.model.entityIds)return a;for(var b=0,c;c=this.model.entityIds[b];b++){var e=bd.component.lookup(c).model;"perPlayer"!=e.shareMode&&"local"!=e.shareMode||null!=e.playerId?("share"==e.shareMode||"local"==e.shareMode||"perPlayer"==e.shareMode&&e.visibleToPlayerId==bd.player.ctr.playerId)&&a.push(c):(c=e.playerIdsToChildInstanceIds[bd.player.ctr.playerId],bd.model.entityLookup(c)&&bd.model.entityLookup(c).layerId==e.layerId&&
a.push(c))}return a};bd.methodTag.tmxLayer.getEditorLayer=function(){var a="tmxLayer"+this.model.id;return bd.component.lookup(this.model.viewId).getLayer(a)};bd.methodTag.tmxLayer.getBlockName=function(){return bd.model.entityLookup(this.model.viewId).name};bd.methodTag.view={provideMethods:function(){return[{name:"changeView",fxn:bd.methodTag.view.changeView},{name:"setupView",fxn:bd.methodTag.view.setupView},{name:"updateTabsForView",fxn:bd.methodTag.view.updateTabsForView},{name:"removeView",fxn:bd.methodTag.view.removeView},{name:"getWindow",fxn:bd.methodTag.view.getWindow},{name:"isPropertyFromComponentOnView",fxn:bd.methodTag.view.isPropertyFromComponentOnView},{name:"isInComponentsOnView",fxn:bd.methodTag.view.isInComponentsOnView},{name:"setupEditorViewFrame",
fxn:bd.methodTag.view.setupEditorViewFrame},{name:"setupPlayerViewFrame",fxn:bd.methodTag.view.setupPlayerViewFrame},{name:"setViewAsInitialized",fxn:bd.methodTag.view.setViewAsInitialized},{name:"setupEditorKineticView",fxn:bd.methodTag.view.setupEditorKineticView},{name:"populateEditorDisplayObjects",fxn:bd.methodTag.view.populateEditorDisplayObjects},{name:"removeEditorViewFrame",fxn:bd.methodTag.view.removeEditorViewFrame},{name:"removePlayerViewFrame",fxn:bd.methodTag.view.removePlayerViewFrame},
{name:"removeEditorKineticView",fxn:bd.methodTag.view.removeEditorKineticView},{name:"removeEditorDisplayObjects",fxn:bd.methodTag.view.removeEditorDisplayObjects},{name:"getCanvasViewTop",fxn:bd.methodTag.view.getCanvasViewTop},{name:"getCanvasViewLeft",fxn:bd.methodTag.view.getCanvasViewLeft},{name:"getEditorViewHeightWidth",fxn:bd.methodTag.view.getEditorViewHeightWidth},{name:"getPlayerViewHeightWidth",fxn:bd.methodTag.view.getPlayerViewHeightWidth},{name:"updateEditableEntitiesOnView",fxn:bd.methodTag.view.updateEditableEntitiesOnView},
{name:"getLayerPanelButtons",fxn:bd.methodTag.view.getLayerPanelButtons}]}};bd.methodTag.view.handleCommand=function(a){return!1};bd.methodTag.view.setupView=function(){!bd.inPlayer&&this.isKineticJSView?this.setupEditorKineticView():bd.inPlayer||this.isKineticJSView?bd.inPlayer&&this.setupPlayerViewFrame():(this.setupEditorViewFrame(),this.updateTabsForView())};
bd.methodTag.view.updateTabsForView=function(){var a=bd.entityTab.ctr.getTabIdsForView();-1==a.indexOf(bd.editorSettings.currentEntityTabId)&&bd.entityTab.ctr.switchEntityTab(a[0]);bd.updateSelections();bd.sideBar.ctr.updateSideBar()};bd.methodTag.view.setupEditorKineticView=function(){bd.stage.setWidth(this.model.width+bd.editorSettings.viewOffsetX);document.getElementById("gameWorkspace").style.width=this.model.width+bd.editorSettings.viewOffsetX};
bd.methodTag.view.setupEditorViewFrame=function(){var a=document.createElement("div");a.id="viewFrame"+this.id;a.style.height=this.model.height;a.style.width=this.model.width;a.style.backgroundColor="red";document.getElementById("viewFrameContainer").appendChild(a)};
bd.methodTag.view.setupPlayerViewFrame=function(){if(null!=document.getElementById("viewFrame_"+this.type))document.getElementById("viewFrame_"+this.type).style.display="block";else{var a=this.getPlayerViewHeightWidth();if(window.IS_CHROME_APP){console.log("Chrome app phaser frame");var b=document.createElement("iframe");b.setAttribute("src","phaser_stage.html")}else{if(bd.player.ctr.hasNoFrames){b=document.createElement("div");b.id="viewFrame_"+this.type;var c=this.model.hasCamera?this.model.cameraHeight:
a.height,a=this.model.hasCamera?this.model.cameraWidth:a.width;bd.player.ctr.isStandalone||(b.style.height=window.screen.height-120+"px",b.style.width=window.screen.width+"px")}else b=document.createElement("iframe"),b.id="viewFrame_"+this.type,b.src=this.playerFrameFile+"?rev="+bd.gitRevision,c=this.model.hasCamera?this.model.cameraHeight:a.height,a=this.model.hasCamera?this.model.cameraWidth:a.width,b.style.height=c,b.style.width=a;b.style.border="0px"}document.getElementById("viewFrameContainer").appendChild(b);
bd.player.ctr.hasNoFrames&&bd.phaser.ctr.setupPhaserGame()}};bd.methodTag.view.setViewAsInitialized=function(){this.isInitialized=!0;bd.model.getGameInfo().isMultiplayer||bd.evaluator.ctr.startGame()};bd.methodTag.view.populateEditorDisplayObjects=function(){};bd.methodTag.view.removeView=function(){!bd.inPlayer&&this.isKineticJSView?(this.removeEditorDisplayObjects(),this.removeEditorKineticView()):bd.inPlayer||this.isKineticJSView?bd.inPlayer&&this.removePlayerViewFrame():this.removeEditorViewFrame()};
bd.methodTag.view.removeEditorKineticView=function(){bd.stage.setWidth(bd.editorSettings.viewOffsetX);document.getElementById("gameWorkspace").style.width=bd.editorSettings.viewOffsetX;bd.updateSelections()};bd.methodTag.view.removeEditorViewFrame=function(){var a=document.getElementById("viewFrameContainer"),b=document.getElementById("viewFrame"+this.id);b&&a.removeChild(b);bd.editor.ctr.setSelectedInstanceId(null)};
bd.methodTag.view.removePlayerViewFrame=function(){document.getElementById("viewFrame_"+this.type).style.display="none"};bd.methodTag.view.removeEditorDisplayObjects=function(){};bd.methodTag.view.changeView=function(a){var b=bd.editorSettings.currentViewId;bd.editorSettings.currentViewId=this.id;if(bd.editorSettings.currentViewId!=b||a)bd.component.lookup(b).removeView(),this.setupView()};
bd.methodTag.view.getWindow=function(){return bd.inPlayer?document.getElementById("noFrames")&&"true"==document.getElementById("noFrames").innerHTML?window:bd.player.ctr.window.document.getElementById("viewFrame_"+this.type).contentWindow:window};bd.methodTag.view.isInComponentsOnView=function(a){for(var b=0;b<this.componentsOnView.length;b++)if(this.componentsOnView[b]==a)return!0;return!1};
bd.methodTag.view.isPropertyFromComponentOnView=function(a){for(var b=0;b<this.componentsOnView.length;b++)if(bd.component[this.componentsOnView[b]].componentProperties.idListName==a)return!0;return!1};bd.methodTag.view.getCanvasViewTop=function(){return bd.inPlayer||!this.isKineticJSView?0:bd.editorSettings.viewOffsetY};bd.methodTag.view.getCanvasViewLeft=function(){return bd.inPlayer||!this.isKineticJSView?0:bd.editorSettings.viewOffsetX};bd.methodTag.view.getEditorViewHeightWidth=function(){return this.getPlayerViewHeightWidth()};
bd.methodTag.view.getPlayerViewHeightWidth=function(){return{height:this.model.height,width:this.model.width}};
bd.methodTag.view.updateEditableEntitiesOnView=function(){var a=this.getSelectedLayerId();bd.component.lookup(a);for(var b,a=0;a<this.componentsOnView.length;a++){b=bd.component.typeNameToComponent[this.componentsOnView[a]].componentProperties.idListName;var c=this.model[b];null==c&&(this.model[b]=[],c=this.model[b]);for(var e=0;e<c.length;e++){var f=bd.component.lookup(c[e]);b=bd.component.lookup(f.model.layerId);f.getDisplayObject()&&(b.model.isEditorEntitiesDragLocked?f.getDisplayObject().setDraggable(!1):
f.getDisplayObject().setDraggable(!0))}}};bd.methodTag.view.getLayerPanelButtons=function(){return this.layerPanelButtons};bd.modelTag.hasMelonProperties={requiredFields:[],provideFields:function(){return[{fields:["tmxFile"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["tmxMapId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null,removeConnectionFxn:bd.modelTag.hasMelonProperties.removeTmxMap},{fields:["instanceIdToFollow"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["gridHeight"],classOrInstance:"class",providers:["defaultValue"],defaultValue:15},
{fields:["gridWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:20},{fields:["tileHeight"],classOrInstance:"class",providers:["defaultValue"],defaultValue:32},{fields:["tileWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:32}]}};bd.modelTag.hasMelonProperties.removeTmxMap=function(){bd.component.lookup(this.model.tmxMapId).deleteEntity()};bd.component.melonView={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.melonView.componentProperties);this.model=null!=a?a:{};var b=null==a;null==a&&(this.defaultImageId=bd.defaultGameViewAsset.id,bd.component.addComponentListToComponent(this,bd.component.melonView.componentProperties.componentsOnView,"idListName"));bd.modelTag.applyTags(this,b);bd.methodTag.applyMethodTags(this);null==a&&this.afterComponentCreated()},componentProperties:{classOrInstance:"class",
type:"melonView",listName:"melonViews",idName:"melonViewId",idListName:"melonViewIds",sideBarPanelName:"sideBarMelonViewPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},editorDisplayObjectType:"image",minimumEntitiesInList:1,layerNameToObject:{},isKineticJSView:!0,editorFrameFile:"melonEditorView.html",playerFrameFile:"melonPlayerView.html",isView:!0,isInitialized:!1,componentsOnView:["melonPieceInstance"],xTileOffset:10,yTileOffset:10,melonjsPanelWidth:250,selectedLayerBoxNum:0,
selectedLayerId:null,layerPageNum:0,layerDetailPanels:{},namePrefix:"melon view",typeName:"Melon View",tabName:"Melon Views",entityName:"Melon View",entityNamePlural:"Melon Views",thisName:"this melon view",allName:"all melon views",anyName:"any melon view",randomName:"random melon view",modelTags:"entity hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasScripts hasViewHeightWidth hasMelonProperties".split(" "),methodTags:["entity","view","gameView","frameView","melonView"]},beforeCreateEntity:function(){bd.component.melonView.setupGridSizeSelector(null,
bd.component.melonView.componentProperties.type)},initializeComponent:function(){for(var a in bd.component.typeNameToComponent){var b=bd.component.typeNameToComponent[a].componentProperties.layerDetailPanel;b&&(bd.component.melonView.componentProperties.layerDetailPanels[b]=!0)}}};bd.component.typeNameToComponent.melonView=bd.component.melonView;bd.methodTag.tmxEntityLayer={provideMethods:function(){return[{name:"setupLayerDetailPanel",fxn:bd.methodTag.tmxEntityLayer.setupLayerDetailPanel,classOrInstance:"class"},{name:"setupLayerOnCanvas",fxn:bd.methodTag.tmxEntityLayer.setupLayerOnCanvas,classOrInstance:"class"},{name:"removeLayerFromCanvas",fxn:bd.methodTag.tmxEntityLayer.removeLayerFromCanvas,classOrInstance:"class"},{name:"setupLayerOnPhaser",fxn:bd.methodTag.tmxEntityLayer.setupLayerOnPhaser,classOrInstance:"class"},{name:"checkToAddEntity",
fxn:bd.methodTag.tmxEntityLayer.checkToAddEntity,classOrInstance:"class"}]}};bd.methodTag.tmxEntityLayer.handleCommand=function(a){return"entityIds"==a.property&&"removeValue"==a.updateType?(bd.component.lookup(a.value).removeInstanceFromView(),!0):!1};bd.methodTag.tmxEntityLayer.setupLayerDetailPanel=function(){};
bd.methodTag.tmxEntityLayer.setupLayerOnCanvas=function(){for(var a=0;a<this.model.entityIds.length;a++)bd.component.lookup(this.model.entityIds[a]).createEditorDisplayObject();bd.component.lookup(this.model.viewId).getLayer("tmxLayer"+this.id).batchDraw()};bd.methodTag.tmxEntityLayer.removeLayerFromCanvas=function(){};bd.methodTag.tmxEntityLayer.setupLayerOnPhaser=function(){for(var a=0;a<this.model.entityIds.length;a++)this.checkToAddEntity(this.model.entityIds[a])};
bd.methodTag.tmxEntityLayer.checkToAddEntity=function(a){var b=bd.component.lookup(a);a=b.model;var c=bd.component.lookup(this.model.viewId);if(("perPlayer"==a.shareMode||"local"==a.shareMode)&&null==a.playerId)b=a.playerIdsToChildInstanceIds[bd.player.ctr.playerId],bd.model.entityLookup(b)&&bd.model.entityLookup(b).layerId==a.layerId&&this.checkToAddEntity(b);else if("share"==a.shareMode||"local"==a.shareMode&&a.visibleToPlayerId==bd.player.ctr.playerId||"perPlayer"==a.shareMode&&a.visibleToPlayerId==
bd.player.ctr.playerId)null!=b.getDisplayObject()&&b.getDisplayObject().parent==c.getLayer(this.id)||b.addEntity()};bd.component.melonView.tmxEntityLayer={constructor:function(a,b,c){this.viewId="undefined"==typeof b?null:b;this.tmxMapId=c;goog.mixin(this,bd.component.melonView.tmxEntityLayer.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this);null==a&&this.afterComponentCreated()},componentProperties:{classOrInstance:"class",type:"tmxEntityLayer",listName:"tmxEntityLayers",idName:"tmxEntityLayerId",idListName:"tmxEntityLayerIds",namePrefix:"tmxEntityLayer",
layerDetailPanel:"melonLayerEntityPanel",lastUsedLayer:null,layerHasEntities:!0,modelTags:["entity","hasMelonTMXLayerProperties","hasMelonTMXEntityLayerProperties"],methodTags:["entity","tmxLayer","tmxEntityLayer"]}};bd.component.typeNameToComponent.tmxEntityLayer=bd.component.melonView.tmxEntityLayer;bd.modelTag.traitModification={provideFields:function(){return[{fields:["panelVisible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["panelNameVisible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["panelValueVisible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["panelEditable"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["panelDeletable"],classOrInstance:"class",providers:["defaultValue"],
defaultValue:!0},{fields:["blockVisible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["blockSet"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["blockGet"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]}};
bd.modelTag.traitRestriction={provideFields:function(){return[{fields:["global"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["class"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}}]}};
bd.modelTag.classRestriction={provideFields:function(){return[{fields:["restrictionOnBlock"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["maxInstanceNum"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["canDelete"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["hasBlockRestriction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]}};
bd.modelTag.categoryComponent={provideFields:function(){return[{fields:["visible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["name"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""},{fields:["maxBlockCreation"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["content"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}}]}};
bd.modelTag.blockRestriction={provideFields:function(){return[{fields:["maxNum"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["canAdd"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["canDelete"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]}};
bd.modelTag.tabContent={provideFields:function(){return[{fields:["value"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["entityType"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["exceptSwitch"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["tabId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["visible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]}};
bd.modelTag.categoryComponentContent={provideFields:function(){return[{fields:["value"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["blockCategory"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["exceptSwitch"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["visible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]}};bd.component.levelEditorTraitRestriction={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorTraitRestriction.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorTraitRestriction",listName:"levelEditorTraitRestrictions",idName:"levelEditorTraitRestrictionId",idListName:"levelEditorTraitRestrictionIds",namePrefix:"unused prefix...",
tabName:"Level Editor Trait Restriction",entityName:"Level Editor Trait Restriction",modelTags:["entity","traitRestriction"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorTraitRestriction=bd.component.levelEditorTraitRestriction;bd.modelTag.hasAssetProperties={requiredFields:["assetLabel","urlObject"],provideFields:function(){return[{fields:"assetLabel thumbnailFileName isThumbnailFileInternal isDefaultAsset backendAssetId unsavedAssetId".split(" "),classOrInstance:"class",providers:["componentObject"]},{fields:["costumeIds"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.hasAssetProperties.provideCostumeIds}]}};
bd.modelTag.hasAssetProperties.provideCostumeIds=function(){this.model.costumeIds=[];null!=this.initialCostumeId&&(this.model.costumeIds=[this.initialCostumeId]);return!0};bd.modelTag.hasImageAssetProperties={requiredFields:["imageFile"],provideFields:function(){return[{fields:["imageFile"],classOrInstance:"class",providers:["componentObject"]}]}};bd.modelTag.hasVideoAssetProperties={requiredFields:["youtubeId"],provideFields:function(){return[{fields:["youtubeId"],classOrInstance:"class",providers:["componentObject"]}]}};
bd.modelTag.hasSpriteSheetAssetProperties={requiredFields:["tileHeight","tileWidth","previewTileRow","previewTileColumn"],provideFields:function(){return[{fields:["tileHeight","tileWidth"],classOrInstance:"class",providers:["componentObject"]},{fields:["previewTileRow","previewTileColumn"],classOrInstance:"class",providers:["componentObject"]}]}};
bd.modelTag.hasRichTextAssetProperties={requiredFields:["richTextModelText"],provideFields:function(){return[{fields:["richText"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""}]}};bd.methodTag.video={provideMethods:function(){return[{name:"addEntity",fxn:bd.methodTag.video.addEntity,classOrInstance:"instance"},{name:"onPlayerStateChange",fxn:bd.methodTag.video.onPlayerStateChange,classOrInstance:"instance"},{name:"onPlayerReady",fxn:bd.methodTag.video.onPlayerReady,classOrInstance:"instance"},{name:"createPlayer",fxn:bd.methodTag.video.createPlayer,classOrInstance:"instance"},{name:"createVideoContainer",fxn:bd.methodTag.video.createVideoContainer,classOrInstance:"instance"},
{name:"show",fxn:bd.methodTag.video.show,classOrInstance:"instance"},{name:"hide",fxn:bd.methodTag.video.hide,classOrInstance:"instance"},{name:"switchCostume",fxn:bd.methodTag.video.switchCostume,classOrInstance:"instance"},{name:"playVideo",fxn:bd.methodTag.video.playVideo,classOrInstance:"instance"},{name:"removeConnections",fxn:bd.methodTag.video.removeConnections,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.video.updateSideBar,classOrInstance:"class"},{name:"updateInstancePanel",
fxn:bd.methodTag.video.updateInstancePanel,classOrInstance:"instance"},{name:"removeEntityFromView",fxn:bd.methodTag.video.removeEntityFromView,classOrInstance:"instance"}]}};bd.methodTag.video.handleCommand=function(a){if("visible"==a.property)return 1==a.value?this.show():this.hide(),!0;if("costumeId"==a.property)return this.switchCostume(),!0;"playVideo"==a.property&&this.playVideo();return!1};
bd.methodTag.video.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0,updateInstances:!0},
bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",200),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",200),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);
b.getElementsByClassName("costumeSelectorImage")[0].src=bd.component.lookup(bd.model.entityLookup(a.costumeIds[0]).assetId).getThumbnailUrl()};
bd.methodTag.video.updateInstancePanel=function(){var a=this.model,b=document.getElementById(this.instancePanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("xInput")[0];c.value=a.x;bd.sideBar.ctr.resetTextInputStyle(c);
bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("yInput")[0];c.value=a.y;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"y",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);
b.getElementsByClassName("costumeImage")[0].src=bd.component.lookup(bd.model.entityLookup(a.costumeId).assetId).getThumbnailUrl();b.getElementsByClassName("instanceImageContainer")[0].onclick=function(a){return function(){bd.overlay.ctr.showOverlay("imageSelection",["assetVideo"],a)}}(a.id)};
bd.methodTag.video.addEntity=function(){var a=goog.dom.createDom("div");a.setAttribute("id",this.model.type+"Div"+this.id);a.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";a.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";a.style.left=(this.model.x-this.model.width/2)*bd.phaser.ctr.gameScaleFactor+"px";a.style.top=(this.model.y-this.model.height/2)*bd.phaser.ctr.gameScaleFactor+"px";a.style.position="absolute";var b="none";this.model.visible&&(b="block");a.style.display=
b;b=bd.component.lookup(this.model.layerId).componentContainerId;bd.component.lookup(this.model.viewId).getWindow().document.getElementById(b).appendChild(a);this.setDisplayObject(a);this.createPlayer()};
bd.methodTag.video.createPlayer=function(){if(bd.component.video.componentProperties.apiLoaded){var a=this.model,b=bd.model.entityLookup(bd.model.entityLookup(a.costumeId).assetId).youtubeId,a=new (bd.component.lookup(bd.model.getCurrentViewId()).getWindow().YT.Player)(this.model.type+"Div"+this.id,{height:a.height,width:a.width,videoId:b,events:{onReady:this.onPlayerReady,onStateChange:this.onPlayerStateChange}});a.instanceId=this.id;this.videoPlayer=a}else bd.component.video.instanceIdsWaitingForApi.push(this.id)};
bd.methodTag.video.onPlayerReady=function(a){var b=bd.component.lookup(bd.model.getCurrentViewId()).getWindow();a=bd.component.lookup(a.target.instanceId);a.setDisplayObject(b.document.getElementById(a.type+"Div"+a.id))};bd.methodTag.video.onPlayerStateChange=function(a){0===a.data&&bd.evaluator.ctr.finishedVideo(a.target.instanceId)};bd.methodTag.video.playVideo=function(){this.videoPlayer&&this.videoPlayer.playVideo()};
bd.methodTag.video.show=function(){this.videoPlayer&&this.getDisplayObject()&&(this.getDisplayObject().style.display="block")};bd.methodTag.video.hide=function(){this.videoPlayer&&this.videoPlayer.pauseVideo();this.getDisplayObject()&&(this.getDisplayObject().style.display="none")};
bd.methodTag.video.switchCostume=function(){bd.inPlayer||bd.editor.ctr.getSelectedInstanceId()!=this.id||bd.instanceProperty.ctr.setup();if(bd.inPlayer&&this.videoPlayer){var a=bd.model.entityLookup(bd.model.entityLookup(this.model.costumeId).assetId).youtubeId;this.videoPlayer.cueVideoById(a)}};
bd.methodTag.video.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.layerId],"removeValue","entityIds",
this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.methodTag.video.removeEntityFromView=function(){var a=bd.component.lookup(this.model.layerId).componentContainerId,b=bd.component.lookup(this.model.viewId),c=b.getWindow().document.getElementById(this.model.type+"Div"+this.id);try{b.getWindow().document.getElementById(a).removeChild(c)}catch(e){}};bd.methodTag.assetRichText={provideMethods:function(){return[{name:"getThumbnailUrl",fxn:bd.methodTag.assetRichText.getThumbnailUrl}]}};bd.methodTag.assetRichText.getThumbnailUrl=function(){return"/static/images/textInput.png"};bd.modelTag.hasFlexidorProperties={provideFields:function(){return[{fields:["entities"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["flexidorDisplay"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["scriptsDrawers"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["scriptsBlocks"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}}]}};bd.blockMsg={};bd.blockMsg.CONTROLS_FOR_EACH_LIST="for each %1 in %2 \n do %3";bd.blockMsg.CONTROLS_IF="if %1 \n do %2 %( \n else if %3 \n do %4 %)5 %( \n else %6 %)7";bd.blockMsg.CONTROLS_FOR_COUNT="count with %1 from %2 to %3 by %4 \n do %5";bd.blockMsg.SHOW_HIDE_PIECES="%1 %2";bd.blockMsg.SET_WIDTH_HEIGHT="set %1 of %2 to %3";bd.blockMsg.GET_WIDTH_HEIGHT="%1 's %2";bd.blockMsg.IS_VISIBLE="%1 is visible?";bd.blockMsg.SWITCH_COSTUME="switch %1 's costume to %2";bd.blockMsg.NEXT_COSTUME="%1 costume for %2";
bd.blockMsg.COSTUME_NUM="%1 's costume num";bd.blockMsg.SET_COSTUME_NUM="set %1 's costume num to %2";bd.blockMsg.SET_LABEL_TEXT="set %1 's text to %2";bd.blockMsg.GET_INPUT_TEXT="%1 's text";bd.blockMsg.FLIP_SPRITE="flip %1 %2";bd.blockMsg.WITHIN_DISTANCE_OF="all instances of %1 within %2 units from %3";bd.blockMsg.MATH_MAX_MIN="%1 of %( %2 %)3";bd.blockMsg.MATH_NUMBER="%1";bd.blockMsg.MATH_ARITHMETIC="%1 %3 %2";bd.blockMsg.MATH_SINGLE="%1 %2";bd.blockMsg.MATH_TRIG="%1 %2";
bd.blockMsg.MATH_ROUND="%1 %2";bd.blockMsg.MATH_RANDOM_INT="random integer from %1 to %2";bd.blockMsg.TEXT_SUBSTRING="substring of %1 from index %2 to %3";bd.blockMsg.TEXT_LENGTH="length of %1";bd.blockMsg.TEXT_CHAR_AT="character at index %2 of string %1";bd.blockMsg.TEXT_CONTAINS="does string %1 contain %2";bd.blockMsg.TEXT_LIST_OF_CHARACTERS="list of characters in %1";bd.blockMsg.TEXT_JOIN="join %( %1 %)2";bd.blockMsg.TEXT_VAR_REFRESH="update variables in %1 's text";bd.blockMsg.CREATE_LIST="create list of %1 %( %2 %)3";
bd.blockMsg.LIST_SHUFFLE="shuffle %1";bd.blockMsg.LIST_ADD="add %1 to %2";bd.blockMsg.LIST_INSERT="insert %1 at item # %2 of %3";bd.blockMsg.LIST_CHANGE_ITEM="change item # %1 of %2 to %3";bd.blockMsg.LIST_REMOVE="remove %1 from %2";bd.blockMsg.SET_TRAIT="set %1 's %2 to %3";bd.blockMsg.CHANGE_TRAIT="change %1 's %2 by %3";bd.blockMsg.TRAIT_VALUE="%1 's %2";bd.blockMsg.COLOR_PICKER="%1";bd.blockMsg.COLOR_FROM_RGB_OR_HSV_HSV="color from hue %1 saturation %2 brightness %3";
bd.blockMsg.COLOR_FROM_RGB_OR_HSV_RGB="color from red %1 green %2 blue %3";bd.blockMsg.PLAY_ASSET="play sound %1";bd.blockMsg.STOP_ALL_SOUNDS="stop all sounds";bd.blockMsg.STOP_SOUND="stop sound %1";bd.blockMsg.PLAY_NOTE="play note %2 on %1 for %3 %5";bd.blockMsg.PLAY_NOTE_INPUT="play note %4 on %1 for %3 %5";bd.blockMsg.PLAY_STOP_ALL_NOTES="stop all notes";bd.blockMsg.PLAY_SET_VOLUME="set %1 's volume to %2 %";bd.blockMsg.PLAY_SET_TEMPO="set %1 's tempo to %2";
bd.blockMsg.PLAY_SET_INSTRUMENT_NUMBER="set %1 's instrument to %2";bd.blockMsg.PLAY_SET_INSTRUMENT_NAME="set %1 's instrument to %3";bd.blockMsg.SWITCH_STAGE="switch to %1 %( %2 %)3";bd.blockMsg.IS_ON_STAGE="is %1 on %2";bd.blockMsg.IS_PLAYER_ON_STAGE="is player on %1";bd.blockMsg.STAGE_SET_GET_NUMBER_SET="set player's stage number to %1";bd.blockMsg.STAGE_SET_GET_NUMBER_GET="player's stage number";bd.blockMsg.NUMBER_OF_STAGES="number of stages";
bd.blockMsg.MOVE_PLAYER_TO_NEXT_OR_PREVIOUS_STAGE="switch to %1 stage";bd.blockMsg.SPRITE_STAGE_SET_GET_NUMBER_SET="move %1 to %3 %( %2 %)4";bd.blockMsg.SPRITE_STAGE_SET_GET_NUMBER_GET="%1's stage number";bd.blockMsg.STAGE_SWITCH_EVENT="when switch to %2 \n %1";bd.blockMsg.TABLE_SET_GET_VALUE_SET="set %1 's %2 %( %5 %)6 in row number %3 to %4";bd.blockMsg.TABLE_SET_GET_VALUE_GET="%1 's %2 %( %5 %)6 in row number %3";bd.blockMsg.TABLE_ADD_ROW="add row to %1 \n at %2 %( \n %)3 %( %4 %)5 %( %6 %7 %)8";
bd.blockMsg.TABLE_GET_DIMENSION="%2 's number of %1";bd.blockMsg.TABLE_REMOVE_ROW="remove %1 's row number %2";bd.blockMsg.GET_ROW_NUM_OF_VARIABLE_ALL="in %1 find row numbers of %6 instances of %2 in %3 %( %4 %)5";bd.blockMsg.GET_ROW_NUM_OF_VARIABLE_NOT_ALL="in %1 find row number of %6 instance of %2 in %3 %( %4 %)5";bd.blockMsg.ACTIVATE_RESTART_PIECES="%1 %2";bd.blockMsg.IS_ACTIVATED="%1 is activated?";bd.blockMsg.SET_TIMER="set %1 's time limit to %2";bd.blockMsg.GET_TIMER_TIME="%1 's time";
bd.blockMsg.WHEN_TIMER_GOES_OFF="when %1 goes off";bd.blockMsg.PLAY_VIDEO="play %1";bd.blockMsg.WHEN_VIDEO_FINISHED="when %1 ends \n %2";bd.blockMsg.MOBILE_VIBRATE="vibrate";bd.blockMsg.MOBILE_SCAN_QRCODE="scan QR code \n with %1 \n %2";bd.blockMsg.TEXT_TO_SPEECH_LANGUAGE="say %1 in %2 voice";bd.blockMsg.TEXT_TO_SPEECH_LANGUAGE_WAIT="say %1 in %2 voice and wait";bd.blockMsg.DICTIONARY_IS_WORD="%1 is in dictionary?";bd.blockMsg.DICTIONARY_ANAGRAMS="anagrams of %1";
bd.blockMsg.DICTIONARY_RAND_WORD_WITH_LENGTH="random word of length %1";bd.blockMsg.DICTIONARY_RAND_WORD="random word";bd.blockMsg.DICTIONARY_WORDS_IN_STRING="words in %1";bd.blockMsg.DICTIONARY_WORDS_USING_LETTERS_IN_STRING="words using letters in %1";bd.blockMsg.DICTIONARY_SET_DICTIONARY="set dictionary to %1";bd.blockMsg.PROCEDURES_DEF="%1 define %2 %( \n %3 : %4 %)5 %( \n returns: %6 %)7 \n %8";bd.blockMsg.PROCEDURES_CALL="call %1 %( \n %2 : %3 %4 %)5";bd.blockMsg.PROCEDURES_CALL_AND_WAIT="call %1 and wait %( \n %2 : %3 %4 %)5";
bd.blockMsg.PROCEDURES_CALL_RETURN="call %6 %( \n %2 : %3 %4 %)5";bd.blockMsg.PROCEDURES_CALL_FOR_PLAYERS="call %1 for %7 %( \n %2 : %3 %4 %)5";bd.blockMsg.PROCEDURES_CALL_FOR_PLAYERS_INPUT="call %1 for player %8 %( \n %2 : %3 %4 %)5";bd.blockMsg.PROCEDURES_RETURN="return %1";bd.blockMsg.PEN_STAMP="stamp %1";bd.blockMsg.PEN_CLEAR="clear";bd.blockMsg.PROJECT_SWITCH_TO="switch to project %1 %( %2 %3 %4 %)5 %6";bd.blockMsg.PROJECT_GET_PARAMETER="get project parameter %1";bd.methodTag.gameInfo={provideMethods:function(){return[{name:"updateClassName",fxn:bd.methodTag.gameInfo.updateClassName},{name:"initializeSharedVariable",fxn:bd.methodTag.gameInfo.initializeSharedVariable},{name:"setGlobalVariable",fxn:bd.methodTag.gameInfo.setGlobalVariable,classOrInstance:"class"},{name:"getGlobalVariable",fxn:bd.methodTag.gameInfo.getGlobalVariable,classOrInstance:"class"},{name:"updateSideBar",fxn:bd.methodTag.gameInfo.updateSideBar},{name:"getTabIds",fxn:bd.methodTag.gameInfo.getTabIds}]}};
bd.methodTag.gameInfo.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.gameName;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"gameName"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("descriptionInput")[0];c.value=a.description;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"description"},null,bd.sideBar.ctr.textUpdateSuccess,null);
b=b.getElementsByClassName("draftVersionNotesInput")[0];b.value=a.draftVersionNotes;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"draftVersionNotes"},null,bd.sideBar.ctr.textUpdateSuccess,null)};
bd.methodTag.gameInfo.updateClassName=function(){bd.updateSelections();if(bd.editor.ctr.getSelectedEntity().id==this.id){var a=document.getElementById(this.sideBarPanelName).getElementsByClassName("nameInput")[0];a.hasFocus||(a.value=this.model.gameName)}(a=document.getElementById("headerGameNameInput"))&&!a.hasFocus&&(a.value=this.model.gameName)};
bd.methodTag.gameInfo.initializeSharedVariable=function(a,b,c){if(bd.model.getGameInfo().isMultiplayerGame&&!bd.player.ctr.inEditorPreview){var e=bd.racer.ctr.sharedModel,f=e.getDeepCopy("_page.room.variableNameToValue"),g=b;c&&(g={type:"value",value:b});null==f[a]&&(f[a]=g,e.setDiffDeep("_page.room.variableNameToValue",f));bd.evaluator.ctr.variableChanged(a,null,!0)}else bd.model.getGameInfo().isMultiplayerGame&&bd.player.ctr.inEditorPreview?(window.parent.bd.preview.ctr.initializeSharedVariable(a,
b,c),bd.evaluator.ctr.variableChanged(a,null,!0)):this.setGlobalVariable(a,b,c,!1,!0)};
bd.methodTag.gameInfo.setGlobalVariable=function(a,b,c,e,f){if("undefined"==typeof e||null==e)e=!1;if("undefined"==typeof f||null==f)f=!1;var g=bd.model.getGameInfo().playerIdToGlobalVariables;g[bd.player.ctr.playerId]||(g[bd.player.ctr.playerId]={});var h=b;c&&(h={type:"value",value:b});bd.model.getGameInfo().isMultiplayerGame&&!bd.player.ctr.inEditorPreview&&bd.racer.ctr.sharedModel&&null!=bd.racer.ctr.sharedModel.get("_page.room.variableNameToValue."+a)?(e?(e=bd.racer.ctr.sharedModel.get("_page.room.variableNameToValue."+
a+".value"),h=bd.racer.ctr.sharedModel.increment("_page.room.variableNameToValue."+a+".value",b)):(b=bd.racer.ctr.sharedModel.getDeepCopy("_page.room.variableNameToValue"),e=b[a].value,b[a]=h,bd.racer.ctr.sharedModel.setDiffDeep("_page.room.variableNameToValue",b)),bd.evaluator.ctr.variableChanged(a,e,f)):bd.model.getGameInfo().isMultiplayerGame&&bd.player.ctr.inEditorPreview&&null!=window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a]?(e?(e=window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a].value,
h=window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a].value+b,window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a].value=h):(e=window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a],null!=e.value&&(e=window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a].value),window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a]=h),window.parent.bd.preview.ctr.sharedVariableChanged(a,e,f)):(e?g[bd.player.ctr.playerId][a]&&g[bd.player.ctr.playerId][a].type&&"value"==
g[bd.player.ctr.playerId][a].type?(e=g[bd.player.ctr.playerId][a].value,g[bd.player.ctr.playerId][a].value+=b):(e=g[bd.player.ctr.playerId][a],g[bd.player.ctr.playerId][a]+=b):(e=g[bd.player.ctr.playerId][a],g[bd.player.ctr.playerId][a]=h),bd.evaluator.ctr.variableChanged(a,e,f));if(c&&bd.model.getCurrentGame().gameInfos.richTextVariablesToAssets[a])for(a=bd.model.getCurrentGame().gameInfos.richTextVariablesToAssets[a],c=0;c<a.length;c++)for(f=bd.component.lookup(a[c]),h=0;h<f.model.costumeIds.length;h++)if(e=
bd.component.lookup(f.model.costumeIds[h]),bd.component.lookup(e.model.entityId))for(e=bd.component.lookup(e.model.entityId),b=0;b<e.model.instanceIds.length;b++)g=bd.component.lookup(e.model.instanceIds[b]),null!=g.model.playerId&&g.variableRefresh()};
bd.methodTag.gameInfo.getGlobalVariable=function(a){return bd.model.getGameInfo().isMultiplayerGame&&!bd.player.ctr.inEditorPreview&&bd.racer.ctr.sharedModel&&null!=bd.racer.ctr.sharedModel.get("_page.room.variableNameToValue."+a)?bd.racer.ctr.sharedModel.get("_page.room.variableNameToValue."+a):bd.model.getGameInfo().isMultiplayerGame&&bd.player.ctr.inEditorPreview&&null!=window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a]?window.parent.bd.preview.ctr.sharedModel.variableNameToValue[a]:
this.model.playerIdToGlobalVariables[bd.player.ctr.playerId]&&null!=this.model.playerIdToGlobalVariables[bd.player.ctr.playerId][a]?this.model.playerIdToGlobalVariables[bd.player.ctr.playerId][a]:null};bd.methodTag.gameInfo.getTabIds=function(){var a=this.model.tabListIds;bd.editor.ctr.isFlexidor()&&(a=bd.flexidor.ctr.getEntitySelectTabs());for(var b=[],c=0,e;e=a[c];c++)b.push(e);return b};bd.evaluator.ctr.blocks.deprecated={};
bd.evaluator.ctr.configs.add_to_trait_list={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"traitDefIdArray",type:"entity",fieldName:"TRAIT"},{name:"val",type:"value",valueName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.val,b=bd.evaluator.ctr.getTraitIds(b.params.entityIdArray,b.params.traitDefIdArray);bd.model.addModelUpdateElement(b,"push","value",c,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});
bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.configs.set_label_color={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"labelColor",type:"field",fieldName:"COLOR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","color",b.params.labelColor,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.cordovaServer={};bd.cordovaServer.ctr={};bd.cordovaServer.ctr.httpd=null;
bd.cordovaServer.ctr.startServer=function(){var a;if(bd.cordovaServer.ctr.httpd)a=bd.cordovaServer.ctr.httpd;else if(a=cordova&&cordova.plugins&&cordova.plugins.CorHttpd?cordova.plugins.CorHttpd:null,bd.cordovaServer.ctr.httpd=a,!a){bd.cordova.ctr.bootstrap.deviceReadyCallbacks.push(function(){bd.cordovaServer.ctr.startServer()});alert("push to callbacks");return}alert("in start server, httpd: "+a);a&&a.getURL(function(b){0<b.length?alert("server is up: "+b):a.startServer({www_root:"",port:8080},
function(a){a=JSON.parse(a);if("url"==a.type){a=a.url;var b=document.getElementById("siteUrl").innerHTML;document.getElementById("qrcodeUrl")&&""!=document.getElementById("qrcodeUrl").innerHTML&&(b=document.getElementById("qrcodeUrl").innerHTML);bd.util.ajaxPost(b+"/rendezvous/addDevice/","code="+bd.player.bootstrap.sessionCode+"&url="+a,function(a){})}else"gameFile"==a.type&&(null==bd.player.bootstrap.loadedGameString?bd.player.bootstrap.loadSinglePlayerGame(JSON.stringify({game:a.gameFileString})):
bd.player.bootstrap.restartGame(JSON.stringify({game:a.gameFileString})))},function(a){alert("failed to start server: "+a)})},function(){})};
bd.cordovaServer.ctr.handleServerResponse=function(a){a=JSON.parse(a);"url"==a.type?(alert("server is started: "+a.url),a=document.getElementById("siteUrl").innerHTML,document.getElementById("qrcodeUrl")&&""!=document.getElementById("qrcodeUrl").innerHTML&&(a=document.getElementById("qrcodeUrl").innerHTML),bd.util.ajaxPost(a+"/rendezvous/addDevice/","code="+bd.player.bootstrap.sessionCode+"&url="+url,function(a){alert(a)})):"gameFile"==a.type&&bd.player.bootstrap.loadSinglePlayerGame(a.gameFileString)};
bd.cordovaServer.ctr.stopServer=function(){var a=bd.cordovaServer.ctr.httpd;a&&a.stopServer(function(){},function(a){})};bd.methodTag.assetVideo={provideMethods:function(){return[{name:"getAssetDbInfo",fxn:bd.methodTag.assetVideo.getAssetDbInfo,classOrInstance:"class"}]}};bd.methodTag.assetVideo.getAssetDbInfo=function(){var a=bd.methodTag.asset.getAssetDbInfo.call(this);a.youtube_id=this.model.youtubeId;a.is_thumbnail_file_internal=0;return a};bd.methodTag.asset={provideMethods:function(){return[{name:"getThumbnailUrl",fxn:bd.methodTag.asset.getThumbnailUrl,classOrInstance:"class"},{name:"getAssetDbInfo",fxn:bd.methodTag.asset.getAssetDbInfo,classOrInstance:"class"},{name:"getThumbnailFileNameNoExtension",fxn:bd.methodTag.asset.getThumbnailFileNameNoExtension,classOrInstance:"class"},{name:"setBitMapData",fxn:bd.methodTag.asset.setBitMapData,classOrInstance:"class"},{name:"getBitMapData",fxn:bd.methodTag.asset.getBitMapData,classOrInstance:"class"},
{name:"createBitMapData",fxn:bd.methodTag.asset.createBitMapData,classOrInstance:"class"}]}};bd.methodTag.asset.getThumbnailUrl=function(){return bd.component.getComponentByType(this.type).getThumbnailUrlFromParams(this.model.thumbnailFileName,this.model.isThumbnailFileInternal,this.model.isDefaultAsset,this.model.unsavedAssetId)};
bd.methodTag.asset.getAssetDbInfo=function(){var a=this.model.isThumbnailFileInternal?1:0;this.model.isDefaultAsset&&(a="onHost");return{backend_id:this.model.backendAssetId,type:this.type,label:this.model.assetLabel,thumbnail_file_name:this.model.thumbnailFileName,is_thumbnail_file_internal:a,unsavedAssetId:this.model.unsavedAssetId}};bd.methodTag.asset.getThumbnailFileNameNoExtension=function(){var a=this.model.thumbnailFileName;return a.substr(0,a.lastIndexOf("."))};
bd.methodTag.asset.setBitMapData=function(a,b){this.spriteIdToBitMapData[a]={bitMapData:b,isUsingBitMapData:!0}};bd.methodTag.asset.getBitMapData=function(a){return this.spriteIdToBitMapData&&this.spriteIdToBitMapData[a]?this.spriteIdToBitMapData[a].bitMapData:null};
bd.methodTag.asset.createBitMapData=function(a,b,c){var e=bd.model.entityLookup(bd.player.ctr.playerId),f=bd.component.lookup(e.viewId).getPhaserGameObject(),e=f.add.bitmapData(b,c);e.smoothed=!1;f=f.cache.getImage("assetId:"+this.id);e.draw(f,0,0,b,c);e.update();this.spriteIdToBitMapData||(this.spriteIdToBitMapData={});this.spriteIdToBitMapData[a]={bitMapData:e,isUsingBitMapData:!0}};bd.component.assetVideo={constructor:function(a,b,c,e,f,g){this.model="undefined"==typeof a?null:a;this.urlObject="undefined"==typeof urlObject?null:urlObject;goog.mixin(this,bd.component.assetVideo.componentProperties);this.assetLabel=this.youtubeId=b;this.thumbnailFileName=c;this.isThumbnailFileInternal=!1;this.isDefaultAsset="undefined"==typeof e?!1:e;this.backendAssetId="undefined"==typeof g?null:g;this.initialCostumeId="undefined"==typeof f?null:f;this.costumeIds=[];this.type="assetVideo";this.model=
null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"assetVideo",listName:"assetVideos",idName:"assetVideoId",idListName:"assetVideoIds",namePrefix:"dummy pic",isAsset:!0,buttonRowElementId:"filepickerButtonsVideo",assetUploadDivId:"filepickerSelectVideo",identifierProperty:"thumbnailFileName",assetPickerBoxId:"assetPickerAsset",assetCategoriesOrder:["user","game","inherited","stock"],assetCategoryInfo:{user:{buttonText:"My Videos",
buttonId:"assetPickerUserVideoButton"},game:{buttonText:"Game Videos",buttonId:"assetPickerGameVideoButton"},inherited:{buttonText:"Inherited Videos"},stock:{buttonText:"Stock Videos"}},modelTags:["entity","hasAssetProperties","hasVideoAssetProperties"],methodTags:["entity","asset","assetVideo"]}};bd.component.typeNameToComponent.assetVideo=bd.component.assetVideo;
bd.component.assetVideo.createAssetFromDbInfoObject=function(a,b){return new bd.component.assetVideo.constructor(null,a.youtube_id,a.thumbnail_file_name,!1,b,a.backend_id)};bd.component.assetVideo.getThumbnailUrlFromDbInfo=function(a){return bd.component.assetImage.getThumbnailUrlFromDbInfo(a)};bd.component.assetVideo.getThumbnailUrlFromParams=function(a,b,c){return bd.component.assetImage.getThumbnailUrlFromParams(a,b,c)};bd.modelTag.hasMelonTMXEntityProperties={requiredFields:[],provideFields:function(){return[{fields:["firstgid"],classOrInstance:"class",providers:["defaultValue"],defaultValue:-1},{fields:["assetId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:241},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:640},{fields:["properties"],classOrInstance:"class",providers:["defaultValue"],
defaultValue:{}},{fields:["visible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["x"],classOrInstance:"class",providers:["defaultValue"],defaultValue:34},{fields:["y"],classOrInstance:"class",providers:["defaultValue"],defaultValue:129}]}};bd.methodTag.tabContent={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.tabContent.removeConnections},{name:"hideFromUser",fxn:bd.methodTag.tabContent.hideFromUser},{name:"setExceptSwitch",fxn:bd.methodTag.tabContent.setExceptSwitch},{name:"toggleExceptSwitchOnAEntity",fxn:bd.methodTag.tabContent.toggleExceptSwitchOnAEntity},{name:"updateEntityExclusionItems",fxn:bd.methodTag.tabContent.updateEntityExclusionItems},{name:"makeNewTabComponentContent",fxn:bd.methodTag.tabContent.makeNewTabComponentContent}]}};
bd.methodTag.tabContent.removeConnections=function(){bd.model.addModelUpdateElement([this.model.tabId],"removeValue","content",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.tabContent.hideFromUser=function(a){"true"==a.toString()?a=!0:a=!1;a?bd.model.addModelUpdateElement([this.id],"set","visible",!1,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}):bd.model.addModelUpdateElement([this.id],"set","visible",!0,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.tabContent.setExceptSwitch=function(a){"true"==a.toString()?a=!0:a=!1;this.model.exceptSwitch!=a&&(bd.model.addModelUpdateElement([this.id],"set","exceptSwitch",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.sendUpdates())};
bd.methodTag.tabContent.toggleExceptSwitchOnAEntity=function(a,b){"true"==b.toString()?b=!0:b=!1;a=parseInt(a,10);-1==this.model.value.indexOf(a)&&b?(bd.model.addModelUpdateElement([this.id],"push","value",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.sendUpdates()):-1<this.model.value.indexOf(a)&&0==b&&(bd.model.addModelUpdateElement([this.id],"removeValue","value",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),
bd.model.sendUpdates())};
bd.methodTag.tabContent.updateEntityExclusionItems=function(a){this.model.entityType!=a&&(bd.model.addModelUpdateElement([this.id],"set","entityType",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.addModelUpdateElement([this.id],"set","value",[],{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.addModelUpdateElement([this.id],"set","exceptSwitch",!0,{updateUIForOrigin:!1,updateModelForOrigin:!0,
updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.addModelUpdateElement([this.id],"set","visible",!0,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.sendUpdates())};
bd.methodTag.tabContent.makeNewTabComponentContent=function(a,b,c){if("unit"==a){var e=new bd.component.tabContent.constructor;bd.model.addModelUpdateElement([e.id],"push","value",b,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([e.id],"set","exceptSwitch",!1,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([e.id],"set","tabId",c,{updateUIForOrigin:!1,
updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1})}else"type"==a&&(e=new bd.component.tabContent.constructor,bd.model.addModelUpdateElement([e.id],"set","entityType",b,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.addModelUpdateElement([e.id],"set","tabId",c,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1}));bd.model.sendUpdates();return e};bd.methodTag.timer={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.timer.updateSideBar,classOrInstance:"class"},{name:"setCountUpOrDown",fxn:bd.methodTag.timer.setCountUpOrDown,classOrInstance:"class"},{name:"setHasTimeLimit",fxn:bd.methodTag.timer.setHasTimeLimit,classOrInstance:"class"},{name:"timerRead",fxn:bd.methodTag.timer.timerRead,classOrInstance:"instance"},{name:"setSidebarTimerSelection",fxn:bd.methodTag.timer.setSidebarTimerSelection,classOrInstance:"instance"},
{name:"removeConnections",fxn:bd.methodTag.timer.removeConnections,classOrInstance:"instance"},{name:"timeOutShort",fxn:bd.methodTag.timer.timeOutShort,classOrInstance:"instance"},{name:"confirmAndDeleteInstance",fxn:bd.methodTag.timer.confirmAndDeleteInstance,classOrInstance:"instance"},{name:"triggerTimeOut",fxn:bd.methodTag.timer.triggerTimeOut,classOrInstance:"instance"}]}};
bd.methodTag.timer.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);var e=b.getElementsByClassName("timerDropDown")[0];if(e.options[e.selectedIndex])var f=parseInt(e.options[e.selectedIndex].value);e.innerHTML="";for(var c=a.instanceIds,g=[],h=0;h<c.length;h++){var k=
bd.component.lookup(c[h]),l=document.createElement("option");e.options.add(l);l.text=k.model.name;l.value=k.model.id;g.push(k.model.id)}f&&-1!=g.indexOf(f)&&(e.value=f);b.getElementsByClassName("sideBarTimerSelectionContainer")[0].style.display=0==c.length?"none":"block";b.getElementsByClassName("timerInstanceDelete")[0].onclick=function(a){e.options[e.selectedIndex]&&(a=parseInt(e.options[e.selectedIndex].value),bd.component.lookup(a).confirmAndDeleteInstance());return!1};var m=this;e.onchange=function(a){};
f=b.getElementsByClassName("timeInput")[0];f.value=a.timeInput;bd.util.setTextInputChangeEventHandlers(f,{entityId:a.id,propertyName:"timeInput",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);a=b.getElementsByClassName("isCountDown")[0];f=b.getElementsByClassName("isCountUp")[0];this.model.countDown?(a.checked=!0,c=b.getElementsByClassName("noTimeLimitContainer")[0],
c.style.visibility="hidden",c=b.getElementsByClassName("hasTimeLimitRadio")[0],c.style.display="none"):(f.checked=!0,c=b.getElementsByClassName("noTimeLimitContainer")[0],c.style.visibility="visible",c=b.getElementsByClassName("hasTimeLimitRadio")[0],c.style.display="inline",c=b.getElementsByClassName("hasTimeLimitRadio")[0],g=b.getElementsByClassName("noTimeLimitRadio")[0],this.model.hasTimeLimit?c.checked=!0:g.checked=!0,c.onclick=function(a){m.setHasTimeLimit(!0)},g.onclick=function(a){m.setHasTimeLimit(!1)});
a.onclick=function(){m.setCountUpOrDown(!0)};f.onclick=function(){m.setCountUpOrDown(!1)};b.getElementsByClassName("newTimerButton")[0].onclick=function(){var a=bd.editor.ctr.getSelectedEntity().id,a=new bd.component.timerInstance.constructor(null,a);bd.sideBar.ctr.updateSideBar();a.setSidebarTimerSelection()}};
bd.methodTag.timer.setCountUpOrDown=function(a){var b=this.model.instanceIds.slice(0,this.model.instanceIds.length);b.push(this.id);bd.model.addModelUpdateElement(b,"set","countDown",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();bd.sideBar.ctr.updateSideBar()};
bd.methodTag.timer.setHasTimeLimit=function(a){var b=this.model.instanceIds.slice(0,this.model.instanceIds.length);b.push(this.id);bd.model.addModelUpdateElement(b,"set","hasTimeLimit",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();bd.sideBar.ctr.updateSideBar()};
bd.methodTag.timer.timerRead=function(){var a=(new Date).getTime(),b=this.model.timeInput,c=this.model.startTime,e=this.model.stopTime,f=b;this.model.countDown?this.model.countDown&&(this.model.activated?(f=b-(a-c)/1E3,0!=e&&(f=e-(a-c)/1E3),0>=f&&(f=0)):f=e):0==c?f=0:this.model.activated?(f=(a-c)/1E3,0!=e&&(f=e+f),f>=b&&this.model.hasTimeLimit&&(f=b)):f=e;return f};
bd.methodTag.timer.setSidebarTimerSelection=function(){var a=bd.component.lookup(this.model.parentId);document.getElementById(a.sideBarPanelName).getElementsByClassName("timerDropDown")[0].value=this.id};bd.methodTag.timer.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.timer.timeOutShort=function(){var a=this.model.timeInput-this.timerRead();this.model.countDown&&(a=this.timerRead());a*=1E3;null!=this.model.timeOut&&clearTimeout(this.model.timeOut);var b=this;if(this.model.activated&&(this.model.countDown||this.model.hasTimeLimit))if(0>a)this.triggerTimeOut();else{var c=setTimeout(function(a){delete bd.evaluator.ctr.activeTimerIds[c];b.model.activated&&b.triggerTimeOut()},a,b.id);bd.model.addModelUpdateElement([b.id],"set","timeOut",c,{updateUIForOrigin:!1,
updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.activeTimerIds[c]=!0}};
bd.methodTag.timer.triggerTimeOut=function(){bd.model.addModelUpdateElement([this.id],"set","activated",!1,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.addModelUpdateElement([this.id],"set","stopTime",this.timerRead(),{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.timeOutTriggered(this.id)};
bd.methodTag.timer.confirmAndDeleteInstance=function(){confirm("Are you sure that you want to delete this timer?")&&(this.deleteInstance(),bd.sideBar.ctr.updateSideBar())};bd.methodTag.sound={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.sound.updateSideBar,classOrInstance:"class"}]}};
bd.methodTag.sound.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);document.getElementById("soundImageSelector").src=bd.component.lookup(bd.entityLookup[a.costumeIds[0]].assetId).getThumbnailUrl();b.getElementsByClassName("addRemoveSoundLink")[0].onclick=function(a){bd.overlay.ctr.showOverlay("imageSelection",
["assetSound"],null,!1,"ASSET_LIST");return!1};a=b.getElementsByClassName("soundChannelList")[0];a.innerHTML="";for(c=0;c<bd.model.getEntityList("soundChannel").length;c++){var e=bd.model.getEntityList("soundChannel")[c].id,f=bd.component.lookup(e).model.instrument,g=goog.dom.createDom("li");g.style.width="400px";g.style["float"]="left";f=goog.dom.createDom("input");f.style.width="100px";f.type="text";f.value=bd.component.lookup(e).model.name;bd.util.setTextInputChangeEventHandlers(f,{entityId:e,
propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);g.appendChild(f);var h=goog.dom.createDom("select");h.innerHTML="";h.style.width="130px";instrumentParameter=bd.sound.ctr.getInstrumentParameter();for(f=0;f<instrumentParameter.length;f++){var k=goog.dom.createDom("option");k.value=instrumentParameter[f][1];k.text=instrumentParameter[f][0];h.appendChild(k)}g.appendChild(h);(function(a){h.onchange=function(b){bd.model.addModelUpdateElement([a],"set","instrument",parseInt(h.value),
{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()}})(e);if(1!=bd.model.getEntityList("soundChannel").length){var l=goog.dom.createDom("button");l.innerHTML="Remove";g.appendChild(l);(function(a){l.onclick=function(c){16==bd.model.getCurrentGame().soundChannels.length&&(b.getElementsByClassName("addSoundChannelBtn")[0].style.display="block");bd.component.lookup(a).deleteEntity();m.updateSideBar()}})(e)}a.appendChild(g)}var m=this,n=b.getElementsByClassName("addSoundChannelBtn")[0];
n.onclick=function(a){16>bd.model.getCurrentGame().soundChannels.length&&(new bd.component.soundChannel.constructor(null),m.updateSideBar(),16==bd.model.getCurrentGame().soundChannels.length&&(n.style.display="none"))}};bd.modelTag.hasSoundProperties={provideFields:function(){return[{fields:["assetSoundIds"],providers:["function"],fxn:bd.modelTag.hasSoundProperties.provideAssetSoundIds}]}};bd.modelTag.hasSoundProperties.provideAssetSoundIds=function(){var a=[];null!=this.defaultImageId&&(a=[this.defaultImageId]);this.model.assetSoundIds=a;return!0};bd.component.sound={constructor:function(a,b){this.model="undefined"==typeof a?null:a;this.tabId="undefined"==typeof b?null:b;goog.mixin(this,bd.component.sound.componentProperties);null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"sound",listName:"sounds",idName:"soundId",idListName:"soundIds",sideBarPanelName:"sideBarSoundPanel",
defaultImageUrlObject:{url:"images/sound.png",internal:!0},tabIconFileName:"class-icon-sound.png",editorDisplayObjectType:"image",hasTraitTab:!1,namePrefix:"sound ",typeName:"Sound",tabName:"Sounds",entityName:"Sound",entityNamePlural:"Sounds",thisName:"this sound",allName:"all sounds",anyName:"any sound",randomName:"random sound",modelTags:"entity hasSrcInstanceId hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasTabContainer hasScripts hasSoundProperties".split(" "),methodTags:["entity",
"sound"]},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetSound.componentProperties.type,"ding.m4a");if(null==a){var b=new bd.component.assetSound.constructor(null,"ding.m4a",!0,!0,null,null,"ding"),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};bd.component.typeNameToComponent.sound=bd.component.sound;bd.methodTag.melonPiece={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.melonPiece.removeConnections,classOrInstance:"instance"},{name:"canCreateInstance",fxn:bd.methodTag.melonPiece.canCreateInstance,classOrInstance:"class"},{name:"getLayerName",fxn:bd.methodTag.melonPiece.getLayerName,classOrInstance:"instance"},{name:"pointDirection",fxn:bd.methodTag.melonPiece.pointDirection,classOrInstance:"instance"},{name:"moveDirection",fxn:bd.methodTag.melonPiece.moveDirection,
classOrInstance:"instance"},{name:"setVelocity",fxn:bd.methodTag.melonPiece.setVelocity,classOrInstance:"instance"},{name:"jump",fxn:bd.methodTag.melonPiece.jump,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.melonPiece.updateSideBar,classOrInstance:"class"}]}};
bd.methodTag.melonPiece.handleCommand=function(a){return"pointDirection"==a.property?(this.pointDirection(a.value.direction),!0):"moveDirection"==a.property?(this.moveDirection(a.value.direction),!0):"setVelocity"==a.property?(this.setVelocity(a.value.xOrY,a.value.velocity),!0):"jump"==a.property?(this.jump(),!0):!1};
bd.methodTag.melonPiece.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0,
updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,
bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("isDraggableCheckbox")[0];c.checked=a.draggable?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"draggable",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);b=b.getElementsByClassName("isVisibleCheckbox")[0];b.checked=a.visible?!0:!1;bd.util.setupCheckboxChangeEventHandlers(b,{entityId:a.id,propertyName:"visible",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);document.getElementById("melonPieceImageSelector").src=
bd.component.lookup(bd.entityLookup[a.costumeIds[0]].assetId).getThumbnailUrl()};
bd.methodTag.melonPiece.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});if(null!=a.viewId){bd.model.addModelUpdateElement([a.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});var b=bd.component.lookup(a.viewId);b.model.instanceIdToFollow==
this.id&&bd.model.addModelUpdateElement([b.id],"set","instanceIdToFollow",null,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})}bd.model.addModelUpdateElement([a.layerId],"removeValue","entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.melonPiece.canCreateInstance=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()).getSelectedLayerId(),b=bd.component.melonView.tmxEntityLayer.componentProperties.type;return bd.component.lookup(a).type==b};bd.methodTag.melonPiece.getLayerName=function(){return"tmxLayer"+this.model.layerId};bd.methodTag.melonPiece.pointDirection=function(a){var b=this.getDisplayObject();null!=b&&("left"==a?b.flipX(!0):"right"==a&&b.flipX(!1))};
bd.methodTag.melonPiece.moveDirection=function(a){var b=this.getDisplayObject(),c=bd.component.lookup(this.model.viewId);null!=b&&null!=c.getMelonObject()&&("left"==a?b.vel.x-=b.accel.x*c.getMelonObject().timer.tick:"right"==a&&(b.vel.x+=b.accel.x*c.getMelonObject().timer.tick))};bd.methodTag.melonPiece.setVelocity=function(a,b){var c=this.getDisplayObject();null!=c&&("x"==a?c.vel.x=b:c.vel.y=b)};
bd.methodTag.melonPiece.jump=function(){var a=this.getDisplayObject(),b=bd.component.lookup(this.model.viewId);null==a||null==b.getMelonObject()||a.jumping||a.falling||(a.vel.y=-a.maxVel.y*b.getMelonObject().timer.tick,a.jumping=!0)};bd.modelTag.hasMelonPieceProperties={requiredFields:["animation"],provideFields:function(){return[{fields:["animation"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"off"}]}};bd.component.melonPiece={constructor:function(a){goog.mixin(this,bd.component.melonPiece.componentProperties);null==a&&(this.defaultImageId=bd.defaultPieceAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"melonPiece",listName:"melonPieces",idName:"melonPieceId",idListName:"melonPieceIds",editorDisplayObjectType:"image",sideBarPanelName:"sideBarMelonPiecePanel",defaultImageUrlObject:{url:"images/qmarksq.png",
internal:!0},namePrefix:"Melon Piece Class",typeName:"Melon Piece",tabName:"Melon Pieces",entityName:"Melon Piece Classes",entityNamePlural:"Melon Piece Classes",thisName:"this melon piece class",allName:"all melon piece classes",anyName:"any melon piece class",randomName:"random melon piece class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasViewId hasLayerId hasCostume perPlayer hasTraits hasScripts hasTargetId hasMelonPieceProperties".split(" "),
methodTags:["entity","canvasObject","melonPiece"]}};
bd.component.melonPieceInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.melonPieceInstance.componentProperties);this.layer=function(){return bd.pieceLayer};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"melonPieceInstance",listName:"melonPieceInstances",idName:"melonPieceInstanceId",idListName:"melonPieceInstanceIds",editorDisplayObjectType:"image",
namePrefix:"melonPiece",entityName:"Melon Piece",thisName:"this melon piece",allName:"all melon pieces",anyName:"any melon piece",randomName:"random melon piece",modelTags:bd.component.melonPiece.componentProperties.modelTags,methodTags:bd.component.melonPiece.componentProperties.methodTags}};bd.component.typeNameToComponent.melonPiece=bd.component.melonPiece;bd.component.typeNameToComponent.melonPieceInstance=bd.component.melonPieceInstance;bd.component.childNameToParentName.melonPieceInstance="melonPiece";goog.labs={};goog.labs.userAgent={};goog.labs.userAgent.util={};goog.labs.userAgent.util.getNativeUserAgentString_=function(){var a=goog.labs.userAgent.util.getNavigator_();return a&&(a=a.userAgent)?a:""};goog.labs.userAgent.util.getNavigator_=function(){return goog.global.navigator};goog.labs.userAgent.util.userAgent_=goog.labs.userAgent.util.getNativeUserAgentString_();goog.labs.userAgent.util.setUserAgent=function(a){goog.labs.userAgent.util.userAgent_=a||goog.labs.userAgent.util.getNativeUserAgentString_()};
goog.labs.userAgent.util.getUserAgent=function(){return goog.labs.userAgent.util.userAgent_};goog.labs.userAgent.util.matchUserAgent=function(a){var b=goog.labs.userAgent.util.getUserAgent();return goog.string.contains(b,a)};goog.labs.userAgent.util.matchUserAgentIgnoreCase=function(a){var b=goog.labs.userAgent.util.getUserAgent();return goog.string.caseInsensitiveContains(b,a)};
goog.labs.userAgent.util.extractVersionTuples=function(a){for(var b=RegExp("(\\w[\\w ]+)/([^\\s]+)\\s*(?:\\((.*?)\\))?","g"),c=[],e;e=b.exec(a);)c.push([e[1],e[2],e[3]||void 0]);return c};goog.labs.userAgent.platform={};goog.labs.userAgent.platform.isAndroid=function(){return goog.labs.userAgent.util.matchUserAgent("Android")};goog.labs.userAgent.platform.isIpod=function(){return goog.labs.userAgent.util.matchUserAgent("iPod")};goog.labs.userAgent.platform.isIphone=function(){return goog.labs.userAgent.util.matchUserAgent("iPhone")&&!goog.labs.userAgent.util.matchUserAgent("iPod")&&!goog.labs.userAgent.util.matchUserAgent("iPad")};goog.labs.userAgent.platform.isIpad=function(){return goog.labs.userAgent.util.matchUserAgent("iPad")};
goog.labs.userAgent.platform.isIos=function(){return goog.labs.userAgent.platform.isIphone()||goog.labs.userAgent.platform.isIpad()||goog.labs.userAgent.platform.isIpod()};goog.labs.userAgent.platform.isMacintosh=function(){return goog.labs.userAgent.util.matchUserAgent("Macintosh")};goog.labs.userAgent.platform.isLinux=function(){return goog.labs.userAgent.util.matchUserAgent("Linux")};goog.labs.userAgent.platform.isWindows=function(){return goog.labs.userAgent.util.matchUserAgent("Windows")};
goog.labs.userAgent.platform.isChromeOS=function(){return goog.labs.userAgent.util.matchUserAgent("CrOS")};
goog.labs.userAgent.platform.getVersion=function(){var a=goog.labs.userAgent.util.getUserAgent(),b="";goog.labs.userAgent.platform.isWindows()?(b=/Windows (?:NT|Phone) ([0-9.]+)/,b=(a=b.exec(a))?a[1]:"0.0"):goog.labs.userAgent.platform.isIos()?(b=/(?:iPhone|iPod|iPad|CPU)\s+OS\s+(\S+)/,b=(a=b.exec(a))&&a[1].replace(/_/g,".")):goog.labs.userAgent.platform.isMacintosh()?(b=/Mac OS X ([0-9_.]+)/,b=(a=b.exec(a))?a[1].replace(/_/g,"."):"10"):goog.labs.userAgent.platform.isAndroid()?(b=/Android\s+([^\);]+)(\)|;)/,
b=(a=b.exec(a))&&a[1]):goog.labs.userAgent.platform.isChromeOS()&&(b=/(?:CrOS\s+(?:i686|x86_64)\s+([0-9.]+))/,b=(a=b.exec(a))&&a[1]);return b||""};goog.labs.userAgent.platform.isVersionOrHigher=function(a){return 0<=goog.string.compareVersions(goog.labs.userAgent.platform.getVersion(),a)};goog.labs.userAgent.browser={};goog.labs.userAgent.browser.matchOpera_=function(){return goog.labs.userAgent.util.matchUserAgent("Opera")||goog.labs.userAgent.util.matchUserAgent("OPR")};goog.labs.userAgent.browser.matchIE_=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.browser.matchEdge_=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};goog.labs.userAgent.browser.matchFirefox_=function(){return goog.labs.userAgent.util.matchUserAgent("Firefox")};
goog.labs.userAgent.browser.matchSafari_=function(){return goog.labs.userAgent.util.matchUserAgent("Safari")&&!(goog.labs.userAgent.browser.matchChrome_()||goog.labs.userAgent.browser.matchCoast_()||goog.labs.userAgent.browser.matchOpera_()||goog.labs.userAgent.browser.matchEdge_()||goog.labs.userAgent.browser.isSilk()||goog.labs.userAgent.util.matchUserAgent("Android"))};goog.labs.userAgent.browser.matchCoast_=function(){return goog.labs.userAgent.util.matchUserAgent("Coast")};
goog.labs.userAgent.browser.matchIosWebview_=function(){return(goog.labs.userAgent.util.matchUserAgent("iPad")||goog.labs.userAgent.util.matchUserAgent("iPhone"))&&!goog.labs.userAgent.browser.matchSafari_()&&!goog.labs.userAgent.browser.matchChrome_()&&!goog.labs.userAgent.browser.matchCoast_()&&goog.labs.userAgent.util.matchUserAgent("AppleWebKit")};
goog.labs.userAgent.browser.matchChrome_=function(){return(goog.labs.userAgent.util.matchUserAgent("Chrome")||goog.labs.userAgent.util.matchUserAgent("CriOS"))&&!goog.labs.userAgent.browser.matchOpera_()&&!goog.labs.userAgent.browser.matchEdge_()};goog.labs.userAgent.browser.matchAndroidBrowser_=function(){return goog.labs.userAgent.util.matchUserAgent("Android")&&!(goog.labs.userAgent.browser.isChrome()||goog.labs.userAgent.browser.isFirefox()||goog.labs.userAgent.browser.isOpera()||goog.labs.userAgent.browser.isSilk())};
goog.labs.userAgent.browser.isOpera=goog.labs.userAgent.browser.matchOpera_;goog.labs.userAgent.browser.isIE=goog.labs.userAgent.browser.matchIE_;goog.labs.userAgent.browser.isEdge=goog.labs.userAgent.browser.matchEdge_;goog.labs.userAgent.browser.isFirefox=goog.labs.userAgent.browser.matchFirefox_;goog.labs.userAgent.browser.isSafari=goog.labs.userAgent.browser.matchSafari_;goog.labs.userAgent.browser.isCoast=goog.labs.userAgent.browser.matchCoast_;goog.labs.userAgent.browser.isIosWebview=goog.labs.userAgent.browser.matchIosWebview_;
goog.labs.userAgent.browser.isChrome=goog.labs.userAgent.browser.matchChrome_;goog.labs.userAgent.browser.isAndroidBrowser=goog.labs.userAgent.browser.matchAndroidBrowser_;goog.labs.userAgent.browser.isSilk=function(){return goog.labs.userAgent.util.matchUserAgent("Silk")};
goog.labs.userAgent.browser.getVersion=function(){function a(a){a=goog.array.find(a,e);return c[a]||""}var b=goog.labs.userAgent.util.getUserAgent();if(goog.labs.userAgent.browser.isIE())return goog.labs.userAgent.browser.getIEVersion_(b);var b=goog.labs.userAgent.util.extractVersionTuples(b),c={};goog.array.forEach(b,function(a){c[a[0]]=a[1]});var e=goog.partial(goog.object.containsKey,c);return goog.labs.userAgent.browser.isOpera()?a(["Version","Opera","OPR"]):goog.labs.userAgent.browser.isEdge()?
a(["Edge"]):goog.labs.userAgent.browser.isChrome()?a(["Chrome","CriOS"]):(b=b[2])&&b[1]||""};goog.labs.userAgent.browser.isVersionOrHigher=function(a){return 0<=goog.string.compareVersions(goog.labs.userAgent.browser.getVersion(),a)};
goog.labs.userAgent.browser.getIEVersion_=function(a){var b=/rv: *([\d\.]*)/.exec(a);if(b&&b[1])return b[1];var b="",c=/MSIE +([\d\.]+)/.exec(a);if(c&&c[1])if(a=/Trident\/(\d.\d)/.exec(a),"7.0"==c[1])if(a&&a[1])switch(a[1]){case "4.0":b="8.0";break;case "5.0":b="9.0";break;case "6.0":b="10.0";break;case "7.0":b="11.0"}else b="7.0";else b=c[1];return b};goog.labs.userAgent.engine={};goog.labs.userAgent.engine.isPresto=function(){return goog.labs.userAgent.util.matchUserAgent("Presto")};goog.labs.userAgent.engine.isTrident=function(){return goog.labs.userAgent.util.matchUserAgent("Trident")||goog.labs.userAgent.util.matchUserAgent("MSIE")};goog.labs.userAgent.engine.isEdge=function(){return goog.labs.userAgent.util.matchUserAgent("Edge")};
goog.labs.userAgent.engine.isWebKit=function(){return goog.labs.userAgent.util.matchUserAgentIgnoreCase("WebKit")&&!goog.labs.userAgent.engine.isEdge()};goog.labs.userAgent.engine.isGecko=function(){return goog.labs.userAgent.util.matchUserAgent("Gecko")&&!goog.labs.userAgent.engine.isWebKit()&&!goog.labs.userAgent.engine.isTrident()&&!goog.labs.userAgent.engine.isEdge()};
goog.labs.userAgent.engine.getVersion=function(){var a=goog.labs.userAgent.util.getUserAgent();if(a){var a=goog.labs.userAgent.util.extractVersionTuples(a),b=goog.labs.userAgent.engine.getEngineTuple_(a);if(b)return"Gecko"==b[0]?goog.labs.userAgent.engine.getVersionForKey_(a,"Firefox"):b[1];var a=a[0],c;if(a&&(c=a[2])&&(c=/Trident\/([^\s;]+)/.exec(c)))return c[1]}return""};
goog.labs.userAgent.engine.getEngineTuple_=function(a){if(!goog.labs.userAgent.engine.isEdge())return a[1];for(var b=0;b<a.length;b++){var c=a[b];if("Edge"==c[0])return c}};goog.labs.userAgent.engine.isVersionOrHigher=function(a){return 0<=goog.string.compareVersions(goog.labs.userAgent.engine.getVersion(),a)};goog.labs.userAgent.engine.getVersionForKey_=function(a,b){var c=goog.array.find(a,function(a){return b==a[0]});return c&&c[1]||""};goog.userAgent={};goog.userAgent.ASSUME_IE=!1;goog.userAgent.ASSUME_EDGE=!1;goog.userAgent.ASSUME_GECKO=!1;goog.userAgent.ASSUME_WEBKIT=!1;goog.userAgent.ASSUME_MOBILE_WEBKIT=!1;goog.userAgent.ASSUME_OPERA=!1;goog.userAgent.ASSUME_ANY_VERSION=!1;goog.userAgent.BROWSER_KNOWN_=goog.userAgent.ASSUME_IE||goog.userAgent.ASSUME_EDGE||goog.userAgent.ASSUME_GECKO||goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_OPERA;goog.userAgent.getUserAgentString=function(){return goog.labs.userAgent.util.getUserAgent()};
goog.userAgent.getNavigator=function(){return goog.global.navigator||null};goog.userAgent.OPERA=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_OPERA:goog.labs.userAgent.browser.isOpera();goog.userAgent.IE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_IE:goog.labs.userAgent.browser.isIE();goog.userAgent.EDGE=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_EDGE:goog.labs.userAgent.engine.isEdge();goog.userAgent.EDGE_OR_IE=goog.userAgent.EDGE||goog.userAgent.IE;
goog.userAgent.GECKO=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_GECKO:goog.labs.userAgent.engine.isGecko();goog.userAgent.WEBKIT=goog.userAgent.BROWSER_KNOWN_?goog.userAgent.ASSUME_WEBKIT||goog.userAgent.ASSUME_MOBILE_WEBKIT:goog.labs.userAgent.engine.isWebKit();goog.userAgent.isMobile_=function(){return goog.userAgent.WEBKIT&&goog.labs.userAgent.util.matchUserAgent("Mobile")};goog.userAgent.MOBILE=goog.userAgent.ASSUME_MOBILE_WEBKIT||goog.userAgent.isMobile_();goog.userAgent.SAFARI=goog.userAgent.WEBKIT;
goog.userAgent.determinePlatform_=function(){var a=goog.userAgent.getNavigator();return a&&a.platform||""};goog.userAgent.PLATFORM=goog.userAgent.determinePlatform_();goog.userAgent.ASSUME_MAC=!1;goog.userAgent.ASSUME_WINDOWS=!1;goog.userAgent.ASSUME_LINUX=!1;goog.userAgent.ASSUME_X11=!1;goog.userAgent.ASSUME_ANDROID=!1;goog.userAgent.ASSUME_IPHONE=!1;goog.userAgent.ASSUME_IPAD=!1;
goog.userAgent.PLATFORM_KNOWN_=goog.userAgent.ASSUME_MAC||goog.userAgent.ASSUME_WINDOWS||goog.userAgent.ASSUME_LINUX||goog.userAgent.ASSUME_X11||goog.userAgent.ASSUME_ANDROID||goog.userAgent.ASSUME_IPHONE||goog.userAgent.ASSUME_IPAD;goog.userAgent.MAC=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_MAC:goog.labs.userAgent.platform.isMacintosh();goog.userAgent.WINDOWS=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_WINDOWS:goog.labs.userAgent.platform.isWindows();
goog.userAgent.isLegacyLinux_=function(){return goog.labs.userAgent.platform.isLinux()||goog.labs.userAgent.platform.isChromeOS()};goog.userAgent.LINUX=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_LINUX:goog.userAgent.isLegacyLinux_();goog.userAgent.isX11_=function(){var a=goog.userAgent.getNavigator();return!!a&&goog.string.contains(a.appVersion||"","X11")};goog.userAgent.X11=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_X11:goog.userAgent.isX11_();
goog.userAgent.ANDROID=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_ANDROID:goog.labs.userAgent.platform.isAndroid();goog.userAgent.IPHONE=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPHONE:goog.labs.userAgent.platform.isIphone();goog.userAgent.IPAD=goog.userAgent.PLATFORM_KNOWN_?goog.userAgent.ASSUME_IPAD:goog.labs.userAgent.platform.isIpad();
goog.userAgent.determineVersion_=function(){if(goog.userAgent.OPERA&&goog.global.opera){var a=goog.global.opera.version;return goog.isFunction(a)?a():a}var a="",b=goog.userAgent.getVersionRegexResult_();b&&(a=b?b[1]:"");return goog.userAgent.IE&&(b=goog.userAgent.getDocumentMode_(),b>parseFloat(a))?String(b):a};
goog.userAgent.getVersionRegexResult_=function(){var a=goog.userAgent.getUserAgentString();if(goog.userAgent.GECKO)return/rv\:([^\);]+)(\)|;)/.exec(a);if(goog.userAgent.EDGE)return/Edge\/([\d\.]+)/.exec(a);if(goog.userAgent.IE)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(a);if(goog.userAgent.WEBKIT)return/WebKit\/(\S+)/.exec(a)};goog.userAgent.getDocumentMode_=function(){var a=goog.global.document;return a?a.documentMode:void 0};goog.userAgent.VERSION=goog.userAgent.determineVersion_();
goog.userAgent.compare=function(a,b){return goog.string.compareVersions(a,b)};goog.userAgent.isVersionOrHigherCache_={};goog.userAgent.isVersionOrHigher=function(a){return goog.userAgent.ASSUME_ANY_VERSION||goog.userAgent.isVersionOrHigherCache_[a]||(goog.userAgent.isVersionOrHigherCache_[a]=0<=goog.string.compareVersions(goog.userAgent.VERSION,a))};goog.userAgent.isVersion=goog.userAgent.isVersionOrHigher;goog.userAgent.isDocumentModeOrHigher=function(a){return goog.userAgent.DOCUMENT_MODE>=a};
goog.userAgent.isDocumentMode=goog.userAgent.isDocumentModeOrHigher;goog.userAgent.DOCUMENT_MODE=function(){var a=goog.global.document,b=goog.userAgent.getDocumentMode_();return a&&goog.userAgent.IE?b||("CSS1Compat"==a.compatMode?parseInt(goog.userAgent.VERSION,10):5):void 0}();goog.math={};goog.math.Size=function(a,b){this.width=a;this.height=b};goog.math.Size.equals=function(a,b){return a==b?!0:a&&b?a.width==b.width&&a.height==b.height:!1};goog.math.Size.prototype.clone=function(){return new goog.math.Size(this.width,this.height)};goog.DEBUG&&(goog.math.Size.prototype.toString=function(){return"("+this.width+" x "+this.height+")"});goog.math.Size.prototype.getLongest=function(){return Math.max(this.width,this.height)};
goog.math.Size.prototype.getShortest=function(){return Math.min(this.width,this.height)};goog.math.Size.prototype.area=function(){return this.width*this.height};goog.math.Size.prototype.perimeter=function(){return 2*(this.width+this.height)};goog.math.Size.prototype.aspectRatio=function(){return this.width/this.height};goog.math.Size.prototype.isEmpty=function(){return!this.area()};goog.math.Size.prototype.ceil=function(){this.width=Math.ceil(this.width);this.height=Math.ceil(this.height);return this};
goog.math.Size.prototype.fitsInside=function(a){return this.width<=a.width&&this.height<=a.height};goog.math.Size.prototype.floor=function(){this.width=Math.floor(this.width);this.height=Math.floor(this.height);return this};goog.math.Size.prototype.round=function(){this.width=Math.round(this.width);this.height=Math.round(this.height);return this};goog.math.Size.prototype.scale=function(a,b){var c=goog.isNumber(b)?b:a;this.width*=a;this.height*=c;return this};
goog.math.Size.prototype.scaleToCover=function(a){a=this.aspectRatio()<=a.aspectRatio()?a.width/this.width:a.height/this.height;return this.scale(a)};goog.math.Size.prototype.scaleToFit=function(a){a=this.aspectRatio()>a.aspectRatio()?a.width/this.width:a.height/this.height;return this.scale(a)};goog.dom.safe={};goog.dom.safe.InsertAdjacentHtmlPosition={AFTERBEGIN:"afterbegin",AFTEREND:"afterend",BEFOREBEGIN:"beforebegin",BEFOREEND:"beforeend"};goog.dom.safe.insertAdjacentHtml=function(a,b,c){a.insertAdjacentHTML(b,goog.html.SafeHtml.unwrap(c))};goog.dom.safe.setInnerHtml=function(a,b){a.innerHTML=goog.html.SafeHtml.unwrap(b)};goog.dom.safe.setOuterHtml=function(a,b){a.outerHTML=goog.html.SafeHtml.unwrap(b)};goog.dom.safe.documentWrite=function(a,b){a.write(goog.html.SafeHtml.unwrap(b))};
goog.dom.safe.setAnchorHref=function(a,b){var c;c=b instanceof goog.html.SafeUrl?b:goog.html.SafeUrl.sanitize(b);a.href=goog.html.SafeUrl.unwrap(c)};goog.dom.safe.setEmbedSrc=function(a,b){a.src=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setFrameSrc=function(a,b){a.src=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setIframeSrc=function(a,b){a.src=goog.html.TrustedResourceUrl.unwrap(b)};
goog.dom.safe.setLinkHrefAndRel=function(a,b,c){a.rel=c;goog.string.caseInsensitiveContains(c,"stylesheet")?(goog.asserts.assert(b instanceof goog.html.TrustedResourceUrl,'URL must be TrustedResourceUrl because "rel" contains "stylesheet"'),a.href=goog.html.TrustedResourceUrl.unwrap(b)):a.href=b instanceof goog.html.TrustedResourceUrl?goog.html.TrustedResourceUrl.unwrap(b):b instanceof goog.html.SafeUrl?goog.html.SafeUrl.unwrap(b):goog.html.SafeUrl.sanitize(b).getTypedStringValue()};
goog.dom.safe.setObjectData=function(a,b){a.data=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setScriptSrc=function(a,b){a.src=goog.html.TrustedResourceUrl.unwrap(b)};goog.dom.safe.setLocationHref=function(a,b){var c;c=b instanceof goog.html.SafeUrl?b:goog.html.SafeUrl.sanitize(b);a.href=goog.html.SafeUrl.unwrap(c)};
goog.dom.safe.openInWindow=function(a,b,c,e,f){a=a instanceof goog.html.SafeUrl?a:goog.html.SafeUrl.sanitize(a);return(b||window).open(goog.html.SafeUrl.unwrap(a),c?goog.string.Const.unwrap(c):"",e,f)};goog.dom.BrowserFeature={CAN_ADD_NAME_OR_TYPE_ATTRIBUTES:!goog.userAgent.IE||goog.userAgent.isDocumentModeOrHigher(9),CAN_USE_CHILDREN_ATTRIBUTE:!goog.userAgent.GECKO&&!goog.userAgent.IE||goog.userAgent.IE&&goog.userAgent.isDocumentModeOrHigher(9)||goog.userAgent.GECKO&&goog.userAgent.isVersionOrHigher("1.9.1"),CAN_USE_INNER_TEXT:goog.userAgent.IE&&!goog.userAgent.isVersionOrHigher("9"),CAN_USE_PARENT_ELEMENT_PROPERTY:goog.userAgent.IE||goog.userAgent.OPERA||goog.userAgent.WEBKIT,INNER_HTML_NEEDS_SCOPED_ELEMENT:goog.userAgent.IE,
LEGACY_IE_RANGES:goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)};goog.math.randomInt=function(a){return Math.floor(Math.random()*a)};goog.math.uniformRandom=function(a,b){return a+Math.random()*(b-a)};goog.math.clamp=function(a,b,c){return Math.min(Math.max(a,b),c)};goog.math.modulo=function(a,b){var c=a%b;return 0>c*b?c+b:c};goog.math.lerp=function(a,b,c){return a+c*(b-a)};goog.math.nearlyEquals=function(a,b,c){return Math.abs(a-b)<=(c||1E-6)};goog.math.standardAngle=function(a){return goog.math.modulo(a,360)};
goog.math.standardAngleInRadians=function(a){return goog.math.modulo(a,2*Math.PI)};goog.math.toRadians=function(a){return a*Math.PI/180};goog.math.toDegrees=function(a){return 180*a/Math.PI};goog.math.angleDx=function(a,b){return b*Math.cos(goog.math.toRadians(a))};goog.math.angleDy=function(a,b){return b*Math.sin(goog.math.toRadians(a))};goog.math.angle=function(a,b,c,e){return goog.math.standardAngle(goog.math.toDegrees(Math.atan2(e-b,c-a)))};
goog.math.angleDifference=function(a,b){var c=goog.math.standardAngle(b)-goog.math.standardAngle(a);180<c?c-=360:-180>=c&&(c=360+c);return c};goog.math.sign=Math.sign||function(a){return 0<a?1:0>a?-1:a};
goog.math.longestCommonSubsequence=function(a,b,c,e){c=c||function(a,b){return a==b};e=e||function(b,c){return a[b]};for(var f=a.length,g=b.length,h=[],k=0;k<f+1;k++)h[k]=[],h[k][0]=0;for(var l=0;l<g+1;l++)h[0][l]=0;for(k=1;k<=f;k++)for(l=1;l<=g;l++)c(a[k-1],b[l-1])?h[k][l]=h[k-1][l-1]+1:h[k][l]=Math.max(h[k-1][l],h[k][l-1]);for(var m=[],k=f,l=g;0<k&&0<l;)c(a[k-1],b[l-1])?(m.unshift(e(k-1,l-1)),k--,l--):h[k-1][l]>h[k][l-1]?k--:l--;return m};
goog.math.sum=function(a){return goog.array.reduce(arguments,function(a,c){return a+c},0)};goog.math.average=function(a){return goog.math.sum.apply(null,arguments)/arguments.length};goog.math.sampleVariance=function(a){var b=arguments.length;if(2>b)return 0;var c=goog.math.average.apply(null,arguments);return goog.math.sum.apply(null,goog.array.map(arguments,function(a){return Math.pow(a-c,2)}))/(b-1)};goog.math.standardDeviation=function(a){return Math.sqrt(goog.math.sampleVariance.apply(null,arguments))};
goog.math.isInt=function(a){return isFinite(a)&&0==a%1};goog.math.isFiniteNumber=function(a){return isFinite(a)&&!isNaN(a)};goog.math.isNegativeZero=function(a){return 0==a&&0>1/a};goog.math.log10Floor=function(a){if(0<a){var b=Math.round(Math.log(a)*Math.LOG10E);return b-(parseFloat("1e"+b)>a)}return 0==a?-Infinity:NaN};goog.math.safeFloor=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.floor(a+(b||2E-15))};
goog.math.safeCeil=function(a,b){goog.asserts.assert(!goog.isDef(b)||0<b);return Math.ceil(a-(b||2E-15))};goog.math.Coordinate=function(a,b){this.x=goog.isDef(a)?a:0;this.y=goog.isDef(b)?b:0};goog.math.Coordinate.prototype.clone=function(){return new goog.math.Coordinate(this.x,this.y)};goog.DEBUG&&(goog.math.Coordinate.prototype.toString=function(){return"("+this.x+", "+this.y+")"});goog.math.Coordinate.equals=function(a,b){return a==b?!0:a&&b?a.x==b.x&&a.y==b.y:!1};goog.math.Coordinate.distance=function(a,b){var c=a.x-b.x,e=a.y-b.y;return Math.sqrt(c*c+e*e)};
goog.math.Coordinate.magnitude=function(a){return Math.sqrt(a.x*a.x+a.y*a.y)};goog.math.Coordinate.azimuth=function(a){return goog.math.angle(0,0,a.x,a.y)};goog.math.Coordinate.squaredDistance=function(a,b){var c=a.x-b.x,e=a.y-b.y;return c*c+e*e};goog.math.Coordinate.difference=function(a,b){return new goog.math.Coordinate(a.x-b.x,a.y-b.y)};goog.math.Coordinate.sum=function(a,b){return new goog.math.Coordinate(a.x+b.x,a.y+b.y)};
goog.math.Coordinate.prototype.ceil=function(){this.x=Math.ceil(this.x);this.y=Math.ceil(this.y);return this};goog.math.Coordinate.prototype.floor=function(){this.x=Math.floor(this.x);this.y=Math.floor(this.y);return this};goog.math.Coordinate.prototype.round=function(){this.x=Math.round(this.x);this.y=Math.round(this.y);return this};goog.math.Coordinate.prototype.translate=function(a,b){a instanceof goog.math.Coordinate?(this.x+=a.x,this.y+=a.y):(this.x+=a,goog.isNumber(b)&&(this.y+=b));return this};
goog.math.Coordinate.prototype.scale=function(a,b){var c=goog.isNumber(b)?b:a;this.x*=a;this.y*=c;return this};goog.math.Coordinate.prototype.rotateRadians=function(a,b){var c=b||new goog.math.Coordinate(0,0),e=this.x,f=this.y,g=Math.cos(a),h=Math.sin(a);this.x=(e-c.x)*g-(f-c.y)*h+c.x;this.y=(e-c.x)*h+(f-c.y)*g+c.y};goog.math.Coordinate.prototype.rotateDegrees=function(a,b){this.rotateRadians(goog.math.toRadians(a),b)};goog.dom.ASSUME_QUIRKS_MODE=!1;goog.dom.ASSUME_STANDARDS_MODE=!1;goog.dom.COMPAT_MODE_KNOWN_=goog.dom.ASSUME_QUIRKS_MODE||goog.dom.ASSUME_STANDARDS_MODE;goog.dom.getDomHelper=function(a){return a?new goog.dom.DomHelper(goog.dom.getOwnerDocument(a)):goog.dom.defaultDomHelper_||(goog.dom.defaultDomHelper_=new goog.dom.DomHelper)};goog.dom.getDocument=function(){return document};goog.dom.getElement=function(a){return goog.dom.getElementHelper_(document,a)};
goog.dom.getElementHelper_=function(a,b){return goog.isString(b)?a.getElementById(b):b};goog.dom.getRequiredElement=function(a){return goog.dom.getRequiredElementHelper_(document,a)};goog.dom.getRequiredElementHelper_=function(a,b){goog.asserts.assertString(b);var c=goog.dom.getElementHelper_(a,b);return c=goog.asserts.assertElement(c,"No element found with id: "+b)};goog.dom.$=goog.dom.getElement;
goog.dom.getElementsByTagNameAndClass=function(a,b,c){return goog.dom.getElementsByTagNameAndClass_(document,a,b,c)};goog.dom.getElementsByClass=function(a,b){var c=b||document;return goog.dom.canUseQuerySelector_(c)?c.querySelectorAll("."+a):goog.dom.getElementsByTagNameAndClass_(document,"*",a,b)};
goog.dom.getElementByClass=function(a,b){var c=b||document,e=null;return(e=c.getElementsByClassName?c.getElementsByClassName(a)[0]:goog.dom.canUseQuerySelector_(c)?c.querySelector("."+a):goog.dom.getElementsByTagNameAndClass_(document,"*",a,b)[0])||null};goog.dom.getRequiredElementByClass=function(a,b){var c=goog.dom.getElementByClass(a,b);return goog.asserts.assert(c,"No element found with className: "+a)};goog.dom.canUseQuerySelector_=function(a){return!(!a.querySelectorAll||!a.querySelector)};
goog.dom.getElementsByTagNameAndClass_=function(a,b,c,e){a=e||a;b=b&&"*"!=b?b.toUpperCase():"";if(goog.dom.canUseQuerySelector_(a)&&(b||c))return a.querySelectorAll(b+(c?"."+c:""));if(c&&a.getElementsByClassName){a=a.getElementsByClassName(c);if(b){e={};for(var f=0,g=0,h;h=a[g];g++)b==h.nodeName&&(e[f++]=h);e.length=f;return e}return a}a=a.getElementsByTagName(b||"*");if(c){e={};for(g=f=0;h=a[g];g++)b=h.className,"function"==typeof b.split&&goog.array.contains(b.split(/\s+/),c)&&(e[f++]=h);e.length=
f;return e}return a};goog.dom.$$=goog.dom.getElementsByTagNameAndClass;goog.dom.setProperties=function(a,b){goog.object.forEach(b,function(b,e){"style"==e?a.style.cssText=b:"class"==e?a.className=b:"for"==e?a.htmlFor=b:goog.dom.DIRECT_ATTRIBUTE_MAP_.hasOwnProperty(e)?a.setAttribute(goog.dom.DIRECT_ATTRIBUTE_MAP_[e],b):goog.string.startsWith(e,"aria-")||goog.string.startsWith(e,"data-")?a.setAttribute(e,b):a[e]=b})};
goog.dom.DIRECT_ATTRIBUTE_MAP_={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};goog.dom.getViewportSize=function(a){return goog.dom.getViewportSize_(a||window)};goog.dom.getViewportSize_=function(a){a=a.document;a=goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body;return new goog.math.Size(a.clientWidth,a.clientHeight)};
goog.dom.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(window)};goog.dom.getDocumentHeight_=function(a){var b=a.document,c=0;if(b){var c=b.body,e=b.documentElement;if(!e||!c)return 0;a=goog.dom.getViewportSize_(a).height;if(goog.dom.isCss1CompatMode_(b)&&e.scrollHeight)c=e.scrollHeight!=a?e.scrollHeight:e.offsetHeight;else{var b=e.scrollHeight,f=e.offsetHeight;e.clientHeight!=f&&(b=c.scrollHeight,f=c.offsetHeight);c=b>a?b>f?b:f:b<f?b:f}}return c};
goog.dom.getPageScroll=function(a){return goog.dom.getDomHelper((a||goog.global||window).document).getDocumentScroll()};goog.dom.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(document)};
goog.dom.getDocumentScroll_=function(a){var b=goog.dom.getDocumentScrollElement_(a);a=goog.dom.getWindow_(a);return goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("10")&&a.pageYOffset!=b.scrollTop?new goog.math.Coordinate(b.scrollLeft,b.scrollTop):new goog.math.Coordinate(a.pageXOffset||b.scrollLeft,a.pageYOffset||b.scrollTop)};goog.dom.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(document)};
goog.dom.getDocumentScrollElement_=function(a){return a.scrollingElement?a.scrollingElement:!goog.userAgent.WEBKIT&&goog.dom.isCss1CompatMode_(a)?a.documentElement:a.body||a.documentElement};goog.dom.getWindow=function(a){return a?goog.dom.getWindow_(a):window};goog.dom.getWindow_=function(a){return a.parentWindow||a.defaultView};goog.dom.createDom=function(a,b,c){return goog.dom.createDom_(document,arguments)};
goog.dom.createDom_=function(a,b){var c=b[0],e=b[1];if(!goog.dom.BrowserFeature.CAN_ADD_NAME_OR_TYPE_ATTRIBUTES&&e&&(e.name||e.type)){c=["<",c];e.name&&c.push(' name="',goog.string.htmlEscape(e.name),'"');if(e.type){c.push(' type="',goog.string.htmlEscape(e.type),'"');var f={};goog.object.extend(f,e);delete f.type;e=f}c.push(">");c=c.join("")}c=a.createElement(c);e&&(goog.isString(e)?c.className=e:goog.isArray(e)?c.className=e.join(" "):goog.dom.setProperties(c,e));2<b.length&&goog.dom.append_(a,
c,b,2);return c};goog.dom.append_=function(a,b,c,e){function f(c){c&&b.appendChild(goog.isString(c)?a.createTextNode(c):c)}for(;e<c.length;e++){var g=c[e];goog.isArrayLike(g)&&!goog.dom.isNodeLike(g)?goog.array.forEach(goog.dom.isNodeList(g)?goog.array.toArray(g):g,f):f(g)}};goog.dom.$dom=goog.dom.createDom;goog.dom.createElement=function(a){return document.createElement(a)};goog.dom.createTextNode=function(a){return document.createTextNode(String(a))};
goog.dom.createTable=function(a,b,c){return goog.dom.createTable_(document,a,b,!!c)};goog.dom.createTable_=function(a,b,c,e){for(var f=a.createElement(goog.dom.TagName.TABLE),g=f.appendChild(a.createElement(goog.dom.TagName.TBODY)),h=0;h<b;h++){for(var k=a.createElement(goog.dom.TagName.TR),l=0;l<c;l++){var m=a.createElement(goog.dom.TagName.TD);e&&goog.dom.setTextContent(m,goog.string.Unicode.NBSP);k.appendChild(m)}g.appendChild(k)}return f};
goog.dom.safeHtmlToNode=function(a){return goog.dom.safeHtmlToNode_(document,a)};goog.dom.safeHtmlToNode_=function(a,b){var c=a.createElement(goog.dom.TagName.DIV);goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(goog.dom.safe.setInnerHtml(c,goog.html.SafeHtml.concat(goog.html.SafeHtml.create("br"),b)),c.removeChild(c.firstChild)):goog.dom.safe.setInnerHtml(c,b);return goog.dom.childrenToNode_(a,c)};
goog.dom.htmlToDocumentFragment=function(a){return goog.dom.htmlToDocumentFragment_(document,a)};goog.dom.htmlToDocumentFragment_=function(a,b){var c=a.createElement(goog.dom.TagName.DIV);goog.dom.BrowserFeature.INNER_HTML_NEEDS_SCOPED_ELEMENT?(c.innerHTML="<br>"+b,c.removeChild(c.firstChild)):c.innerHTML=b;return goog.dom.childrenToNode_(a,c)};
goog.dom.childrenToNode_=function(a,b){if(1==b.childNodes.length)return b.removeChild(b.firstChild);for(var c=a.createDocumentFragment();b.firstChild;)c.appendChild(b.firstChild);return c};goog.dom.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(document)};goog.dom.isCss1CompatMode_=function(a){return goog.dom.COMPAT_MODE_KNOWN_?goog.dom.ASSUME_STANDARDS_MODE:"CSS1Compat"==a.compatMode};goog.dom.canHaveChildren=function(a){if(a.nodeType!=goog.dom.NodeType.ELEMENT)return!1;switch(a.tagName){case goog.dom.TagName.APPLET:case goog.dom.TagName.AREA:case goog.dom.TagName.BASE:case goog.dom.TagName.BR:case goog.dom.TagName.COL:case goog.dom.TagName.COMMAND:case goog.dom.TagName.EMBED:case goog.dom.TagName.FRAME:case goog.dom.TagName.HR:case goog.dom.TagName.IMG:case goog.dom.TagName.INPUT:case goog.dom.TagName.IFRAME:case goog.dom.TagName.ISINDEX:case goog.dom.TagName.KEYGEN:case goog.dom.TagName.LINK:case goog.dom.TagName.NOFRAMES:case goog.dom.TagName.NOSCRIPT:case goog.dom.TagName.META:case goog.dom.TagName.OBJECT:case goog.dom.TagName.PARAM:case goog.dom.TagName.SCRIPT:case goog.dom.TagName.SOURCE:case goog.dom.TagName.STYLE:case goog.dom.TagName.TRACK:case goog.dom.TagName.WBR:return!1}return!0};
goog.dom.appendChild=function(a,b){a.appendChild(b)};goog.dom.append=function(a,b){goog.dom.append_(goog.dom.getOwnerDocument(a),a,arguments,1)};goog.dom.removeChildren=function(a){for(var b;b=a.firstChild;)a.removeChild(b)};goog.dom.insertSiblingBefore=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b)};goog.dom.insertSiblingAfter=function(a,b){b.parentNode&&b.parentNode.insertBefore(a,b.nextSibling)};goog.dom.insertChildAt=function(a,b,c){a.insertBefore(b,a.childNodes[c]||null)};
goog.dom.removeNode=function(a){return a&&a.parentNode?a.parentNode.removeChild(a):null};goog.dom.replaceNode=function(a,b){var c=b.parentNode;c&&c.replaceChild(a,b)};goog.dom.flattenElement=function(a){var b,c=a.parentNode;if(c&&c.nodeType!=goog.dom.NodeType.DOCUMENT_FRAGMENT){if(a.removeNode)return a.removeNode(!1);for(;b=a.firstChild;)c.insertBefore(b,a);return goog.dom.removeNode(a)}};
goog.dom.getChildren=function(a){return goog.dom.BrowserFeature.CAN_USE_CHILDREN_ATTRIBUTE&&void 0!=a.children?a.children:goog.array.filter(a.childNodes,function(a){return a.nodeType==goog.dom.NodeType.ELEMENT})};goog.dom.getFirstElementChild=function(a){return goog.isDef(a.firstElementChild)?a.firstElementChild:goog.dom.getNextElementNode_(a.firstChild,!0)};goog.dom.getLastElementChild=function(a){return goog.isDef(a.lastElementChild)?a.lastElementChild:goog.dom.getNextElementNode_(a.lastChild,!1)};
goog.dom.getNextElementSibling=function(a){return goog.isDef(a.nextElementSibling)?a.nextElementSibling:goog.dom.getNextElementNode_(a.nextSibling,!0)};goog.dom.getPreviousElementSibling=function(a){return goog.isDef(a.previousElementSibling)?a.previousElementSibling:goog.dom.getNextElementNode_(a.previousSibling,!1)};goog.dom.getNextElementNode_=function(a,b){for(;a&&a.nodeType!=goog.dom.NodeType.ELEMENT;)a=b?a.nextSibling:a.previousSibling;return a};
goog.dom.getNextNode=function(a){if(!a)return null;if(a.firstChild)return a.firstChild;for(;a&&!a.nextSibling;)a=a.parentNode;return a?a.nextSibling:null};goog.dom.getPreviousNode=function(a){if(!a)return null;if(!a.previousSibling)return a.parentNode;for(a=a.previousSibling;a&&a.lastChild;)a=a.lastChild;return a};goog.dom.isNodeLike=function(a){return goog.isObject(a)&&0<a.nodeType};goog.dom.isElement=function(a){return goog.isObject(a)&&a.nodeType==goog.dom.NodeType.ELEMENT};
goog.dom.isWindow=function(a){return goog.isObject(a)&&a.window==a};goog.dom.getParentElement=function(a){var b;if(goog.dom.BrowserFeature.CAN_USE_PARENT_ELEMENT_PROPERTY&&!(goog.userAgent.IE&&goog.userAgent.isVersionOrHigher("9")&&!goog.userAgent.isVersionOrHigher("10")&&goog.global.SVGElement&&a instanceof goog.global.SVGElement)&&(b=a.parentElement))return b;b=a.parentNode;return goog.dom.isElement(b)?b:null};
goog.dom.contains=function(a,b){if(a.contains&&b.nodeType==goog.dom.NodeType.ELEMENT)return a==b||a.contains(b);if("undefined"!=typeof a.compareDocumentPosition)return a==b||Boolean(a.compareDocumentPosition(b)&16);for(;b&&a!=b;)b=b.parentNode;return b==a};
goog.dom.compareNodeOrder=function(a,b){if(a==b)return 0;if(a.compareDocumentPosition)return a.compareDocumentPosition(b)&2?1:-1;if(goog.userAgent.IE&&!goog.userAgent.isDocumentModeOrHigher(9)){if(a.nodeType==goog.dom.NodeType.DOCUMENT)return-1;if(b.nodeType==goog.dom.NodeType.DOCUMENT)return 1}if("sourceIndex"in a||a.parentNode&&"sourceIndex"in a.parentNode){var c=a.nodeType==goog.dom.NodeType.ELEMENT,e=b.nodeType==goog.dom.NodeType.ELEMENT;if(c&&e)return a.sourceIndex-b.sourceIndex;var f=a.parentNode,
g=b.parentNode;return f==g?goog.dom.compareSiblingOrder_(a,b):!c&&goog.dom.contains(f,b)?-1*goog.dom.compareParentsDescendantNodeIe_(a,b):!e&&goog.dom.contains(g,a)?goog.dom.compareParentsDescendantNodeIe_(b,a):(c?a.sourceIndex:f.sourceIndex)-(e?b.sourceIndex:g.sourceIndex)}e=goog.dom.getOwnerDocument(a);c=e.createRange();c.selectNode(a);c.collapse(!0);e=e.createRange();e.selectNode(b);e.collapse(!0);return c.compareBoundaryPoints(goog.global.Range.START_TO_END,e)};
goog.dom.compareParentsDescendantNodeIe_=function(a,b){var c=a.parentNode;if(c==b)return-1;for(var e=b;e.parentNode!=c;)e=e.parentNode;return goog.dom.compareSiblingOrder_(e,a)};goog.dom.compareSiblingOrder_=function(a,b){for(var c=b;c=c.previousSibling;)if(c==a)return-1;return 1};
goog.dom.findCommonAncestor=function(a){var b,c=arguments.length;if(!c)return null;if(1==c)return arguments[0];var e=[],f=Infinity;for(b=0;b<c;b++){for(var g=[],h=arguments[b];h;)g.unshift(h),h=h.parentNode;e.push(g);f=Math.min(f,g.length)}g=null;for(b=0;b<f;b++){for(var h=e[0][b],k=1;k<c;k++)if(h!=e[k][b])return g;g=h}return g};goog.dom.getOwnerDocument=function(a){goog.asserts.assert(a,"Node cannot be null or undefined.");return a.nodeType==goog.dom.NodeType.DOCUMENT?a:a.ownerDocument||a.document};
goog.dom.getFrameContentDocument=function(a){return a.contentDocument||a.contentWindow.document};goog.dom.getFrameContentWindow=function(a){return a.contentWindow||goog.dom.getWindow(goog.dom.getFrameContentDocument(a))};
goog.dom.setTextContent=function(a,b){goog.asserts.assert(null!=a,"goog.dom.setTextContent expects a non-null value for node");if("textContent"in a)a.textContent=b;else if(a.nodeType==goog.dom.NodeType.TEXT)a.data=b;else if(a.firstChild&&a.firstChild.nodeType==goog.dom.NodeType.TEXT){for(;a.lastChild!=a.firstChild;)a.removeChild(a.lastChild);a.firstChild.data=b}else{goog.dom.removeChildren(a);var c=goog.dom.getOwnerDocument(a);a.appendChild(c.createTextNode(String(b)))}};
goog.dom.getOuterHtml=function(a){if("outerHTML"in a)return a.outerHTML;var b=goog.dom.getOwnerDocument(a).createElement(goog.dom.TagName.DIV);b.appendChild(a.cloneNode(!0));return b.innerHTML};goog.dom.findNode=function(a,b){var c=[];return goog.dom.findNodes_(a,b,c,!0)?c[0]:void 0};goog.dom.findNodes=function(a,b){var c=[];goog.dom.findNodes_(a,b,c,!1);return c};
goog.dom.findNodes_=function(a,b,c,e){if(null!=a)for(a=a.firstChild;a;){if(b(a)&&(c.push(a),e)||goog.dom.findNodes_(a,b,c,e))return!0;a=a.nextSibling}return!1};goog.dom.TAGS_TO_IGNORE_={SCRIPT:1,STYLE:1,HEAD:1,IFRAME:1,OBJECT:1};goog.dom.PREDEFINED_TAG_VALUES_={IMG:" ",BR:"\n"};goog.dom.isFocusableTabIndex=function(a){return goog.dom.hasSpecifiedTabIndex_(a)&&goog.dom.isTabIndexFocusable_(a)};goog.dom.setFocusableTabIndex=function(a,b){b?a.tabIndex=0:(a.tabIndex=-1,a.removeAttribute("tabIndex"))};
goog.dom.isFocusable=function(a){var b;return(b=goog.dom.nativelySupportsFocus_(a)?!a.disabled&&(!goog.dom.hasSpecifiedTabIndex_(a)||goog.dom.isTabIndexFocusable_(a)):goog.dom.isFocusableTabIndex(a))&&goog.userAgent.IE?goog.dom.hasNonZeroBoundingRect_(a):b};goog.dom.hasSpecifiedTabIndex_=function(a){a=a.getAttributeNode("tabindex");return goog.isDefAndNotNull(a)&&a.specified};goog.dom.isTabIndexFocusable_=function(a){a=a.tabIndex;return goog.isNumber(a)&&0<=a&&32768>a};
goog.dom.nativelySupportsFocus_=function(a){return a.tagName==goog.dom.TagName.A||a.tagName==goog.dom.TagName.INPUT||a.tagName==goog.dom.TagName.TEXTAREA||a.tagName==goog.dom.TagName.SELECT||a.tagName==goog.dom.TagName.BUTTON};goog.dom.hasNonZeroBoundingRect_=function(a){a=goog.isFunction(a.getBoundingClientRect)?a.getBoundingClientRect():{height:a.offsetHeight,width:a.offsetWidth};return goog.isDefAndNotNull(a)&&0<a.height&&0<a.width};
goog.dom.getTextContent=function(a){if(goog.dom.BrowserFeature.CAN_USE_INNER_TEXT&&"innerText"in a)a=goog.string.canonicalizeNewlines(a.innerText);else{var b=[];goog.dom.getTextContent_(a,b,!0);a=b.join("")}a=a.replace(/ \xAD /g," ").replace(/\xAD/g,"");a=a.replace(/\u200B/g,"");goog.dom.BrowserFeature.CAN_USE_INNER_TEXT||(a=a.replace(/ +/g," "));" "!=a&&(a=a.replace(/^\s*/,""));return a};goog.dom.getRawTextContent=function(a){var b=[];goog.dom.getTextContent_(a,b,!1);return b.join("")};
goog.dom.getTextContent_=function(a,b,c){if(!(a.nodeName in goog.dom.TAGS_TO_IGNORE_))if(a.nodeType==goog.dom.NodeType.TEXT)c?b.push(String(a.nodeValue).replace(/(\r\n|\r|\n)/g,"")):b.push(a.nodeValue);else if(a.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)b.push(goog.dom.PREDEFINED_TAG_VALUES_[a.nodeName]);else for(a=a.firstChild;a;)goog.dom.getTextContent_(a,b,c),a=a.nextSibling};goog.dom.getNodeTextLength=function(a){return goog.dom.getTextContent(a).length};
goog.dom.getNodeTextOffset=function(a,b){for(var c=b||goog.dom.getOwnerDocument(a).body,e=[];a&&a!=c;){for(var f=a;f=f.previousSibling;)e.unshift(goog.dom.getTextContent(f));a=a.parentNode}return goog.string.trimLeft(e.join("")).replace(/ +/g," ").length};
goog.dom.getNodeAtOffset=function(a,b,c){a=[a];for(var e=0,f=null;0<a.length&&e<b;)if(f=a.pop(),!(f.nodeName in goog.dom.TAGS_TO_IGNORE_))if(f.nodeType==goog.dom.NodeType.TEXT)var g=f.nodeValue.replace(/(\r\n|\r|\n)/g,"").replace(/ +/g," "),e=e+g.length;else if(f.nodeName in goog.dom.PREDEFINED_TAG_VALUES_)e+=goog.dom.PREDEFINED_TAG_VALUES_[f.nodeName].length;else for(g=f.childNodes.length-1;0<=g;g--)a.push(f.childNodes[g]);goog.isObject(c)&&(c.remainder=f?f.nodeValue.length+b-e-1:0,c.node=f);return f};
goog.dom.isNodeList=function(a){if(a&&"number"==typeof a.length){if(goog.isObject(a))return"function"==typeof a.item||"string"==typeof a.item;if(goog.isFunction(a))return"function"==typeof a.item}return!1};goog.dom.getAncestorByTagNameAndClass=function(a,b,c,e){if(!b&&!c)return null;var f=b?b.toUpperCase():null;return goog.dom.getAncestor(a,function(a){return(!f||a.nodeName==f)&&(!c||goog.isString(a.className)&&goog.array.contains(a.className.split(/\s+/),c))},!0,e)};
goog.dom.getAncestorByClass=function(a,b,c){return goog.dom.getAncestorByTagNameAndClass(a,null,b,c)};goog.dom.getAncestor=function(a,b,c,e){c||(a=a.parentNode);c=null==e;for(var f=0;a&&(c||f<=e);){goog.asserts.assert("parentNode"!=a.name);if(b(a))return a;a=a.parentNode;f++}return null};goog.dom.getActiveElement=function(a){try{return a&&a.activeElement}catch(b){}return null};
goog.dom.getPixelRatio=function(){var a=goog.dom.getWindow();return goog.isDef(a.devicePixelRatio)?a.devicePixelRatio:a.matchMedia?goog.dom.matchesPixelRatio_(.75)||goog.dom.matchesPixelRatio_(1.5)||goog.dom.matchesPixelRatio_(2)||goog.dom.matchesPixelRatio_(3)||1:1};goog.dom.matchesPixelRatio_=function(a){return goog.dom.getWindow().matchMedia("(-webkit-min-device-pixel-ratio: "+a+"),(min--moz-device-pixel-ratio: "+a+"),(min-resolution: "+a+"dppx)").matches?a:0};
goog.dom.DomHelper=function(a){this.document_=a||goog.global.document||document};goog.dom.DomHelper.prototype.getDomHelper=goog.dom.getDomHelper;goog.dom.DomHelper.prototype.setDocument=function(a){this.document_=a};goog.dom.DomHelper.prototype.getDocument=function(){return this.document_};goog.dom.DomHelper.prototype.getElement=function(a){return goog.dom.getElementHelper_(this.document_,a)};
goog.dom.DomHelper.prototype.getRequiredElement=function(a){return goog.dom.getRequiredElementHelper_(this.document_,a)};goog.dom.DomHelper.prototype.$=goog.dom.DomHelper.prototype.getElement;goog.dom.DomHelper.prototype.getElementsByTagNameAndClass=function(a,b,c){return goog.dom.getElementsByTagNameAndClass_(this.document_,a,b,c)};goog.dom.DomHelper.prototype.getElementsByClass=function(a,b){return goog.dom.getElementsByClass(a,b||this.document_)};
goog.dom.DomHelper.prototype.getElementByClass=function(a,b){return goog.dom.getElementByClass(a,b||this.document_)};goog.dom.DomHelper.prototype.getRequiredElementByClass=function(a,b){return goog.dom.getRequiredElementByClass(a,b||this.document_)};goog.dom.DomHelper.prototype.$$=goog.dom.DomHelper.prototype.getElementsByTagNameAndClass;goog.dom.DomHelper.prototype.setProperties=goog.dom.setProperties;goog.dom.DomHelper.prototype.getViewportSize=function(a){return goog.dom.getViewportSize(a||this.getWindow())};
goog.dom.DomHelper.prototype.getDocumentHeight=function(){return goog.dom.getDocumentHeight_(this.getWindow())};goog.dom.DomHelper.prototype.createDom=function(a,b,c){return goog.dom.createDom_(this.document_,arguments)};goog.dom.DomHelper.prototype.$dom=goog.dom.DomHelper.prototype.createDom;goog.dom.DomHelper.prototype.createElement=function(a){return this.document_.createElement(a)};goog.dom.DomHelper.prototype.createTextNode=function(a){return this.document_.createTextNode(String(a))};
goog.dom.DomHelper.prototype.createTable=function(a,b,c){return goog.dom.createTable_(this.document_,a,b,!!c)};goog.dom.DomHelper.prototype.safeHtmlToNode=function(a){return goog.dom.safeHtmlToNode_(this.document_,a)};goog.dom.DomHelper.prototype.htmlToDocumentFragment=function(a){return goog.dom.htmlToDocumentFragment_(this.document_,a)};goog.dom.DomHelper.prototype.isCss1CompatMode=function(){return goog.dom.isCss1CompatMode_(this.document_)};goog.dom.DomHelper.prototype.getWindow=function(){return goog.dom.getWindow_(this.document_)};
goog.dom.DomHelper.prototype.getDocumentScrollElement=function(){return goog.dom.getDocumentScrollElement_(this.document_)};goog.dom.DomHelper.prototype.getDocumentScroll=function(){return goog.dom.getDocumentScroll_(this.document_)};goog.dom.DomHelper.prototype.getActiveElement=function(a){return goog.dom.getActiveElement(a||this.document_)};goog.dom.DomHelper.prototype.appendChild=goog.dom.appendChild;goog.dom.DomHelper.prototype.append=goog.dom.append;
goog.dom.DomHelper.prototype.canHaveChildren=goog.dom.canHaveChildren;goog.dom.DomHelper.prototype.removeChildren=goog.dom.removeChildren;goog.dom.DomHelper.prototype.insertSiblingBefore=goog.dom.insertSiblingBefore;goog.dom.DomHelper.prototype.insertSiblingAfter=goog.dom.insertSiblingAfter;goog.dom.DomHelper.prototype.insertChildAt=goog.dom.insertChildAt;goog.dom.DomHelper.prototype.removeNode=goog.dom.removeNode;goog.dom.DomHelper.prototype.replaceNode=goog.dom.replaceNode;
goog.dom.DomHelper.prototype.flattenElement=goog.dom.flattenElement;goog.dom.DomHelper.prototype.getChildren=goog.dom.getChildren;goog.dom.DomHelper.prototype.getFirstElementChild=goog.dom.getFirstElementChild;goog.dom.DomHelper.prototype.getLastElementChild=goog.dom.getLastElementChild;goog.dom.DomHelper.prototype.getNextElementSibling=goog.dom.getNextElementSibling;goog.dom.DomHelper.prototype.getPreviousElementSibling=goog.dom.getPreviousElementSibling;
goog.dom.DomHelper.prototype.getNextNode=goog.dom.getNextNode;goog.dom.DomHelper.prototype.getPreviousNode=goog.dom.getPreviousNode;goog.dom.DomHelper.prototype.isNodeLike=goog.dom.isNodeLike;goog.dom.DomHelper.prototype.isElement=goog.dom.isElement;goog.dom.DomHelper.prototype.isWindow=goog.dom.isWindow;goog.dom.DomHelper.prototype.getParentElement=goog.dom.getParentElement;goog.dom.DomHelper.prototype.contains=goog.dom.contains;goog.dom.DomHelper.prototype.compareNodeOrder=goog.dom.compareNodeOrder;
goog.dom.DomHelper.prototype.findCommonAncestor=goog.dom.findCommonAncestor;goog.dom.DomHelper.prototype.getOwnerDocument=goog.dom.getOwnerDocument;goog.dom.DomHelper.prototype.getFrameContentDocument=goog.dom.getFrameContentDocument;goog.dom.DomHelper.prototype.getFrameContentWindow=goog.dom.getFrameContentWindow;goog.dom.DomHelper.prototype.setTextContent=goog.dom.setTextContent;goog.dom.DomHelper.prototype.getOuterHtml=goog.dom.getOuterHtml;goog.dom.DomHelper.prototype.findNode=goog.dom.findNode;
goog.dom.DomHelper.prototype.findNodes=goog.dom.findNodes;goog.dom.DomHelper.prototype.isFocusableTabIndex=goog.dom.isFocusableTabIndex;goog.dom.DomHelper.prototype.setFocusableTabIndex=goog.dom.setFocusableTabIndex;goog.dom.DomHelper.prototype.isFocusable=goog.dom.isFocusable;goog.dom.DomHelper.prototype.getTextContent=goog.dom.getTextContent;goog.dom.DomHelper.prototype.getNodeTextLength=goog.dom.getNodeTextLength;goog.dom.DomHelper.prototype.getNodeTextOffset=goog.dom.getNodeTextOffset;
goog.dom.DomHelper.prototype.getNodeAtOffset=goog.dom.getNodeAtOffset;goog.dom.DomHelper.prototype.isNodeList=goog.dom.isNodeList;goog.dom.DomHelper.prototype.getAncestorByTagNameAndClass=goog.dom.getAncestorByTagNameAndClass;goog.dom.DomHelper.prototype.getAncestorByClass=goog.dom.getAncestorByClass;goog.dom.DomHelper.prototype.getAncestor=goog.dom.getAncestor;bd.methodTag.tableGrid={provideMethods:function(){return[{name:"addEntity",fxn:bd.methodTag.tableGrid.addEntity,classOrInstance:"instance"},{name:"getHandsOnTableObject",fxn:bd.methodTag.tableGrid.getHandsOnTableObject,classOrInstance:"instance"},{name:"updateInstancePanel",fxn:bd.methodTag.tableGrid.updateInstancePanel,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.tableGrid.updateSideBar,classOrInstance:"class"},{name:"removeEntityFromView",fxn:bd.methodTag.tableGrid.removeEntityFromView,
classOrInstance:"instance"},{name:"removeConnections",fxn:bd.methodTag.tableGrid.removeConnections,classOrInstance:"instance"},{name:"renderTable",fxn:bd.methodTag.tableGrid.renderTable,classOrInstance:"instance"},{name:"updatePosition",fxn:bd.methodTag.tableGrid.updatePosition,classOrInstance:"instance"}]}};
bd.methodTag.tableGrid.updateInstancePanel=function(){var a=this.model,b=document.getElementById(this.instancePanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("xInput")[0];c.value=a.x;bd.sideBar.ctr.resetTextInputStyle(c);
bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("yInput")[0];c.value=a.y;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"y",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);
a=b.getElementsByClassName("tableEditorContainer")[0];this.setupTableEditor(a)};
bd.methodTag.tableGrid.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("isReadOnlyCheckbox")[0];c.checked=a.readOnly?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"readOnly",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,
null);b.getElementsByClassName("columnEditorLink")[0].onclick=function(a){bd.overlay.ctr.showOverlay("columnEditor");return!1}};
bd.methodTag.tableGrid.addEntity=function(){var a=goog.dom.createDom("div");a.setAttribute("id",this.model.type+"Div"+this.id);a.style.maxHeight=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";a.style.maxWidth=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";a.style.left=(this.model.x-this.model.width/2)*bd.phaser.ctr.gameScaleFactor+"px";a.style.top=(this.model.y-this.model.height/2)*bd.phaser.ctr.gameScaleFactor+"px";a.style.position="absolute";a.style.overflow="scroll";var b="none";this.model.visible&&
(b="block");a.style.display=b;b=bd.component.lookup(this.model.layerId).componentContainerId;bd.component.lookup(this.model.viewId).getWindow().document.getElementById(b).appendChild(a);this.setDisplayObject(a);b=goog.dom.createDom("div");a.appendChild(b);this.setupTableEditor(b)};bd.methodTag.tableGrid.getHandsOnTableObject=function(){return bd.component.lookup(this.model.viewId).getWindow().Handsontable};
bd.methodTag.tableGrid.removeEntityFromView=function(){var a=bd.component.lookup(this.model.layerId).componentContainerId,b=bd.component.lookup(this.model.viewId),c=b.getWindow().document.getElementById(this.model.type+"Div"+this.id);try{b.getWindow().document.getElementById(a).removeChild(c)}catch(e){}};
bd.methodTag.tableGrid.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.layerId],"removeValue",
"entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.methodTag.tableGrid.setTableObject=function(a){this.tableObject=a};bd.methodTag.tableGrid.getTableObject=function(){return this.tableObject};bd.methodTag.tableGrid.renderTable=function(){var a=this.getTableObject();a&&a.render()};
bd.methodTag.tableGrid.updatePosition=function(){var a=this.getDisplayObject();a&&(a.style.maxHeight=this.model.height*bd.phaser.ctr.gameScaleFactor+"px",a.style.maxWidth=this.model.width*bd.phaser.ctr.gameScaleFactor+"px",a.style.left=(this.model.x-this.model.width/2)*bd.phaser.ctr.gameScaleFactor+"px",a.style.top=(this.model.y-this.model.height/2)*bd.phaser.ctr.gameScaleFactor+"px")};bd.modelTag.hasMapSpriteProperties={provideFields:function(){return[{fields:["lat"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["lat"],classOrInstance:"class",providers:["defaultValue"],defaultValue:42.36039450439665},{fields:["lng"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["lng"],classOrInstance:"class",providers:["defaultValue"],defaultValue:-71.08565181380848}]}};bd.methodTag.mapSprite={provideMethods:function(){return[{name:"createEditorDisplayObjectFromXY",fxn:bd.methodTag.mapSprite.createEditorDisplayObjectFromXY,classOrInstance:"instance"},{name:"createEditorDisplayObject",fxn:bd.methodTag.mapSprite.createEditorDisplayObject,classOrInstance:"instance"},{name:"selectInstanceInEditor",fxn:bd.methodTag.mapSprite.selectInstanceInEditor,classOrInstance:"instance"}]}};
bd.methodTag.mapSprite.createEditorDisplayObjectFromXY=function(a,b){var c=bd.component.lookup(bd.model.getCurrentViewId()).getMapObject(),e=new google.maps.OverlayView,f=this;e.draw=function(){var c=e.getProjection().fromContainerPixelToLatLng(new google.maps.Point(a,b));bd.model.addModelUpdateElement([f.id],"set","lat",c.lat(),{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([f.id],"set","lng",c.lng(),{updateUIForOrigin:!1,
updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();f.createEditorDisplayObject();this.setMap(null)};e.setMap(c)};
bd.methodTag.mapSprite.createEditorDisplayObject=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()).getMapObject(),b=new google.maps.LatLng(this.model.lat,this.model.lng),c={url:bd.component.lookup(bd.model.entityLookup(this.model.costumeId).assetId).getThumbnailUrl(),size:new google.maps.Size(50,50),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(25,25),scaledSize:new google.maps.Size(50,50)};new google.maps.Marker({position:b,map:a,icon:c,draggable:!0,title:"Hello World!"})};
bd.methodTag.mapSprite.selectInstanceInEditor=function(){};bd.component.mapSprite={constructor:function(a,b){goog.mixin(this,bd.component.mapSprite.componentProperties);this.tabId="undefined"==typeof b?null:b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"mapSprite",listName:"mapSprites",idName:"mapSpriteId",idListName:"mapSpriteIds",editorDisplayObjectType:"image",
sideBarPanelName:"sideBarMapSpritePanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-sprite.png",namePrefix:"Map Sprite Class",typeName:"Map Sprite",tabName:"Map Sprites",entityName:"Map Sprite Class",entityNamePlural:"Map Sprite Classes",thisName:"this map sprite class",allName:"all map sprite classes",anyName:"any map sprite class",randomName:"random map sprite class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasFlipModes hasHeightWidth hasVisibility hasDragability hasCoordinateOffset hasViewId hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasTargetId hasTint hasMapSpriteProperties".split(" "),
methodTags:["entity","canvasObject","mapSprite"]},getDefaultAssetId:function(){var a=bd.image.ctr.entityTypeToAssetDbCategoriesAndList.assetImage.stock.character,b=Math.floor(Math.random()*a.length),b=a[b].thumbnail_file_name,a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,b);null==a&&(b=new bd.component.assetImage.constructor(null,b,!0,!0),a=b.id,bd.imageLoader.ctr.loadAsset(b.id));return a}};
bd.component.mapSpriteInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.mapSpriteInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"mapSpriteInstance",listName:"mapSpriteInstances",idName:"mapSpriteInstanceId",idListName:"mapSpriteInstanceIds",editorDisplayObjectType:"image",instancePanelName:"mapSpriteInstancePanel",
namePrefix:"map sprite",entityName:"Map Sprite",thisName:"this map sprite",allName:"all map sprites",anyName:"any map sprite",randomName:"random map sprite class",modelTags:bd.component.mapSprite.componentProperties.modelTags,methodTags:bd.component.mapSprite.componentProperties.methodTags}};bd.component.typeNameToComponent.mapSprite=bd.component.mapSprite;bd.component.typeNameToComponent.mapSpriteInstance=bd.component.mapSpriteInstance;bd.component.childNameToParentName.mapSpriteInstance="mapSprite";bd.component.assetRichText={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.assetRichText.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"assetRichText",listName:"assetRichTexts",idName:"assetRichTextId",idListName:"assetRichTextIds",namePrefix:"dummy pic",isAsset:!0,buttonRowElementId:"filepickerButtonsRichText",assetUploadDivId:"filepickerImageUploadContainer",
uploadFilePrefix:"images/uploads/",onServerPrefix:"images/assetRichTexts/",identifierProperty:"thumbnailFileName",defaultAssetIconType:"EDIT",assetCategoriesOrder:["stock","user","game"],assetCategoryInfo:{user:{buttonText:"My Images",buttonId:"assetPickerUserImageButton",hasEditOrDeleteToggle:!0},game:{buttonText:"Game Images",buttonId:"assetPickerGameImageButton"},inherited:{buttonText:"Inherited Images"},stock:{buttonText:"Stock Images",buttonId:"assetPickerStockImageButton",subCategories:{containerId:"assetPickerImageSubCategoryContainer",
buttonOrder:["character","item","vehicle"],buttonInfo:{character:{buttonId:"assetPickerCharactersImageButton"},item:{buttonId:"assetPickerItemsImageButton"},vehicle:{buttonId:"assetPickerVehiclesImageButton"}}}}},modelTags:["entity","hasAssetProperties","hasRichTextAssetProperties"],methodTags:["entity","asset","assetRichText"]}};bd.component.typeNameToComponent.assetRichText=bd.component.assetRichText;bd.component.assetRichText.getThumbnailUrlFromDbInfo=function(a){return bd.methodTag.assetRichText.getThumbnailUrl};
bd.component.assetRichText.getThumbnailUrlFromParams=function(){return bd.methodTag.assetRichText.getThumbnailUrl()};bd.modelTag.hasTutorialProperties={provideFields:function(){return[{fields:["tutorialStepIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]}]}};bd.player={};bd.player.bootstrap={};bd.player.bootstrap.sessionCode="";
bd.player.bootstrap.init=function(){bd.inPlayer=!0;bd.isServer=!1;bd.gitRevision=document.getElementById("gitRevision").innerHTML;var a=document.getElementById("socketServer").innerHTML;bd.socket=io.connect("http://"+a+":"+document.getElementById("socketPort").innerHTML);bd.socket.on("serverGameUpdate",function(a){bd.model.dispatchIncomingData(a)});bd.socket.on("gameFileReceived",function(a){bd.player.bootstrap.initCallback(a)});bd.component.initializeComponents();bd.model.populateModels();null==
bd.model.getCurrentGame()?(bd.instanceId=document.getElementById("mongoId").innerHTML,bd.socket.emit("setInstanceId",{instanceId:bd.instanceId})):bd.player.ctr.setupSelection();bd.player.ctr.window=window};bd.player.bootstrap.initCallback=function(a){bd.model.currentInstance=a.game;bd.model.populateEntityLookup();bd.imageLoader.ctr.loadAllAssets();bd.player.ctr.setupSelection()};
bd.player.bootstrap.singlePlayer=function(){bd.isSinglePlayer=!0;bd.inPlayer=!0;bd.isServer=!1;bd.player.ctr.inEditorPreview=!1;bd.player.ctr.window=window;document.getElementById("isCordova")&&"True"==document.getElementById("isCordova").innerHTML&&(bd.player.ctr.isCordova=!0);document.getElementById("isStandalone")&&"true"==document.getElementById("isStandalone").innerHTML&&(bd.player.ctr.isStandalone=!0);var a=document.getElementById("noFrames")&&"true"==document.getElementById("noFrames").innerHTML;
bd.player.ctr.hasNoFrames=a;a=!0;if(!bd.player.ctr.isCordova&&"1"==document.getElementById("isMultiplayer").innerHTML){a=!1;document.getElementById("viewFrameContainer").style.display="none";document.getElementById("instanceSelectionContainer").style.display="block";for(var b=document.getElementsByClassName("resetGameButtonPlay"),c=0;c<b.length;c++)b[c].style.display="none"}bd.player.ctr.isCordova&&"1"==document.getElementById("isMultiplayer").innerHTML&&(a=!1,bd.player.bootstrap.loadGame(bd.player.bootstrap.loadedGameString));
a&&(a=document.getElementById("gameId").innerHTML,b="",bd.player.ctr.isCordova&&(b=document.getElementById("siteUrl").innerHTML),bd.player.ctr.isStandalone?bd.util.ajaxGet(b+"gbgame/game.txt",function(a){a={game:JSON.parse(a)};bd.player.bootstrap.loadSinglePlayerGame(JSON.stringify(a))}):bd.util.ajaxGet(b+"/game/getPlayerGame/"+a+"/?rnd="+Math.random(),bd.player.bootstrap.loadSinglePlayerGame));bd.player.ctr.isStandalone||MIDI.loadPlugin({soundfontUrl:"/static/sounds/soundfont/",onprogress:function(a,
b){console.log(a,b)}})};
bd.player.bootstrap.loadGame=function(a){bd.evaluator.ctr.resetEvaluatorForNewGame();bd.deviceMotion.ctr.setup();var b=JSON.parse(a).game;bd.model.currentInstance=b;bd.model.populateEntityLookup();b=bd.model.currentInstance;bd.player.ctr.playerId=b.players[0].id;bd.revision.ctr.updateGame();bd.player.ctr.isCordova&&setTimeout(function(){var a=angular.element(document.getElementsByClassName("playPageView")[0]).scope(),b=bd.model.getGameInfo();a.$apply(function(){var f=b.gameName;b.isMultiplayerGame&&
(f=bd.instance.ctr.instanceCode+" - "+f);a.gameTitle=f})},0);bd.model.getGameInfo().dictionaries=bd.evaluator.ctr.getDictionariesFromBlocks();bd.dictionary.ctr.loadDictionaries(function(){bd.projectParam.ctr.setupParamsInPlayer(function(){bd.model.convertGameToInstance(b,null,function(){bd.player.ctr.setupSelection()})})})};
bd.player.bootstrap.restartGame=function(a){bd.player.bootstrap.stopScripts();"undefined"==typeof a&&(a=bd.player.bootstrap.loadedGameString);null!=a&&(document.getElementById("viewFrameContainer").innerHTML="",bd.player.bootstrap.loadGame(a))};
bd.player.bootstrap.stopScripts=function(){bd.evaluator.ctr.stopAllTimers();bd.evaluator.ctr.callStackObjectsForTick=[];bd.evaluator.ctr.stacksToEvaluate=[];bd.evaluator.ctr.callStack=[];bd.evaluator.ctr.stackIdsForThisTick=[];bd.evaluator.ctr.stackIdsForNextTick=[];bd.evaluator.ctr.currentCallStackId=null;bd.evaluator.ctr.gameStarted=!1};
bd.player.bootstrap.stopGame=function(){bd.player.bootstrap.stopScripts();document.getElementById("viewFrameContainer").innerHTML="";var a=document.createElement("div");a.style.width="490px";a.style.height="418px";a.style.border="1px solid black";a.style.display="block";document.getElementById("viewFrameContainer").appendChild(a)};bd.player.bootstrap.loadSinglePlayerGame=function(a){bd.player.bootstrap.loadedGameString=a;bd.player.bootstrap.loadGame(bd.player.bootstrap.loadedGameString)};
bd.player.bootstrap.editorFrameInit=function(){bd.inPlayer=!0;bd.isServer=!1;bd.gitRevision=document.getElementById("gitRevision").innerHTML;bd.model.currentInstance=window.parent.bd.model.currentInstance;bd.player.ctr.inEditorPreview=!0;bd.component.initializeComponents();bd.model.populateModels();bd.model.populateEntityLookup();bd.imageLoader.ctr.loadAllAssets();bd.player.ctr.window=window;for(var a=0;a<bd.model.getCurrentGameAssets().length;a++)bd.model.getCurrentGameAssets();window.scrollTo(20,
20);MIDI.loadPlugin({soundfontUrl:"/static/sounds/soundfont/",onprogress:function(a,c){console.log(a,c)}});bd.model.getGameInfo().dictionaries=bd.evaluator.ctr.getDictionariesFromBlocks();bd.dictionary.ctr.loadDictionaries(function(){bd.player.ctr.setupSelection()})};jQuery(document).ready(function(){document.getElementById("noFrames")&&"true"==document.getElementById("noFrames").innerHTML&&bd.player.bootstrap.singlePlayer()});bd.methodTag.spreadsheet={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.spreadsheet.updateSideBar}]}};
bd.methodTag.spreadsheet.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);b=b.getElementsByClassName("spreadsheetKeyInput")[0];b.value=a.spreadsheetKey;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"spreadsheetKey"},null,bd.sideBar.ctr.textUpdateSuccess,null)};bd.evaluator.ctr.blocks.list={};bd.evaluator.ctr.configs.create_list={getParams:function(a){for(var b=[],c=0;c<parseInt(a.mutation._nums);c++)b.push({name:"ADD"+c,type:"value",valueName:"ADD"+c});return b},evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=[],e=0;e<parseInt(a.mutation._nums);e++)null!=b.params["ADD"+e]&&c.push(b.params["ADD"+e]);bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.add_to_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"},{name:"val",type:"value",valueName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.val,b=b.params.currentList;"true"==a.mutation._has_output?(b=b.slice(0),b.push(c),bd.evaluator.ctr.returnHandler(b,a.returnsEntity)):(b.push(c),bd.evaluator.ctr.nextBlockInCallStack(a.next))}};
bd.evaluator.ctr.configs.insert_into_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"},{name:"val",type:"value",valueName:"VAR"},{name:"listIndex",type:"value",valueName:"INDEX"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.val,e=b.params.currentList,f=Math.floor(b.params.listIndex)-1;f!==b.params.listIndex-1&&bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_NOT_AN_INTEGER,[b.params.listIndex]);0>f?(bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_OUT_OF_BOUNDS,
[f+1,a.value[2].block.field.__text]),f=0):f>e.length&&(bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_OUT_OF_BOUNDS,[f+1,a.value[2].block.field.__text]),f=e.length);"true"==a.mutation._has_output?(b=e.slice(0),b.splice(f,0,c),bd.evaluator.ctr.returnHandler(b,a.returnsEntity)):(e.splice(f,0,c),bd.evaluator.ctr.nextBlockInCallStack(a.next))}};
bd.evaluator.ctr.configs.change_item_from_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"},{name:"val",type:"value",valueName:"VAR"},{name:"listIndex",type:"value",valueName:"INDEX"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.val,e=b.params.currentList,f=Math.floor(b.params.listIndex)-1;f!==b.params.listIndex-1&&bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_NOT_AN_INTEGER,[b.params.listIndex]);0>f?(f=0,bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_OUT_OF_BOUNDS,
[f+1,a.value[1].block.field.__text])):f>=e.length&&(bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_OUT_OF_BOUNDS,[f+1,a.value[1].block.field.__text]),f=e.length-1);"true"==a.mutation._has_output?(b=e.slice(0),b.splice(f,1,c),bd.evaluator.ctr.returnHandler(b,a.returnsEntity)):(e.splice(f,1,c),bd.evaluator.ctr.nextBlockInCallStack(a.next))}};
bd.evaluator.ctr.configs.remove_from_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"},{name:"val",type:"value",valueName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.val,e=b.params.currentList,f=!1,b=function(a){for(var b=0;b<a.length;b++)if(a[b]==c){a.splice(b,1);f=!0;break}};"true"==a.mutation._has_output?(e=e.slice(0),b(e),f||bd.errorLog.ctr.printError(bd.msg.ERROR_NOT_IN_LIST,[c,e]),bd.evaluator.ctr.returnHandler(e,a.returnsEntity)):
(b(e),f||bd.errorLog.ctr.printError(bd.msg.ERROR_NOT_IN_LIST,[c,"["+e+"]"]),bd.evaluator.ctr.nextBlockInCallStack(a.next))}};
bd.evaluator.ctr.configs.shuffle_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.currentList;if("true"==a.mutation._has_output){for(var b=b.slice(0),c=[],e=b.length-1;0<=e;e--){var f=Math.floor(Math.random()*b.length);c.push(b.splice(f,1)[0])}bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}else{for(f=b.length;f;c=parseInt(Math.random()*f),e=b[--f],b[f]=b[c],b[c]=e);bd.evaluator.ctr.nextBlockInCallStack(a.next)}}};
bd.evaluator.ctr.configs.list_contains={paramsInfo:[{name:"val",type:"value",valueName:"VAR"},{name:"currentList",type:"value",valueName:"LIST"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.currentList,b=b.params.val,e=!1,f=0;f<c.length;f++)c[f]==b&&(e=!0);bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}};
bd.evaluator.ctr.configs.list_length={paramsInfo:[{name:"list",type:"value",valueName:"LIST"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.returnHandler(b.params.list.length,a.returnsEntity)}};
bd.evaluator.ctr.configs.item_from_list={paramsInfo:[{name:"listIndex",type:"value",valueName:"INDEX"},{name:"currentList",type:"value",valueName:"LIST"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=Math.floor(b.params.listIndex);c!==b.params.listIndex&&bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_NOT_AN_INTEGER,[b.params.listIndex]);b=b.params.currentList;0<b.length&&c<=b.length&&0<c?bd.evaluator.ctr.returnHandler(b[c-1],a.returnsEntity):(0==b.length?bd.evaluator.ctr.returnHandler("nullObject",
a.returnsEntity):c>b.length?bd.evaluator.ctr.returnHandler(b[b.length-1],a.returnsEntity):1>c&&bd.evaluator.ctr.returnHandler(b[0],a.returnsEntity),bd.errorLog.ctr.printError(bd.msg.ERROR_INDEX_OUT_OF_BOUNDS,[c,a.value[1].block.field.__text]))}};
bd.evaluator.ctr.configs.random_item_from_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.currentList;0==b.length?bd.evaluator.ctr.returnHandler("nullObject",a.returnsEntity):bd.evaluator.ctr.returnHandler(b[Math.floor(Math.random()*b.length)],a.returnsEntity)}};
bd.evaluator.ctr.configs.empty_list={paramsInfo:[{name:"currentList",type:"value",valueName:"LIST"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.currentList;b.splice(0,b.length);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.cordova={};bd.cordova.ctr={};bd.cordova.ctr.bootstrap={};bd.cordova.ctr.bootstrap.deviceReadyCallbacks=[];var app={initialize:function(){this.bindEvents()},bindEvents:function(){document.addEventListener("deviceready",this.onDeviceReady,!1)},onDeviceReady:function(){if(bd&&0!=bd.cordova.ctr.bootstrap.deviceReadyCallbacks.length)for(var a=0;a<bd.cordova.ctr.bootstrap.deviceReadyCallbacks.length;a++)bd.cordova.ctr.bootstrap.deviceReadyCallbacks[a]();app.receivedEvent("deviceready")},receivedEvent:function(a){}};
app.initialize();bd.evaluator.ctr.blocks.stage={};
bd.evaluator.ctr.configs.stage_switch={getParams:function(a){var b=[];a.mutation&&"1"==a.mutation._has_stage_num&&b.push({name:"stageNum",type:"value",valueName:"STAGE_NUM"});b.push({name:"stageId",type:"field",fieldName:"VIEW"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();if(b.hasStageSwitched)b.hasStageSwitched=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next);else{b.hasStageSwitched=!0;var c;a=bd.model.getStageIds();if("NEXT"==b.params.stageId||"PREVIOUS"==b.params.stageId){var e=
bd.component.lookup(bd.player.ctr.playerId).getStageId(),e=a.indexOf(e);"NEXT"==b.params.stageId&&(c=e==a.length-1?a[0]:a[e+1]);"PREVIOUS"==b.params.stageId&&(c=0==e?a[a.length-1]:a[e-1])}else"STAGE_NUM"==b.params.stageId?(e=b.params.stageNum-1,c=a[(e+a.length)%a.length]):c=bd.util.removePrefix(b.params.stageId,"id");bd.model.addModelUpdateElement([bd.player.ctr.playerId],"set","viewId",c,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();
bd.evaluator.ctr.onSwitchStageEvent(c);bd.evaluator.ctr.stackIdsForThisTick.push(bd.evaluator.ctr.currentCallStackId);bd.evaluator.ctr.currentCallStackId=null}}};
bd.evaluator.ctr.configs.stage_set_get_number={getParams:function(a){var b=[];"set"==a.mutation._set_or_get&&b.push({name:"stageNum",type:"value",valueName:"STAGE_NUM"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.stageNum,e=bd.model.getStageIds(),c=e[c-1];"set"==a.mutation._set_or_get?b.hasStageSwitched?(b.hasStageSwitched=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next)):(b.hasStageSwitched=!0,bd.model.addModelUpdateElement([bd.player.ctr.playerId],"set",
"viewId",c,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates(),bd.evaluator.ctr.stackIdsForThisTick.push(bd.evaluator.ctr.currentCallStackId),bd.evaluator.ctr.currentCallStackId=null):(c=bd.model.entityLookup(bd.player.ctr.playerId).viewId,e=bd.model.getStageIds(),b=e.indexOf(c),bd.evaluator.ctr.returnHandler(b+1,a.returnsEntity))}};
bd.evaluator.ctr.configs.stage_height_width={paramsInfo:[{name:"dimension",type:"field",fieldName:"DIMENSION"},{name:"viewId",type:"entity",fieldName:"VIEW"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.dimension,b=bd.component.lookup(b.params.viewId[0]).getPlayerViewHeightWidth();bd.evaluator.ctr.returnHandler(b[c],a.returnsEntity)}};
bd.evaluator.ctr.configs.is_on_stage={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"stageIdArray",type:"entity",fieldName:"STAGE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.stageIdArray[0],b=bd.component.lookup(b.params.entityIdArray[0]).getStageId();bd.evaluator.ctr.returnHandler(c==b,a.returnsEntity)}};
bd.evaluator.ctr.configs.is_player_on_stage={paramsInfo:[{name:"stageIdArray",type:"entity",fieldName:"STAGE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.stageIdArray[0],c=bd.component.lookup(bd.player.ctr.playerId).getStageId();bd.evaluator.ctr.returnHandler(b==c,a.returnsEntity)}};bd.evaluator.ctr.configs.number_of_stages={paramsInfo:[],evalFunc:function(a){var b=bd.model.getStageIds().length;bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};
bd.evaluator.ctr.configs.stage_sprite_set_get={getParams:function(a){var b=[];"set"==a.mutation._set_or_get&&("1"==a.mutation._has_stage_num&&b.push({name:"stageNum",type:"value",valueName:"STAGE_NUM"}),b.push({name:"stageId",type:"field",fieldName:"STAGE"}));b.push({name:"entityIdArray",type:"entity",fieldName:"ENTITY"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray[0];if("set"==a.mutation._set_or_get){if("STAGE_NUM"==b.params.stageId||"NEXT"==
b.params.stageId||"PREVIOUS"==b.params.stageId){var e=bd.model.getStageIds(),f;if("STAGE_NUM"==b.params.stageId){var g=b.params.stageNum-1;f=e[(g+e.length)%e.length]}else if("NEXT"==b.params.stageId||"PREVIOUS"==b.params.stageId)g=bd.model.entityLookup(c).viewId,g=e.indexOf(g),"NEXT"==b.params.stageId&&(f=g==e.length-1?e[0]:e[g+1]),"PREVIOUS"==b.params.stageId&&(f=0==g?e[e.length-1]:e[g-1]);b=bd.component.lookup(bd.component.lookup(c).model.parentId).model.type;b=bd.component.getComponentByType(b).componentProperties.possibleLayerTypes;
f=bd.component.lookup(f).getLayerIds();for(e=0;e<f.length;e++)if(g=bd.component.lookup(f[e]).model.type,-1!=b.indexOf(g)){bd.component.lookup(c).moveToLayerXY(f[e],bd.component.lookup(c).getLocalXY("x"),bd.component.lookup(c).getLocalXY("y"));break}}else f=bd.util.removePrefix(b.params.stageId,"id"),bd.component.lookup(c).moveToLayerXY(f,bd.component.lookup(c).getLocalXY("x"),bd.component.lookup(c).getLocalXY("y"));bd.evaluator.ctr.nextBlockInCallStack(a.next)}"get"==a.mutation._set_or_get&&(f=bd.component.lookup(c).getStageId(),
e=bd.model.getStageIds(),g=e.indexOf(f),bd.evaluator.ctr.returnHandler(g+1,a.returnsEntity))}};bd.modelTag.hasRichTextInputProperties={requiredFields:["height","width"],provideFields:function(){return[{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:100},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:200},{fields:["offsetX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["offsetY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["entityPerPlayer"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:!1},{fields:["entityPerPlayer"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:!0}]}};bd.modelTag.hasPlayerProperties={requiredFields:["nextId","username","viewId","roleId"],provideFields:function(){return[{fields:["nextId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["viewId"],classOrInstance:"class",providers:["srcInstance","function"],fxn:bd.modelTag.hasPlayerProperties.provideViewId},{fields:["username"],classOrInstance:"class",providers:["function"],fxn:bd.modelTag.hasPlayerProperties.provideUsername},{fields:["roleId"],classOrInstance:"class",
providers:["function"],fxn:bd.modelTag.hasPlayerProperties.provideRoleId},{fields:["hasJoined"],providers:["defaultValue"],defaultValue:!1}]}};
bd.modelTag.hasPlayerInstanceProperties={requiredFields:["nextId","username","viewId","roleId"],provideFields:function(){return[{fields:["nextId"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:0},{fields:["viewId"],classOrInstance:"instance",providers:["srcInstance","function"],fxn:bd.modelTag.hasPlayerProperties.provideViewId},{fields:["username"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasPlayerProperties.provideUsername},{fields:["roleId"],classOrInstance:"instance",
providers:["function"],fxn:bd.modelTag.hasPlayerProperties.provideRoleId},{fields:["hasJoined"],providers:["defaultValue"],defaultValue:!1}]}};bd.modelTag.hasPlayerProperties.provideViewId=function(){this.model.viewId=bd.model.getCurrentViewId();null==this.model.viewId&&(this.model.viewId=bd.model.getEntityList("phaserView")[0].id)};bd.modelTag.hasPlayerProperties.provideUsername=function(){this.model.username=null!=this.srcInstance?this.username:"a username"};
bd.modelTag.hasPlayerProperties.provideRoleId=function(){this.model.roleId=null!=this.srcInstance?this.srcInstance.id:null};bd.component.levelEditorCategoryComponentContent={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorCategoryComponentContent.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorCategoryComponentContent",listName:"levelEditorCategoryComponentContents",idName:"levelEditorCategoryComponentContentId",idListName:"levelEditorCategoryComponentContentIds",
namePrefix:"unused prefix...",tabName:"Level Editor Category Component Content",entityName:"Level Editor Category Component Content",modelTags:["entity","categoryComponentContent"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorCategoryComponentContent=bd.component.levelEditorCategoryComponentContent;bd.modelTag.hasPhaserViewProperties={requiredFields:[],provideFields:function(){return[{fields:["gridVisible"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["backgroundColor"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"#FFFFFF"},{fields:["cameraLayerIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["hasCamera"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["cameraHeight"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:250},{fields:["cameraWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:400},{fields:["cameraX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["cameraY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["instanceIdToFollow"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["cameraLocationType"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"instance"}]},
provideProperties:function(){return{BACKGROUND_COLOR:{modelName:"backgroundColor",getType:function(){return bd.type.ctr.getColorTypeObject}}}}};
bd.modelTag.hasBackgroundDrawingProperties={provideFields:function(){return[{fields:["backgroundDrawingColor"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["backgroundDrawingColor"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"#000000"},{fields:["backgroundDrawingThickness"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["backgroundDrawingThickness"],classOrInstance:"class",providers:["defaultValue"],defaultValue:10},{fields:["backgroundDrawingEnabled"],
classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["backgroundDrawingEnabled"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]},provideProperties:function(){return{BACKGROUND_DRAWING_COLOR:{modelName:"backgroundDrawingColor",getType:function(){return bd.type.ctr.getColorTypeObject}},BACKGROUND_DRAWING_THICKNESS:{modelName:"backgroundDrawingThickness",getType:function(){return bd.type.ctr.getNumberTypeObject}},BACKGROUND_DRAWING_ENABLED:{modelName:"backgroundDrawingEnabled",
getType:function(){return bd.type.ctr.getBooleanTypeObject}}}}};bd.methodTag.richTextInput={provideMethods:function(){return[{name:"addEntity",fxn:bd.methodTag.richTextInput.addEntity,classOrInstance:"instance"},{name:"textChanged",fxn:bd.methodTag.richTextInput.textChanged,classOrInstance:"instance"},{name:"removeConnections",fxn:bd.methodTag.richTextInput.removeConnections,classOrInstance:"instance"},{name:"updateInstancePanel",fxn:bd.methodTag.richTextInput.updateInstancePanel,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.richTextInput.updateSideBar,
classOrInstance:"class"},{name:"removeEntityFromView",fxn:bd.methodTag.richTextInput.removeEntityFromView,classOrInstance:"instance"},{name:"setRichText",fxn:bd.methodTag.richTextInput.setRichText,classOrInstance:"instance"},{name:"textVariableHandler",fxn:bd.methodTag.richTextInput.textVariableHandler,classOrInstance:"instance"},{name:"variableRefresh",fxn:bd.methodTag.richTextInput.variableRefresh,classOrInstance:"instance"},{name:"switchCostume",fxn:bd.methodTag.richTextInput.switchCostume,classOrInstance:"instance",
inEditor:!1,inPlayer:!0},{name:"getSceditorInstance",fxn:bd.methodTag.richTextInput.getSceditorInstance,classOrInstance:"instance"},{name:"updatePosition",fxn:bd.methodTag.richTextInput.updatePosition,classOrInstance:"instance"}]}};bd.methodTag.richTextInput.handleCommand=function(a){return"richText"==a.property&&bd.model.isInstance(this.id)&&bd.inPlayer?(this.setRichText(a.value),!0):!1};
bd.methodTag.richTextInput.updateInstancePanel=function(){var a=this.model,b=this.model.id,c=bd.component.lookup(a.costumeId);bd.component.lookup(c.model.assetId);c=document.getElementById(this.instancePanelName);b=c.getElementsByClassName("nameInput")[0];b.value=a.name;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);b=c.getElementsByClassName("heightInput")[0];b.value=a.height;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,
{entityId:a.id,propertyName:"height",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=c.getElementsByClassName("widthInput")[0];b.value=a.width;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"width",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,
bd.sideBar.ctr.textUpdateFailure);b=c.getElementsByClassName("xInput")[0];b.value=a.x;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=c.getElementsByClassName("yInput")[0];b.value=a.y;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"y",
isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);var b=this.model.id,e=c.getElementsByClassName("richTextEditorPencil")[0];(function(a){e.onclick=function(b){bd.overlay.ctr.showOverlay("imageSelection",["assetRichText"],a)}})(b)};
bd.methodTag.richTextInput.setupRichTextInputPanel=function(){var a=goog.dom.createDom("button");a.innerHTML="Edit Text";soundChannelElement.appendChild(a);(function(a){soundChannelDeleteElement.onclick=function(c){bd.component.lookup(a).deleteEntity();soundComponentObject.updateSideBar()}})(id)};
bd.methodTag.richTextInput.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0,
updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=b.getElementsByClassName("widthInput")[0];b.value=a.width;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"width",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,
bd.sideBar.ctr.textUpdateFailure);var e=document.getElementsByClassName("richTextEditButtonPanel")[0].getElementsByClassName("richTextEditorPencil")[0];(function(){e.onclick=function(a){bd.overlay.ctr.showOverlay("imageSelection",["assetRichText"])}})()};
bd.methodTag.richTextInput.addEntity=function(){var a=goog.dom.createDom("div");a.setAttribute("id",this.model.type+"Div"+this.id);a.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";a.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";a.style.left=this.model.x*bd.phaser.ctr.gameScaleFactor+"px";a.style.top=this.model.y*bd.phaser.ctr.gameScaleFactor+"px";a.style.position="absolute";var b="none";this.model.visible&&(b="block");a.style.display=b;b=goog.dom.createDom("textarea");
b.readOnly=!0;b.setAttribute("id","richTextInput"+this.id);b.setAttribute("richText","richText");b.className="richTextArea";b.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";b.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";b.instanceId=this.id;var c=bd.component.lookup(this.model.costumeId),c=bd.component.lookup(c.model.assetId).model.richText;b.value=this.textVariableHandler(c);this.variableRefresh();b.onchange=function(a){bd.component.lookup(a.target.instanceId).textChanged(a.target.value)};
b.onkeyup=function(a){bd.component.lookup(a.target.instanceId).textChanged(a.target.value)};a.appendChild(b);b=bd.component.lookup(this.model.layerId).componentContainerId;c=bd.component.lookup(this.model.viewId);c.getWindow().document.getElementById(b).appendChild(a);b=c.getWindow().$;b("textarea#richTextInput"+this.id).sceditor({plugins:"bbcode",toolbar:"",style:"/static/scripts/libraries/scEditor/minified/jquery.sceditor.default.min.css",emoticonsRoot:"/static/images/",height:this.model.height*
bd.phaser.ctr.gameScaleFactor,width:this.model.width*bd.phaser.ctr.gameScaleFactor,resizeEnabled:!1,spellcheck:!1,readOnly:!0});this.setDisplayObject(a)};bd.methodTag.richTextInput.textVariableHandler=function(a){var b=bd.model.getGameInfo().id,c=bd.component.lookup(b),e=/\[var\]([^\[]*)\[\/var]/,f=function(a){if(e.test(a)){var b=e.exec(a)[1];(doesVariableExist=c.getGlobalVariable(b))?(variableValue=c.getGlobalVariable(b).value,a=f(a.replace(e,variableValue))):a=f(a.replace(e,b))}return a};return f(a)};
bd.methodTag.richTextInput.getVariablesInText=function(a){var b=/\[var\]([^\[]*)\[\/var]/,c=function(a,f){if(b.test(a)){var g=b.exec(a)[1];-1==f.indexOf(g)&&f.push(g);f=c(a.replace(b,g),f)}return f};return c(a,[])};
bd.methodTag.richTextInput.variableRefresh=function(){var a=this.getDisplayObject(),b=bd.component.lookup(this.model.viewId).getWindow().$;a&&a.getElementsByClassName("richTextArea")[0]&&(a=bd.component.lookup(this.model.costumeId),a=bd.component.lookup(a.model.assetId),a=this.textVariableHandler(a.model.richText),b("textarea#richTextInput"+this.id).sceditor("instance").val(a))};
bd.methodTag.richTextInput.switchCostume=function(){if(null!=this.getDisplayObject()){var a=this.getDisplayObject(),b=bd.component.lookup(this.model.costumeId),b=bd.component.lookup(b.model.assetId).model.richText;a.children[0].value=this.textVariableHandler(b);this.variableRefresh()}};bd.methodTag.richTextInput.textChanged=function(a){bd.model.addModelUpdateElement([this.id],"set","richText",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.richTextInput.removeEntityFromView=function(){var a=bd.component.lookup(this.model.layerId).componentContainerId,b=bd.component.lookup(this.model.viewId),c=b.getWindow().document.getElementById(this.model.type+"Div"+this.id);try{b.getWindow().document.getElementById(a).removeChild(c)}catch(e){}};bd.methodTag.richTextInput.setRichText=function(){};
bd.methodTag.richTextInput.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.layerId],"removeValue",
"entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.methodTag.richTextInput.getSceditorInstance=function(){var a=bd.component.lookup(this.model.viewId).getWindow().$;return a("textarea#richTextInput"+this.id).sceditor("instance")};
bd.methodTag.richTextInput.updatePosition=function(){var a=this.getDisplayObject();if(a){a.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";a.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";a.style.left=this.model.x*bd.phaser.ctr.gameScaleFactor+"px";a.style.top=this.model.y*bd.phaser.ctr.gameScaleFactor+"px";var a=this.model.height*bd.phaser.ctr.gameScaleFactor,b=this.model.width*bd.phaser.ctr.gameScaleFactor,c=this.getSceditorInstance();c.height(a);c.width(b)}};bd.methodTag.htmlObject={provideMethods:function(){return[{name:"show",fxn:bd.methodTag.htmlObject.show,classOrInstance:"instance"},{name:"hide",fxn:bd.methodTag.htmlObject.hide,classOrInstance:"instance"},{name:"canCreateInstance",fxn:bd.methodTag.htmlObject.canCreateInstance,classOrInstance:"class"}]}};bd.methodTag.htmlObject.handleCommand=function(a){return"visible"==a.property?(1==a.value?this.show():this.hide(),!0):!1};
bd.methodTag.htmlObject.show=function(){var a=bd.component.lookup(this.model.viewId);a.isInitialized&&a.getWindow().document.getElementById(this.model.type+"Div"+this.id)&&(a.getWindow().document.getElementById(this.model.type+"Div"+this.id).style.display="block")};
bd.methodTag.htmlObject.hide=function(){var a=bd.component.lookup(this.model.viewId);a.isInitialized&&a.getWindow().document.getElementById(this.model.type+"Div"+this.id)&&(a.getWindow().document.getElementById(this.model.type+"Div"+this.id).style.display="none")};bd.methodTag.htmlObject.canCreateInstance=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()).getSelectedLayerId(),b=bd.component.uiLayer.componentProperties.type;return(a=bd.model.entityLookup(a))&&a.type==b};bd.component.richTextInput={constructor:function(a,b){goog.mixin(this,bd.component.richTextInput.componentProperties);this.tabId=b;if(null==a){var c=(new bd.component.assetRichText.constructor(null)).id;bd.imageLoader.ctr.loadAsset(c);this.defaultImageId=c}this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"richTextInput",listName:"richTextInputs",idName:"richTextInputId",idListName:"richTextInputIds",sideBarPanelName:"sideBarRichTextInputPanel",
defaultImageUrlObject:{url:"images/textInput.png",internal:!0},tabIconFileName:"class-icon-input.png",editorDisplayObjectType:"image",possibleLayerTypes:["uiLayer"],namePrefix:"Rich Text Input Class",typeName:"Rich Text Input",tabName:"Rich Text Inputs",entityName:"Rich Text Input Class",entityNamePlural:"Rich Text Input Classes",thisName:"this rich text input class",allName:"all rich text input classes",anyName:"any rich text input class",randomName:"random rich text input class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasHeightWidth hasVisibility hasViewId hasLayerId hasCostume hasCoordinateOffset shareMode hasTraits hasTabContainer hasScripts hasRichTextInputProperties".split(" "),
methodTags:["entity","canvasObject","htmlObject","richTextInput"]},getDefaultAssetId:function(){var a=new bd.component.assetRichText.constructor(null);defaultAssetId=a.id;bd.imageLoader.ctr.loadAsset(a.id);return defaultAssetId}};
bd.component.richTextInputInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.richTextInputInstance.componentProperties);if(a=null==a)b=(new bd.component.assetRichText.constructor(null)).id,bd.imageLoader.ctr.loadAsset(b),this.defaultImageId=b;bd.modelTag.applyTags(this,a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"richTextInputInstance",listName:"richTextInputInstances",idName:"richTextInputInstanceId",
idListName:"richTextInputInstanceIds",editorDisplayObjectType:"image",instancePanelName:"richTextInputInstancePanel",editButtonPanelName:"richTextEditButtonPanel",shouldUpdatePositionToScale:!0,namePrefix:" rich text input",entityName:"Rich Text Input",thisName:"this rich text input",allName:"all text inputs",anyName:"any text input",randomName:"random text input",modelTags:bd.component.richTextInput.componentProperties.modelTags,methodTags:bd.component.richTextInput.componentProperties.methodTags}};
bd.component.typeNameToComponent.richTextInput=bd.component.richTextInput;bd.component.typeNameToComponent.richTextInputInstance=bd.component.richTextInputInstance;bd.component.childNameToParentName.richTextInputInstance="richTextInput";bd.methodTag.levelEditor={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.levelEditor.removeConnections},{name:"addTab",fxn:bd.methodTag.levelEditor.addTab},{name:"changeTabOrdering",fxn:bd.methodTag.levelEditor.changeTabOrdering}]}};
bd.methodTag.levelEditor.removeConnections=function(){for(var a=this.tabOrder,b=0;b<a.length;b++)bd.component.lookup(a[b]).deleteEntity();null!=this.model.viewId&&bd.model.addModelUpdateElement([this.model.viewId],"removeValue","labelInstanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.levelEditor.addTab=function(a){bd.model.addModelUpdateElement([this.id],"push","tabOrder",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};bd.methodTag.levelEditor.changeTabOrdering=function(a){bd.model.addModelUpdateElement([this.id],"set","tabOrder",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};bd.component.flexidor={constructor:function(a){goog.mixin(this,bd.component.flexidor.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"flexidor",listName:"flexidors",idName:"flexId",idListName:"flexIds",editorDisplayObjectType:"flexidor",namePrefix:"Flexidor",typeName:"Flexidor",tabName:"Flexidors",entityName:"Flexidor",entityNamePlural:"Flexidors",thisName:"this flexidor",allName:"all flexidors",
anyName:"any flexidor",randomName:"random flexidor",modelTags:["entity","hasFlexidorProperties"],methodTags:["entity"]}};bd.component.typeNameToComponent.flexidor=bd.component.flexidor;bd.validator={};bd.validator.ctr={};bd.validator.ctr.getTextInputValidatorFunction=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){var c=b.slice(0);c.splice(0,0,this.value);return a.apply(null,c)}};bd.validator.ctr.getPropertyValidatorFunction=function(a){var b=Array.prototype.slice.call(arguments,1);return function(c){var e=b.slice(0);e.splice(0,0,c);return a.apply(null,e)}};bd.validator.ctr.isANumber=function(a){return!isNaN(parseFloat(a))};
bd.validator.ctr.isAPositiveNumber=function(a){return bd.validator.ctr.matchesNumberComparison(a,">=",0)};bd.validator.ctr.matchesNumberComparison=function(a,b,c){if(!bd.validator.ctr.isANumber(a)||!bd.validator.ctr.isANumber(c))return!1;a=parseFloat(a);c=parseFloat(c);switch(b){case ">":return a>c;case ">=":return a>=c;case "<":return a<c;case "<=":return a<=c;case "==":return a==c;default:return!1}};
bd.validator.ctr.isBetweenNumbers=function(a,b,c,e,f){var g=!1,h=!1;if(e&&a>b||!e&&a>=b)g=!0;if(f&&a<c||!f&&a<=c)h=!0;return g&&h};bd.revision={};bd.revision.ctr={};bd.revision.ctr.X2JS=new X2JS;
bd.revision.ctr.updateGame=function(){var a={"0.0.0":{updateFxn:bd.revision.ctr.updateToVersion0_0_1,nextVersion:[0,0,1]},"0.0.1":{updateFxn:bd.revision.ctr.updateToVersion0_0_2,nextVersion:[0,0,2]},"0.0.2":{updateFxn:bd.revision.ctr.updateToVersion0_0_3,nextVersion:[0,0,3]},"0.0.3":{updateFxn:bd.revision.ctr.updateToVersion0_0_4,nextVersion:[0,0,4]},"0.0.4":{updateFxn:bd.revision.ctr.updateToVersion0_0_5,nextVersion:[0,0,5]},"0.0.5":{updateFxn:bd.revision.ctr.updateToVersion0_0_6,nextVersion:[0,
0,6]},"0.0.6":{updateFxn:bd.revision.ctr.updateToVersion0_0_7,nextVersion:[0,0,7]},"0.0.7":{updateFxn:bd.revision.ctr.updateToVersion0_0_8,nextVersion:[0,0,8]},"0.0.8":{updateFxn:bd.revision.ctr.updateToVersion0_0_9,nextVersion:[0,0,9]},"0.0.9":{updateFxn:bd.revision.ctr.updateToVersion0_0_10,nextVersion:[0,0,10]},"0.0.10":{updateFxn:bd.revision.ctr.updateToVersion0_0_11,nextVersion:[0,0,11]},"0.0.11":{updateFxn:bd.revision.ctr.updateToVersion0_0_12,nextVersion:[0,0,12]},"0.0.12":{updateFxn:bd.revision.ctr.updateToVersion0_0_13,
nextVersion:[0,0,13]},"0.0.13":{updateFxn:bd.revision.ctr.updateToVersion0_0_14,nextVersion:[0,0,14]},"0.0.14":{updateFxn:bd.revision.ctr.updateToVersion0_0_15,nextVersion:[0,0,15]},"0.0.15":{updateFxn:bd.revision.ctr.updateToVersion0_0_16,nextVersion:[0,0,16]},"0.0.16":{updateFxn:bd.revision.ctr.updateToVersion0_0_17,nextVersion:[0,0,17]},"0.0.17":{updateFxn:bd.revision.ctr.updateToVersion0_0_18,nextVersion:[0,0,18]},"0.0.18":{updateFxn:bd.revision.ctr.updateToVersion0_0_19,nextVersion:[0,0,19]},
"0.0.19":{updateFxn:bd.revision.ctr.updateToVersion0_0_20,nextVersion:[0,0,20]},"0.0.20":{updateFxn:bd.revision.ctr.updateToVersion0_0_21,nextVersion:[0,0,21]},"0.0.21":{updateFxn:bd.revision.ctr.updateToVersion0_0_22,nextVersion:[0,0,22]},"0.0.22":{updateFxn:bd.revision.ctr.updateToVersion0_0_23,nextVersion:[0,0,23]},"0.0.23":{updateFxn:bd.revision.ctr.updateToVersion0_0_24,nextVersion:[0,0,24]},"0.0.24":{updateFxn:bd.revision.ctr.updateToVersion0_0_25,nextVersion:[0,0,25]},"0.0.25":{updateFxn:bd.revision.ctr.updateToVersion0_0_26,
nextVersion:[0,0,26]},"0.0.26":{updateFxn:bd.revision.ctr.updateToVersion0_0_27,nextVersion:[0,0,27]},"0.0.27":{updateFxn:bd.revision.ctr.updateToVersion0_0_28,nextVersion:[0,0,28]}},b=bd.revision.ctr.getRevisionNum(),b=a[b];null!=b&&(b.updateFxn(),bd.revision.ctr.setVersionNumber(b.nextVersion),b=bd.revision.ctr.getRevisionNum(),null!=a[b]&&bd.revision.ctr.updateGame())};
bd.revision.ctr.setVersionNumber=function(a){var b=bd.model.getCurrentGame();b.versionRelease=a[0];b.versionMajor=a[1];b.versionMinor=a[2]};bd.revision.ctr.getRevisionNum=function(){var a=bd.model.getCurrentGame();return null==a.versionRelease&&null==a.versionMajor&&null==a.versionMinor?"0.0.0":a.versionRelease+"."+a.versionMajor+"."+a.versionMinor};
bd.revision.ctr.updateToVersion0_0_1=function(){for(var a=[],a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)null==a[b].frictionX&&(a[b].frictionX=0),null==a[b].frictionY&&(a[b].frictionY=0)};
bd.revision.ctr.updateToVersion0_0_2=function(){var a=bd.model.getCurrentGame();a.phaserViews[0].backgroundColor="#FFFFFF";var b=new bd.component.melonView.tmxImageLayer.constructor(null,a.phaserViews[0].id,a.phaserViews[0].tmxMapId,bd.model.currentGame.assetImages[0].id),a=bd.model.entityLookup(bd.model.entityLookup(a.phaserViews[0].id).tmxMapId),c=a.layerIds.indexOf(b.id);-1!=c&&(a.layerIds.splice(c,1),a.layerIds.splice(0,0,b.id))};
bd.revision.ctr.updateToVersion0_0_3=function(){bd.model.getCurrentGame().phaserViews[0].gridVisible=!1};bd.revision.ctr.updateToVersion0_0_4=function(){bd.model.getCurrentGame();for(var a=[],a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)null!=a[b].bounceX&&(a[b].bounceX*=100),null!=a[b].bounceY&&(a[b].bounceY*=100)};
bd.revision.ctr.updateToVersion0_0_5=function(){bd.model.getCurrentGame();for(var a=[],a=a.concat(bd.model.getEntityList("labelInstance")),a=a.concat(bd.model.getEntityList("label")),b=0;b<a.length;b++)null==a[b].fontSize&&(a[b].fontSize=18)};
bd.revision.ctr.updateToVersion0_0_6=function(){bd.model.getCurrentGame();for(var a=[],a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),a=a.concat(bd.model.getEntityList("labelInstance")),a=a.concat(bd.model.getEntityList("label")),b=0;b<a.length;b++)90==a[b].direction&&(a[b].direction=0)};
bd.revision.ctr.updateToVersion0_0_7=function(){var a=bd.model.getCurrentGame();bd.revision.ctr.changeXmlBlocks(a,function(a){if("clone_to_xy"==a.getAttribute("type")||"clone_to_xy_return"==a.getAttribute("type")){a=bd.revision.ctr.getFieldOrValueFromXmlBlock(a,"field","VIEW");var c=a.innerText;if(bd.util.containsPrefix(c,"id:"))for(var c=bd.util.removePrefix(c,"id"),c=bd.component.lookup(c).getLayerIds(),e=0,f;f=c[e];e++)if("tmxEntityLayer"==bd.model.entityLookup(f).type){a.innerText="id:"+f;a.setAttribute("name",
"LAYER");break}}})};bd.revision.ctr.updateToVersion0_0_8=function(){var a=bd.model.getCurrentGame();a.assetSounds=[];for(var b=0;b<a.assetSound.length;b++){var c=a.assetSound[b];a.assetSounds.push(c);bd.component.lookupDict[c.id]=new bd.component.assetSound.constructor(c)}delete a.assetSound;for(b=0;c=a.tabs[b];b++)"soundTab"==c.tabKey&&(new bd.component.sound.constructor(null,c.id),c.canCreateEntities=!1,c.minEntityNum=1)};
bd.revision.ctr.updateToVersion0_0_9=function(){for(var a=bd.model.getCurrentGame(),b=!1,c=0,e;e=a.tabs[c];c++)"tableTab"==e.tabKey&&(b=!0);b||(a=bd.model.getGameInfo().id,b=new bd.component.table.constructor(null),new bd.component.tab.constructor(null,"Table","tableTab",a,["table"],null,[b.id]))};
bd.revision.ctr.updateToVersion0_0_10=function(){var a=bd.model.getCurrentGame();bd.revision.ctr.changeXmlBlocks(a,function(a){"table_get_dimension"==a.getAttribute("type")&&(a=bd.revision.ctr.getFieldOrValueFromXmlBlock(a,"field","DIMENSION"))&&a.setAttribute("name","ROW_OR_COLUMN")})};
bd.revision.ctr.updateToVersion0_0_11=function(){bd.model.getCurrentGame();for(var a=[],a=a.concat(bd.model.getEntityList("labelInstance")),a=a.concat(bd.model.getEntityList("label")),a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)void 0===a[b].tint&&(a[b].tint="#ffffff")};
bd.revision.ctr.updateToVersion0_0_12=function(){for(var a=bd.model.getCurrentGame(),b=!1,c=0,e;e=a.tabs[c];c++)"timerTab"==e.tabKey&&(b=!0);b||(a=bd.model.getGameInfo().id,b=new bd.component.timer.constructor(null),new bd.component.tab.constructor(null,"Timer","timerTab",a,["timer"],null,[b.id]))};bd.revision.ctr.updateToVersion0_0_13=function(){bd.model.getCurrentGame();var a=bd.model.getEntityList("scriptPage")[0];"Script Page 1"==a.name&&(a.name="block page 1")};
bd.revision.ctr.updateToVersion0_0_14=function(){for(var a=bd.model.getEntityList("phaserView"),b=0;b<a.length;b++)a[b].height=480,a[b].width=640};
bd.revision.ctr.updateToVersion0_0_15=function(){for(var a=bd.model.getEntityList("phaserView"),b=0;b<a.length;b++)a[b].cameraLayerIds=[],a[b].cameraX=0,a[b].cameraY=0,a[b].cameraLocationType="instance";a=[];a=a.concat(bd.model.getEntityList("uiLayer"));a=a.concat(bd.model.getEntityList("tmxEntityLayer"));a=a.concat(bd.model.getEntityList("tmxImageLayer"));for(b=0;b<a.length;b++)a[b].isCameraLayer=!1};
bd.revision.ctr.updateToVersion0_0_16=function(){for(var a=bd.model.getEntityList("tableColumn"),b=0;b<a.length;b++)"String"==a[b].columnType&&(a[b].columnType="STRING")};bd.revision.ctr.updateToVersion0_0_17=function(){var a=bd.model.getCurrentGame();bd.revision.ctr.changeXmlBlocks(a,function(a){"procedures_call"==a.getAttribute("type")&&(a=bd.revision.ctr.getFieldOrValueFromXmlBlock(a,"mutation"))&&null==a.getAttribute("should_return")&&a.setAttribute("should_return","false")})};
bd.revision.ctr.updateToVersion0_0_18=function(){var a=bd.model.getCurrentGame();bd.revision.ctr.changeXmlBlocks(a,function(a){if("create_list"==a.getAttribute("type")){var c=bd.revision.ctr.getFieldOrValueFromXmlBlock(a,"mutation","num_lists");if(c){var e=c.getAttribute("num_lists");c.setAttribute("type_list_depth",e);for(i=0;i<e;i++)bd.revision.ctr.getFieldOrValueFromXmlBlock(a,"field","TYPE_"+i).setAttribute("name","TYPE_LIST_DEPTH"+i)}}})};
bd.revision.ctr.updateToVersion0_0_19=function(){var a=bd.model.getEntityList("gameInfo")[0];void 0===a.isMultiplayerGame&&(a.isMultiplayerGame=!1)};bd.revision.ctr.updateToVersion0_0_20=function(){var a=bd.model.getEntityList("gameInfo")[0];void 0===a.framesPerSecond&&(a.framesPerSecond=60)};
bd.revision.ctr.updateToVersion0_0_21=function(){bd.model.getCurrentGame();for(var a=[],a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)void 0===a[b].drawingColor&&(a[b].drawingColor="#000000"),void 0===a[b].drawingThickness&&(a[b].drawingThickness=10),void 0===a[b].drawingEnabled&&(a[b].drawingEnabled=!1)};
bd.revision.ctr.updateToVersion0_0_22=function(){bd.model.getCurrentGame();for(var a=[],a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)void 0===a[b].penColor&&(a[b].penColor="#000000"),void 0===a[b].penThickness&&(a[b].penThickness=10),void 0===a[b].penEnabled&&(a[b].penEnabled=!1)};
bd.revision.ctr.updateToVersion0_0_23=function(){bd.model.getCurrentGame();var a=new bd.component.playerClass.constructor(null);a.model.name=bd.component.playerClass.componentProperties.tabName;var b=new bd.component.team.constructor(null);b.model.name=bd.component.team.componentProperties.tabName;var c=bd.model.getGameInfo().id;new bd.component.tab.constructor(null,"Players","playerTab",c,["playerClass"],null,[a.id,b.id],!1,2)};
bd.revision.ctr.updateToVersion0_0_24=function(){for(var a=[],a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)a[b].collisionObject={},a[b].friction=0,a[b].bounciness=Math.max(a[b].bounceX,a[b].bounceY),a[b].gravityX/=100,a[b].gravityY/=100,a[b].fixedRotation=!0,a[b].wallCollisionIds=[],a[b].stopAfterDrag=!0};
bd.revision.ctr.updateToVersion0_0_25=function(){for(var a=[],a=a.concat(bd.model.getEntityList("tmxImageLayer")),b=0;b<a.length;b++)a[b].visible?a[b].visible&&null==a[b].tileSpriteVisible&&(a[b].tileSpriteVisible=!0):(a[b].tileSpriteVisible=!1,a[b].visible=!0)};bd.revision.ctr.updateToVersion0_0_26=function(){var a=bd.model.getGameInfo().id,b=new bd.component.video.constructor(null);new bd.component.tab.constructor(null,"Videos","videoTab",a,["video"],null,[b.id])};
bd.revision.ctr.updateToVersion0_0_27=function(){new bd.component.soundChannel.constructor(null)};
bd.revision.ctr.updateToVersion0_0_28=function(){for(var a=[],a=a.concat(bd.model.getEntityList("labelInstance")),a=a.concat(bd.model.getEntityList("label")),a=a.concat(bd.model.getEntityList("phaserPhysicsPieceInstance")),a=a.concat(bd.model.getEntityList("phaserPhysicsPiece")),b=0;b<a.length;b++)void 0===a[b].allowHorizontalDrag&&(a[b].allowHorizontalDrag=!0),void 0===a[b].allowVerticalDrag&&(a[b].allowVerticalDrag=!0)};
bd.revision.ctr.textToDom=function(a){a=(new DOMParser).parseFromString(a,"text/xml");if(!a||!a.firstChild||"xml"!=a.firstChild.nodeName.toLowerCase()||a.firstChild!==a.lastChild)throw"Blockly.Xml.textToDom did not obtain a valid XML tree.";return a.firstChild};bd.revision.ctr.domToText=function(a){return(new XMLSerializer).serializeToString(a)};
bd.revision.ctr.getAllBlocksFromXmlBlock=function(a){var b=[];b.push(a);for(var c=0,e;e=a.childNodes[c];c++)if(3!=e.nodeType||!e.data.match(/^\s*$/)){for(var f=null,g=0,h;h=e.childNodes[g];g++)3==h.nodeType&&h.data.match(/^\s*$/)||(f=h);e.getAttribute("name");switch(e.nodeName.toLowerCase()){case "statement":case "value":case "next":f&&"block"==f.nodeName.toLowerCase()&&(b=b.concat(bd.revision.ctr.getAllBlocksFromXmlBlock(f)))}}return b};
bd.revision.ctr.getAllBlocksFromScriptPageXml=function(a){for(var b=[],c=0,e;e=a.childNodes[c];c++)b=b.concat(bd.revision.ctr.getAllBlocksFromXmlBlock(e));return b};bd.revision.ctr.changeXmlBlocks=function(a,b){for(var c,e,f=0,g;g=a.scriptPages[f];f++){c=bd.revision.ctr.textToDom(g.scripts);e=bd.revision.ctr.getAllBlocksFromScriptPageXml(c);for(var h=0,k;k=e[h];h++)b(k);g.scripts=bd.revision.ctr.domToText(c);g.scriptObject=bd.revision.ctr.X2JS.xml_str2json(g.scripts)}};
bd.revision.ctr.getFieldOrValueFromXmlBlock=function(a,b,c){for(var e=0,f;f=a.childNodes[e];e++)if(f.nodeName.toLowerCase()==b&&("mutation"==b||f.getAttribute("name")==c))return f;return null};bd.property={};bd.property.ctr={};
bd.property.ctr.setOrChangePropertyValue=function(a,b,c,e){for(var f=0;entityId=b[f];f++){var g=bd.model.entityLookup(entityId);if(null!=g){var h=bd.component.getComponentByType(g.type),g=bd.component.lookup(entityId),h=h.propertyNameToObject[c],k=e;"change"==a&&(k=parseFloat(bd.property.ctr.getPropertyValue(entityId,c))+parseFloat(e));h.validator&&!h.validator(k)?console.log(k+" is an invalid value for "+bd.model.getPropertyMessageName(c,"block")):h.setFxn?h.setFxn.call(g,k):(bd.model.addModelUpdateElement([entityId],
a,h.modelName,e,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!0}),bd.model.sendUpdates())}}};bd.property.ctr.getPropertyValue=function(a,b){if(null==bd.model.entityLookup(a))return null;var c=bd.component.getComponentByType(bd.model.entityLookup(a).type).propertyNameToObject[b];if(c.getFxn){var e=bd.component.lookup(a);return c.getFxn.call(e)}return bd.model.entityLookup(a)[c.modelName]};bd.projectParam={};bd.projectParam.ctr={};bd.projectParam.ctr.tableData=[["parameter1","10"]];bd.projectParam.ctr.handsOnTable=null;bd.projectParam.ctr.setupPlayerCallback=null;
bd.projectParam.ctr.setupInputTable=function(){var a=document.getElementById("projectParametersInitializationContainer");a.style.display="block";var b=a.getElementsByClassName("projectParametersSubmitButton")[0];""!=bd.util.getURLParamValue("projectParams")?(bd.projectParam.ctr.setTableDataFromUrl(),bd.projectParam.ctr.submitProjectParams()):(b.style.display="block",a.getElementsByClassName("projectParametersTypeInstructions")[0].style.display="inline",a.getElementsByClassName("projectParametersLabel")[0].style.display=
"none",bd.projectParam.ctr.handsOnTable.updateSettings({readOnly:!1}))};bd.projectParam.ctr.setTableDataFromUrl=function(){var a=[],b=bd.util.getURLParamValue("projectParams");if(""!=b)try{var c=JSON.parse(decodeURIComponent(b)),e;for(e in c)a.push([e,c[e]])}catch(f){}bd.projectParam.ctr.tableData=a;bd.projectParam.ctr.handsOnTable.updateSettings({data:bd.projectParam.ctr.tableData})};
bd.projectParam.ctr.initializeInputTable=function(){var a=document.getElementById("projectParametersInitializationContainer");if(a){var b=a.getElementsByClassName("projectParametersTableContainer")[0];bd.projectParam.ctr.handsOnTable=new Handsontable(b,{data:bd.projectParam.ctr.tableData,minSpareRows:1,colHeaders:["Name","Value"]});a.style.display="none"}};
bd.projectParam.ctr.doesProjectContainGetParamsBlock=function(){for(var a=bd.model.getAllEvaluatorBlocks(),b=0;b<a.length;b++)if("project_get_parameter"==a[b]._type)return!0;return!1};
bd.projectParam.ctr.submitProjectParams=function(){var a=document.getElementById("projectParametersInitializationContainer");a.getElementsByClassName("projectParametersSubmitButton")[0].style.display="none";a.getElementsByClassName("projectParametersTypeInstructions")[0].style.display="none";a.getElementsByClassName("projectParametersLabel")[0].style.display="inline";bd.projectParam.ctr.handsOnTable.updateSettings({readOnly:!0});bd.inPlayer?bd.projectParam.ctr.setupPlayerCallback():bd.preview.ctr.handlePlayerSelection()};
bd.projectParam.ctr.setupParamsInPlayer=function(a){bd.projectParam.ctr.setupPlayerCallback=a;bd.projectParam.ctr.doesProjectContainGetParamsBlock()?bd.projectParam.ctr.setupInputTable():a()};jQuery(document).ready(function(){bd.projectParam.ctr.initializeInputTable();jQuery(".projectParametersSubmitButton").click(function(a){bd.projectParam.ctr.submitProjectParams();return!1})});bd.common_reqs={};bd.evaluator.ctr.blocks.pen={};bd.evaluator.ctr.configs.pen_stamp={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"SPRITE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray,b=bd.component.lookup(b[0]),c=b.getDisplayObject(),e=bd.model.entityLookup(bd.player.ctr.playerId),e=bd.component.lookup(e.viewId);e.getPhaserGameObject();var f=e.getImageLayerId();e.getLayer(f);e=bd.component.lookup(f).getBitMapData();b.drawSpriteOnBitMap(e,c);e.update();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.pen_clear={paramsInfo:[],evalFunc:function(a){var b=bd.model.entityLookup(bd.player.ctr.playerId),b=bd.component.lookup(b.viewId).getImageLayerId();bd.component.lookup(b).getBitMapData().clear();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.methodTag.map={provideMethods:function(){return[{name:"updateInstancePanel",fxn:bd.methodTag.map.updateInstancePanel,classOrInstance:"instance"},{name:"setupEditorViewFrame",fxn:bd.methodTag.map.setupEditorViewFrame,classOrInstance:"instance"},{name:"removeEditorViewFrame",fxn:bd.methodTag.map.removeEditorViewFrame,classOrInstance:"instance"},{name:"setMapObject",fxn:bd.methodTag.map.setMapObject,classOrInstance:"instance"},{name:"getMapObject",fxn:bd.methodTag.map.getMapObject,classOrInstance:"instance"},
{name:"getEditorViewHeightWidth",fxn:bd.methodTag.map.getEditorViewHeightWidth,classOrInstance:"instance"}]}};
bd.methodTag.map.updateInstancePanel=function(){var a=this.model,b=document.getElementById(this.instancePanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("xInput")[0];c.value=a.x;bd.sideBar.ctr.resetTextInputStyle(c);
bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("yInput")[0];c.value=a.y;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"y",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);
b.getElementsByClassName("editMapButton")[0].onclick=function(b){bd.component.lookup(a.id).changeView();bd.layerSelect.ctr.setupLayerSelect()}};
bd.methodTag.map.setupEditorViewFrame=function(){var a=document.getElementById("viewFrame"+this.id);a||(a=document.createElement("div"),a.id="viewFrame"+this.id,a.style.height=480,a.style.width=640,a.style.marginLeft=this.xTileOffset,a.style.marginTop=this.yTileOffset,a.style.backgroundColor="red",a.style.display="block",document.getElementById("viewFrameContainer").appendChild(a),map=new google.maps.Map(a,{center:{lat:this.model.centerLat,lng:this.model.centerLng},mapTypeId:google.maps.MapTypeId.SATELLITE,
zoom:17}),new google.maps.Rectangle({strokeColor:"#FF0000",strokeOpacity:.8,strokeWeight:2,fillColor:"#FF0000",fillOpacity:.35,map:map,draggable:!0,editable:!0,bounds:new google.maps.LatLngBounds(new google.maps.LatLng(this.model.swLat,this.model.swLng),new google.maps.LatLng(this.model.neLat,this.model.neLng))}),this.setMapObject(map));a.style.display="block";document.getElementById("viewFrameContainer").style.width=640+this.xTileOffset;document.getElementById("gameWorkspace").style.width=640+this.xTileOffset+
bd.editorSettings.viewOffsetX+bd.editorSettings.layerPanelMarginLeft+bd.component.melonView.componentProperties.melonjsPanelWidth;document.getElementById("melonjsPanelContainer").style.display="block";this.isInitialized=!0};bd.methodTag.map.removeEditorViewFrame=function(){var a=document.getElementById("viewFrame"+this.id);a&&(a.style.display="none");bd.editor.ctr.setSelectedInstanceId(null)};bd.methodTag.map.setMapObject=function(a){this.mapObject=a};bd.methodTag.map.getMapObject=function(){return this.mapObject};
bd.methodTag.map.getEditorViewHeightWidth=function(){return{height:480,width:640}};bd.evaluator.ctr.blocks.table={};
bd.evaluator.ctr.configs.table_set_get_value={getParams:function(a){var b=[];b.push({name:"tableIdArray",type:"entity",fieldName:"TABLE"});"0"==a.mutation._has_column_num?b.push({name:"columnIdArray",type:"entity",fieldName:"COLUMN"}):b.push({name:"columnNum",type:"value",valueName:"COLUMN_NUM"});b.push({name:"rowNum",type:"value",valueName:"ROW_NUM"});"set"==a.mutation._set_or_get&&b.push({name:"cellValue",type:"value",valueName:"VALUE"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),
c=bd.component.lookup(b.params.tableIdArray[0]);if("0"==a.mutation._has_column_num){var e=b.params.columnIdArray[0],e=c.getColumnIds().indexOf(parseInt(e));-1==e&&bd.errorLog.ctr.printError("Error: Invalid column index")}else e=b.params.columnNum-1;var f=b.params.rowNum-1;"set"==a.mutation._set_or_get?(b=b.params.cellValue,c.setCellValue(e,f,b),bd.evaluator.ctr.nextBlockInCallStack(a.next)):(b=c.getCellValue(e,f),bd.evaluator.ctr.returnHandler(b,a.returnsEntity))}};
bd.evaluator.ctr.configs.table_add_row={getParams:function(a){var b=[];b.push({name:"tableIdArray",type:"entity",fieldName:"TABLE"});for(var c=0;c<parseInt(a.mutation._num_columns);c++){var e=bd.evaluator.ctr.getValueFromBlock("VALUE"+c,a);b.push({name:e._name,type:"value",valueName:e._name})}b.push({name:"rowLocation",type:"field",fieldName:"ROW_LOCATION"});1==a.mutation._has_index_input&&b.push({name:"index",type:"value",valueName:"INDEX"});return b},evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),
c=b.params.tableIdArray[0],e=[],f=0;f<parseInt(a.mutation._num_columns);f++)e.push({value:b.params["VALUE"+f]});f=-1;"BEGINNING"==b.params.rowLocation?f=0:"INDEX"==b.params.rowLocation&&(f=b.params.index-1);if(null==f||f==bd.model.nullBlockString)f=-1,bd.errorLog.ctr.printError("Error: Invalid table row index");bd.component.lookup(c).addDataRow(e,f);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.table_get_dimension={getParams:function(a){a=[];a.push({name:"tableIdArray",type:"entity",fieldName:"TABLE"});a.push({name:"rowOrColumn",type:"field",fieldName:"ROW_OR_COLUMN"});return a},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.tableIdArray[0],b=b.params.rowOrColumn,e=0;null!=c&&c!=bd.model.nullBlockString&&bd.component.lookup(c)?(e="ROW"==b?bd.component.lookup(c).getNumberOfRows():bd.component.lookup(c).getNumberOfColumns(),bd.evaluator.ctr.returnHandler(e,
a.returnsEntity)):(bd.errorLog.ctr.printError("Error: Invalid table"),bd.evaluator.ctr.returnHandler(0,a.returnsEntity))}};
bd.evaluator.ctr.configs.get_row_num_of_variable={getParams:function(a){var b=[];"0"==a.mutation._has_column_num?b.push({name:"columnIdArray",type:"entity",fieldName:"COLUMN"}):b.push({name:"columnNum",type:"value",valueName:"COLUMN_NUM"});b.push({name:"tableIdArray",type:"entity",fieldName:"TABLE"});b.push({name:"variable",type:"value",valueName:"VALUE"});b.push({name:"instance_number",type:"field",fieldName:"ROW_FILTER"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),
c=b.params.variable,e=bd.component.lookup(b.params.tableIdArray[0]),f=b.params.tableIdArray[0],g=b.params.instance_number;"0"==a.mutation._has_column_num?(b=b.params.columnIdArray[0],b=e.getColumnIds().indexOf(parseInt(b)),-1==b&&bd.errorLog.ctr.printError("Error: Invalid column index")):b=b.params.columnNum-1;for(var h=bd.component.lookup(f).getNumberOfRows(),f=[],k=0;k<h;k++)e.getCellValue(b,k)==c&&f.push(k+1);0==f.length?(bd.errorLog.ctr.printError("Variable not in that column -- returning nullObject"),
bd.evaluator.ctr.returnHandler(bd.model.nullBlockString,a.returnsEntity)):"FIRST"==g?bd.evaluator.ctr.returnHandler(f[0],a.returnsEntity):"LAST"==g?bd.evaluator.ctr.returnHandler(f[f.length-1],a.returnsEntity):"RANDOM"==g?(c=f.length,c=Math.floor(Math.random()*c),bd.evaluator.ctr.returnHandler(f[c],a.returnsEntity)):"ALL"==g&&bd.evaluator.ctr.returnHandler(f,a.returnsEntity)}};bd.evaluator.ctr.blocks.mobile={};bd.evaluator.ctr.configs.mobile_vibrate={paramsInfo:[],evalFunc:function(a){navigator.vibrate(500);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.mobile_scan_qrcode={paramsInfo:[{name:"resultVar",type:"variableName",valueName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.evaluator.ctr.getCurrentCallStack().id,e=bd.evaluator.ctr.getCurrentCallStack();"undefined"!=typeof cordova?b.hasScanned?b.hasRunStatement?(b.hasScanned=!1,b.hasRunStatement=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next)):(b.hasRunStatement=!0,a.statement&&a.statement.block&&e.createStackObjectAndAddToStack(a.statement.block,
{}),bd.evaluator.ctr.evaluateStack()):(b.hasScanned=!0,cordova.plugins.barcodeScanner.scan(function(a){b.context[b.params.resultVar.__text]={type:"value",value:a.text};bd.evaluator.ctr.stackIdsForNextTick.push(c)},function(a){bd.errorLog.ctr.printError("The QR Code is invalid.");b.context["".__text]={type:"value",value:""};bd.evaluator.ctr.stackIdsForNextTick.push(c)}),bd.evaluator.ctr.currentCallStackId=null,bd.evaluator.ctr.continuePreviousStack()):(bd.errorLog.ctr.printError("The Scan QR Code block can only be used on mobiles. Continued to next block."),
bd.evaluator.ctr.nextBlockInCallStack(a.next))}};
bd.evaluator.ctr.configs.get_sprite_hex_array={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"SPRITE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray,c=bd.model.entityLookup(bd.player.ctr.playerId);bd.component.lookup(c.viewId).getPhaserGameObject();var c=bd.component.lookup(b[0]),e=c.getDisplayObject(),b=bd.component.lookup(c.model.costumeId).model.assetId,f=bd.component.lookup(b),b=f.getBitMapData(c.id);b||(f.createBitMapData(c.id,e.width,e.height),
b=f.getBitMapData(c.id));for(var c=[],g,e=0;e<b.width;e++)for(f=0;f<b.height;f++)g=b.getPixel(e,f),g=goog.color.rgbToHex(g.r,g.g,g.b),c.push(g);bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.sprite_get_set_hex_array={getParams:function(a){var b=[];b.push({name:"entityIdArray",type:"entity",fieldName:"SPRITE"});b.push({name:"x",type:"value",valueName:"X"});b.push({name:"y",type:"value",valueName:"Y"});"set"==a.mutation._set_or_get&&b.push({name:"hexColor",type:"value",valueName:"COLOR"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.getCurrentCallStack();bd.evaluator.ctr.getCurrentCallStack();var c=b.params.entityIdArray,
e=b.params.x,f=b.params.y,b=b.params.hexColor,g=bd.model.entityLookup(bd.player.ctr.playerId);bd.component.lookup(g.viewId).getPhaserGameObject();var c=bd.component.lookup(c[0]),g=c.getDisplayObject(),h=bd.model.entityLookup(c.model.costumeId).assetId,h=bd.component.lookup(h),k=h.getBitMapData(c.id);k||(console.log("no bmd"),h.createBitMapData(c.id,g.width,g.height),k=h.getBitMapData(c.id));"set"==a.mutation._set_or_get?(b=goog.color.hexToRgb(b),k.setPixel(e-1,f-1,b[0],b[1],b[2]),k.update(),h.setBitMapData(c.id,
k),g.loadTexture(k),c.setWidthHeight(),bd.evaluator.ctr.nextBlockInCallStack(a.next)):(b=k.getPixel(e-1,f-1),console.log(b),e=goog.color.rgbToHex(b.r,b.g,b.b),bd.evaluator.ctr.returnHandler(e,a.returnsEntity))}};
bd.evaluator.ctr.configs.get_rgbhsb_of_color={paramsInfo:[{name:"property",type:"field",fieldName:"PROPERTY"},{name:"hexColor",type:"value",valueName:"COLOR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.hexColor,b=b.params.property,e,f=goog.color.hexToRgb(c),c=goog.color.hexToHsv(c);"RED"==b?e=f[0]:"GREEN"==b?e=f[1]:"BLUE"==b?e=f[2]:"HUE"==b?e=c[0]:"SATURATION"==b?e=100*c[1]:"BRIGHTNESS"==b&&(e=c[2]/255*100);bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}};bd.component.team={constructor:function(a,b){goog.mixin(this,bd.component.team.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"team",listName:"teams",idName:"teamId",idListName:"teamIds",editorDisplayObjectType:"image",sideBarPanelName:"sideBarTeamPanel",defaultImageUrlObject:{url:"images/qmarksq.png",
internal:!0},tabIconFileName:"class-icon-players.png",possibleLayerTypes:["tmxEntityLayer"],hasTraitTab:!0,namePrefix:"Team Class ",typeName:"Team Class",tabName:"Teams",entityName:"Team Class",entityNamePlural:"Team Classes",thisName:"this team class",allName:"all team classes",anyName:"any team class",randomName:"random team class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasPlayerInstanceProperties".split(" "),
methodTags:["entity"]},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"players.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"players.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.teamInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.teamInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"teamInstance",listName:"teamInstances",idName:"teamInstanceId",idListName:"teamInstanceIds",editorDisplayObjectType:"image",namePrefix:"team ",entityName:"Team",thisName:"this team",allName:"all teams",
anyName:"any team",randomName:"random team",modelTags:bd.component.team.componentProperties.modelTags,methodTags:bd.component.team.componentProperties.methodTags}};bd.component.typeNameToComponent.team=bd.component.team;bd.component.typeNameToComponent.teamInstance=bd.component.teamInstance;bd.component.childNameToParentName.teamInstance="team";bd.methodTag.phaserView={provideMethods:function(){return[{name:"setupEditorViewFrame",fxn:bd.methodTag.phaserView.setupEditorViewFrame,classOrInstance:"class"},{name:"setupCanvasView",fxn:bd.methodTag.phaserView.setupCanvasView,classOrInstance:"class"},{name:"removeEditorViewFrame",fxn:bd.methodTag.phaserView.removeEditorViewFrame,classOrInstance:"class"},{name:"updateGridVisibility",fxn:bd.methodTag.phaserView.updateGridVisibility,classOrInstance:"class"},{name:"updateBackgroundColor",fxn:bd.methodTag.phaserView.updateBackgroundColor,
classOrInstance:"class"},{name:"setPhaserGameObject",fxn:bd.methodTag.phaserView.setPhaserGameObject,classOrInstance:"class"},{name:"getPhaserGameObject",fxn:bd.methodTag.phaserView.getPhaserGameObject,classOrInstance:"class"},{name:"setPhaserObject",fxn:bd.methodTag.phaserView.setPhaserObject,classOrInstance:"class"},{name:"getPhaserObject",fxn:bd.methodTag.phaserView.getPhaserObject,classOrInstance:"class"},{name:"preloadAssets",fxn:bd.methodTag.phaserView.preloadAssets,classOrInstance:"class"},
{name:"getLayerZIndex",fxn:bd.methodTag.phaserView.getLayerZIndex,classOrInstance:"class"},{name:"populateDisplayObjects",fxn:bd.methodTag.phaserView.populateDisplayObjects,classOrInstance:"class"},{name:"afterComponentCreated",fxn:bd.methodTag.phaserView.afterComponentCreated,classOrInstance:"class"},{name:"createCameraView",fxn:bd.methodTag.phaserView.createCameraView,classOrInstance:"class"},{name:"removeCameraView",fxn:bd.methodTag.phaserView.removeCameraView,classOrInstance:"class"},{name:"switchHeadsUpEditMode",
fxn:bd.methodTag.phaserView.switchHeadsUpEditMode,classOrInstance:"class"},{name:"getTopLayerIdWithType",fxn:bd.methodTag.phaserView.getTopLayerIdWithType,classOrInstance:"class"},{name:"setDefaultLastUsedLayerIds",fxn:bd.methodTag.phaserView.setDefaultLastUsedLayerIds,classOrInstance:"class"},{name:"updateSideBar",fxn:bd.methodTag.phaserView.updateSideBar,classOrInstance:"class"},{name:"updatePropertyView",fxn:bd.methodTag.phaserView.updatePropertyView,classOrInstance:"class"},{name:"removeEditorDisplayObjects",
fxn:bd.methodTag.phaserView.removeEditorDisplayObjects},{name:"getImageLayerId",fxn:bd.methodTag.phaserView.getImageLayerId},{name:"setCameraView",fxn:bd.methodTag.phaserView.setCameraView,classOrInstance:"class"},{name:"getBlockRenameDependantIds",fxn:bd.methodTag.phaserView.getBlockRenameDependantIds,classOrInstance:"class"},{name:"populateEditorDisplayObjects",fxn:bd.methodTag.phaserView.populateEditorDisplayObjects,classOrInstance:"class"},{name:"onMouseMove",fxn:bd.methodTag.phaserView.onMouseMove,
classOrInstance:"class"},{name:"getPlayerViewHeightWidth",fxn:bd.methodTag.phaserView.getPlayerViewHeightWidth,classOrInstance:"class"},{name:"getReverseLayerIds",fxn:bd.methodTag.phaserView.getReverseLayerIds,classOrInstance:"class"},{name:"getLayerIds",fxn:bd.methodTag.phaserView.getLayerIds,classOrInstance:"class"},{name:"setWorldBounds",fxn:bd.methodTag.phaserView.setWorldBounds,classOrInstance:"class"}]}};
bd.methodTag.phaserView.handleCommand=function(a){return"gridVisible"==a.property?(this.updateGridVisibility(),!0):"backgroundColor"==a.property?(this.updateBackgroundColor(),!0):"height"==a.property||"width"==a.property?(this.editingHeadsUp||this.changeView(!0),!0):"cameraHeight"==a.property||"cameraWidth"==a.property?(this.editingHeadsUp&&this.changeView(!0),!0):"hasCamera"==a.property?(console.log(a.value),a.value?this.createCameraView():this.removeCameraView(),this.switchHeadsUpEditMode(!1),!0):
!1};bd.methodTag.phaserView.updatePropertyView=function(){var a=this.model,b=document.getElementById("stagePropertyInfoPanel").getElementsByClassName("nameInput")[0];b.value=a.name;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null)};
bd.methodTag.phaserView.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("gridVisibleCheckbox")[0];c.checked=a.gridVisible?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,{entityId:a.id,propertyName:"gridVisible"},null,bd.sideBar.ctr.checkboxUpdateSuccess,
null);c=b.getElementsByClassName("cameraHeightInput")[0];c.value=a.cameraHeight;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"cameraHeight",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("cameraWidthInput")[0];c.value=a.cameraWidth;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,
{entityId:a.id,propertyName:"cameraWidth",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=b.getElementsByClassName("followInstanceDropdown")[0];b.innerHTML="";c=a[bd.component.phaserPhysicsPieceInstance.componentProperties.idListName];b.options[b.options.length]=new Option("none","none");null==a.instanceIdToFollow&&(b.selectedIndex=0);for(var e=0;e<c.length;e++){var f=bd.model.entityLookup(c[e]);
b.options[b.options.length]=new Option(f.name,f.id);f.id==a.instanceIdToFollow&&(b.selectedIndex=b.options.length-1)}};
bd.methodTag.phaserView.setupEditorViewFrame=function(){var a=this.getPlayerViewHeightWidth(!0),b=document.createElement("div");b.id="viewFrame"+this.id;b.style.height=a.height;b.style.width=a.width;b.style.marginLeft=this.xTileOffset;b.style.marginTop=this.yTileOffset;b.style.backgroundColor="red";document.getElementById("viewFrameContainer").appendChild(b);var c=this;b.onmousemove=function(a){c.onMouseMove(a)};this.konvaStage=new Konva.Stage({container:"viewFrame"+this.id,width:a.width,height:a.height});
this.setupCanvasView();document.getElementById("viewFrame"+this.id).style.backgroundColor=this.model.backgroundColor;document.getElementById("viewFrameContainer").style.width=a.width+this.xTileOffset;document.getElementById("gameWorkspace").style.width=a.width+this.xTileOffset+bd.editorSettings.viewOffsetX+bd.editorSettings.layerPanelMarginLeft+bd.component.melonView.componentProperties.melonjsPanelWidth;document.getElementById("melonjsPanelContainer").style.display="block";this.setDefaultLastUsedLayerIds();
bd.layerPanel.ctr.setupLayerPanel();this.isInitialized=!0};bd.methodTag.phaserView.setupCanvasView=function(){for(var a=this.getWindow().Konva,b=this.getLayerIds(!0),c=0;c<b.length;c++){var e=this.getLayer("tmxLayer"+b[c]);null==e&&(this.setLayer("tmxLayer"+b[c],new a.Layer),e=this.getLayer("tmxLayer"+b[c]),this.konvaStage.add(e),bd.component.lookup(b[c]).setupLayerOnCanvas());e.visible(bd.component.lookup(b[c]).model.visible)}};
bd.methodTag.phaserView.removeEditorViewFrame=function(){var a=document.getElementById("viewFrameContainer"),b=document.getElementById("viewFrame"+this.id);b&&a.removeChild(b);bd.editor.ctr.setSelectedInstanceId(null);this.layerNameToObject={};this.setSelectedLayerId(null)};bd.methodTag.phaserView.removeEditorDisplayObjects=function(){document.getElementById("melonjsPanelContainer").style.display="none";var a=this.getLayerIds();bd.editorSettings.selectedInstanceId=null;for(var b=0;b<a.length;b++)bd.component.lookup(a[b]).removeEntitiesFromEditorLayer()};
bd.methodTag.phaserView.updateGridVisibility=function(){this.getLayer("gridLine").visible(this.model.gridVisible);this.getLayer("gridLine").batchDraw()};bd.methodTag.phaserView.updateBackgroundColor=function(){if(bd.inPlayer)this.getPhaserGameObject().stage.backgroundColor=this.model.backgroundColor;else{var a=document.getElementById("viewFrame"+this.id);a&&(a.style.backgroundColor=this.model.backgroundColor)}};bd.methodTag.phaserView.setPhaserGameObject=function(a){bd.component.getComponentByType(this.type).setPhaserGameObject(a)};
bd.methodTag.phaserView.getPhaserGameObject=function(){return bd.component.getComponentByType(this.type).getPhaserGameObject()};bd.methodTag.phaserView.setPhaserObject=function(a){bd.component.getComponentByType(this.type).setPhaserObject(a)};bd.methodTag.phaserView.getPhaserObject=function(){return bd.component.getComponentByType(this.type).getPhaserObject()};
bd.methodTag.phaserView.preloadAssets=function(){for(var a=bd.model.getCurrentGameAssets(),b=0;b<a.length;b++)if("assetSound"!=a[b].type||bd.player.ctr.isCordova)"assetImage"==a[b].type&&(c=bd.component.lookup(a[b].id).getThumbnailUrl(),this.getPhaserGameObject().load.image("assetId:"+a[b].id,c+"?rnd="+Math.random()));else{var c=bd.component.lookup(a[b].id).getSoundUrl();this.getPhaserGameObject().load.audio("assetId:"+a[b].id,c)}};bd.methodTag.phaserView.getLayerZIndex=function(a){return this.model.layerIds.indexOf(a)};
bd.methodTag.phaserView.populateDisplayObjects=function(){this.pointerIdsDown={};var a=this.getLayerIds(),a=a.concat(this.model.cameraLayerIds),b=this.getPhaserGameObject(),c=this.getPhaserObject();b.physics.startSystem(c.Physics.BOX2D);this.setWorldBounds();for(c=0;c<a.length;c++){var e=bd.component.lookup(a[c]);if("uiLayer"!=e.type){var f=b.add.group();f.z=c;f.visible=e.model.visible;this.setLayer(e.id,f)}e.setupLayerOnPhaser()}};
bd.methodTag.phaserView.setWorldBounds=function(){var a=this.getPhaserGameObject();this.getPhaserObject();var b=this.getPlayerViewHeightWidth();a.world.setBounds(0,0,b.width,b.height);a.physics.box2d.walls.left.data.SetUserData(1);a.physics.box2d.walls.top.data.SetUserData(2);a.physics.box2d.walls.right.data.SetUserData(3);a.physics.box2d.walls.bottom.data.SetUserData(4)};
bd.methodTag.phaserView.afterComponentCreated=function(){var a=new bd.component.melonView.tmxMap.constructor;this.model.tmxMapId=a.id;new bd.component.melonView.tmxImageLayer.constructor(null,this.id,a.id);new bd.component.uiLayer.constructor(null,this.id,a.id);new bd.component.melonView.tmxEntityLayer.constructor(null,this.id,a.id)};
bd.methodTag.phaserView.createCameraView=function(){var a=new bd.component.uiLayer.constructor(null,this.id);a.model.isCameraLayer=!0;var b=new bd.component.melonView.tmxEntityLayer.constructor(null,this.id);b.model.isCameraLayer=!0;this.model.cameraLayerIds.push(b.id);this.model.cameraLayerIds.push(a.id);var b=this.getLayerIds(),c=bd.component.lookup(b[b.length-1]);if("uiLayer"==c.type){for(var e=c.model.entityIds,f=0;f<e.length;f++)bd.model.entityLookup(e[f]).layerId=a.id,a.model.entityIds.push(e[f]);
c.model.entityIds=[];a=c.id;c.deleteEntity();-1!=b.indexOf(a)&&b.splice(b.indexOf(a),1)}};bd.methodTag.phaserView.getTopLayerIdWithType=function(a,b){"undefined"==typeof b&&(b=this.getLayerIds());for(var c=b.length-1;layerId=b[c];c--)if(bd.model.entityLookup(layerId).type==a)return layerId;return null};
bd.methodTag.phaserView.removeCameraView=function(){var a=new bd.component.uiLayer.constructor(null,this.id,this.model.tmxMapId),b=this.model.cameraLayerIds,c=this.getTopLayerIdWithType("uiLayer",b),e=null;null!=c&&(e=bd.component.lookup(c));if("uiLayer"==e.type){for(var f=e.model.entityIds,c=0;c<f.length;c++)bd.model.entityLookup(f[c]).layerId=a.id,a.model.entityIds.push(f[c]);e.model.entityIds=[]}a=this.getTopLayerIdWithType("tmxEntityLayer");null==a&&(a=(new bd.component.melonView.tmxEntityLayer.constructor(null,
this.id,this.model.tmxMapId)).id);e=bd.model.entityLookup(a);for(c=0;c<b.length;c++)if("tmxEntityLayer"==bd.model.entityLookup(b[c]).type){for(var f=bd.model.entityLookup(b[c]).entityIds,g=0;g<f.length;g++)bd.model.entityLookup(f[g]).layerId=a,e.entityIds.push(f[g]);bd.model.entityLookup(b[c]).entityIds=[]}for(c=0;c<b.length;c++)bd.component.lookup(b[c]).deleteEntity();this.model.cameraLayerIds=[]};
bd.methodTag.phaserView.switchHeadsUpEditMode=function(a){this.editingHeadsUp=a;this.changeView(!0);bd.editor.ctr.getSelectedEntity()&&bd.entitySelect.ctr.switchLayerForEntityChange(bd.editor.ctr.getSelectedEntity().id);bd.layerSelect.ctr.setupLayerSelect()};
bd.methodTag.phaserView.setDefaultLastUsedLayerIds=function(){for(var a={},b=0;b<this.possibleLayerTypes.length;b++){a[this.possibleLayerTypes[b]]=!1;var c=bd.component.typeNameToComponent[this.possibleLayerTypes[b]];c.componentProperties.lastUsedLayerId=null}for(var e=this.getReverseLayerIds(!0),b=0;b<e.length;b++)c=bd.model.entityLookup(e[b]).type,a[c]||(a[c]=!0,c=bd.component.typeNameToComponent[c],c.componentProperties.lastUsedLayerId=e[b])};
bd.methodTag.phaserView.getImageLayerId=function(){for(var a=this.getLayerIds(),b=0,c;c=a[b];b++)if("tmxImageLayer"==bd.component.lookup(c).type)return c};bd.methodTag.phaserView.getBlockRenameDependantIds=function(){return this.getLayerIds()};bd.methodTag.phaserView.populateEditorDisplayObjects=function(){};
bd.methodTag.phaserView.onMouseMove=function(a){lastestMouseX=a.offsetX;lastestMouseY=a.offsetY;var b=bd.component.lookup(bd.model.getCurrentViewId());if(b){var c=a.offsetX;a=a.offsetY;var e=b.getPlayerViewHeightWidth().width,b=b.getPlayerViewHeightWidth().height;0<=c&&c<=e&&0<=a&&a<=b&&(b=document.getElementsByClassName("mouseX")[0],e=document.getElementsByClassName("mouseY")[0],b.innerText=c,e.innerText=a)}};
bd.methodTag.phaserView.getPlayerViewHeightWidth=function(a){var b=this.model.height,c=this.model.width;a&&this.editingHeadsUp&&(b=this.model.cameraHeight,c=this.model.cameraWidth);return{height:b,width:c}};bd.methodTag.phaserView.getReverseLayerIds=function(a){a=this.getLayerIds(a);for(var b=[],c=a.length-1;0<=c;c--)b.push(a[c]);return b};
bd.methodTag.phaserView.getLayerIds=function(a){var b=bd.component.lookup(this.model.tmxMapId).model.layerIds;a&&this.editingHeadsUp&&(b=this.model.cameraLayerIds);return b};bd.methodTag.view.getLayerPanelButtons=function(){return this.editingHeadsUp?this.cameraLayerPanelButtons:this.layerPanelButtons};bd.modelTag.hasTimerProperties={provideFields:function(){return[{fields:["countDown"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["countDown"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["timeInput"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["timeInput"],classOrInstance:"class",providers:["defaultValue"],defaultValue:5},{fields:["startTime"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["startTime"],
classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["stopTime"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["stopTime"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["timeOut"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["timeOut"],classOrInstance:"class",providers:["defaultValue"],defaultValue:null},{fields:["activated"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["activated"],
classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["hasTimeLimit"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["hasTimeLimit"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0}]}};bd.methodTag.player={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.player.updateSideBar},{name:"updateView",fxn:bd.methodTag.player.updateView},{name:"getStageId",fxn:bd.methodTag.player.getStageId},{name:"removeConnections",fxn:bd.methodTag.player.removeConnections,classOrInstance:"instance"}]}};bd.methodTag.player.handleCommand=function(a){if("viewId"==a.property&&bd.inPlayer)return this.updateView(),!0};
bd.methodTag.player.updateSideBar=function(){var a=document.getElementById(this.sideBarPanelName),b=this;a.getElementsByClassName("addPlayerLinkContainer")[0].onclick=function(){new bd.component.playerInstance.constructor(null,b.id);bd.sideBar.ctr.updateSideBar()};a=a.getElementsByClassName("playerListContainer")[0];a.innerHTML="";for(var c=bd.model.getEntityList("playerInstance"),e=0;e<c.length;e++){var f=goog.dom.createDom("div");f.style["float"]="left";f.style.width="320px";f.style.marginTop="5px";
f.style.backgroundColor="none";var g=goog.dom.createDom("input");g.className="nameInput";g.type="text";g.style.width="114px";g.value=c[e].name;bd.util.setTextInputChangeEventHandlers(g,{entityId:c[e].id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);var h=goog.dom.createDom("a");h.href="#";h.className="playerDeleteLink";h.innerHTML="Delete";h.instanceId=c[e].id;h.onclick=function(a){confirm("Are you sure you want to delete this player?")&&bd.component.lookup(this.instanceId).deleteInstance();
return!1};f.appendChild(g);1<c.length&&f.appendChild(h);a.appendChild(f)}};bd.methodTag.player.updateView=function(){if(this.id==bd.player.ctr.playerId){for(var a=bd.component.lookup(this.model.viewId).getPhaserGameObject(),b=bd.component.lookup(bd.player.ctr.uiViewId).getLayerIds(),c=0,e;e=b[c];c++)e=bd.component.lookup(e),e.saveStateInModelForEntitiesFromLayer(),e.removeEntitiesFromLayer();bd.player.ctr.uiViewId=this.model.viewId;a.state.start(a.state.current)}};bd.methodTag.player.getStageId=function(){return this.model.viewId};
bd.methodTag.player.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.component.playerClass={constructor:function(a,b){goog.mixin(this,bd.component.playerClass.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};var c=null==a;bd.modelTag.applyTags(this,c);bd.methodTag.applyMethodTags(this);c&&(new bd.component.playerInstance.constructor(null,this.id),new bd.component.playerInstance.constructor(null,this.id))},componentProperties:{classOrInstance:"class",type:"playerClass",
listName:"playerClasss",idName:"playerClassId",idListName:"playerClassIds",editorDisplayObjectType:"image",sideBarPanelName:"sideBarPlayerClassPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-players.png",possibleLayerTypes:["tmxEntityLayer"],hasTraitTab:!0,namePrefix:"Player Class ",typeName:"Player Class",tabName:"Players",entityName:"Player Class",entityNamePlural:"Player Classes",thisName:"this player class",allName:"all player classes",anyName:"any player class",
randomName:"random player class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasCostume perPlayer hasTraits hasTabContainer hasScripts hasPlayerInstanceProperties".split(" "),methodTags:["entity","player"]},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"sprite.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"sprite.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.playerInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.playerInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"playerInstance",listName:"playerInstances",idName:"playerInstanceId",idListName:"playerInstanceIds",editorDisplayObjectType:"image",namePrefix:"player ",entityName:"Player",thisName:"this player",
allName:"all players",anyName:"any player",randomName:"random player",modelTags:bd.component.playerClass.componentProperties.modelTags,methodTags:bd.component.playerClass.componentProperties.methodTags}};bd.component.typeNameToComponent.playerClass=bd.component.playerClass;bd.component.typeNameToComponent.playerInstance=bd.component.playerInstance;bd.component.childNameToParentName.playerInstance="playerClass";bd.component.melonView.tmxLayer={constructor:function(a){goog.mixin(this,bd.component.melonView.tmxLayer.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tmxLayer",listName:"tmxLayers",idName:"tmxLayerId",idListName:"tmxLayerIds",namePrefix:"tmxLayer",modelTags:["entity","hasMelonTMXLayerProperties"],methodTags:["entity"]}};bd.component.typeNameToComponent.tmxLayer=bd.component.melonView.tmxLayer;bd.component.melonView.tmxEntity={constructor:function(a){goog.mixin(this,bd.component.melonView.tmxEntity.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tmxEntity",listName:"tmxEntities",idName:"tmxEntityId",idListName:"tmxEntityIds",namePrefix:"tmxEntity",modelTags:["entity","hasMelonTMXEntityProperties"],methodTags:["entity"]}};bd.component.typeNameToComponent.tmxEntity=bd.component.melonView.tmxEntity;bd.modelTag.hasTableRowProperties={provideFields:function(){return[{fields:["tableInstanceId"],providers:["function"],fxn:bd.modelTag.hasTableRowProperties.tableRowId},{fields:["data"],providers:["srcInstance","componentObject"]}]}};
bd.modelTag.hasTableRowProperties.tableRowId=function(){this.model.tableInstanceId=this.tableInstanceId;bd.model.addModelUpdateElement([this.tableInstanceId],"push","rowIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});return!0};bd.component.tableRow={constructor:function(a,b,c){goog.mixin(this,bd.component.tableRow.componentProperties);this.tableInstanceId=b;this.data=c;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tableRow",listName:"tableRows",idName:"tableRowId",idListName:"tableRowIds",editorDisplayObjectType:"image",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},possibleLayerTypes:["tmxEntityLayer"],namePrefix:"Table Row Class ",
typeName:"Table Row",tabName:"Table Rows",entityName:"Table Row Class",entityNamePlural:"Table Row Classes",thisName:"this table row class",allName:"all table row classes",anyName:"any table row class",randomName:"random table row class",modelTags:["entity","hasTableRowProperties"],methodTags:["entity","canvasObject","phaserObject"]}};bd.component.typeNameToComponent.tableRow=bd.component.tableRow;bd.modelTag.hasTextInputProperties={requiredFields:["height","width"],provideFields:function(){return[{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:20},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:80},{fields:["offsetX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["offsetY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["entityPerPlayer"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:!1},{fields:["entityPerPlayer"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:!0},{fields:["text"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:""}]}};bd.modelTag.hasTableGridProperties={provideFields:function(){return[{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:150},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:200},{fields:["readOnly"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["readOnly"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1}]}};bd.evaluator.ctr.blocks.project={};
bd.evaluator.ctr.configs.project_switch_to={getParams:function(a){var b=[];b.push({name:"projectNum",type:"value",valueName:"PROJECT_NUM"});a=a.mutation._num_parameters;for(var c=0;c<a;c++)b.push({name:"paramName"+c,type:"field",fieldName:"PARAM_NAME"+c}),b.push({name:"paramValue"+c,type:"value",valueName:"PARAM_VALUE"+c});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.projectNum;a=a.mutation._num_parameters;for(var e={},f="",g=0;g<a;g++)e[b.params["paramName"+
g]]=b.params["paramValue"+g],0!=g&&(f+=", "),f=f+b.params["paramName"+g]+" = "+b.params["paramValue"+g];b="";0<a&&(b="?projectParams="+encodeURIComponent(JSON.stringify(e)));bd.player.ctr.inEditorPreview||isNaN(parseInt(c))||(window.location="/play/"+c+b);bd.errorLog.ctr.printError("Switched to project "+c);0<a&&bd.errorLog.ctr.printError("with parameters: "+f);bd.evaluator.ctr.stopAllSprites();bd.evaluator.ctr.stopAllScripts(!1)}};
bd.evaluator.ctr.configs.project_get_parameter={paramsInfo:[{name:"paramName",type:"value",valueName:"PARAM_NAME"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.paramName,c=bd.util.getURLParamValue("projectParams"),e="nullObject";if(""!=c)try{var f=JSON.parse(decodeURIComponent(c));f[b]&&(e=f[b])}catch(g){}if("nullObject"==e)for(c=bd.projectParam.ctr.tableData,bd.player.ctr.inEditorPreview&&(c=window.parent.bd.projectParam.ctr.tableData),f=0;f<c.length;f++)if(c[f][0]==
b){e=c[f][1];break}bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}};bd.component.phaserView={constructor:function(a,b){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.phaserView.componentProperties);this.tabId=b;this.model=null!=a?a:{};var c=null==a;null==a&&(this.defaultImageId=bd.defaultGameViewAsset.id,bd.component.addComponentListToComponent(this,bd.component.phaserView.componentProperties.componentsOnView,"idListName"));bd.modelTag.applyTags(this,c);bd.methodTag.applyMethodTags(this);null==a&&this.afterComponentCreated()},componentProperties:{classOrInstance:"class",
type:"phaserView",listName:"phaserViews",idName:"phaserViewId",idListName:"phaserViewIds",namePrefix:"stage",tabName:"Phaser View",typeName:"Stage",entityName:"Stage",sideBarPanelName:"sideBarPhaserViewPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-stage.png",editorDisplayObjectType:"image",minimumEntitiesInList:1,layerNameToObject:{},isKineticJSView:!1,editorFrameFile:"melonEditorView.html",playerFrameFile:"/stage/phaser/",isView:!0,isInitialized:!1,
hasLayers:!0,layerPanelButtons:["component","gameProperties","background","stageProperties"],cameraLayerPanelButtons:["component","stageProperties"],availableTabs:"sharedSpriteTab spriteTab labelTab textInputTab soundTab tableTab timerTab mapTab videoTab playerTab".split(" "),editingHeadsUp:!1,possibleLayerTypes:["tmxEntityLayer","uiLayer"],possibleStageLayerTypesWithHeadUp:["tmxEntityLayer"],possibleHeadsUpLayerTypes:["tmxEntityLayer","uiLayer"],componentsOnView:"melonPieceInstance phaserPieceInstance labelInstance phaserPhysicsPieceInstance gridInstance textInputInstance tableGridInstance mapInstance richTextInputInstance videoInstance".split(" "),
xTileOffset:10,yTileOffset:10,melonjsPanelWidth:250,selectedLayerBoxNum:0,selectedLayerId:null,layerPageNum:0,layerDetailPanels:{},modelTags:"entity hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasTabContainer hasScripts hasViewHeightWidth hasMelonProperties hasPhaserViewProperties hasBackgroundDrawingProperties".split(" "),methodTags:"entity view gameView frameView melonView phaserView".split(" ")},getProperties:function(){return[{name:"BACKGROUND_COLOR"},{name:"BACKGROUND_DRAWING_ENABLED"},
{name:"BACKGROUND_DRAWING_COLOR"},{name:"BACKGROUND_DRAWING_THICKNESS"}]},initializeComponent:function(){for(var a in bd.component.typeNameToComponent){var b=bd.component.typeNameToComponent[a].componentProperties.layerDetailPanel;b&&(bd.component.phaserView.componentProperties.layerDetailPanels[b]=!0)}},setPhaserGameObject:function(a){this.phaserGame=a},getPhaserGameObject:function(){return this.phaserGame},setPhaserObject:function(a){this.phaserObject=a},getPhaserObject:function(){return this.phaserObject}};
bd.component.typeNameToComponent.phaserView=bd.component.phaserView;bd.methodTag.traitDef={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.traitDef.removeConnections,classOrInstance:"class"}]}};bd.methodTag.traitDef.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.entityId],"removeValue","traitDefIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.commonTraitDef={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.commonTraitDef.removeConnections,classOrInstance:"class"}]}};
bd.methodTag.commonTraitDef.removeConnections=function(){bd.model.entityLookup(this.id);for(var a=[],b=bd.component[this.model.entityType].componentProperties.listName,c=0;c<bd.model.getCurrentGame()[b].length;c++)a.push(bd.model.getCurrentGame()[b][c].id);bd.model.addModelUpdateElement(a,"removeValue","traitDefIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.component.traitDef={constructor:function(a,b,c){this.srcInstance="undefined"==typeof c?null:c;this.entityId="undefined"==typeof b?null:b;this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.traitDef.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"traitDef",listName:"traitDefs",idName:"traitDefId",idListName:"traitDefIds",namePrefix:"property",modelTags:["entity",
"hasSrcInstanceId","hasBlockEntityTracking","hasTraitDefCommonProperties","hasTraitDefProperties"],methodTags:["entity","traitDef"]}};
bd.component.commonTraitDef={constructor:function(a,b,c){this.srcInstance="undefined"==typeof c?null:c;this.entityType="undefined"==typeof b?null:b;this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.commonTraitDef.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"commonTraitDef",listName:"commonTraitDefs",idName:"commonTraitDefId",idListName:"commonTraitDefIds",namePrefix:"property",
modelTags:["entity","hasSrcInstanceId","hasBlockEntityTracking","hasTraitDefCommonProperties","hasCommonTraitDefProperties"],methodTags:["entity","commonTraitDef"]}};
bd.component.trait={constructor:function(a,b,c,e){this.traitDefId="undefined"==typeof b?null:b;this.instanceId="undefined"==typeof c?null:c;this.value="undefined"==typeof e?null:e;this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.trait.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"trait",listName:"traits",idName:"traitId",idListName:"traitIds",namePrefix:"trait",
modelTags:["entity","hasTraitProperties"],methodTags:["entity"]}};bd.component.typeNameToComponent.traitDef=bd.component.traitDef;bd.component.typeNameToComponent.commonTraitDef=bd.component.commonTraitDef;bd.component.typeNameToComponent.trait=bd.component.trait;bd.component.timer={constructor:function(a,b){goog.mixin(this,bd.component.timer.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};var c=null==a;bd.modelTag.applyTags(this,c);bd.methodTag.applyMethodTags(this);c&&new bd.component.timerInstance.constructor(null,this.id)},componentProperties:{classOrInstance:"class",type:"timer",listName:"timer",idName:"timerId",idListName:"timerIds",editorDisplayObjectType:"image",
sideBarPanelName:"sideBarTimerPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-timers.png",possibleLayerTypes:["tmxEntityLayer"],namePrefix:"Timer Class",typeName:"Timer",tabName:"Timers",entityName:"Timer Class",entityNamePlural:"Timer Classes",thisName:"this timer class",allName:"all timer classes",anyName:"any timer class",randomName:"random timer class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasCoordinateOffset hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasTargetId hasTimerProperties".split(" "),
methodTags:["entity","canvasObject","timer"]},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"timer.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"timer.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.timerInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.timerInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"timerInstance",listName:"timerInstances",idName:"timerInstanceId",idListName:"timerInstanceIds",editorDisplayObjectType:"image",namePrefix:"timer",entityName:"Timer",thisName:"this timer",allName:"all timers",
anyName:"any timer",randomName:"random timer class",modelTags:bd.component.timer.componentProperties.modelTags,methodTags:bd.component.timer.componentProperties.methodTags}};bd.component.typeNameToComponent.timer=bd.component.timer;bd.component.typeNameToComponent.timerInstance=bd.component.timerInstance;bd.component.childNameToParentName.timerInstance="timer";bd.modelTag.hasLevelEditorProperties={provideFields:function(){return[{fields:["tabOrder"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["traitIdToTraitModification"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["componentTypeToTraitRestriction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["componentTypeToCustomRestriction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["codeBlockCategoryless"],
classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["categoryIdToCategoryContent"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["blockIdToBlockRestriction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}}]}};bd.player.ctr={};bd.player.ctr.playerId=null;bd.player.ctr.playerInstanceId=null;bd.player.ctr.playerUdid=null;bd.player.ctr.playerPeerId=null;bd.player.ctr.uiViewId=null;bd.player.ctr.playerViewInitialized=!1;bd.player.ctr.inEditorPreview=!1;
bd.player.ctr.setupSelection=function(){if(bd.model.isMultiplayerGame()&&null!=bd.player.ctr.playerInstanceId||null!=bd.player.ctr.playerId&&!bd.model.isMultiplayerGame())bd.player.ctr.startGameAfterPlayerSelected();else{var a=bd.util.getURLParamValue("playerId");if(""!=a)bd.player.ctr.playerSelectFromUrl(a);else{document.getElementById("playerSelectionContainer")&&(document.getElementById("playerSelectionContainer").style.display="block");document.getElementById("playerSelectionPanel").innerHTML=
"";for(a=0;a<bd.model.currentInstance.playerInstances.length;a++){var b=bd.model.currentInstance.playerInstances[a];null==b.roleId&&bd.player.ctr.addPlayerRadio(b.id,b.name)}for(a=0;a<bd.model.currentInstance.roles.length;a++){var c=bd.model.currentInstance.roles[a],b=goog.dom.createDom("br");document.getElementById("playerSelectionPanel").appendChild(b);b=goog.dom.createDom("span");b.style.fontWeight="bold";var e=goog.html.SafeHtml.htmlEscape(c.name);b.innerHTML=goog.html.SafeHtml.unwrap(e);document.getElementById("playerSelectionPanel").appendChild(b);
b=goog.dom.createDom("br");document.getElementById("playerSelectionPanel").appendChild(b);for(e=0;e<bd.model.currentInstance.players.length;e++)b=bd.model.currentInstance.players[e],b.roleId==c.id&&bd.player.ctr.addPlayerRadio(b.id,b.username);bd.player.ctr.addPlayerRadio(c.id,c.name,!0)}}}};
bd.player.ctr.addPlayerRadio=function(a,b,c){var e=goog.dom.createDom("input");e.type="radio";e.name="playerOrRoleId";e.value=a;document.getElementById("playerSelectionPanel").appendChild(e);e=goog.dom.createDom("span");c&&(b="New "+b+":");b=goog.html.SafeHtml.htmlEscape(b);e.innerHTML=goog.html.SafeHtml.unwrap(b);document.getElementById("playerSelectionPanel").appendChild(e);c&&(c=goog.dom.createDom("input"),c.id="newRoleUsernameInput"+a,c.type="text",c.name="playerOrRoleId",c.style.width="50px",
document.getElementById("playerSelectionPanel").appendChild(c));a=goog.dom.createDom("br");document.getElementById("playerSelectionPanel").appendChild(a)};
bd.player.ctr.playerSelectFromUrl=function(a){for(var b=null,c=bd.model.getEntityList("playerInstance").concat(bd.model.getEntityList("player")),e=0;e<c.length;e++)if(c[e].id==a){b=e;break}null==b?alert("Invalid Player Id"):(bd.player.ctr.playerId=a,bd.model.getGameInfo().isMultiplayer&&(bd.evaluator.ctr.startGame(),bd.evaluator.ctr.whenPlayerJoins()),document.getElementById("playerSelectionContainer").style.display="none",document.getElementById("playerRoleContainer").style.display="none",document.getElementById("playerPageContent").style.backgroundColor=
"white",document.getElementById("titleBar").style.position="absolute",document.getElementById("titleBar").style.top="0px",bd.model.getCurrentGame().multiplayer||(document.getElementById("playerPanel").style.backgroundColor="rgb(229, 231, 198)",document.getElementById("titleBar").style.display="none"),bd.component.lookup(bd.model.getCurrentViewId()).setupView(),bd.player.ctr.focusOnPlayer(),bd.model.getGameInfo())};
bd.player.ctr.focusOnPlayer=function(){var a=bd.player.ctr.window.document.getElementById("playerPageContent");a.tabIndex=0;a.style.outline="none";a.focus();a.onkeydown=bd.player.ctr.onkeydown;a.onkeypress=function(a){a&&a.stopPropagation&&a.stopPropagation();return!1}};
bd.player.ctr.getSelectedPlayerId=function(){if(null==document.getElementById("playerSelectionForm").playerOrRoleId)return alert("Something is wrong, player radio buttons don't exist"),null;var a=document.getElementById("playerSelectionForm").playerOrRoleId;null==document.getElementById("playerSelectionForm").playerOrRoleId.length&&(a=[document.getElementById("playerSelectionForm").playerOrRoleId]);for(var b=null,c=0;c<a.length;c++)if(a[c].checked){b=a[c].value;break}if(null==b)return alert("You need to select a role"),
null;if("role"==bd.entityLookup[b].type){a=b;b=document.getElementById("newRoleUsernameInput"+a).value;if(""==b)return alert("You need to type in a username"),null;bd.inPlayer||(bd.preview.ctr.creatingPreviewPlayer=!0);a=bd.model.createPlayerFromRoleId(a,b);bd.inPlayer||(bd.preview.ctr.creatingPreviewPlayer=!1);return a.id}return b};
bd.player.ctr.startGameAfterPlayerSelected=function(){document.getElementById("playerSelectionContainer").style.display="none";document.getElementById("playerRoleContainer")&&bd.model.getGameInfo().isMultiplayerGame&&(document.getElementById("playerRoleContainer").style.display="block");bd.model.getGameInfo().isMultiplayerGame&&bd.inPlayer&&bd.instance.ctr.afterGameLoadInstanceSetup();bd.component.lookup(bd.model.getCurrentViewId()).setupView();bd.player.ctr.focusOnPlayer()};
bd.player.ctr.playerSelected=function(){var a=bd.player.ctr.getSelectedPlayerId();null!=a&&(bd.player.ctr.playerId=a,bd.player.ctr.playerInstanceId=a,bd.player.ctr.startGameAfterPlayerSelected())};bd.player.ctr.onkeydown=function(a){bd.evaluator.ctr.keyPressed(a.keyCode);a&&a.stopPropagation&&a.stopPropagation();return!1};
jQuery(document).ready(function(){document.getElementById("playerSelectionButton")&&(document.getElementById("playerSelectionButton").onclick=function(a){bd.inPlayer?bd.player.ctr.playerSelected():bd.preview.ctr.activatePlayer()})});bd.methodTag.grid={provideMethods:function(){return[{name:"createKineticEditorObject",fxn:bd.methodTag.grid.createKineticEditorObject,classOrInstance:"instance"},{name:"createDisplayObject",fxn:bd.methodTag.grid.createDisplayObject,classOrInstance:"instance"},{name:"createSelectionBorder",fxn:bd.methodTag.grid.createSelectionBorder,classOrInstance:"instance"},{name:"setWidthHeight",fxn:bd.methodTag.grid.setWidthHeight,classOrInstance:"instance"},{name:"setAnchor",fxn:bd.methodTag.grid.setAnchor,classOrInstance:"instance"},
{name:"switchCostume",fxn:bd.methodTag.grid.switchCostume,classOrInstance:"instance"},{name:"setCellByIndex",fxn:bd.methodTag.grid.setCellByIndex,classOrInstance:"instance"},{name:"getCellByIndex",fxn:bd.methodTag.grid.getCellByIndex,classOrInstance:"instance"},{name:"updateGrid",fxn:bd.methodTag.grid.updateGrid,classOrInstance:"instance"},{name:"xOrYByColumnRow",fxn:bd.methodTag.grid.xOrYByColumnRow,classOrInstance:"instance"},{name:"getColumnRowByXY",fxn:bd.methodTag.grid.getColumnRowByXY,classOrInstance:"instance"},
{name:"createTileObjects",fxn:bd.methodTag.grid.createTileObjects,classOrInstance:"instance"},{name:"getTileByColumnRow",fxn:bd.methodTag.grid.getTileByColumnRow,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.grid.updateSideBar,classOrInstance:"class"}]}};
bd.methodTag.grid.handleCommand=function(a){if(("numColumns"==a.property||"numRows"==a.property||"tileWidth"==a.property||"tileHeight"==a.property||"horizontalMargin"==a.property||"verticalMargin"==a.property||"borderThickness"==a.property||"tilePattern"==a.property)&&!bd.component.isComponentClass(this.type))return this.updateGrid(),!0;if("costumeIds"==a.property)for(a=0;a<this.model.instanceIds.length;a++)bd.component.lookup(this.model.instanceIds[a]).updateGrid();return!1};
bd.methodTag.grid.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName).getElementsByClassName("nameInput")[0];b.value=a.name;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);document.getElementById("gridImageSelector").src=bd.component.lookup(bd.entityLookup[a.costumeIds[0]].assetId).getThumbnailUrl()};
bd.methodTag.grid.updateGrid=function(){var a=this.getDisplayObject().selectionBorder;this.getDisplayObject().destroy();var b=this.getLayer(),c=this.createEditorDisplayObject(),e=bd.component.lookup(bd.model.getCurrentViewId());c.setX(this.model.x+e.getCanvasViewLeft());c.setY(this.model.y+e.getCanvasViewTop());a.setWidth(this.model.width+4);a.setHeight(this.model.height+4);this.getDisplayObject().selectedInstanceBorder=a;b.add(c);b.batchDraw()};
bd.methodTag.grid.createKineticEditorObject=function(){for(var a=new Kinetic.Group({draggable:!0}),b=0;b<this.model.numColumns*this.model.numRows;b++){var c=b,e=Math.floor(c/this.model.numColumns),f=c%this.model.numColumns,g=new Kinetic.Image({x:f*(this.model.tileWidth+this.model.horizontalMargin+(0===this.model.horizontalMargin?1:2)*this.model.borderThickness)+this.model.borderThickness,y:e*(this.model.tileHeight+this.model.verticalMargin+(0===this.model.verticalMargin?1:2)*this.model.borderThickness)+
this.model.borderThickness,width:this.model.tileWidth,height:this.model.tileHeight}),h=new Kinetic.Rect({x:g.x()-this.model.borderThickness/2,y:g.y()-this.model.borderThickness/2,width:g.width()+this.model.borderThickness,height:g.height()+this.model.borderThickness,stroke:"black",strokeWidth:this.model.borderThickness});g.i=c;this.setCellByIndex(c,g);c=bd.component.lookup(this.model.parentId).model.costumeIds;"solid"===this.model.tilePattern||2>c.length?bd.imageLoader.ctr.getImage(g,this.getLayer(),
bd.model.entityLookup(this.model.costumeId).assetId):"checkerboard"===this.model.tilePattern&&bd.imageLoader.ctr.getImage(g,this.getLayer(),bd.model.entityLookup(c[(e+f)%2]).assetId);g.on("click tap",function(){alert(this.i)});a.add(g);0<this.model.borderThickness&&a.add(h)}return a};
bd.methodTag.grid.createSelectionBorder=function(){var a=this.getDisplayObject();if(null!=bd.editor.ctr.getSelectedInstanceId()){var b=bd.component.lookup(bd.editor.ctr.getSelectedInstanceId()).getDisplayObject();b.selectedInstanceBorder.destroy();b.parent.batchDraw()}bd.editor.ctr.setSelectedInstanceId(a.instanceId);b=new Kinetic.Group;a.selectedInstanceBorder=b;var c=new Kinetic.Rect({x:a.x()-2,y:a.y()-2,width:this.model.width+4,height:this.model.height+4,stroke:"red",strokeWidth:4});b.add(c);a.on("dragmove",
function(){c.setX(this.x()-2);c.setY(this.y()-2)});a.selectionBorder=c;var e=this.getLayer();e.add(b);a.moveToTop();e.batchDraw()};
bd.methodTag.grid.createDisplayObject=function(){for(var a=bd.component.lookup(this.model.viewId),b=a.getPhaserGameObject(),a=a.getPhaserObject(),c=b.add.group(),e=0;e<this.model.numColumns*this.model.numRows;e++){var f=b.add.group(),g=Math.floor(e/this.model.numColumns),h=e%this.model.numColumns,k=h*(this.model.tileWidth+this.model.horizontalMargin+(0===this.model.horizontalMargin?1:2)*this.model.borderThickness)+this.model.borderThickness,l=g*(this.model.tileHeight+this.model.verticalMargin+(0===
this.model.verticalMargin?1:2)*this.model.borderThickness)+this.model.borderThickness,g=this.getTileByColumnRow(h,g),h=bd.model.entityLookup(g.model.costumeId).assetId,k=new a.Sprite(b,k,l,"assetId:"+h);k.scale.setTo(this.model.tileWidth/k.width,this.model.tileHeight/k.height);l=b.add.graphics(0,0);l.lineStyle(this.model.borderThickness,0,1);l.drawRect(k.x-this.model.borderThickness/2,k.y-this.model.borderThickness/2,k.width+this.model.borderThickness,k.height+this.model.borderThickness);f.add(k);
f.add(l);g.setDisplayObject(f);c.add(f)}c.x=this.model.x;c.y=this.model.y;return c};bd.methodTag.grid.setAnchor=function(){};
bd.methodTag.grid.createTileObjects=function(){for(i=0;i<this.model.numColumns*this.model.numRows;i++){var a=Math.floor(i/this.model.numColumns),b=i%this.model.numColumns,c=bd.component.lookup(this.model.parentId).model.costumeIds;if("solid"===this.model.tilePattern||2>c.length)var e=this.model.costumeId;else"checkerboard"===this.model.tilePattern&&(e=c[(a+b)%2]);new bd.component.gridTile.constructor(null,this.id,a,b,!0,e)}};
bd.methodTag.grid.xOrYByColumnRow=function(a,b){return{X:a*(this.model.tileWidth+this.model.horizontalMargin+(0===this.model.horizontalMargin?1:2)*this.model.borderThickness)+this.model.x+this.model.borderThickness+this.model.tileWidth/2,Y:b*(this.model.tileHeight+this.model.verticalMargin+(0===this.model.verticalMargin?1:2)*this.model.borderThickness)+this.model.y+this.model.borderThickness+this.model.tileHeight/2}};
bd.methodTag.grid.getColumnRowByXY=function(a,b){if(a>this.model.x&&a<this.model.x+this.model.height&&b>this.model.y&&b<this.model.y+this.model.width){for(var c=this.model.x-this.model.horizontalMargin,e=this.model.y-this.model.verticalMargin,f=0===this.model.horizontalMargin?1:2,g=0===this.model.horizontalMargin?1:2,h=1;h<=this.model.numColumns;h++)if(a<c+h*(this.model.tileWidth+this.model.horizontalMargin+f*this.model.borderThickness)){var k=h-1;break}for(h=1;h<=this.model.numRows;h++)if(b<e+h*
(this.model.tileHeight+this.model.verticalMargin+g*this.model.borderThickness)){var l=h-1;break}return{COLUMN:k,ROW:l}}return{COLUMN:null,ROW:null}};bd.methodTag.grid.getTileByColumnRow=function(a,b){for(i=0;i<this.model.gridTiles.length;i++){0>b?b=0:b>=this.model.numRows&&(b=this.model.numRows-1);0>a?a=0:a>=this.model.numColumns&&(a=this.model.numColumns-1);var c=bd.component.lookup(this.model.gridTiles[i]);if(b===c.model.row&&a===c.model.column)return c}};
bd.methodTag.grid.setWidthHeight=function(){bd.inPlayer||bd.methodTag.canvasObject.setWidthHeight.call(this)};bd.methodTag.grid.switchCostume=function(){for(var a=0;a<this.model.numColumns*this.model.numRows;a++)if(null!=this.getCellByIndex(a)){var b=this.getCellByIndex(a);bd.imageLoader.ctr.getImage(b,this.getLayer(),bd.entityLookup[this.model.costumeId].assetId)}};bd.methodTag.grid.setCellByIndex=function(a,b){this.cellDictionary[a]=b};bd.methodTag.grid.getCellByIndex=function(a){return this.cellDictionary[a]};bd.component.melonView.gridSizeSelector={};bd.component.melonView.gridSizeSelector.isResizing=!1;bd.component.melonView.gridSizeSelector.entityType=null;
bd.component.melonView.setupGridSizeSelector=function(a,b){"undefined"!=typeof b&&(bd.component.melonView.gridSizeSelector.entityType=b);var c,e,f,g;"undefined"==typeof a||null==a?(bd.component.melonView.gridSizeSelector.isResizing=!1,e=15,c=20,f=g=32):(bd.component.melonView.gridSizeSelector.isResizing=!0,f=bd.model.entityLookup(a),e=f.gridHeight,c=f.gridWidth,g=f.tileHeight,f=f.tileWidth);document.getElementById("melonViewMapHeightInput").value=e;document.getElementById("melonViewMapWidthInput").value=
c;document.getElementById("melonViewTileHeightInput").value=g;document.getElementById("melonViewTileWidthInput").value=f;document.getElementById("melonViewSizeOverlay").style.display="block"};
bd.component.melonView.selectGridAndTileSize=function(){document.getElementById("melonViewSizeOverlay").style.display="none";if(bd.component.melonView.gridSizeSelector.isResizing){var a=parseInt(document.getElementById("melonViewMapHeightInput").value),b=parseInt(document.getElementById("melonViewMapWidthInput").value),c=parseInt(document.getElementById("melonViewTileHeightInput").value),e=parseInt(document.getElementById("melonViewTileWidthInput").value),f=bd.model.getCurrentViewId(),g=bd.component.lookup(f),
h=g.model.tmxMapId;bd.model.addModelUpdateElement([f,h],"set","gridHeight",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([f,h],"set","gridWidth",b,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([f,h],"set","tileHeight",c,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([f,h],
"set","tileWidth",e,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();g.removeView();g.setupView()}else bd.entitySelect.ctr.newEntityProperties.gridHeight=parseInt(document.getElementById("melonViewMapHeightInput").value),bd.entitySelect.ctr.newEntityProperties.gridWidth=parseInt(document.getElementById("melonViewMapWidthInput").value),bd.entitySelect.ctr.newEntityProperties.tileHeight=parseInt(document.getElementById("melonViewTileHeightInput").value),
bd.entitySelect.ctr.newEntityProperties.tileWidth=parseInt(document.getElementById("melonViewTileWidthInput").value),bd.entitySelect.ctr.createEntity(bd.component.melonView.gridSizeSelector.entityType)};bd.component.levelEditorTraitModification={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorTraitModification.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorTraitModification",listName:"levelEditorTraitModifications",idName:"levelEditorTraitModificationId",idListName:"levelEditorTraitModificationIds",namePrefix:"unused prefix...",
tabName:"Level Editor Trait Modification",entityName:"Level Editor Trait Modification",modelTags:["entity","traitModification"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorTraitModification=bd.component.levelEditorTraitModification;bd.methodTag.role={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.role.updateSideBar}]}};
bd.methodTag.role.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName).getElementsByClassName("nameInput")[0];b.value=a.name;bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);document.getElementById("roleStartingGameView").innerHTML="";for(a=0;a<bd.model.getCurrentGame().gameViews.length;a++)document.getElementById("roleStartingGameView").options[document.getElementById("roleStartingGameView").options.length]=new Option(bd.model.getCurrentGame().gameViews[a].name,
bd.model.getCurrentGame().gameViews[a].id),bd.model.getCurrentGame().gameViews[a].id==bd.model.getCurrentGame().roles[bd.editor.ctr.getEntityTabObject().selectedEntityIndex-bd.model.getCurrentGame().players.length].viewId&&(document.getElementById("roleStartingGameView").selectedIndex=a)};bd.methodTag.piece={provideMethods:function(){return[{name:"updateBoxForTarget",fxn:bd.methodTag.piece.updateBoxForTarget,classOrInstance:"instance"},{name:"removeConnections",fxn:bd.methodTag.piece.removeConnections,classOrInstance:"instance"}]}};bd.methodTag.piece.handleCommand=function(a){return"targetId"==a.property?(this.updateBoxForTarget(a.entityId,a.value),!0):!1};
bd.methodTag.piece.updateBoxForTarget=function(a){var b=bd.model.entityLookup(this.id),c=bd.model.entityLookup(bd.player.ctr.playerId);null==a?b.viewId==c.viewId&&(!b.entityPerPlayer||b.entityPerPlayer&&b.visibleToPlayerId==c.id)&&this.addBox():(a=bd.model.entityLookup(a),a.viewId==c.viewId&&(!a.entityPerPlayer||a.entityPerPlayer&&a.visibleToPlayerId==c.id)?this.addBox():this.removeBox())};
bd.methodTag.piece.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue","pieceInstanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.targetId&&bd.model.addModelUpdateElement([a.targetId],
"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};bd.modelTag.hasTargetId={requiredFields:["targetId"],provideFields:function(){return[{fields:["targetId"],classOrInstance:"instance",providers:["srcInstance","defaultValue"],defaultValue:null}]}};bd.component.piece={constructor:function(a){goog.mixin(this,bd.component.piece.componentProperties);null==a&&(this.defaultImageId=bd.defaultPieceAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"piece",listName:"pieces",idName:"pieceId",idListName:"pieceIds",editorDisplayObjectType:"image",sideBarPanelName:"sideBarPiecePanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},namePrefix:"Piece Class",
typeName:"Piece",tabName:"Pieces",entityName:"Piece Class",entityNamePlural:"Piece Classes",thisName:"this piece class",allName:"all piece classes",anyName:"any piece class",randomName:"random piece class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasViewId hasCostume perPlayer hasTraits hasScripts hasTargetId".split(" "),methodTags:["entity","canvasObject","piece"]}};
bd.component.pieceInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.pieceInstance.componentProperties);this.layer=function(){return bd.pieceLayer};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"pieceInstance",listName:"pieceInstances",idName:"pieceInstanceId",idListName:"pieceInstanceIds",editorDisplayObjectType:"image",namePrefix:"piece",entityName:"Piece",
thisName:"this piece",allName:"all pieces",anyName:"any piece",randomName:"random piece",modelTags:bd.component.piece.componentProperties.modelTags,methodTags:bd.component.piece.componentProperties.methodTags}};bd.component.typeNameToComponent.piece=bd.component.piece;bd.component.typeNameToComponent.pieceInstance=bd.component.pieceInstance;bd.component.childNameToParentName.pieceInstance="piece";bd.evaluator.ctr.blocks.multiplayer={};bd.evaluator.ctr.configs.multiplayer_current_player={paramsInfo:[],evalFunc:function(a){bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.returnHandler(bd.player.ctr.playerId,a.returnsEntity)}};bd.modelTag.hasTableColumnProperties={provideFields:function(){return[{fields:["tableId"],providers:["function"],fxn:bd.modelTag.hasTableColumnProperties.tableColumnId,removeConnectionFxn:bd.modelTag.hasTableColumnProperties.removeColumnIds},{fields:["columnName"],providers:["srcInstance","componentObject"]},{fields:["columnType"],providers:["srcInstance","componentObject"]}]}};
bd.modelTag.hasTableColumnProperties.tableColumnId=function(){this.model.tableId=this.tableId;bd.model.addModelUpdateElement([this.tableId],"push","columnIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});return!0};
bd.modelTag.hasTableColumnProperties.removeColumnIds=function(){bd.model.addModelUpdateElement([this.model.tableId],"removeValue","columnIds",this.model.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};bd.component.tableColumn={constructor:function(a,b,c,e){goog.mixin(this,bd.component.tableColumn.componentProperties);this.tableId=b;this.columnName=c;this.columnType=e;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tableColumn",listName:"tableColumns",idName:"tableColumnId",idListName:"tableColumnIds",editorDisplayObjectType:"image",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},possibleLayerTypes:["tmxEntityLayer"],
columnTypes:["STRING","COLOR"],columnTypeToInfo:{STRING:{typeName:"Value",typeBlock:["String","Number"],typeHot:null},COLOR:{typeName:"Color",typeBlock:["Color"],typeHot:null}},namePrefix:"column ",typeName:"Table Column",tabName:"Table Columns",entityName:"Table Column Class",entityNamePlural:"Table Column Classes",thisName:"this table column class",allName:"all table column classes",anyName:"any table column class",randomName:"random table column class",modelTags:["entity","hasTableColumnProperties"],
methodTags:["entity","canvasObject","phaserObject"]}};bd.component.typeNameToComponent.tableColumn=bd.component.tableColumn;bd.component.melonView.tileGrid={};bd.component.melonView.isMouseDown=!1;
bd.component.melonView.setupTileGrid=function(){var a=this.getWindow().Kinetic;this.setLayer("gridLine",new a.Layer);for(var b=this.model.tileHeight,c=this.model.tileWidth,e=this.model.gridHeight,f=this.model.gridWidth,g,h=0;h<f+1;h++){g=this.getCanvasViewLeft()+this.xTileOffset+h*c;var k=this.getCanvasViewTop()+this.yTileOffset;g=new a.Line({points:[0,0,0,b*e],stroke:"black",strokeWidth:1,lineJoin:"round",dash:[4,2],x:g,y:k});this.getLayer("gridLine").add(g)}for(h=0;h<e+1;h++)g=this.getCanvasViewLeft()+
this.xTileOffset,k=this.getCanvasViewTop()+this.yTileOffset+h*b,g=new a.Line({points:[0,0,c*f,0],stroke:"black",strokeWidth:1,lineJoin:"round",dash:[4,2],x:g,y:k}),this.getLayer("gridLine").add(g);this.stage.add(this.getLayer("gridLine"));this.getLayer("gridLine").batchDraw();this.getLayer("gridLine").visible(this.model.gridVisible);this.setLayer("cursorLayer",new a.Layer);this.stage.add(this.getLayer("cursorLayer"));var l=this,m=new Image;m.crossOrigin="anonymous";m.onload=function(){l.tileCursor=
new a.Sprite({animation:"tileAnimation",animations:{tileAnimation:[0,32,32,32]},x:0,y:0,image:m,opacity:.6,visible:!1});l.getLayer("cursorLayer").add(l.tileCursor);l.getLayer("cursorLayer").batchDraw()};m.src="/static/images/1x1_trans.png";this.stage.container().onmousemove=function(a){a=bd.component.lookup(bd.model.getCurrentViewId());if(a.tileCursor)if("tmxTileLayer"!=bd.component.lookup(a.getSelectedLayerId()).type)a.tileCursor.hide(),a.getLayer("cursorLayer").batchDraw();else{var b=a.model.tileHeight,
c=a.model.tileWidth,e=a.getCanvasViewLeft()+a.xTileOffset,f=a.getCanvasViewTop()+a.yTileOffset,g=bd.component.melonView.getRowColumnNumFromPointer();null!=g?(a.tileCursor.setX(e+g.column*c),a.tileCursor.setY(f+(g.row*b+b-a.tileCursor.getHeight())),a.tileCursor.show()):a.tileCursor.hide();a.getLayer("cursorLayer").batchDraw();bd.component.melonView.isMouseDown&&bd.component.melonView.canvasView.placeTileOnLayerFromClick()}};this.stage.container().onmousedown=function(a){bd.component.melonView.isMouseDown=
!0;bd.component.melonView.canvasView.placeTileOnLayerFromClick()};this.stage.container().onmouseup=function(a){bd.component.melonView.isMouseDown=!1}};
bd.component.melonView.getRowColumnNumFromPointer=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()),b=a.model.tileHeight,c=a.model.tileWidth,e=a.model.gridHeight,f=a.model.gridWidth,g=a.getCanvasViewLeft()+a.xTileOffset,h=a.getCanvasViewTop()+a.yTileOffset;return(a=a.stage.getPointerPosition())&&a.x>g&&a.x<g+c*f&&a.y>h&&a.y<h+b*e?{row:Math.floor((a.y-h)/b),column:Math.floor((a.x-g)/c)}:null};
bd.component.melonView.removeTileGrid=function(){this.stage.container().onmousemove=null;this.stage.container().onmousedown=null;this.stage.container().onmouseup=null;this.tileCursor.remove();this.getLayer("cursorLayer").remove();this.getLayer("gridLine").remove()};bd.component.tutorialStep={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.tutorialStep.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tutorialStep",listName:"tutorialStep",idName:"tutorialStep",idListName:"tutorialStep",namePrefix:"unused prefix...",tabName:"Tutorial Step",entityName:"Tutorial Step",modelTags:["entity","hasTutorialStepProperties"],
methodTags:["entity"]}};bd.component.typeNameToComponent.tutorialStep=bd.component.tutorialStep;bd.methodTag.soundChannel={provideMethods:function(){return[{name:"play",fxn:bd.methodTag.soundChannel.play},{name:"setInstrument",fxn:bd.methodTag.soundChannel.setInstrument}]}};bd.methodTag.soundChannel.play=function(a,b){var c=this.model.channelNumber,e=this.model.volume,f=60/this.model.tempo*b;MIDI.programChange(c,this.model.instrument);MIDI.noteOn(c,a,e);setTimeout(function(a,b,c){MIDI.noteOff(a,b,0)},1E3*f,c,a,0)};
bd.methodTag.soundChannel.setInstrument=function(a){MIDI.loadResource({onsuccess:function(){},onprogress:function(a,c){},instrument:a})};bd.modelTag.hasSoundChannelProperties={provideFields:function(){return[{fields:["channelNumber"],providers:["function"],fxn:bd.modelTag.hasSoundChannelProperties.channelNumber},{fields:["volume"],providers:["defaultValue"],defaultValue:127},{fields:["instrument"],providers:["defaultValue"],defaultValue:0},{fields:["tempo"],providers:["defaultValue"],defaultValue:60}]}};
bd.modelTag.hasSoundChannelProperties.channelNumber=function(){channel=1;for(var a=0;a<bd.model.getEntityList("soundChannel").length;a++)channel==bd.model.getEntityList("soundChannel").channelNumber&&(channel+=1);this.model.channelNumber=channel;return!0};bd.component.soundChannel={constructor:function(a,b,c,e,f){goog.mixin(this,bd.component.soundChannel.componentProperties);this.channelNumber=b;this.volume=c;this.instrument=e;this.tempo=f;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"soundChannel",listName:"soundChannels",idName:"soundChannelId",idListName:"soundChannelIds",editorDisplayObjectType:"image",defaultImageUrlObject:{url:"images/qmarksq.png",
internal:!0},tabIconFileName:"class-icon-sound.png",possibleLayerTypes:["tmxEntityLayer"],columnTypes:[["Value","String"]],namePrefix:"channel ",typeName:"Sound Channel",tabName:"Sound Channel",entityName:"Sound Channel Class",entityNamePlural:"Sound Channel Classes",thisName:"this sound channel class",allName:"all sound channel classes",anyName:"any sound channel class",randomName:"random sound channel class",modelTags:["entity","hasSoundChannelProperties"],methodTags:["entity","soundChannel"]}};
bd.component.typeNameToComponent.soundChannel=bd.component.soundChannel;bd.component.levelEditorClassRestriction={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorClassRestriction.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorClassRestriction",listName:"levelEditorClassRestrictions",idName:"levelEditorClassRestrictionId",idListName:"levelEditorClassRestrictionIds",namePrefix:"unused prefix...",
tabName:"Level Editor Class Restriction",entityName:"Level Editor Class Restriction",modelTags:["entity","classRestriction"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorClassRestriction=bd.component.levelEditorClassRestriction;bd.modelTag.hasMapProperties={provideFields:function(){return[{fields:["height"],classOrInstance:"class",providers:["defaultValue"],defaultValue:20},{fields:["width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:80},{fields:["centerLat"],classOrInstance:"class",providers:["defaultValue"],defaultValue:42.36039450439665},{fields:["centerLng"],classOrInstance:"class",providers:["defaultValue"],defaultValue:-71.08565181380848},{fields:["centerLat","centerLng"],classOrInstance:"instance",
providers:["srcInstance","parent"]},{fields:["swLat"],classOrInstance:"class",providers:["defaultValue"],defaultValue:42.35970871235335},{fields:["swLng"],classOrInstance:"class",providers:["defaultValue"],defaultValue:-71.08687644509126},{fields:["neLat"],classOrInstance:"class",providers:["defaultValue"],defaultValue:42.361080296439944},{fields:["neLng"],classOrInstance:"class",providers:["defaultValue"],defaultValue:-71.0844271825257},{fields:["swLat","swLng","neLat","neLng"],classOrInstance:"instance",
providers:["srcInstance","parent"]}]}};bd.methodTag.textInput={provideMethods:function(){return[{name:"addEntity",fxn:bd.methodTag.textInput.addEntity,classOrInstance:"instance"},{name:"textChanged",fxn:bd.methodTag.textInput.textChanged,classOrInstance:"instance"},{name:"removeConnections",fxn:bd.methodTag.textInput.removeConnections,classOrInstance:"instance"},{name:"updateInstancePanel",fxn:bd.methodTag.textInput.updateInstancePanel,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.textInput.updateSideBar,classOrInstance:"class"},
{name:"removeEntityFromView",fxn:bd.methodTag.textInput.removeEntityFromView,classOrInstance:"instance"},{name:"setText",fxn:bd.methodTag.textInput.setText,classOrInstance:"instance"},{name:"updatePosition",fxn:bd.methodTag.textInput.updatePosition,classOrInstance:"instance"}]}};bd.methodTag.textInput.handleCommand=function(a){return"text"==a.property&&bd.model.isInstance(this.id)&&bd.inPlayer?(this.setText(a.value),!0):!1};
bd.methodTag.textInput.updateInstancePanel=function(){var a=this.model,b=document.getElementById(this.instancePanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,
">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("widthInput")[0];c.value=a.width;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"width",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("xInput")[0];c.value=a.x;bd.sideBar.ctr.resetTextInputStyle(c);
bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=b.getElementsByClassName("yInput")[0];b.value=a.y;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"y",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure)};
bd.methodTag.textInput.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("heightInput")[0];c.value=a.height;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"height",isNumber:!0,
updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=b.getElementsByClassName("widthInput")[0];b.value=a.width;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"width",isNumber:!0,updateInstances:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,
bd.sideBar.ctr.textUpdateFailure)};
bd.methodTag.textInput.addEntity=function(){var a=goog.dom.createDom("div");a.setAttribute("id",this.model.type+"Div"+this.id);a.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";a.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";a.style.left=this.model.x*bd.phaser.ctr.gameScaleFactor+"px";a.style.top=this.model.y*bd.phaser.ctr.gameScaleFactor+"px";a.style.position="absolute";a.style.fontSize="18px";var b="none";this.model.visible&&(b="block");a.style.display=b;b=goog.dom.createDom("input");
b.setAttribute("id","textInput"+this.id);b.setAttribute("text","text");b.className="textInputDisplayObject";b.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px";b.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px";b.instanceId=this.id;b.value=this.model.text;b.onchange=function(a){bd.component.lookup(a.target.instanceId).textChanged(a.target.value)};b.onkeyup=function(a){bd.component.lookup(a.target.instanceId).textChanged(a.target.value)};a.appendChild(b);b=bd.component.lookup(this.model.layerId).componentContainerId;
bd.component.lookup(this.model.viewId).getWindow().document.getElementById(b).appendChild(a);this.setDisplayObject(a)};bd.methodTag.textInput.textChanged=function(a){bd.model.addModelUpdateElement([this.id],"set","text",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.textInput.removeEntityFromView=function(){var a=bd.component.lookup(this.model.layerId).componentContainerId,b=bd.component.lookup(this.model.viewId),c=b.getWindow().document.getElementById(this.model.type+"Div"+this.id);try{b.getWindow().document.getElementById(a).removeChild(c)}catch(e){}};bd.methodTag.textInput.setText=function(){var a=this.getDisplayObject();a&&(a=a.getElementsByClassName("textInputDisplayObject")[0])&&(a.value=this.model.text)};
bd.methodTag.textInput.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue",this.idListName,this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.layerId],"removeValue",
"entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.textInput.updatePosition=function(){var a=this.getDisplayObject();a&&(a.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px",a.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+"px",a.style.left=this.model.x*bd.phaser.ctr.gameScaleFactor+"px",a.style.top=this.model.y*bd.phaser.ctr.gameScaleFactor+"px",a=a.getElementsByClassName("textInputDisplayObject")[0],a.style.height=this.model.height*bd.phaser.ctr.gameScaleFactor+"px",a.style.width=this.model.width*bd.phaser.ctr.gameScaleFactor+
"px")};bd.component.map={constructor:function(a,b){goog.mixin(this,bd.component.map.componentProperties);this.tabId=b;this.model=null!=a?a:{};var c=null==a;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId(),bd.component.addComponentListToComponent(this,bd.component.map.componentProperties.componentsOnView,"idListName"));bd.modelTag.applyTags(this,c);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"map",listName:"maps",idName:"mapId",
idListName:"mapIds",sideBarPanelName:"sideBarMapPanel",tabIconFileName:"class-icon-input.png",editorDisplayObjectType:"image",possibleLayerTypes:["uiLayer"],namePrefix:"Map Class",typeName:"Map",tabName:"Maps",entityName:"Map Class",entityNamePlural:"Map Classes",thisName:"this map class",allName:"all map classes",anyName:"any map class",randomName:"random map class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasHeightWidth hasVisibility hasViewId hasLayerId hasCostume hasCoordinateOffset shareMode hasTraits hasTabContainer hasScripts hasMapProperties".split(" "),
methodTags:["entity","canvasObject","htmlObject","textInput"]},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"map.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"map.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.mapInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.mapInstance.componentProperties);b=null==a;null==a&&bd.component.addComponentListToComponent(this,bd.component.mapInstance.componentProperties.componentsOnView,"idListName");bd.modelTag.applyTags(this,b);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"mapInstance",listName:"mapInstances",idName:"mapInstanceId",idListName:"mapInstanceIds",
editorDisplayObjectType:"image",instancePanelName:"mapInstancePanel",isInitialized:!1,componentsOnView:["mapSpriteInstance"],hasLayers:!1,layerPanelButtons:["component"],layerPanelDivs:["layerSwitchMapButtonContainer"],availableTabs:["mapSpriteTab"],xTileOffset:10,yTileOffset:10,namePrefix:"map",entityName:"Map",thisName:"this map",allName:"all maps",anyName:"any map",randomName:"random map",modelTags:bd.component.map.componentProperties.modelTags,methodTags:"entity view canvasObject htmlObject textInput map".split(" ")}};
bd.component.typeNameToComponent.map=bd.component.map;bd.component.typeNameToComponent.mapInstance=bd.component.mapInstance;bd.component.childNameToParentName.mapInstance="map";bd.modelTag.hasGameInfoProperties={requiredFields:["name","gameName","description"],provideFields:function(){return[{fields:["name"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"game"},{fields:["description"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""},{fields:["gameName"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"New Game"},{fields:["tabListIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["isMultiplayer"],
classOrInstance:"class",providers:["componentObject"]},{fields:["isMultiplayerGame"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["framesPerSecond"],classOrInstance:"class",providers:["defaultValue"],defaultValue:60},{fields:["draftVersionNotes"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""},{fields:["keyCodeToEntityAndBlockId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["deletedEntityIdToName"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:{}},{fields:["playerIdToGlobalVariables"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["dictionaries"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]}]}};bd.component.gameInfo={constructor:function(a,b){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.gameInfo.componentProperties);this.isMultiplayer=b;this.model=null!=a?a:{};null==a&&(this.defaultImageId=bd.defaultPieceAsset.id);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"gameInfo",listName:"gameInfos",idName:"gameInfoId",idListName:"gameInfoIds",sideBarPanelName:"sideBarGamePanel",defaultImageUrlObject:{url:"images/qmarksq.png",
internal:!0},editorDisplayObjectType:"image",minimumEntitiesInList:1,maximumEntitiesInList:1,namePrefix:"unused prefix...",typeName:"Game",tabName:"Game",entityName:"Game",entityNamePlural:"Game",thisName:"this game",allName:"all games",anyName:"any game",randomName:"random game",modelTags:"entity hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasTabContainer hasScripts hasGameInfoProperties".split(" "),methodTags:["entity","gameInfo"]}};
bd.component.typeNameToComponent.gameInfo=bd.component.gameInfo;bd.component.uiLayer={constructor:function(a,b,c){this.viewId="undefined"==typeof b?null:b;this.tmxMapId=c;goog.mixin(this,bd.component.uiLayer.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this);null==a&&this.afterComponentCreated()},componentProperties:{classOrInstance:"class",type:"uiLayer",listName:"uiLayers",idName:"uiLayerId",idListName:"uiLayerIds",namePrefix:"uiLayer",layerDetailPanel:"uiLayerPanel",componentContainerId:"uiElementContainer",
layerAddContainerId:"layerAddUILayerContainer",lastUsedLayerId:null,layerHasEntities:!0,modelTags:["entity","hasMelonTMXLayerProperties","hasUILayerProperties"],methodTags:["entity","tmxLayer","tmxEntityLayer"]}};bd.component.typeNameToComponent.uiLayer=bd.component.uiLayer;bd.methodTag.tab={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.tab.removeConnections},{name:"changeTabName",fxn:bd.methodTag.tab.changeTabName},{name:"hideFromUser",fxn:bd.methodTag.tab.hideFromUser},{name:"changeMaxEntityCount",fxn:bd.methodTag.tab.changeMaxEntityCount},{name:"addCreatetype",fxn:bd.methodTag.tab.addCreatetype},{name:"removeCreatetype",fxn:bd.methodTag.tab.removeCreatetype},{name:"addTabComponentContent",fxn:bd.methodTag.tab.addTabComponentContent},
{name:"addNewTabComponent",fxn:bd.methodTag.tab.addNewTabComponent},{name:"changeContentOrdering",fxn:bd.methodTag.tab.changeContentOrdering},{name:"entityIdGenerator",fxn:bd.methodTag.tab.getEntityIds},{name:"shouldShowAddButton",fxn:bd.methodTag.tab.shouldShowAddButton},{name:"shouldShowRemoveButton",fxn:bd.methodTag.tab.shouldShowRemoveButton},{name:"getTabIconFilePath",fxn:bd.methodTag.tab.getTabIconFilePath}]}};
bd.methodTag.tab.removeConnections=function(){for(var a=this.model.content,b=a.length,c=0;c<b;c++)bd.component.lookup(a[0]).deleteEntity();bd.model.addModelUpdateElement([this.model.levelEditorId],"removeValue","tabOrder",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=this.model.viewId&&bd.model.addModelUpdateElement([this.model.viewId],"removeValue","labelInstanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,
updateUIInEditor:!1})};bd.methodTag.tab.getEntityIds=function(){return this.model.entityIds};bd.methodTag.tab.shouldShowAddButton=function(){return this.model.canCreateEntities?null==this.model.maxEntityNum?!0:this.model.entityIds.length<this.model.maxEntityNum:!1};bd.methodTag.tab.shouldShowRemoveButton=function(){return this.model.entityIds.length>this.model.minEntityNum};
bd.methodTag.tab.getTabIconFilePath=function(){if(this.model.entityTypesToCreate&&0!=this.model.entityTypesToCreate.length){var a=bd.component.typeNameToComponent[this.model.entityTypesToCreate[0]];if(a&&a.componentProperties.tabIconFileName)return bd.model.getImagePath()+a.componentProperties.tabIconFileName}return null};
bd.methodTag.tab.changeTabName=function(a){bd.model.addModelUpdateElement([this.id],"set","name",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.tab.hideFromUser=function(a){"true"==a.toString()?a=!0:a=!1;a?bd.model.addModelUpdateElement([this.id],"set","visible",!1,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}):bd.model.addModelUpdateElement([this.id],"set","visible",!0,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.tab.changeMaxEntityCount=function(a){var b=!1;isNaN(parseInt(a))?(bd.model.addModelUpdateElement([this.id],"set","maxEntityNum",null,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),b=!0):bd.model.addModelUpdateElement([this.id],"set","maxEntityNum",parseInt(a),{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();return b};
bd.methodTag.tab.addCreatetype=function(a){bd.model.addModelUpdateElement([this.id],"push","create",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};bd.methodTag.tab.removeCreatetype=function(a){bd.model.addModelUpdateElement([this.id],"removeValue","create",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.tab.addTabComponentContent=function(a){bd.model.addModelUpdateElement([this.id],"push","content",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};
bd.methodTag.tab.addNewTabComponent=function(a){var b=new bd.component.tab.constructor;bd.model.addModelUpdateElement([b.id],"set","name","tab_"+b.id,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([b.id],"set","levelEditorId",a,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates();return b};
bd.methodTag.tab.changeContentOrdering=function(a){bd.model.addModelUpdateElement([this.id],"set","content",a,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()};bd.component.tab={constructor:function(a,b,c,e,f,g,h,k,l){this.model="undefined"==typeof a?null:a;this.name="undefined"==typeof b?"tab":b;this.tabKey="undefined"==typeof c?null:c;this.flexidorKey="undefined"==typeof flexidorKey?null:flexidorKey;this.tabListContainerId="undefined"==typeof e?null:e;this.entityTypesToCreate="undefined"==typeof f?[]:f;this.overlayOnEntityCreate="undefined"==typeof g?null:g;this.entityIds="undefined"==typeof h?[]:h;this.canCreateEntities="undefined"==typeof k?!0:k;this.minEntityNum=
"undefined"==typeof l?0:l;goog.mixin(this,bd.component.tab.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tab",listName:"tabs",idName:"tabId",idListName:"tabIds",entityPanelPageNum:0,selectedEntityIndex:0,namePrefix:"unused prefix...",tabName:"Tab",entityName:"Tab",modelTags:["entity","tab"],methodTags:["entity","tab"]}};bd.component.typeNameToComponent.tab=bd.component.tab;bd.methodTag.costume={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.costume.removeConnections,classOrInstance:"class"},{name:"updateAsset",fxn:bd.methodTag.costume.updateAsset}]}};bd.methodTag.costume.handleCommand=function(a){"assetId"==a.property&&this.updateAsset();return!1};
bd.methodTag.costume.removeConnections=function(){var a=bd.model.entityLookup(this.model.entityId),b=a.costumeIds[0];b==this.id&&(b=a.costumeIds[1]);if(null!=a.instanceIds)for(var c,e=0;e<a.instanceIds.length;e++)c=bd.model.entityLookup(a.instanceIds[e]),c.costumeId==this.id&&bd.model.addModelUpdateElement([c.id],"set","costumeId",b,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!0});bd.model.addModelUpdateElement([a.id],"removeValue","costumeIds",this.id,{updateUIForOrigin:!1,
updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!0})};
bd.methodTag.costume.updateAsset=function(){var a=bd.model.entityLookup(this.model.entityId);if(!bd.inPlayer){a.costumeIds[0]==this.id&&(bd.updateSelections(),bd.sideBar.ctr.updateSideBar(),null!=document.getElementById("componentThumbnail"+a.id)&&(document.getElementById("componentThumbnail"+a.id).src=bd.component.lookup(bd.model.entityLookup(a.costumeIds[0]).assetId).getThumbnailUrl()));if(null!=a.instanceIds)for(var b=0;b<a.instanceIds.length;b++)instanceComponentObject=bd.component.lookup(a.instanceIds[b]),
instanceComponentObject.model.costumeId==this.id&&instanceComponentObject.switchCostume();null!=bd.component.lookup(a.id).updateCostume&&bd.component.lookup(a.id).updateCostume()}};bd.component.costume={constructor:function(a,b,c){this.entityId="undefined"==typeof b?null:b;this.assetId="undefined"==typeof c?null:c;this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.costume.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"costume",listName:"costumes",idName:"costumeId",idListName:"costumeIds",namePrefix:"costume",modelTags:["entity","hasBlockEntityTracking",
"hasCostumeProperties"],methodTags:["entity","costume"]}};bd.component.typeNameToComponent.costume=bd.component.costume;bd.methodTag.gameView={provideMethods:function(){return[{name:"updateSideBar",fxn:bd.methodTag.gameView.updateSideBar},{name:"setGravity",fxn:bd.methodTag.gameView.setGravity,classOrInstance:"class"},{name:"removeEditorDisplayObjects",fxn:bd.methodTag.gameView.removeEditorDisplayObjects,classOrInstance:"class"},{name:"populateEditorDisplayObjects",fxn:bd.methodTag.gameView.populateEditorDisplayObjects,classOrInstance:"class"},{name:"populateDisplayObjects",fxn:bd.methodTag.gameView.populateDisplayObjects,
classOrInstance:"class"},{name:"setLayer",fxn:bd.methodTag.gameView.setLayer,classOrInstance:"class"},{name:"getLayer",fxn:bd.methodTag.gameView.getLayer,classOrInstance:"class"},{name:"setTargetHighlightSquare",fxn:bd.methodTag.gameView.setTargetHighlightSquare,classOrInstance:"class"},{name:"getTargetHighlightSquare",fxn:bd.methodTag.gameView.getTargetHighlightSquare,classOrInstance:"class"},{name:"setupPlayerFrame",fxn:bd.methodTag.gameView.setupPlayerFrame,classOrInstance:"class"},{name:"addEntityToView",
fxn:bd.methodTag.gameView.addEntityToView,classOrInstance:"class"}]}};bd.methodTag.gameView.handleCommand=function(a){return"gravityY"==a.property?(this.setGravity(),!0):this.isPropertyFromComponentOnView(a.property)&&"push"==a.updateType?(this.addEntityToView(a.value),!0):!1};
bd.methodTag.gameView.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);b=b.getElementsByClassName("gravityYInput")[0];b.value=a.gravityY;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"gravityY",isNumber:!0},
bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",0),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure)};bd.methodTag.gameView.addEntityToView=function(a){bd.component.lookup(a).addEntity()};bd.methodTag.gameView.setLayer=function(a,b){this.layerNameToObject[a]=b};bd.methodTag.gameView.getLayer=function(a){return!bd.inPlayer&&this.isKineticJSView?bd[a]:this.layerNameToObject[a]};
bd.methodTag.gameView.setTargetHighlightSquare=function(a){bd.inPlayer?this.highlightSquare=a:bd.highlight.ui.square=a};bd.methodTag.gameView.getTargetHighlightSquare=function(){return bd.inPlayer?this.highlightSquare:bd.highlight.ui.square};
bd.methodTag.gameView.setupPlayerFrame=function(){var a=this.getWindow().Kinetic;this.stage=new a.Stage({container:"playerPanel",width:this.model.width,height:this.model.height});this.stage.getContainer().addEventListener("mousedown",function(a){bd.player.ctr.focusOnPlayer();a.stopPropagation();a.preventDefault()});this.setLayer("bgLayer",new a.Layer);this.stage.add(this.getLayer("bgLayer"));this.setLayer("mainLayer",new a.Layer);this.setLayer("targetHighlightLayer",new a.Layer);this.setLayer("targetLayer",
new a.Layer);this.setLayer("pieceLayer",new a.Layer);this.stage.add(this.getLayer("targetHighlightLayer"));this.stage.add(this.getLayer("targetLayer"));this.stage.add(this.getLayer("pieceLayer"));this.stage.add(this.getLayer("mainLayer"));this.populateDisplayObjects();bd.component.physicsRectangle.onStartUp(this.id);bd.component.video.onStartUp(this.id);this.isInitialized=!0};
bd.methodTag.gameView.setGravity=function(){var a=bd.entityLookup[bd.entityLookup[bd.player.ctr.playerId].viewId],b=Box2D.Common.Math.b2Vec2;a.id==this.id&&bd.component.physicsRectangleInstance.world.SetGravity(new b(a.gravityX,a.gravityY))};bd.methodTag.gameView.setHeightWidth=function(){};
bd.methodTag.gameView.removeEditorDisplayObjects=function(){for(var a=0;a<this.componentsOnView.length;a++)for(var b=this.model[bd.component.typeNameToComponent[this.componentsOnView[a]].componentProperties.idListName],c=0;c<b.length;c++){var e=bd.component.lookup(b[c]).getDisplayObject();if(null!=e){var f=e.getLayer();e.remove();f.batchDraw();bd.component.lookup(b[c]).setDisplayObject(null)}}};
bd.methodTag.gameView.populateDisplayObjects=function(){for(var a={},b=0;b<this.componentsOnView.length;b++){var c=bd.component.typeNameToComponent[this.componentsOnView[b]].componentProperties.idListName,e=this.model[c];null==e&&(this.model[c]=[],e=this.model[c]);for(c=0;c<e.length;c++){var f=bd.model.entityLookup(e[c]);if((!f.entityPerPlayer||f.entityPerPlayer&&f.playerId==bd.player.ctr.playerId)&&("pieceInstance"!=f.type||null==f.targetId||bd.model.entityLookup(f.targetId).playerId==bd.player.ctr.playerId)){var g=
bd.component.lookup(e[c]);"textInputInstance"==f.type?g.addToPlayerView(this.id):"videoInstance"==f.type?g.createVideoContainer():(bd.pieces.ctr.setupPiece("board",e[c],g.editorDisplayObjectType),null==a[g.model.viewId]&&(a[g.model.viewId]={}),a[g.model.viewId][g.layerName]=!0)}}}for(var h in a)for(var k in a[h])bd.component.lookup(h).getLayer(k).batchDraw()};bd.component.gameView={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.gameView.componentProperties);this.model=null!=a?a:{};var b=null==a;null==a&&(this.defaultImageId=bd.defaultGameViewAsset.id,bd.component.addComponentListToComponent(this,bd.component.gameView.componentProperties.componentsOnView,"idListName"));bd.modelTag.applyTags(this,b);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"gameView",listName:"gameViews",
idName:"gameViewId",idListName:"gameViewIds",sideBarPanelName:"sideBarGameViewPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},editorDisplayObjectType:"image",layerNameToObject:{},isInitialized:!1,tabNewEntityTypes:["gameView","melonView","phaserView"],tabEntityIdGenerator:function(){for(var a=[],b=0;b<bd.component.viewTypes.length;b++)for(var c=bd.component.typeNameToComponent[bd.component.viewTypes[b]].componentProperties.listName,e=0;e<bd.model.getCurrentGame()[c].length;e++){var f=
bd.model.getCurrentGame()[c][e];a.push(f.id)}return a},minimumEntitiesInList:1,isKineticJSView:!0,playerFrameFile:"kineticPlayerView.html",isView:!0,componentsOnView:"pieceInstance physicsRectangleInstance labelInstance videoInstance target textInputInstance".split(" "),namePrefix:"view",typeName:"View",tabName:"Views",entityName:"Game View",entityNamePlural:"Game Views",thisName:"this game view",allName:"all game views",anyName:"any game view",randomName:"random game view",modelTags:"entity hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasScripts hasGravity hasViewHeightWidth".split(" "),
methodTags:["entity","view","gameView"]}};bd.component.typeNameToComponent.gameView=bd.component.gameView;bd.component.tutorial={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.tutorial.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tutorial",listName:"tutorial",idName:"tutorial",idListName:"tutorial",namePrefix:"unused prefix...",tabName:"Tutorial",entityName:"Tutorial",modelTags:["entity","hasTutorialProperties"],methodTags:["entity"]}};
bd.component.typeNameToComponent.tutorial=bd.component.tutorial;bd.component.levelEditorBlockRestriction={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorBlockRestriction.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorBlockRestriction",listName:"levelEditorBlockRestrictions",idName:"levelEditorBlockRestrictionId",idListName:"levelEditorBlockRestrictionIds",namePrefix:"unused prefix...",
tabName:"Level Editor Block Restriction",entityName:"Level Editor Block Restriction",modelTags:["entity","blockRestriction"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorBlockRestriction=bd.component.levelEditorBlockRestriction;bd.modelTag.hasGameProperties={requiredFields:["nextId","started"],provideFields:function(){return[{fields:["nextId"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["started"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["multiplayer"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["versionRelease"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["versionMajor"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:0},{fields:["versionMinor"],classOrInstance:"class",providers:["defaultValue"],defaultValue:28}]}};bd.component.game={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.game.componentProperties);this.model=null!=a?a:{};var b=null==a;null==a&&bd.component.addComponentListToComponent(this,null,"listName");bd.modelTag.applyTags(this,b);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"game",listName:"games",idName:"gameId",idListName:"gameIds",modelTags:["hasGameProperties"],methodTags:[]}};bd.methodTag.assetSound={provideMethods:function(){return[{name:"getThumbnailUrl",fxn:bd.methodTag.assetSound.getThumbnailUrl},{name:"getThumbnailFileNameNoExtension",fxn:bd.methodTag.assetSound.getThumbnailFileNameNoExtension},{name:"getSoundUrl",fxn:bd.methodTag.assetSound.getSoundUrl},{name:"setSoundObject",fxn:bd.methodTag.assetSound.setSoundObject},{name:"getSoundObject",fxn:bd.methodTag.assetSound.getSoundObject}]}};bd.methodTag.assetSound.getThumbnailUrl=function(){return bd.component.getComponentByType(this.type).getThumbnailUrlFromParams()};
bd.methodTag.assetSound.getThumbnailFileNameNoExtension=function(){return bd.model.staticUrl+this.thumbnailImageNoExtension};bd.methodTag.assetSound.getSoundUrl=function(){return this.model.isDefaultAsset?bd.inPlayer&&bd.player.ctr.isCordova?this.onServerPrefix+this.model.thumbnailFileName:bd.model.staticUrl+this.onServerPrefix+this.model.thumbnailFileName:bd.model.getUploadUrl()+bd.component.assetSound.componentProperties.uploadFilePrefix+this.model.thumbnailFileName};
bd.methodTag.assetSound.setSoundObject=function(a){this.phaserSoundObject=a};bd.methodTag.assetSound.getSoundObject=function(){return this.phaserSoundObject};bd.component.assetSound={constructor:function(a,b,c,e,f,g,h){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.assetSound.componentProperties);this.thumbnailFileName=b;this.isThumbnailFileInternal=c;this.isDefaultAsset="undefined"==typeof e?!1:e;this.assetLabel=h;this.backendAssetId="undefined"==typeof g?null:g;this.initialCostumeId="undefined"==typeof f?null:f;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",
type:"assetSound",listName:"assetSounds",idName:"assetSoundId",idListName:"assetSoundIds",namePrefix:"dummy pic",isAsset:!0,buttonRowElementId:"filepickerButtonsSound",assetUploadDivId:"filepickerSoundUpload",uploadFilePrefix:"sounds/uploads/",onServerPrefix:"sounds/assetSounds/",thumbnailImage:"images/sound.png",thumbnailImageNoExtension:"images/sound",identifierProperty:"thumbnailFileName",assetPickerBoxId:"soundPickerAssetBox",defaultAssetIconType:"PLAY",assetCategoriesOrder:["stock","user","game"],
assetCategoryInfo:{user:{buttonText:"My Sounds",buttonId:"assetPickerUserSoundButton",hasEditOrDeleteToggle:!0,hasPlayButton:!0},game:{buttonText:"Game Sounds",buttonId:"assetPickerGameSoundButton",hasEditOrDeleteToggle:!1},inherited:{buttonText:"Inherited Sounds"},stock:{buttonText:"Stock Sounds",buttonId:"assetPickerStockSoundButton",hasEditOrDeleteToggle:!1}},modelTags:["entity","hasAssetProperties","hasImageAssetProperties"],methodTags:["entity","asset","assetSound"]}};
bd.component.typeNameToComponent.assetSound=bd.component.assetSound;bd.component.assetSound.createAssetFromDbInfoObject=function(a){var b=a.is_thumbnail_file_internal,c=!1;"onHost"==a.is_thumbnail_file_internal&&(c=!0,b=1);return new bd.component.assetSound.constructor(null,a.thumbnail_file_name,b,c,null,a.backend_id,a.label)};bd.component.assetSound.getThumbnailUrlFromDbInfo=function(a){return bd.component.assetSound.getThumbnailUrlFromParams()};
bd.component.assetSound.getThumbnailUrlFromParams=function(){return bd.model.staticUrl+bd.component.assetSound.componentProperties.thumbnailImage};bd.component.assetSound.getSoundUrlFromDbInfo=function(a){var b=a.is_thumbnail_file_internal,c=!1;"onHost"==a.is_thumbnail_file_internal&&(c=!0,b=1);return bd.component.assetSound.getSoundUrlFromParams(a.thumbnail_file_name,b,c)};
bd.component.assetSound.getSoundUrlFromParams=function(a,b,c){b=bd.component.assetSound.componentProperties;return c?bd.inPlayer&&(bd.player.ctr.isCordova||bd.player.ctr.isStandalone)?b.onServerPrefix+a:bd.model.staticUrl+b.onServerPrefix+a:bd.model.getUploadUrl()+b.uploadFilePrefix+a};bd.component.assetSound.isUniqueAsset=function(a){};bd.modelTag.hasGridProperties={provideFields:function(){return[{fields:["numRows"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["numRows"],classOrInstance:"class",providers:["defaultValue"],defaultValue:3},{fields:["numColumns"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["numColumns"],classOrInstance:"class",providers:["defaultValue"],defaultValue:3},{fields:["tileHeight"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["tileHeight"],
classOrInstance:"class",providers:["defaultValue"],defaultValue:30},{fields:["tileWidth"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["tileWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:30},{fields:["verticalMargin"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["verticalMargin"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["horizontalMargin"],classOrInstance:"instance",providers:["srcInstance",
"parent"]},{fields:["horizontalMargin"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["borderThickness"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["borderThickness"],classOrInstance:"class",providers:["defaultValue"],defaultValue:2},{fields:["tilePattern"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["tilePattern"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"solid"},{fields:["offsetX"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:0},{fields:["offsetY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["height","width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:98},{fields:["tileProperties"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["gridTiles"],classOrInstance:"instance",providers:["defaultValue"],defaultValue:[]}]}};bd.component.grid={constructor:function(a,b){goog.mixin(this,bd.component.grid.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.defaultPieceAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"grid",listName:"grids",idName:"gridId",idListName:"gridIds",editorDisplayObjectType:"image",sideBarPanelName:"sideBarGridPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},
tabIconFileName:"class-icon-grids.png",possibleLayerTypes:["tmxEntityLayer"],namePrefix:"Grid Class",typeName:"Grid",tabName:"Grids",entityName:"Grid Class",entityNamePlural:"Grid Classes",thisName:"this grid class",allName:"all grid classes",anyName:"any grid class",randomName:"random grid class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasCoordinateOffset hasViewId hasLayerId hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasTargetId hasGridProperties".split(" "),
methodTags:["entity","canvasObject","phaserObject","grid"]},beforeCreateEntity:function(){var a=bd.component.grid.componentProperties.type;bd.model.isMultiplayer()?bd.overlay.ctr.showOverlay("shareMode",a):bd.entitySelect.ctr.createEntity(a)}};
bd.component.gridInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.gridInstance.componentProperties);this.cellDictionary={};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"gridInstance",listName:"gridInstances",idName:"gridInstanceId",idListName:"gridInstanceIds",editorDisplayObjectType:"image",namePrefix:"grid",entityName:"Grid",thisName:"this grid",
allName:"all grids",anyName:"any grid",randomName:"random grid",modelTags:bd.component.grid.componentProperties.modelTags,methodTags:bd.component.grid.componentProperties.methodTags}};bd.component.typeNameToComponent.grid=bd.component.grid;bd.component.typeNameToComponent.gridInstance=bd.component.gridInstance;bd.component.childNameToParentName.gridInstance="grid";bd.component.player={constructor:function(a,b,c,e){this.srcInstance="undefined"==typeof c?null:c;this.username="undefined"==typeof e?null:e;this.model="undefined"==typeof a?null:a;this.tabId="undefined"==typeof b?null:b;goog.mixin(this,bd.component.player.componentProperties);null==a&&(this.defaultImageId=bd.defaultPlayerAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"player",listName:"players",
idName:"playerId",idListName:"playerIds",sideBarPanelName:"sideBarPlayerPanel",defaultImageUrlObject:{url:"images/stickFigure.png",internal:!0},tabIconFileName:"class-icon-players.png",editorDisplayObjectType:"image",tabNewEntityTypes:["player"],tabEntityIdGenerator:function(){for(var a=bd.model.currentGame.players.concat(bd.model.currentGame.roles),b=[],c=0;c<a.length;c++)b.push(a[c].id);return b},minimumEntitiesInList:1,namePrefix:"player ",typeName:"Player",tabName:"Players",entityName:"Player",
entityNamePlural:"Players",thisName:"this player",allName:"all players",anyName:"any player",randomName:"random player",modelTags:"entity hasSrcInstanceId hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasTabContainer hasScripts hasPlayerProperties".split(" "),methodTags:["entity","player"]}};
bd.component.role={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.role.componentProperties);null==a&&(this.defaultImageId=bd.defaultPlayerAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"role",listName:"roles",idName:"roleId",idListName:"roleIds",sideBarPanelName:"sideBarRolePanel",defaultImageUrlObject:{url:"images/stickFigure.png",internal:!0},
editorDisplayObjectType:"image",namePrefix:"role ",typeName:"Role",tabName:"Roles",entityName:"Role",entityNamePlural:"Roles",thisName:"this role",allName:"all roles",anyName:"any role",randomName:"random role",modelTags:"entity hasSrcInstanceId hasBlockEntityTracking hasCostumeNoInstance hasTraits hasScripts hasPlayerProperties".split(" "),methodTags:["entity","role"]}};bd.component.typeNameToComponent.player=bd.component.player;bd.component.typeNameToComponent.role=bd.component.role;bd.component.melonView.canvasView={};
bd.component.melonView.setupCanvasView=function(a){a=bd.component.lookup(a);var b=a.getWindow().Konva,c=bd.component.lookup(bd.component.lookup(a.id).model.tmxMapId).model.layerIds;bd.bgLayer.setZIndex(0);bd.mainLayer.setZIndex(1);for(var e=0;e<c.length;e++){var f=a.getLayer("tmxLayer"+c[e]);null==f&&(a.setLayer("tmxLayer"+c[e],new b.Layer),f=a.getLayer("tmxLayer"+c[e]),a.konvaStage.add(f),bd.component.lookup(c[e]).setupLayerOnCanvas());f.visible(bd.component.lookup(c[e]).model.visible);f.parent&&
f.setZIndex(e+2)}};bd.component.melonView.removeCanvasView=function(){this.getWindow();for(var a=bd.component.lookup(bd.component.lookup(this.id).model.tmxMapId).model.layerIds,b=0;b<a.length;b++)this.getLayer("tmxLayer"+a[b]).remove(),this.setLayer("tmxLayer"+a[b],null),bd.component.lookup(a[b]).removeLayerFromCanvas()};
bd.component.melonView.canvasView.placeTileOnLayerFromClick=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()).getSelectedLayerId(),b=bd.component.melonView.getRowColumnNumFromPointer();null!=b&&bd.component.melonView.canvasView.placeTileOnLayer(a,b.column,b.row,bd.component.melonView.tmxTileLayer.selectedTileSetId,bd.component.melonView.tmxTileLayer.selectedTileColumn,bd.component.melonView.tmxTileLayer.selectedTileRow)};
bd.component.melonView.canvasView.placeTileOnLayer=function(a,b,c,e,f,g){var h=bd.component.lookup(bd.model.getCurrentViewId()),k=bd.component.lookup(a);if("tmxTileLayer"==k.type){a=bd.component.lookup(e);var l=a.model.tileHeight,m=a.model.tileWidth;a=bd.imageLoader.ctr.getImageObject(a.model.assetId);var n=h.getWindow().Kinetic,q=bd.component.lookup(h.model.tmxMapId).model.gridWidth,p=b+c*q;k.model.gridTileIndexToTileSetTile[p]={tileSetId:e,tileSetColumn:f,tileSetRow:g};var t={tileAnimation:[f*m,
g*l,m,l]};if(k.gridTileIndexToKineticSpriteObject[p]){var v=k.gridTileIndexToKineticSpriteObject[p];v.image().src==a.src?(v.animations(t),h.getLayer("tmxLayer"+k.id).batchDraw()):(r=new Image,r.crossOrigin="anonymous",r.onload=function(){v.image(r);v.animations(t);h.getLayer("tmxLayer"+k.id).batchDraw()},r.src=a.src)}else{var r=new Image;r.crossOrigin="anonymous";r.onload=function(){var a=new n.Sprite({animation:"tileAnimation",animations:t,x:b*m+h.getCanvasViewLeft()+h.xTileOffset,y:c*l+h.getCanvasViewTop()+
h.yTileOffset,image:r});h.getLayer("tmxLayer"+k.id).add(a);h.getLayer("tmxLayer"+k.id).batchDraw();k.gridTileIndexToKineticSpriteObject[p]=a};r.src=a.src}}};bd.component.tabContent={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.tabContent.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tabContent",listName:"tabContents",idName:"tabContentId",idListName:"tabContentIds",namePrefix:"unused prefix...",tabName:"Tab Content",entityName:"Tab Content",modelTags:["entity","tabContent"],methodTags:["entity",
"tabContent"]}};bd.component.typeNameToComponent.tabContent=bd.component.tabContent;bd.component.assetSpriteSheet={constructor:function(a,b,c,e,f,g,h,k,l,m){this.model="undefined"==typeof a?null:a;this.urlObject="undefined"==typeof urlObject?null:urlObject;goog.mixin(this,bd.component.assetSpriteSheet.componentProperties);this.thumbnailFileName=b;this.isThumbnailFileInternal=c;this.isDefaultAsset="undefined"==typeof e?!1:e;this.assetLabel=b;this.backendAssetId="undefined"==typeof g?null:g;this.initialCostumeId="undefined"==typeof f?null:f;this.tileHeight=h;this.tileWidth=k;this.previewTileRow=
l;this.previewTileColumn=m;this.costumeIds=[];this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"assetSpriteSheet",listName:"assetSpriteSheets",idName:"assetSpriteSheetId",idListName:"assetSpriteSheetIds",namePrefix:"dummy pic",isAsset:!0,buttonRowElementId:"filepickerButtonsSpritesheet",assetUploadDivId:"filepickerSpritesheetUpload",uploadFilePrefix:"images/uploads/",assetCategoriesOrder:["user","game",
"inherited","stock"],assetCategoryInfo:{user:{buttonText:"My Sprite Sheets"},game:{buttonText:"Game Sprite Sheets"},inherited:{buttonText:"Inherited Sprite Sheets"},stock:{buttonText:"Stock Sprite Sheets"}},modelTags:["entity","hasAssetProperties","hasSpriteSheetAssetProperties"],methodTags:["entity","asset"]}};bd.component.typeNameToComponent.assetSpriteSheet=bd.component.assetSpriteSheet;
bd.component.assetSpriteSheet.createAssetFromDbInfoObject=function(a,b){return new bd.component.assetSpriteSheet.constructor(null,a.thumbnail_file_name,a.is_thumbnail_file_internal,!1,b,a.backend_id,a.tile_height,a.tile_width,a.preview_tile_row,a.preview_tile_column)};bd.modelTag.hasPhaserPhysicsProperties={provideFields:function(){return[{fields:["gravityX"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["gravityX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["gravityY"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["gravityY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:9.8},{fields:["movable"],classOrInstance:"instance",providers:["srcInstance","parent"]},
{fields:["movable"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["allowGravity"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["allowGravity"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["bounceX"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["bounceX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["bounceY"],classOrInstance:"instance",providers:["srcInstance",
"parent"]},{fields:["bounceY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["collideWorldBounds"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["collideWorldBounds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["passthrough"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["passthrough"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!1},{fields:["frictionX"],classOrInstance:"instance",
providers:["srcInstance","parent"]},{fields:["frictionX"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["frictionY"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["frictionY"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["collisionObject"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasPhaserPhysicsProperties.provideCollisionObject},{fields:["friction"],classOrInstance:"instance",providers:["srcInstance",
"parent"]},{fields:["friction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["bounciness"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["bounciness"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["fixedRotation"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["fixedRotation"],classOrInstance:"class",providers:["defaultValue"],defaultValue:!0},{fields:["direction"],classOrInstance:"instance",
providers:["srcInstance","parent"]},{fields:["direction"],classOrInstance:"class",providers:["defaultValue"],defaultValue:0},{fields:["wallCollisionIds"],classOrInstance:"instance",providers:["function"],fxn:bd.modelTag.hasPhaserPhysicsProperties.provideWallCollisionIds},{fields:["wallCollisionIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[]},{fields:["stopAfterDrag"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["stopAfterDrag"],classOrInstance:"class",
providers:["defaultValue"],defaultValue:!0}]},provideProperties:function(){return{X:{modelName:"x",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject},getFxn:function(){return this.getLocalXY("x")},setFxn:function(a){this.localSetXY("x",a)}},Y:{modelName:"y",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject},getFxn:function(){return this.getLocalXY("y")},setFxn:function(a){this.localSetXY("y",a)}},ALLOW_GRAVITY:{modelName:"allowGravity",getType:function(){return bd.type.ctr.getBooleanTypeObject}},
GRAVITY_X:{modelName:"gravityX",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},GRAVITY_Y:{modelName:"gravityY",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},DAMPING_X:{modelName:"frictionX",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},DAMPING_Y:{modelName:"frictionY",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},RESTITUTION:{modelName:"restitution",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},
FRICTION:{modelName:"friction",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject}},FIXED_ROTATION:{modelName:"fixedRotation",getType:function(){return bd.type.ctr.getBooleanTypeObject}},PASSTHROUGH:{modelName:"passthrough",getType:function(){return bd.type.ctr.getBooleanTypeObject}},COLLIDE_WORLD_BOUNDS:{modelName:"collideWorldBounds",getType:function(){return bd.type.ctr.getBooleanTypeObject}},MOVABLE:{modelName:"movable",getType:function(){return bd.type.ctr.getBooleanTypeObject}},
DIRECTION:{modelName:"direction",isNumber:!0,getType:function(){return bd.type.ctr.getNumberTypeObject},getFxn:function(){return this.getLocalDirection()},setFxn:function(a){this.localDirection(a,"set")}},STOP_AFTER_DRAG:{modelName:"stopAfterDrag",getType:function(){return bd.type.ctr.getBooleanTypeObject}}}}};bd.modelTag.hasPhaserPhysicsProperties.provideCollisionObject=function(){this.model.collisionObject={}};
bd.modelTag.hasPhaserPhysicsProperties.provideWallCollisionIds=function(){this.model.wallCollisionIds=[]};bd.component.phaserPhysicsPiece={constructor:function(a,b){goog.mixin(this,bd.component.phaserPhysicsPiece.componentProperties);this.tabId="undefined"==typeof b?null:b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"phaserPhysicsPiece",listName:"phaserPhysicsPieces",idName:"phaserPhysicsPieceId",idListName:"phaserPhysicsPieceIds",
editorDisplayObjectType:"image",sideBarPanelName:"sideBarPhaserPhysicsPiecePanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-sprite.png",possibleLayerTypes:["tmxEntityLayer"],namePrefix:"Sprite Class",typeName:"Sprite",tabName:"Sprites",entityName:"Sprite Class",entityNamePlural:"Sprite Classes",thisName:"this sprite class",allName:"all sprite classes",anyName:"any sprite class",randomName:"random sprite class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasFlipModes hasHeightWidth hasVisibility hasDragability hasCoordinateOffset hasViewId hasLayerId hasCostume perPlayer shareMode hasTraits hasTabContainer hasScripts hasTargetId hasTint hasDrawingProperties hasPenProperties hasPhaserPhysicsProperties".split(" "),
methodTags:["entity","canvasObject","phaserObject","phaserPhysicsPiece"]},getProperties:function(){return[{name:"VISIBLE"},{name:"HEIGHT"},{name:"WIDTH"},{name:"X"},{name:"Y"},{name:"NAME"},{name:"DRAGGABLE"},{name:"ALLOW_HORIZONTAL_DRAG"},{name:"ALLOW_VERTICAL_DRAG"},{name:"COSTUME_NUM"},{name:"TINT"},{name:"DRAWING_ENABLED"},{name:"DRAWING_COLOR"},{name:"DRAWING_THICKNESS"},{name:"PEN_ENABLED"},{name:"PEN_COLOR"},{name:"PEN_THICKNESS"},{name:"RESTITUTION"},{name:"ALLOW_GRAVITY"},{name:"GRAVITY_X"},
{name:"GRAVITY_Y"},{name:"DAMPING_X"},{name:"DAMPING_Y"},{name:"FRICTION"},{name:"FIXED_ROTATION"},{name:"PASSTHROUGH"},{name:"COLLIDE_WORLD_BOUNDS"},{name:"MOVABLE"},{name:"DIRECTION"},{name:"STOP_AFTER_DRAG"}]},getDefaultAssetId:function(){var a=bd.image.ctr.entityTypeToAssetDbCategoriesAndList.assetImage.stock.character,b=Math.floor(Math.random()*a.length),b=a[b].thumbnail_file_name,a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,b);null==a&&(b=new bd.component.assetImage.constructor(null,
b,!0,!0),a=b.id,bd.imageLoader.ctr.loadAsset(b.id));return a}};
bd.component.phaserPhysicsPieceInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.phaserPhysicsPieceInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"phaserPhysicsPieceInstance",listName:"phaserPhysicsPieceInstances",idName:"phaserPhysicsPieceInstanceId",idListName:"phaserPhysicsPieceInstanceIds",editorDisplayObjectType:"image",
instancePanelName:"phaserPhysicsPieceInstancePanel",namePrefix:"sprite",entityName:"Sprite",thisName:"this sprite",allName:"all sprites",anyName:"any sprite",randomName:"random sprite class",modelTags:bd.component.phaserPhysicsPiece.componentProperties.modelTags,methodTags:bd.component.phaserPhysicsPiece.componentProperties.methodTags}};bd.component.typeNameToComponent.phaserPhysicsPiece=bd.component.phaserPhysicsPiece;bd.component.typeNameToComponent.phaserPhysicsPieceInstance=bd.component.phaserPhysicsPieceInstance;
bd.component.childNameToParentName.phaserPhysicsPieceInstance="phaserPhysicsPiece";bd.component.textInput={constructor:function(a,b){goog.mixin(this,bd.component.textInput.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.defaultTextInputAsset.id);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"textInput",listName:"textInputs",idName:"textInputId",idListName:"textInputIds",sideBarPanelName:"sideBarTextInputPanel",defaultImageUrlObject:{url:"images/textInput.png",internal:!0},
tabIconFileName:"class-icon-input.png",editorDisplayObjectType:"image",possibleLayerTypes:["uiLayer"],namePrefix:"Text Input Class",typeName:"Text Input",tabName:"Text Inputs",entityName:"Text Input Class",entityNamePlural:"Text Input Classes",thisName:"this text input class",allName:"all text input classes",anyName:"any text input class",randomName:"random text input class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasHeightWidth hasVisibility hasViewId hasLayerId hasCostume hasCoordinateOffset shareMode hasTraits hasTabContainer hasScripts hasTextInputProperties".split(" "),
methodTags:["entity","canvasObject","htmlObject","textInput"]}};
bd.component.textInputInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.textInputInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"textInputInstance",listName:"textInputInstances",idName:"textInputInstanceId",idListName:"textInputInstanceIds",editorDisplayObjectType:"image",instancePanelName:"textInputInstancePanel",
shouldUpdatePositionToScale:!0,namePrefix:"text input",entityName:"Text Input",thisName:"this text input",allName:"all text inputs",anyName:"any text input",randomName:"random text input",modelTags:bd.component.textInput.componentProperties.modelTags,methodTags:bd.component.textInput.componentProperties.methodTags}};bd.component.typeNameToComponent.textInput=bd.component.textInput;bd.component.typeNameToComponent.textInputInstance=bd.component.textInputInstance;
bd.component.childNameToParentName.textInputInstance="textInput";bd.modelTag.hasSpreadsheetProperties={requiredFields:["spreadsheetKey"],provideFields:function(){return[{fields:["spreadsheetKey"],classOrInstance:"class",providers:["defaultValue"],defaultValue:""}]}};bd.component.spreadsheet={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.spreadsheet.componentProperties);this.model=null!=a?a:{};null==a&&(this.defaultImageId=bd.defaultSpreadsheetAsset.id);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"spreadsheetType",listName:"spreadsheetTypes",idName:"spreadsheetTypeId",idListName:"spreadsheetTypeIds",sideBarPanelName:"sideBarSpreadsheetPanel",
defaultImageUrlObject:{url:"images/spreadsheet.png",internal:!0},editorDisplayObjectType:"image",namePrefix:"spreadsheet",typeName:"Spreadsheet",tabName:"Spreadsheets",entityName:"Spreadsheet",entityNamePlural:"Spreadsheets",thisName:"this spreadsheet",allName:"all spreadsheets",anyName:"any spreadsheet",randomName:"random spreadsheet",modelTags:"entity hasBlockEntityTracking perPlayerNoInstance hasCostumeNoInstance hasTraitsNoInstance hasScripts hasSpreadsheetProperties".split(" "),methodTags:["entity",
"spreadsheet"]}};bd.component.typeNameToComponent.spreadsheetType=bd.component.spreadsheet;bd.component.levelEditor={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditor.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditor",listName:"levelEditors",idName:"levelEditorId",idListName:"levelEditorIds",namePrefix:"unused prefix...",tabName:"Level Editor",entityName:"Level Editor",modelTags:["entity","hasLevelEditorProperties"],
methodTags:["entity","levelEditor"]},getLevelEditorObject:function(){var a=bd.model.getCurrentGame().levelEditors[0];return bd.component.lookup(a.id)},whenGameCreated:function(){var a=new bd.component.levelEditor.constructor,b=new bd.component.levelEditorTraitRestriction.constructor;bd.model.addModelUpdateElement([b.id],"dictionary","global",{key:"add",value:!0},{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.id],"push",
"componentTypeToTraitRestriction",b.id,{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.addModelUpdateElement([a.id],"dictionary","codeBlockCategoryless",{key:"categoryless",value:!1},{updateUIForOrigin:!1,updateModelForOrigin:!1,updateModelInEditor:!0,updateUIInEditor:!1});bd.model.sendUpdates()}};bd.component.typeNameToComponent.levelEditor=bd.component.levelEditor;bd.component.video={constructor:function(a,b){goog.mixin(this,bd.component.video.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"video",listName:"videos",idName:"videoId",idListName:"videoIds",sideBarPanelName:"sideBarVideoPanel",defaultImageUrlObject:{url:"https://i.ytimg.com/vi/cy7TD7QXEWw/default.jpg",
internal:!1},tabIconFileName:"class-icon-video.png",editorDisplayObjectType:"image",possibleLayerTypes:["uiLayer"],apiLoaded:!1,namePrefix:"Video Class",typeName:"Video",tabName:"Videos",entityName:"Video Class",entityNamePlural:"Video Classes",thisName:"this video class",allName:"all video classes",anyName:"any video class",randomName:"random video class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasHeightWidth hasVisibility hasViewId hasLayerId hasCostume hasCoordinateOffset shareMode hasTraits hasTabContainer hasScripts hasVideoProperties".split(" "),
methodTags:["entity","canvasObject","video"]},getDefaultCanvasAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"video.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"video.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetVideo.componentProperties.type,"https://i.ytimg.com/vi/HY_oQC2UEQA/default.jpg");if(null==a){var b=new bd.component.assetVideo.constructor(null,
"HY_oQC2UEQA","https://i.ytimg.com/vi/HY_oQC2UEQA/default.jpg",!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.videoInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.videoInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"videoInstance",listName:"videoInstances",idName:"videoInstanceId",idListName:"videoInstanceIds",editorDisplayObjectType:"image",instancePanelName:"videoInstancePanel",namePrefix:"video",entityName:"Video",
thisName:"this video",allName:"all videos",anyName:"any video",randomName:"random video",modelTags:bd.component.video.componentProperties.modelTags,methodTags:bd.component.video.componentProperties.methodTags}};bd.component.typeNameToComponent.video=bd.component.video;bd.component.typeNameToComponent.videoInstance=bd.component.videoInstance;bd.component.childNameToParentName.videoInstance="video";bd.component.video.instanceIdsWaitingForApi=[];
bd.component.video.onYouTubePlayerAPIReady=function(){bd.component.video.componentProperties.apiLoaded=!0;for(var a=0;a<bd.component.video.instanceIdsWaitingForApi.length;a++)bd.component.lookup(bd.component.video.instanceIdsWaitingForApi[a]).createPlayer();bd.component.video.instanceIdsWaitingForApi=[]};bd.methodTag.label={provideMethods:function(){return[{name:"removeConnections",fxn:bd.methodTag.label.removeConnections,classOrInstance:"instance"},{name:"setText",fxn:bd.methodTag.label.setText,classOrInstance:"instance"},{name:"updateFontSize",fxn:bd.methodTag.label.updateFontSize,classOrInstance:"instance"},{name:"updateBorderSize",fxn:bd.methodTag.label.updateBorderSize,classOrInstance:"instance"},{name:"setTextColor",fxn:bd.methodTag.label.setTextColor,classOrInstance:"instance"},{name:"createSelectionBorder",
fxn:bd.methodTag.label.createSelectionBorder,classOrInstance:"instance"},{name:"createKineticEditorObject",fxn:bd.methodTag.label.createKineticEditorObject,classOrInstance:"instance"},{name:"createKineticEditorObjectOnLayer",fxn:bd.methodTag.label.createKineticEditorObjectOnLayer,classOrInstance:"instance"},{name:"createDisplayObject",fxn:bd.methodTag.label.createDisplayObject,classOrInstance:"instance"},{name:"setWidthHeight",fxn:bd.methodTag.label.setWidthHeight,classOrInstance:"instance"},{name:"removeDisplayObject",
fxn:bd.methodTag.label.removeDisplayObject,classOrInstance:"instance"},{name:"setPhaserStyle",fxn:bd.methodTag.label.setPhaserStyle,classOrInstance:"instance"},{name:"updateInstancePanel",fxn:bd.methodTag.label.updateInstancePanel,classOrInstance:"instance"},{name:"updateSideBar",fxn:bd.methodTag.label.updateSideBar,classOrInstance:"class"}]}};
bd.methodTag.label.handleCommand=function(a){if("text"==a.property)return bd.model.isInstance(this.id)?this.setText(a.value):bd.updateSelections(),!0;"fontSize"==a.property&&bd.model.isInstance(this.id)&&this.updateFontSize();if(bd.model.isInstance(this.id))return"color"==a.property?(this.setTextColor(a.value),!0):!1};
bd.methodTag.label.updateInstancePanel=function(){var a=this.model,b=document.getElementById(this.instancePanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("textInput")[0];c.value=a.text;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"text"},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("xInput")[0];
c.value=a.x;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"x",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);b=b.getElementsByClassName("yInput")[0];b.value=a.y;bd.sideBar.ctr.resetTextInputStyle(b);bd.util.setTextInputChangeEventHandlers(b,{entityId:a.id,propertyName:"y",isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.isANumber),
bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure)};
bd.methodTag.label.updateSideBar=function(){var a=this.model,b=document.getElementById(this.sideBarPanelName),c=b.getElementsByClassName("nameInput")[0];c.value=a.name;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"name",updateInstances:!1},null,bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("labelTextInput")[0];c.value=a.text;bd.sideBar.ctr.resetTextInputStyle(c);bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"text",updateInstances:!0},
null,bd.sideBar.ctr.textUpdateSuccess,bd.sideBar.ctr.textUpdateFailure);c=b.getElementsByClassName("fontSizeInput")[0];c.value=a.fontSize;bd.util.setTextInputChangeEventHandlers(c,{entityId:a.id,propertyName:"fontSize",updateInstances:!0,isNumber:!0},bd.util.getTextInputValidatorFunction(bd.validator.ctr.matchesNumberComparison,">=",2),bd.sideBar.ctr.textUpdateSuccess,null);c=b.getElementsByClassName("isDraggableCheckbox")[0];c.checked=a.draggable?!0:!1;bd.util.setupCheckboxChangeEventHandlers(c,
{entityId:a.id,propertyName:"draggable",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null);b=b.getElementsByClassName("isVisibleCheckbox")[0];b.checked=a.visible?!0:!1;bd.util.setupCheckboxChangeEventHandlers(b,{entityId:a.id,propertyName:"visible",updateInstances:!0},null,bd.sideBar.ctr.checkboxUpdateSuccess,null)};
bd.methodTag.label.removeConnections=function(){var a=bd.model.entityLookup(this.id);bd.model.addModelUpdateElement([a.parentId],"removeValue","instanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.viewId&&bd.model.addModelUpdateElement([a.viewId],"removeValue","labelInstanceIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});null!=a.layerId&&bd.model.addModelUpdateElement([a.layerId],
"removeValue","entityIds",this.id,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1})};
bd.methodTag.label.createSelectionBorder=function(){var a=this.getDisplayObject();if(null!=bd.editor.ctr.getSelectedInstanceId()){var b=bd.component.lookup(bd.editor.ctr.getSelectedInstanceId()).getDisplayObject();b.selectedInstanceBorder.destroy();b.parent.batchDraw()}bd.editor.ctr.setSelectedInstanceId(a.instanceId);b=new Konva.Group;a.selectedInstanceBorder=b;var c=new Konva.Rect({x:a.x()-2,y:a.y(),width:a.width()+4,height:a.height(),stroke:"red",strokeWidth:4});b.add(c);a.on("dragmove",function(){c.setX(this.x()-
2);c.setY(this.y())});a.selectionBorder=c;var e=this.getLayer();e.add(b);a.moveToTop();e.batchDraw()};bd.methodTag.label.createKineticEditorObjectOnLayer=function(a){return this.createKineticEditorObject()};
bd.methodTag.label.createKineticEditorObject=function(){var a=new Konva.Text({text:"ABC",fontSize:this.model.fontSize,fontFamily:"Calibri",fill:"black",width:this.model.width,height:this.model.height,draggable:!0}),b=this.model.color;a.setFill(b?b:"#000000");a.setText(this.model.text.replace(/\\n/g,"\n"));return a};
bd.methodTag.label.createDisplayObject=function(){var a=bd.component.lookup(this.model.viewId),b=a.getPhaserGameObject(),a=a.getPhaserObject(),c={font:this.model.fontSize+"px Arial"};return new a.Text(b,this.model.x,this.model.y,this.model.text.replace(/\\n/g,"\n"),c)};
bd.methodTag.label.setText=function(a){bd.inPlayer?null!=this.getDisplayObject()&&(this.getDisplayObject().text=a.replace(/\\n/g,"\n")):(this.getDisplayObject()&&(this.getDisplayObject().setText(a.replace(/\\n/g,"\n")),this.updateBorderSize()),this.drawLayer())};bd.methodTag.label.updateBorderSize=function(){var a=this.getDisplayObject().selectionBorder;null!=a&&(a.setWidth(this.getDisplayObject().width()+4),a.setHeight(this.getDisplayObject().height()))};
bd.methodTag.label.updateFontSize=function(){this.getDisplayObject()&&(bd.inPlayer?bd.inPlayer&&this.setPhaserStyle():(this.getDisplayObject().fontSize(this.model.fontSize),this.updateBorderSize(),this.drawLayer()))};bd.methodTag.label.setTextColor=function(a){bd.inPlayer?this.getDisplayObject().fill=this.model.color:(this.getDisplayObject()&&this.getDisplayObject().setFill(a),this.drawLayer())};bd.methodTag.label.setWidthHeight=function(){bd.inPlayer||bd.methodTag.canvasObject.setWidthHeight.call(this)};
bd.methodTag.label.removeDisplayObject=function(){null!=this.getDisplayObject()&&(this.getDisplayObject().destroy(),this.setDisplayObject(null))};bd.methodTag.label.setPhaserStyle=function(){if(bd.inPlayer&&null!=this.getDisplayObject()){var a=this.getDisplayObject(),b={};b.font=this.model.fontSize+"px Arial";b.backgroundColor=this.model.backgroundColor;b.fill=this.model.color;a.setStyle(b)}};bd.modelTag.hasTextField={requiredFields:["text"],provideFields:function(){return[{fields:["text"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["text"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"text"},{fields:["fontSize"],classOrInstance:"instance",providers:["srcInstance","parent"]},{fields:["fontSize"],classOrInstance:"class",providers:["defaultValue"],defaultValue:18},{fields:["color"],classOrInstance:"instance",providers:["srcInstance","parent"]},
{fields:["color"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"#000000"}]},provideProperties:function(){return{COLOR:{modelName:"color",getType:function(){return bd.type.ctr.getColorTypeObject}},FONT_SIZE:{modelName:"fontSize",getType:function(){return bd.type.ctr.getNumberTypeObject}}}}};bd.modelTag.hasLabelProperties={provideFields:function(){return[{fields:["height","width"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"auto"}]}};bd.component.label={constructor:function(a,b){goog.mixin(this,bd.component.label.componentProperties);this.tabId=b;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"label",listName:"labels",idName:"labelId",idListName:"labelIds",sideBarPanelName:"sideBarLabelPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},tabIconFileName:"class-icon-label.png",editorDisplayObjectType:"label",possibleLayerTypes:["tmxEntityLayer"],
namePrefix:"Label Class",typeName:"Label",tabName:"Labels",entityName:"Label Class",entityNamePlural:"Label Classes",thisName:"this label class",allName:"all label classes",anyName:"any label class",randomName:"random label class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasDirection hasHeightWidth hasVisibility hasDragability hasViewId hasLayerId perPlayer shareMode hasTraits hasTabContainer hasScripts hasTint hasTextField hasLabelProperties".split(" "),
methodTags:["entity","canvasObject","melonPiece","phaserObject","label"]},getProperties:function(){return[{name:"COLOR"},{name:"FONT_SIZE"}]},beforeCreateEntity:function(){bd.overlay.ctr.showOverlay("labelSelect")}};
bd.component.labelInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.labelInstance.componentProperties);this.layer=function(){return bd.bgLayer};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"labelInstance",listName:"labelInstances",idName:"labelInstanceId",idListName:"labelInstanceIds",editorDisplayObjectType:"label",instancePanelName:"labelInstancePanel",
namePrefix:"label",entityName:"Label",thisName:"this label",allName:"all labels",anyName:"any label",randomName:"random label",modelTags:bd.component.label.componentProperties.modelTags,methodTags:bd.component.label.componentProperties.methodTags}};bd.component.typeNameToComponent.label=bd.component.label;bd.component.typeNameToComponent.labelInstance=bd.component.labelInstance;bd.component.childNameToParentName.labelInstance="label";bd.component.levelEditorCategoryComponent={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorCategoryComponent.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorCategoryComponent",listName:"levelEditorCategoryComponents",idName:"levelEditorCategoryComponentId",idListName:"levelEditorCategoryComponentIds",namePrefix:"unused prefix...",
tabName:"Level Editor Category Component",entityName:"Level Editor Category Component",modelTags:["entity","categoryComponent"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorCategoryComponent=bd.component.levelEditorCategoryComponent;bd.methodTag.tmxTileLayer={provideMethods:function(){return[{name:"setupLayerDetailPanel",fxn:bd.methodTag.tmxTileLayer.setupLayerDetailPanel,classOrInstance:"class"},{name:"setupLayerOnCanvas",fxn:bd.methodTag.tmxTileLayer.setupLayerOnCanvas,classOrInstance:"class"},{name:"removeLayerFromCanvas",fxn:bd.methodTag.tmxTileLayer.removeLayerFromCanvas,classOrInstance:"class"},{name:"setupLayerOnPhaser",fxn:bd.methodTag.tmxTileLayer.setupLayerOnPhaser,classOrInstance:"class"}]}};
bd.methodTag.tmxTileLayer.setupLayerDetailPanel=function(){bd.component.melonView.tmxTileLayer.setupDetailPanel()};bd.methodTag.tmxTileLayer.setupLayerOnCanvas=function(){var a=bd.component.lookup(this.model.viewId),b=bd.component.lookup(a.model.tmxMapId).model.gridWidth;a.getWindow();for(var c in this.model.gridTileIndexToTileSetTile)a=this.model.gridTileIndexToTileSetTile[c],bd.component.melonView.canvasView.placeTileOnLayer(this.id,c%b,Math.floor(c/b),a.tileSetId,a.tileSetColumn,a.tileSetRow)};
bd.methodTag.tmxTileLayer.removeLayerFromCanvas=function(){this.gridTileIndexToKineticSpriteObject={}};bd.methodTag.tmxTileLayer.setupLayerOnPhaser=function(){};bd.component.melonView.tmxTileLayer={constructor:function(a,b,c,e){this.viewId="undefined"==typeof b?null:b;this.tmxMapId=c;this.isCollisionLayer="undefined"==typeof e?null:e;this.gridTileIndexToKineticSpriteObject={};goog.mixin(this,bd.component.melonView.tmxTileLayer.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this);null==a&&this.afterComponentCreated()},componentProperties:{classOrInstance:"class",type:"tmxTileLayer",listName:"tmxTileLayers",
idName:"tmxTileLayerId",idListName:"tmxTileLayerIds",namePrefix:"tmxTileLayer",layerDetailPanel:"melonTileSelector",modelTags:["entity","hasMelonTMXLayerProperties","hasMelonTMXTileLayerProperties"],methodTags:["entity","tmxLayer","tmxTileLayer"]}};bd.component.typeNameToComponent.tmxTileLayer=bd.component.melonView.tmxTileLayer;bd.component.melonView.tmxTileLayer.detailPanel={};bd.component.melonView.tmxTileLayer.selectedTileRow=null;bd.component.melonView.tmxTileLayer.selectedTileColumn=null;bd.component.melonView.tmxTileLayer.selectedTileSetId=null;
bd.component.melonView.tmxTileLayer.setupDetailPanel=function(){document.getElementById("tileSetDropDown").innerHTML="";var a=bd.component.melonView.tmxTileSet.collisionTileSet.id,b=bd.component.lookup(bd.model.getCurrentViewId()).getSelectedLayerId();if(bd.component.lookup(b).model.isCollisionLayer)b=goog.dom.createDom("option"),b.value=a,b.text="collision tiles",bd.component.melonView.tmxTileLayer.selectedTileSetId=a,document.getElementById("tileSetDropDown").appendChild(b);else{for(var c=bd.model.getCurrentGame()[bd.component.melonView.tmxTileSet.componentProperties.listName],
e=0;e<c.length;e++)c[e].id!=a&&(0==e&&(bd.component.melonView.tmxTileLayer.selectedTileSetId=c[e].id),b=goog.dom.createDom("option"),b.value=c[e].id,b.text=c[e].name,document.getElementById("tileSetDropDown").appendChild(b));document.getElementById("tileSetDropDown")}bd.component.melonView.tmxTileLayer.generateTileLayerTilePicker()};
bd.component.melonView.tmxTileLayer.tileImageClickHandler=function(a){var b=document.getElementById("tileSetDropDown").value,c=bd.component.lookup(b),b=c.model.tileHeight,e=c.model.tileWidth;bd.component.melonView.tmxTileLayer.selectedTileRow=a.target.row;bd.component.melonView.tmxTileLayer.selectedTileColumn=a.target.column;bd.tilePicker.ctr.moveSelectedTileDiv(bd.component.melonView.tmxTileLayer.selectedTileDiv,bd.component.melonView.tmxTileLayer.selectedTileRow,bd.component.melonView.tmxTileLayer.selectedTileColumn,
b,e);var f=new Image;f.crossOrigin="anonymous";c=bd.component.lookup(c.model.assetId).getThumbnailUrl();f.src=c;f.style.backgroundImage=a.target.style.backgroundImage;f.style.backgroundPosition=a.target.style.backgroundPosition;f.style.width=a.target.style.width;f.style.height=a.target.style.height;c=bd.component.lookup(bd.model.getCurrentViewId());c.tileCursor.image(f);c.tileCursor.setWidth(e);c.tileCursor.setHeight(b);c.tileCursor.setVisible(!0);c.tileCursor.animations({tileAnimation:[a.target.column*
b,a.target.row*e,e,b]})};
bd.component.melonView.tmxTileLayer.generateTileLayerTilePicker=function(){var a=bd.component.lookup(bd.component.melonView.tmxTileLayer.selectedTileSetId),b=a.model.assetId,c=bd.component.lookup(b).getThumbnailUrl(),e=a.model.tileHeight,a=a.model.tileWidth,f=bd.imageLoader.ctr.getImageObject(b),b=f.height,f=f.width;bd.component.melonView.tmxTileLayer.selectedTileRow=null;bd.component.melonView.tmxTileLayer.selectedTileColumn=null;bd.tilePicker.ctr.generateTilePicker(c,"melonTileContainer",b,f,e,
a,bd.component.melonView.tmxTileLayer.tileImageClickHandler);c=bd.tilePicker.ctr.createSelectedTileDiv("selectedTileDiv",0,0,e,a);document.getElementById("melonTileContainer").appendChild(c);bd.component.melonView.tmxTileLayer.selectedTileDiv=c};bd.component.melonView.tmxTileLayer.changeTileSetDropDown=function(){var a=document.getElementById("tileSetDropDown").value;bd.component.melonView.tmxTileLayer.selectedTileSetId=a;bd.tilePicker.ctr.generateTilePicker()};bd.component.frameView={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.frameView.componentProperties);this.model=null!=a?a:{};var b=null==a;null==a&&(this.defaultImageId=bd.defaultGameViewAsset.id,bd.component.addComponentListToComponent(this,bd.component.frameView.componentProperties.componentsOnView,"idListName"));bd.modelTag.applyTags(this,b);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"frameView",listName:"frameViews",
idName:"frameViewId",idListName:"frameViewIds",sideBarPanelName:"sideBarGameViewPanel",defaultImageUrlObject:{url:"images/qmarksq.png",internal:!0},editorDisplayObjectType:"image",minimumEntitiesInList:1,layerNameToObject:{},isKineticJSView:!1,editorFrameFile:"frameView.html",playerFrameFile:"kineticPlayerView.html",isView:!0,componentsOnView:["pieceInstance","physicsRectangleInstance","labelInstance","videoInstance","target"],namePrefix:"frame view",typeName:"Frame View",tabName:"Frame Views",entityName:"Frame View",
entityNamePlural:"Frame Views",thisName:"this frame view",allName:"all frame views",anyName:"any frame view",randomName:"random frame view",modelTags:"entity hasBlockEntityTracking hasCostumeNoInstance hasTraitsNoInstance hasScripts hasGravity hasViewHeightWidth".split(" "),methodTags:["entity","view","gameView","frameView"]}};bd.component.typeNameToComponent.frameView=bd.component.frameView;bd.component.tableGrid={constructor:function(a,b){goog.mixin(this,bd.component.tableGrid.componentProperties);this.tabId=b;null==a&&(this.defaultImageId=bd.component.getComponentByType(this.type).getDefaultAssetId());this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tableGrid",listName:"tableGrids",idName:"tableGridId",idListName:"tableGridIds",sideBarPanelName:"sideBarTableGridPanel",defaultImageUrlObject:{url:"images/textInput.png",
internal:!0},tabIconFileName:"class-icon-input.png",editorDisplayObjectType:"image",possibleLayerTypes:["uiLayer"],namePrefix:"Table Grid Class",typeName:"Table Grid",tabName:"Table Grids",entityName:"Table Grid Class",entityNamePlural:"Table Grid Classes",thisName:"this table grid class",allName:"all table grid classes",anyName:"any table grid class",randomName:"random table grid class",modelTags:"entity hasParentAndInstances hasSrcInstanceId hasBlockEntityTracking hasPosition hasHeightWidth hasVisibility hasViewId hasLayerId hasCostume hasCoordinateOffset shareMode hasTraits hasTabContainer hasScripts hasTableProperties hasTableGridProperties".split(" "),
methodTags:["entity","canvasObject","htmlObject","table","tableGrid"]},getDefaultAssetId:function(){var a=bd.model.getAssetIdByIdentifier(bd.component.assetImage.componentProperties.type,"table.png");if(null==a){var b=new bd.component.assetImage.constructor(null,"table.png",!0,!0),a=b.id;bd.imageLoader.ctr.loadAsset(b.id)}return a}};
bd.component.tableGridInstance={constructor:function(a,b,c,e,f){bd.component.handleInstanceParameters.call(this,a,b,c,e,f);goog.mixin(this,bd.component.tableGridInstance.componentProperties);bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"instance",type:"tableGridInstance",listName:"tableGridInstances",idName:"tableGridInstanceId",idListName:"tableGridInstanceIds",editorDisplayObjectType:"image",instancePanelName:"tableGridInstancePanel",
hasExtraRowInPlayer:!0,shouldUpdatePositionToScale:!0,namePrefix:"table grid",entityName:"Table Grid",thisName:"this table grid",allName:"all table grids",anyName:"any table grid",randomName:"random table grid",modelTags:bd.component.tableGrid.componentProperties.modelTags,methodTags:bd.component.tableGrid.componentProperties.methodTags}};bd.component.typeNameToComponent.tableGrid=bd.component.tableGrid;bd.component.typeNameToComponent.tableGridInstance=bd.component.tableGridInstance;
bd.component.childNameToParentName.tableGridInstance="tableGrid";bd.methodTag.tmxImageLayer={provideMethods:function(){return[{name:"setupLayerDetailPanel",fxn:bd.methodTag.tmxImageLayer.setupLayerDetailPanel,classOrInstance:"class"},{name:"setupLayerOnCanvas",fxn:bd.methodTag.tmxImageLayer.setupLayerOnCanvas,classOrInstance:"class"},{name:"removeLayerFromCanvas",fxn:bd.methodTag.tmxImageLayer.removeLayerFromCanvas,classOrInstance:"class"},{name:"setupLayerOnPhaser",fxn:bd.methodTag.tmxImageLayer.setupLayerOnPhaser,classOrInstance:"class"},{name:"switchCostume",
fxn:bd.methodTag.tmxImageLayer.switchCostume,classOrInstance:"class"},{name:"updateCostume",fxn:bd.methodTag.tmxImageLayer.updateCostume,classOrInstance:"class"},{name:"updateEditorImageTileSpriteVisibility",fxn:bd.methodTag.tmxImageLayer.updateEditorImageTileSpriteVisibility,classOrInstance:"class"},{name:"getBitMapData",fxn:bd.methodTag.tmxImageLayer.getBitMapData,classOrInstance:"class"},{name:"setBitMapData",fxn:bd.methodTag.tmxImageLayer.setBitMapData,classOrInstance:"class"}]}};
bd.methodTag.tmxImageLayer.handleCommand=function(a){return"costumeId"==a.property?(this.switchCostume(),!0):bd.inPlayer||"tileSpriteVisible"!=a.property?!1:(this.updateEditorImageTileSpriteVisibility(),!0)};bd.methodTag.tmxImageLayer.setupLayerDetailPanel=function(){};
bd.methodTag.tmxImageLayer.setupLayerOnCanvas=function(){var a=bd.component.lookup(this.model.viewId),b=a.getWindow().Konva,c=this;this.imageObject=new Image;this.imageObject.crossOrigin="anonymous";var e=this.imageObject;this.imageObject.onload=function(){var f=a.getPlayerViewHeightWidth();c.kineticImageObject=new b.Image({x:0,y:0,width:f.width,height:f.height,image:e,visible:c.model.tileSpriteVisible});a.getLayer("tmxLayer"+c.id).add(c.kineticImageObject);a.getLayer("tmxLayer"+c.id).batchDraw()};
this.imageObject.src=bd.component.lookup(bd.model.entityLookup(this.model.costumeId).assetId).getThumbnailUrl()};bd.methodTag.tmxImageLayer.removeLayerFromCanvas=function(){};
bd.methodTag.tmxImageLayer.setupLayerOnPhaser=function(){var a=bd.component.lookup(this.model.viewId),b=a.getPhaserGameObject();a.getPhaserObject();var c=bd.model.entityLookup(this.model.costumeId).assetId,e=a.getPlayerViewHeightWidth(),f=b.add.tileSprite(0,0,e.width,e.height,"assetId:"+c);this.tileSprite=f;c=b.cache.getImage("assetId:"+c);f.tileScale.setTo(e.width/c.width,e.height/c.height);f.visible=this.model.tileSpriteVisible;a=a.getLayer(this.model.id);a.add(f);f=this.bitMapData;f||(f=b.add.bitmapData(b.width,
b.height),f.smoothed=!1,this.setBitMapData(f));b=f.addToWorld();a.add(b)};bd.methodTag.tmxImageLayer.switchCostume=function(){null!=this.kineticImageObject&&bd.imageLoader.ctr.getImage(this.kineticImageObject,this.getEditorLayer(),bd.model.entityLookup(this.model.costumeId).assetId);var a=bd.component.lookup(bd.model.getCurrentViewId()).getImageLayerId();this.id==a&&bd.layerSelect.ctr.updateBackgroundImageSelector()};bd.methodTag.tmxImageLayer.updateCostume=function(){this.switchCostume()};
bd.methodTag.tmxImageLayer.updateEditorImageTileSpriteVisibility=function(){var a=bd.component.lookup(bd.model.getCurrentViewId()).getLayer("tmxLayer"+this.id);this.kineticImageObject.visible(this.model.tileSpriteVisible);a.batchDraw()};bd.methodTag.tmxImageLayer.getBitMapData=function(){return this.bitMapData};bd.methodTag.tmxImageLayer.setBitMapData=function(a){this.bitMapData=a};bd.component.melonView.tmxImageLayer={constructor:function(a,b,c,e){this.viewId="undefined"==typeof b?null:b;this.assetId="undefined"==typeof e?null:e;this.tmxMapId=c;goog.mixin(this,bd.component.melonView.tmxImageLayer.componentProperties);null==a&&(this.defaultImageId=null==e?bd.defaultPieceAsset.id:e);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this);null==a&&this.afterComponentCreated()},componentProperties:{classOrInstance:"class",type:"tmxImageLayer",
listName:"tmxImageLayers",idName:"tmxImageLayerId",idListName:"tmxImageLayerIds",namePrefix:"tmxImageLayer",layerDetailPanel:"melonLayerImageSelect",modelTags:["entity","hasMelonTMXLayerProperties","hasMelonTMXImageLayerProperties","hasCostumeNoInstance"],methodTags:["entity","tmxLayer","tmxImageLayer"]}};bd.component.typeNameToComponent.tmxImageLayer=bd.component.melonView.tmxImageLayer;bd.modelTag.hasMelonTMXMapProperties={requiredFields:[],provideFields:function(){return[{fields:["gridHeight"],classOrInstance:"class",providers:["defaultValue"],defaultValue:15},{fields:["gridWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:20},{fields:["tileHeight"],classOrInstance:"class",providers:["defaultValue"],defaultValue:32},{fields:["tileWidth"],classOrInstance:"class",providers:["defaultValue"],defaultValue:32},{fields:["version"],classOrInstance:"class",providers:["defaultValue"],
defaultValue:1},{fields:["properties"],classOrInstance:"class",providers:["defaultValue"],defaultValue:{}},{fields:["layerIds"],classOrInstance:"class",providers:["defaultValue"],defaultValue:[],removeConnectionFxn:bd.modelTag.hasMelonTMXMapProperties.removeLayerIds},{fields:["orientation"],classOrInstance:"class",providers:["defaultValue"],defaultValue:"orthogonal"}]}};bd.modelTag.hasMelonTMXMapProperties.removeLayerIds=function(){for(var a=0;a<this.model.layerIds.length;a++)bd.component.lookup(this.model.layerIds[a]).deleteEntity()};bd.component.melonView.tmxMap={constructor:function(a){goog.mixin(this,bd.component.melonView.tmxMap.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tmxMap",listName:"tmxMaps",idName:"tmxMapId",idListName:"tmxMapIds",namePrefix:"tmxmap",modelTags:["entity","hasMelonTMXMapProperties"],methodTags:["entity"]}};bd.component.typeNameToComponent.tmxMap=bd.component.melonView.tmxMap;bd.component.scriptPage={constructor:function(a){goog.mixin(this,bd.component.scriptPage.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"scriptPage",listName:"scriptPages",idName:"scriptPageId",idListName:"scriptPageIds",namePrefix:"block page ",isInitialized:!1,modelTags:["entity","hasScripts"],methodTags:["entity","scriptPage"]},whenGameLoadedInEditor:function(){bd.script.ctr.selectedScriptPageId=
bd.model.getCurrentGame()[this.componentProperties.listName][0].id}};bd.component.typeNameToComponent.scriptPage=bd.component.scriptPage;bd.component.assetImage={constructor:function(a,b,c,e,f,g,h){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.assetImage.componentProperties);this.thumbnailFileName=b;this.isThumbnailFileInternal=c;this.isDefaultAsset="undefined"==typeof e?!1:e;this.assetLabel=b;this.backendAssetId="undefined"==typeof g?null:g;this.initialCostumeId="undefined"==typeof f?null:f;this.unsavedAssetId="undefined"==typeof h?null:h;this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},
componentProperties:{classOrInstance:"class",type:"assetImage",listName:"assetImages",idName:"assetImageId",idListName:"assetImageIds",namePrefix:"dummy pic",isAsset:!0,isImage:!0,buttonRowElementId:"filepickerButtonsImage",assetUploadDivId:"filepickerImageUploadContainer",uploadFilePrefix:"images/uploads/",onServerPrefix:"images/assetImages/",cordovaOnServerPrefix:"img/assetImages/",identifierProperty:"thumbnailFileName",assetPickerBoxId:"assetPickerAsset",defaultAssetIconType:"EDIT",assetCategoriesOrder:["stock",
"user","game"],assetCategoryInfo:{user:{buttonText:"My Images",buttonId:"assetPickerUserImageButton",hasEditOrDeleteToggle:!0},game:{buttonText:"Game Images",buttonId:"assetPickerGameImageButton"},inherited:{buttonText:"Inherited Images"},stock:{buttonText:"Stock Images",buttonId:"assetPickerStockImageButton",subCategories:{containerId:"assetPickerImageSubCategoryContainer",buttonOrder:["character","item","vehicle"],buttonInfo:{character:{buttonId:"assetPickerCharactersImageButton"},item:{buttonId:"assetPickerItemsImageButton"},
vehicle:{buttonId:"assetPickerVehiclesImageButton"}}}}},modelTags:["entity","hasAssetProperties","hasImageAssetProperties"],methodTags:["entity","asset"]}};bd.component.typeNameToComponent.assetImage=bd.component.assetImage;bd.component.assetImage.createAssetFromDbInfoObject=function(a,b){var c=a.is_thumbnail_file_internal,e=!1;"onHost"==a.is_thumbnail_file_internal&&(e=!0,c=1);return new bd.component.assetImage.constructor(null,a.thumbnail_file_name,c,e,b,a.backend_id,a.unsavedAssetId)};
bd.component.assetImage.getThumbnailUrlFromDbInfo=function(a){var b=a.is_thumbnail_file_internal,c=!1;"onHost"==a.is_thumbnail_file_internal&&(c=!0,b=1);return bd.component.assetImage.getThumbnailUrlFromParams(a.thumbnail_file_name,b,c,a.unsavedAssetId)};
bd.component.assetImage.getThumbnailUrlFromParams=function(a,b,c,e){var f=bd.component.assetImage.componentProperties;return null!=e?bd.inPlayer?window.parent.bd.save.ctr.getDataUrlFromUnsavedAssetId(e):bd.save.ctr.getDataUrlFromUnsavedAssetId(e):b?c&&b?"images/"==a.substr(0,7)?bd.inPlayer&&(bd.player.ctr.isCordova||bd.player.ctr.isStandalone)?"img"+a.substr(6):bd.model.staticUrl+a:bd.inPlayer&&(bd.player.ctr.isCordova||bd.player.ctr.isStandalone)?f.cordovaOnServerPrefix+a:bd.model.staticUrl+f.onServerPrefix+
a:bd.model.getUploadUrl()+f.uploadFilePrefix+a:a};bd.modelTag.hasMelonTMXTileSetProperties={requiredFields:[],provideFields:function(){return[{fields:["assetId"],classOrInstance:"class",providers:["componentObject"]},{fields:["tileMargin"],classOrInstance:"class",providers:["componentObject"]},{fields:["tileProperties"],classOrInstance:"class",providers:["componentObject"]},{fields:["tileSpacing"],classOrInstance:"class",providers:["componentObject"]},{fields:["tileHeight"],classOrInstance:"class",providers:["componentObject"]},{fields:["tileWidth"],
classOrInstance:"class",providers:["componentObject"]},{fields:["drawingOffsetX"],classOrInstance:"class",providers:["componentObject"]},{fields:["drawingOffsetY"],classOrInstance:"class",providers:["componentObject"]}]}};bd.component.melonView.tmxTileSet={constructor:function(a,b,c,e,f,g,h,k,l){this.assetId="undefined"==typeof b?null:b;this.tileHeight="undefined"==typeof c?null:c;this.tileWidth="undefined"==typeof e?null:e;this.tileMargin="undefined"==typeof f?null:f;this.tileSpacing="undefined"==typeof g?null:g;this.drawingOffsetX="undefined"==typeof h?null:h;this.drawingOffsetY="undefined"==typeof k?null:k;this.tileProperties="undefined"==typeof l?null:l;goog.mixin(this,bd.component.melonView.tmxTileSet.componentProperties);
this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"tmxTileSet",listName:"tmxTileSets",idName:"tmxTileSetId",idListName:"tmxTileSetIds",namePrefix:"tmxTileSet",defaultTileUrlObject:{url:"images/melonDemoImages/map/area01_level_tiles.png",internal:!0},defaultTileUrl:"images/melonDemoImages/map/area01_level_tiles.png",defaultTileIsUrlInternal:!0,collisionTileUrlObject:{url:"images/melonDemoImages/map/metatiles32x32.png",
internal:!0},collisionTileUrl:"images/melonDemoImages/map/metatiles32x32.png",collisionTileIsUrlInternal:!0,collisionTileProperties:{0:{type:"solid"},1:{type:"platform"},2:{type:"l_slope"},3:{type:"r_slope"},4:{type:"ladder"}},modelTags:["entity","hasMelonTMXTileSetProperties"],methodTags:["entity"]},whenGameCreated:function(){var a=bd.component.melonView.tmxTileSet.componentProperties,b=new bd.component.assetImage.constructor(null,a.defaultTileUrl,a.defaultTileIsUrlInternal,!0);bd.imageLoader.ctr.loadAsset(b.id);
bd.component.melonView.tmxTileSet.defaultTileSet=new bd.component.melonView.tmxTileSet.constructor(null,b.id,32,32,0,0,0,0,{});a=new bd.component.assetImage.constructor(null,a.collisionTileUrl,a.collisionTileIsUrlInternal,!0);bd.imageLoader.ctr.loadAsset(a.id);bd.component.melonView.tmxTileSet.collisionTileSet=new bd.component.melonView.tmxTileSet.constructor(null,a.id,32,32,0,0,0,0,bd.component.melonView.tmxTileSet.componentProperties.collisionTileProperties)},whenGameLoadedInEditor:function(){for(var a=
bd.defaultTileAsset.id,b=bd.collisionTileAsset.id,c=!1,e=!1,f=bd.model.getCurrentGame()[bd.component.melonView.tmxTileSet.componentProperties.listName],g=0;g<f.length&&(f[g].assetId==a&&(bd.component.melonView.tmxTileSet.defaultTileSet=bd.component.lookup(f[g].id),c=!0),f[g].assetId==b&&(bd.component.melonView.tmxTileSet.collisionTileSet=bd.component.lookup(f[g].id),e=!0),!c||!e);g++);}};bd.component.typeNameToComponent.tmxTileSet=bd.component.melonView.tmxTileSet;bd.component_reqs={};bd.deviceMotion={};bd.deviceMotion.ctr={};bd.deviceMotion.ctr.accelerationX=null;bd.deviceMotion.ctr.accelerationY=null;bd.deviceMotion.ctr.accelerationZ=null;bd.deviceMotion.ctr.absolute=null;bd.deviceMotion.ctr.alpha=null;bd.deviceMotion.ctr.beta=null;bd.deviceMotion.ctr.gamma=null;bd.deviceMotion.ctr.orientationAngle=null;bd.deviceMotion.ctr.orientationMagnitude=null;bd.deviceMotion.ctr.calculatedX=null;bd.deviceMotion.ctr.calculatedY=null;
bd.deviceMotion.ctr.setup=function(){bd.deviceMotion.ctr.setupShake();window.ondeviceorientation=function(a){bd.deviceMotion.ctr.absolute=a.absolute;bd.deviceMotion.ctr.alpha=a.alpha;bd.deviceMotion.ctr.beta=a.beta;bd.deviceMotion.ctr.gamma=a.gamma;var b=a.beta,c=a.gamma;90<b&&(b=90);-90>b&&(b=-90);var b=b+90,c=c+90,e=(b-90)/90,f=(c-90)/90;bd.deviceMotion.ctr.calculatedX=a.beta;bd.deviceMotion.ctr.calculatedY=a.gamma;bd.deviceMotion.ctr.orientationMagnitude=Math.sqrt(Math.pow(b-90,2)+Math.pow(c-90,
2));a=Math.atan(f/e)*(90/Math.PI);0<e&&0>f?a*=-2:0>e&&0>f?a=180-2*a:0>e&&0<f?a=180+-2*a:0<e&&0<f&&(a=360-2*a);bd.deviceMotion.ctr.orientationAngle=(a+90)%360}};
bd.deviceMotion.ctr.setupShake=function(){(function(){function a(){navigator.accelerometer.getCurrentAcceleration(b,c)}function b(a){10<(null!==h&&null!==h.x?Math.abs(Math.round(Math.abs(h.x)-Math.abs(a.x)))+Math.abs(Math.round(Math.abs(h.y)-Math.abs(a.y)))+Math.abs(Math.round(Math.abs(h.z)-Math.abs(a.z))):0)?("function"===typeof k&&k(),e.stopWatch(),setTimeout(e.startWatch,1E3),h={x:null,y:null,z:null}):h={x:a.x,y:a.y,z:a.z}}function c(){alert("shake error")}var e={},f=null,g={frequency:300},h={x:null,
y:null,z:null},k=null;e.startWatch=function(b){b&&(k=b);navigator.accelerometer&&(f=navigator.accelerometer.watchAcceleration(a,c,g))};e.stopWatch=function(){null!==f&&(navigator.accelerometer.clearWatch(f),f=null)};return e})().startWatch(bd.deviceMotion.ctr.onShake)};bd.deviceMotion.ctr.onShake=function(){bd.evaluator.ctr.whenDeviceShaken()};jQuery(document).ready(function(){});bd.evaluator.ctr.blocks.text={};bd.evaluator.ctr.configs.text={evalFunc:function(a){bd.evaluator.ctr.getCurrentStackObject();null!=a.field.__text?bd.evaluator.ctr.returnHandler(a.field.__text,a.returnsEntity):bd.evaluator.ctr.returnHandler("",a.returnsEntity)}};
bd.evaluator.ctr.configs.text_join={getParams:function(a){for(var b=[],c=0;c<a.mutation._items;c++)b.push({name:"ADD"+c,type:"value",valueName:"ADD"+c});return b},evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c="",e=0;e<a.mutation._items;e++)c+="nullObject"==b.params["ADD"+e]?"":b.params["ADD"+e];bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.set_label_text={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"labelText",type:"value",valueName:"x"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","text",String(b.params.labelText),{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.get_input_text={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.model.entityLookup(b)?bd.evaluator.ctr.returnHandler(bd.model.entityLookup(b).text,a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler("",a.returnsEntity))}};
bd.evaluator.ctr.configs.text_substring={paramsInfo:[{name:"string",type:"value",valueName:"STRING"},{name:"start_index",type:"value",valueName:"START_INDEX"},{name:"end_index",type:"value",valueName:"END_INDEX"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.string,e=b.params.start_index-1,b=b.params.end_index,e=Math.max(0,e),b=Math.min(b,c.length),e=Math.min(b,e);bd.evaluator.ctr.returnHandler(c.substring(e,b),a.returnsEntity)}};
bd.evaluator.ctr.configs.text_length={paramsInfo:[{name:"string",type:"value",valueName:"STRING"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.string;bd.evaluator.ctr.returnHandler(b.length,a.returnsEntity)}};
bd.evaluator.ctr.configs.text_char_at={paramsInfo:[{name:"string",type:"value",valueName:"STRING"},{name:"index",type:"value",valueName:"INDEX"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.string,b=b.params.index-1;0>b||b>=c.length?(bd.errorLog.ctr.printError(bd.msg.ERROR_STRING_INDEX_OUT_OF_BOUNDS,[b+1,c]),bd.evaluator.ctr.returnHandler("",a.returnsEntity)):bd.evaluator.ctr.returnHandler(c.substring(b,b+1),a.returnsEntity)}};
bd.evaluator.ctr.configs.text_contains={paramsInfo:[{name:"string",type:"value",valueName:"STRING"},{name:"substring",type:"value",valueName:"SUBSTRING"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.returnHandler(-1<b.params.string.indexOf(b.params.substring),a.returnsEntity)}};
bd.evaluator.ctr.configs.text_list_of_characters={paramsInfo:[{name:"string",type:"value",valueName:"STRING"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.string.split("");bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};
bd.evaluator.ctr.configs.text_variable_refresh={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"LABEL"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray;bd.component.lookup(b[0]).variableRefresh();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.blocks.dictionary={};bd.evaluator.ctr.configs.dictionary_is_word={paramsInfo:[{name:"word",type:"value",valueName:"STRING"}],evalFunc:function(a){a=bd.evaluator.ctr.getCurrentStackObject().params.word;bd.evaluator.ctr.returnHandler(bd.dictionary.ctr.isWord(a))}};
bd.evaluator.ctr.configs.dictionary_anagrams={paramsInfo:[{name:"letters",type:"value",valueName:"STRING"}],evalFunc:function(a){a=bd.evaluator.ctr.getCurrentStackObject().params.letters.split("");a=bd.dictionary.ctr.getPermutations(a);for(var b=[],c=0;c<a.length;c++)bd.dictionary.ctr.isWord(a[c])&&b.push(a[c]);bd.evaluator.ctr.returnHandler(b)}};
bd.evaluator.ctr.configs.dictionary_rand_word_with_length={paramsInfo:[{name:"len",type:"value",valueName:"LEN"}],evalFunc:function(a){a=bd.evaluator.ctr.getCurrentStackObject().params.len;a=bd.dictionary.ctr.getRandWordGivenLength(a);bd.evaluator.ctr.returnHandler(a)}};bd.evaluator.ctr.configs.dictionary_rand_word={paramsInfo:[],evalFunc:function(a){a=bd.dictionary.ctr.getRandWord();bd.evaluator.ctr.returnHandler(a)}};
bd.evaluator.ctr.configs.dictionary_words_in_string={paramsInfo:[{name:"letters",type:"value",valueName:"STRING"}],evalFunc:function(a){a=bd.evaluator.ctr.getCurrentStackObject().params.letters;a=bd.dictionary.ctr.getWordsInString(a);bd.evaluator.ctr.returnHandler(a)}};
bd.evaluator.ctr.configs.dictionary_words_using_letters_in_string={paramsInfo:[{name:"letters",type:"value",valueName:"STRING"}],evalFunc:function(a){a=bd.evaluator.ctr.getCurrentStackObject().params.letters;a=bd.dictionary.ctr.getWordsUsingLettersInString(a);bd.evaluator.ctr.returnHandler(a)}};
bd.evaluator.ctr.configs.dictionary_set_dictionary={paramsInfo:[{name:"dict",type:"field",fieldName:"DICT"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.dict;bd.dictionary.ctr.setDictionary(b.toLowerCase());bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.blocks.logic={};
bd.evaluator.ctr.configs.logic_compare={getParams:function(a){var b=[];b.push({name:"comparator",type:"field",fieldName:a.field._name});bd.util.isArray(a.value)?(b.push({name:"val1",type:"value",valueName:a.value[0]._name}),b.push({name:"val2",type:"value",valueName:a.value[1]._name})):a.value&&b.push({name:"val1",type:"value",valueName:a.value._name});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();switch(b.params.comparator){case "EQ":b=b.params.val1==b.params.val2;
break;case "LT":b=b.params.val1<b.params.val2;break;case "LTE":b=b.params.val1<=b.params.val2;break;case "GT":b=b.params.val1>b.params.val2;break;case "GTE":b=b.params.val1>=b.params.val2;break;case "NEQ":b=b.params.val1!=b.params.val2;break;default:b=!1}bd.evaluator.ctr.returnHandler(b,a.returnsEntity)},conditionEval:function(a,b,c){switch(a){case "EQ":a=b==c;break;case "LT":a=b<c;break;case "LTE":a=b<=c;break;case "GT":a=b>c;break;case "GTE":a=b>=c;break;case "NEQ":a=b!=c;break;default:a=!1}return a}};
bd.evaluator.ctr.configs.logic_operation={getParams:function(a){return[{name:"andOr",type:"field",fieldName:a.field._name},{name:"val1",type:"value",valueName:"A"},{name:"val2",type:"value",valueName:"B"}]},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.andOr;if("nullObject"==b.params.val1)bd.evaluator.ctr.returnHandler(!1,a.returnsEntity);else{"nullObject"==b.params.val2&&(b.params.val2=!1);switch(c){case "AND":b=b.params.val1&&b.params.val2;break;case "OR":b=b.params.val1||
b.params.val2;break;default:b=!1}bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}}};bd.evaluator.ctr.configs.logic_negate={paramsInfo:[{name:"val",type:"value",valueName:"BOOL"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.returnHandler(!b.params.val,a.returnsEntity)}};
bd.evaluator.ctr.configs.logic_boolean={paramsInfo:[{name:"trueOrFalse",type:"field",fieldName:"BOOL"}],evalFunc:function(a){var b="TRUE"==bd.evaluator.ctr.getCurrentStackObject().params.trueOrFalse;bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};bd.evaluator.ctr.blocks.video={};bd.evaluator.ctr.configs.play_video={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VIDEO"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray;bd.component.lookup(b[0]).playVideo();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};goog.color={};
goog.color.names={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",
darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",
ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",
lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",
moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",
seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};goog.color.parse=function(a){var b={};a=String(a);var c=goog.color.prependHashIfNecessaryHelper(a);if(goog.color.isValidHexColor_(c))return b.hex=goog.color.normalizeHex(c),b.type="hex",b;c=goog.color.isValidRgbColor_(a);if(c.length)return b.hex=goog.color.rgbArrayToHex(c),b.type="rgb",b;if(goog.color.names&&(c=goog.color.names[a.toLowerCase()]))return b.hex=c,b.type="named",b;throw Error(a+" is not a valid color string");};
goog.color.isValidColor=function(a){var b=goog.color.prependHashIfNecessaryHelper(a);return!!(goog.color.isValidHexColor_(b)||goog.color.isValidRgbColor_(a).length||goog.color.names&&goog.color.names[a.toLowerCase()])};goog.color.parseRgb=function(a){var b=goog.color.isValidRgbColor_(a);if(!b.length)throw Error(a+" is not a valid RGB color");return b};goog.color.hexToRgbStyle=function(a){return goog.color.rgbStyle_(goog.color.hexToRgb(a))};goog.color.hexTripletRe_=/#(.)(.)(.)/;
goog.color.normalizeHex=function(a){if(!goog.color.isValidHexColor_(a))throw Error("'"+a+"' is not a valid hex color");4==a.length&&(a=a.replace(goog.color.hexTripletRe_,"#$1$1$2$2$3$3"));return a.toLowerCase()};goog.color.hexToRgb=function(a){a=goog.color.normalizeHex(a);var b=parseInt(a.substr(1,2),16),c=parseInt(a.substr(3,2),16);a=parseInt(a.substr(5,2),16);return[b,c,a]};
goog.color.rgbToHex=function(a,b,c){a=Number(a);b=Number(b);c=Number(c);if(isNaN(a)||0>a||255<a||isNaN(b)||0>b||255<b||isNaN(c)||0>c||255<c)throw Error('"('+a+","+b+","+c+'") is not a valid RGB color');a=goog.color.prependZeroIfNecessaryHelper(a.toString(16));b=goog.color.prependZeroIfNecessaryHelper(b.toString(16));c=goog.color.prependZeroIfNecessaryHelper(c.toString(16));return"#"+a+b+c};goog.color.rgbArrayToHex=function(a){return goog.color.rgbToHex(a[0],a[1],a[2])};
goog.color.rgbToHsl=function(a,b,c){a/=255;b/=255;c/=255;var e=Math.max(a,b,c),f=Math.min(a,b,c),g=0,h=0,k=.5*(e+f);e!=f&&(e==a?g=60*(b-c)/(e-f):e==b?g=60*(c-a)/(e-f)+120:e==c&&(g=60*(a-b)/(e-f)+240),h=0<k&&.5>=k?(e-f)/(2*k):(e-f)/(2-2*k));return[Math.round(g+360)%360,h,k]};goog.color.rgbArrayToHsl=function(a){return goog.color.rgbToHsl(a[0],a[1],a[2])};goog.color.hueToRgb_=function(a,b,c){0>c?c+=1:1<c&&--c;return 1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+(b-a)*(2/3-c)*6:a};
goog.color.hslToRgb=function(a,b,c){var e=0,f=0,g=0;a/=360;if(0==b)e=f=g=255*c;else var h=g=0,h=.5>c?c*(1+b):c+b-b*c,g=2*c-h,e=255*goog.color.hueToRgb_(g,h,a+1/3),f=255*goog.color.hueToRgb_(g,h,a),g=255*goog.color.hueToRgb_(g,h,a-1/3);return[Math.round(e),Math.round(f),Math.round(g)]};goog.color.hslArrayToRgb=function(a){return goog.color.hslToRgb(a[0],a[1],a[2])};goog.color.validHexColorRe_=/^#(?:[0-9a-f]{3}){1,2}$/i;goog.color.isValidHexColor_=function(a){return goog.color.validHexColorRe_.test(a)};
goog.color.normalizedHexColorRe_=/^#[0-9a-f]{6}$/;goog.color.isNormalizedHexColor_=function(a){return goog.color.normalizedHexColorRe_.test(a)};goog.color.rgbColorRe_=/^(?:rgb)?\((0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2}),\s?(0|[1-9]\d{0,2})\)$/i;goog.color.isValidRgbColor_=function(a){var b=a.match(goog.color.rgbColorRe_);if(b){a=Number(b[1]);var c=Number(b[2]),b=Number(b[3]);if(0<=a&&255>=a&&0<=c&&255>=c&&0<=b&&255>=b)return[a,c,b]}return[]};
goog.color.prependZeroIfNecessaryHelper=function(a){return 1==a.length?"0"+a:a};goog.color.prependHashIfNecessaryHelper=function(a){return"#"==a.charAt(0)?a:"#"+a};goog.color.rgbStyle_=function(a){return"rgb("+a.join(",")+")"};
goog.color.hsvToRgb=function(a,b,c){var e=0,f=0,g=0;if(0==b)g=f=e=c;else{var h=Math.floor(a/60),k=a/60-h;a=c*(1-b);var l=c*(1-b*k);b=c*(1-b*(1-k));switch(h){case 1:e=l;f=c;g=a;break;case 2:e=a;f=c;g=b;break;case 3:e=a;f=l;g=c;break;case 4:e=b;f=a;g=c;break;case 5:e=c;f=a;g=l;break;case 6:case 0:e=c,f=b,g=a}}return[Math.floor(e),Math.floor(f),Math.floor(g)]};
goog.color.rgbToHsv=function(a,b,c){var e=Math.max(Math.max(a,b),c),f=Math.min(Math.min(a,b),c);if(f==e)f=a=0;else{var g=e-f,f=g/e;a=60*(a==e?(b-c)/g:b==e?2+(c-a)/g:4+(a-b)/g);0>a&&(a+=360);360<a&&(a-=360)}return[a,f,e]};goog.color.rgbArrayToHsv=function(a){return goog.color.rgbToHsv(a[0],a[1],a[2])};goog.color.hsvArrayToRgb=function(a){return goog.color.hsvToRgb(a[0],a[1],a[2])};goog.color.hexToHsl=function(a){a=goog.color.hexToRgb(a);return goog.color.rgbToHsl(a[0],a[1],a[2])};
goog.color.hslToHex=function(a,b,c){return goog.color.rgbArrayToHex(goog.color.hslToRgb(a,b,c))};goog.color.hslArrayToHex=function(a){return goog.color.rgbArrayToHex(goog.color.hslToRgb(a[0],a[1],a[2]))};goog.color.hexToHsv=function(a){return goog.color.rgbArrayToHsv(goog.color.hexToRgb(a))};goog.color.hsvToHex=function(a,b,c){return goog.color.rgbArrayToHex(goog.color.hsvToRgb(a,b,c))};goog.color.hsvArrayToHex=function(a){return goog.color.hsvToHex(a[0],a[1],a[2])};
goog.color.hslDistance=function(a,b){var c,e;c=.5>=a[2]?a[1]*a[2]:a[1]*(1-a[2]);e=.5>=b[2]?b[1]*b[2]:b[1]*(1-b[2]);return(a[2]-b[2])*(a[2]-b[2])+c*c+e*e-2*c*e*Math.cos(2*(a[0]/360-b[0]/360)*Math.PI)};goog.color.blend=function(a,b,c){c=goog.math.clamp(c,0,1);return[Math.round(c*a[0]+(1-c)*b[0]),Math.round(c*a[1]+(1-c)*b[1]),Math.round(c*a[2]+(1-c)*b[2])]};goog.color.darken=function(a,b){return goog.color.blend([0,0,0],a,b)};goog.color.lighten=function(a,b){return goog.color.blend([255,255,255],a,b)};
goog.color.highContrast=function(a,b){for(var c=[],e=0;e<b.length;e++)c.push({color:b[e],diff:goog.color.yiqBrightnessDiff_(b[e],a)+goog.color.colorDiff_(b[e],a)});c.sort(function(a,b){return b.diff-a.diff});return c[0].color};goog.color.yiqBrightness_=function(a){return Math.round((299*a[0]+587*a[1]+114*a[2])/1E3)};goog.color.yiqBrightnessDiff_=function(a,b){return Math.abs(goog.color.yiqBrightness_(a)-goog.color.yiqBrightness_(b))};
goog.color.colorDiff_=function(a,b){return Math.abs(a[0]-b[0])+Math.abs(a[1]-b[1])+Math.abs(a[2]-b[2])};bd.evaluator.ctr.blocks.color={};bd.evaluator.ctr.configs.color_picker={getParams:function(a){a=[];a.push({name:"color",type:"field",fieldName:"COLOR"});return a},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.color;bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};
bd.evaluator.ctr.configs.color_from_rgb_or_hsv={getParams:function(a){var b=[];"hsv"==a.mutation._rgb_or_hsv?(b.push({name:"hue",type:"value",valueName:"COLOR_NUM_1"}),b.push({name:"saturation",type:"value",valueName:"COLOR_NUM_2"}),b.push({name:"brightness",type:"value",valueName:"COLOR_NUM_3"})):"rgb"==a.mutation._rgb_or_hsv&&(b.push({name:"red",type:"value",valueName:"COLOR_NUM_1"}),b.push({name:"green",type:"value",valueName:"COLOR_NUM_2"}),b.push({name:"blue",type:"value",valueName:"COLOR_NUM_3"}));
return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();if("rgb"==a.mutation._rgb_or_hsv){var c=b.params.red,e=b.params.green,b=b.params.blue;try{var f=goog.color.rgbToHex(c,e,b)}catch(g){bd.errorLog.ctr.printError("Invalid color - returning black"),f="#000000"}bd.evaluator.ctr.returnHandler(f,a.returnsEntity)}else if("hsv"==a.mutation._rgb_or_hsv){f=b.params.hue;e=b.params.saturation/100;b=b.params.brightness/100*255;try{c=goog.color.hsvToHex(f,e,b)}catch(h){bd.errorLog.ctr.printError("Invalid color - returning black"),
c="#000000"}bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}}};bd.model={};bd.model.staticUrl="/static/";bd.model.currentGame=null;bd.model.emptyScript="<xml></xml>";bd.model.nullBlockString="nullObject";bd.model.getImagePath=function(){return bd.model.staticUrl+"images/buttons/"};bd.model.getUploadUrl=function(){var a=document.getElementById("uploadUrl").innerHTML;return""!=a?a:bd.model.staticUrl};
bd.model.populateModels=function(){bd.model.entitiesWithPlayerInstances=[{entityName:"pieceInstances",entityObject:bd.component.pieceInstance.constructor},{entityName:"phaserPieceInstances",entityObject:bd.component.phaserPieceInstance.constructor},{entityName:"phaserPhysicsPieceInstances",entityObject:bd.component.phaserPhysicsPieceInstance.constructor},{entityName:"physicsRectangleInstances",entityObject:bd.component.physicsRectangleInstance.constructor},{entityName:"targets",entityObject:bd.component.target.constructor},
{entityName:"labelInstances",entityObject:bd.component.labelInstance.constructor},{entityName:"videoInstances",entityObject:bd.component.videoInstance.constructor},{entityName:"textInputInstances",entityObject:bd.component.textInputInstance.constructor},{entityName:"richTextInputInstances",entityObject:bd.component.richTextInputInstance.constructor},{entityName:"spreadsheetTypes",entityObject:bd.model.SpreadsheetType},{entityName:"gridInstances",entityObject:bd.component.gridInstance.constructor},
{entityName:"tableInstances",entityObject:bd.component.tableInstance.constructor},{entityName:"timerInstances",entityObject:bd.component.timerInstance.constructor},{entityName:"tableGridInstances",entityObject:bd.component.tableGridInstance.constructor},{entityName:"mapInstances",entityObject:bd.component.mapInstance.constructor}]};bd.model.types=[{key:"value",name:"Value"},{key:"boolean",name:"Boolean"},{key:"color",name:"Color"},{key:"phaserPhysicsPiece"},{key:"label"},{key:"list",name:"List"}];
bd.model.typeKeyToTypeObject={};bd.model.entityChildNameToParentName={pieceInstance:"piece",physicsRectangleInstance:"physicsRectangle",target:"path",labelInstance:"label",videoInstance:"videoType",phaserPieceInstance:"phaserPiece",phaserPhysicsPieceInstance:"phaserPhysicsPiece"};bd.model.entityParentNameToChildName={};for(var i=0;i<bd.model.types.length;i++)bd.model.typeKeyToTypeObject[bd.model.types[i].key]=bd.model.types[i];
bd.model.getTypeNameFromModelTypeKey=function(a){var b=bd.model.typeKeyToTypeObject[a];return b.name?b.name:bd.component.typeNameToComponent[a].componentProperties.typeName};for(var childName in bd.model.entityChildNameToParentName)bd.model.entityParentNameToChildName[bd.model.entityChildNameToParentName[childName]]=childName;bd.model.getUrlFromUrlObject=function(a){return a.internal?bd.model.staticUrl+a.url:a.url};
bd.model.createNewEntity=function(a,b){if(bd.isServer||!bd.inPlayer)a.id=bd.model.getCurrentGame().nextId++;else if(null==bd.model.getPlayerId())if("player"==b)a.id=uuid.v4();else throw"Error: No player Id defined";else a.id=bd.model.getPlayerId()+"_"+bd.entityLookup[bd.model.getPlayerId()].nextId,bd.entityLookup[bd.model.getPlayerId()].nextId++;bd.inPlayer||bd.isServer||!bd.preview.ctr.creatingInstance&&!bd.preview.ctr.creatingPreviewPlayer?bd.entityLookup[a.id]=a:bd.preview.ctr.previewEntityLookup[a.id]=
a};bd.model.removeBlockReferrer=function(a,b,c,e){var f=bd.model.entityLookup(e).blockReferrers[a],g=f[b];if(null!=g)for(var h=0;h<g.length;h++)if(g[h]==c){g.splice(h,1);break}0==g.length&&delete f[b];b=!1;for(var k in f){b=!0;break}b||delete bd.model.entityLookup(e).blockReferrers[a]};
bd.model.addBlockReferrer=function(a,b,c,e){null==bd.model.entityLookup(e).blockReferrers[a]&&(bd.model.entityLookup(e).blockReferrers[a]={});a=bd.model.entityLookup(e).blockReferrers[a];null==a[b]&&(a[b]=[]);b=a[b];-1==b.indexOf(c)&&b.push(c)};bd.model.deleteBlockReferralHandler=function(a){var b=bd.script.ctr.getSelectedScriptPage().blockIdsToUsedEntities[a],c;for(c in b)bd.model.removeBlockReferrer(bd.script.ctr.getSelectedScriptPage().id,a,c,b[c]);delete bd.script.ctr.getSelectedScriptPage().blockIdsToUsedEntities[a]};
bd.model.switchEntityBlockIds=function(a,b){var c=bd.model.entityLookup(a),e={},f={},g;for(g in c.blockIdsToUsedEntities){var h=c.blockIdsToUsedEntities[g];f[b[g]]=h;for(var k in h){var l=bd.model.entityLookup(h[k]);if(null!=l&&null==e[l.id]){e[l.id]=!0;var m=l.blockReferrers[a],n={},q;for(q in m)n[b[q]]=m[q];l.blockReferrers[a]=n}}}c.blockIdsToUsedEntities=f};bd.model.modelUpdateElements=[];
bd.model.addModelUpdateElement=function(a,b,c,e,f){if("game"!=a&&0==a.length)return null;b={entityIds:a,property:c,value:e,playerId:bd.model.getPlayerId(),updateType:b,updateUIForOrigin:f.updateUIForOrigin,updateModelForOrigin:f.updateModelForOrigin,updateModelInEditor:f.updateModelInEditor,updateUIInEditor:f.updateUIInEditor};0==f.shouldPropagate&&(b.shouldPropagate=!1);if("game"==a)b.type=b.value.type;else{f=[];for(c=0;c<a.length;c++)bd.model.entityLookup(a[c])&&f.push(a[c]);0<f.length&&(b.type=
bd.model.entityLookup(f[0]).type);b.entityIds=f}0<b.entityIds.length&&bd.model.modelUpdateElements.push(b);return b};
bd.model.createPlayerFromRoleId=function(a,b){var c=new bd.component.player.constructor(null,bd.entityLookup[a],b);bd.inPlayer&&(bd.player.ctr.playerId=c.id);for(var e=bd.model.entitiesWithPlayerInstances,f=0;f<e.length;f++)for(var g=0;g<bd.model.getCurrentGame()[e[f].entityName].length;g++){var h=bd.model.getCurrentGame()[e[f].entityName][g];"perPlayer"==h.shareMode&&null==h.playerId&&new e[f].entityObject(null,h.parentId,h,c.id)}return c};
bd.model.addTraitsToEntities=function(a){for(var b=0;b<a.length;b++){var c=bd.model.entityLookup(a[b]);if(null==c.srcInstanceId)for(var e=bd.model.entityLookup(c.parentId),c=0;c<e.traitDefIds.length;c++)new bd.component.trait.constructor(null,e.traitDefIds[c],a[b]);else for(e=bd.model.entityLookup(c.srcInstanceId),c=0;c<e.traitIds.length;c++){var f=bd.model.entityLookup(e.traitIds[c]);new bd.component.trait.constructor(null,f.traitDefId,a[b],f.value)}}bd.model.sendUpdates()};
bd.model.sendUpdates=function(){bd.model.updateModel(bd.model.modelUpdateElements,bd.instanceId,!0);bd.model.modelUpdateElements=[];!bd.inPlayer&&bd.mobileConnect&&bd.mobileConnect.ctr.gameUpdatedHandler&&bd.mobileConnect.ctr.gameUpdatedHandler()};
bd.model.updateModel=function(a,b,c){if(!bd.isServer||bd.model.getCurrentGame()&&bd.model.getCurrentGame().initializingInstance){if(!bd.isServer&&!bd.player.ctr.inEditorPreview&&!bd.model.getCurrentGame().initializingInstance&&bd.model.getCurrentGame().multiplayer&&bd.inPlayer&&!bd.isSinglePlayer&&c){var e=bd.model.getModelUpdatesToPropagate(a);0!=e.length&&bd.socket.emit("clientGameUpdate",{method:"updateModel",modelUpdateArray:e,instanceId:b,propagate:!0})}if(!bd.isServer&&bd.player.ctr.inEditorPreview&&
c)for(var f in window.parent.bd.preview.ctr.playerIdToFrame)e=bd.model.getModelUpdatesToPropagate(a),0!=e.length&&window.parent.bd.preview.ctr.playerIdToFrame[f].contentWindow.bd.model.dispatchIncomingData({method:"updateModel",modelUpdateArray:e,instanceId:b,propagate:!1});for(;0!=a.length;)if(b=a.shift(),bd.model.getCurrentGame().initializingInstance||!bd.inPlayer||c||b.playerId!=bd.model.getPlayerId())if((bd.model.getCurrentGame().initializingInstance&&b.updateModelForOrigin||!bd.inPlayer&&!bd.isServer&&
!bd.preview.ctr.creatingInstance&&b.updateModelInEditor||!bd.inPlayer&&!bd.isServer&&bd.preview.ctr.creatingInstance&&b.updateModelForOrigin||bd.inPlayer&&!bd.isServer&&(!c&&!bd.player.ctr.inEditorPreview||c&&b.updateModelForOrigin))&&bd.model.updateModelFromModelElement(b),!bd.isServer&&(!bd.inPlayer&&!bd.preview.ctr.creatingInstance&&b.updateUIInEditor||bd.inPlayer&&!bd.model.getCurrentGame().initializingInstance&&(!c||c&&b.updateUIForOrigin)))if("game"==b.entityIds){if("addEntity"==b.updateType){for(var g=
JSON.parse(b.value),e=0;e<bd.model.getCurrentGame()[g.type+"s"].length;e++)bd.model.getCurrentGame()[g.type+"s"][e].id==g.id&&(bd.inPlayer||bd.isServer||!bd.preview.ctr.creatingInstance&&!bd.preview.ctr.creatingPreviewPlayer?(bd.entityLookup[g.id]=bd.model.getCurrentGame()[g.type+"s"][e],new bd.component.typeNameToComponent[g.type].constructor(bd.model.getCurrentGame()[g.type+"s"][e])):bd.preview.ctr.previewEntityLookup[g.id]=bd.model.getCurrentGame()[g.type+"s"][e]);f=!1;f=bd.component.lookup(g.id);
if(null!=f.model.viewId){var h=bd.component.lookup(f.model.viewId);f=h.isInitialized||!bd.inPlayer&&h.isKineticJSView?!0:!1}else f=!0;f&&bd.component.handleCommand(bd.component.lookup(g.id),b)}}else for(g=b.entityIds,e=0;e<g.length;e++){var k={};k.entityId=g[e];k.property=b.property;k.updateType=b.updateType;k.value=b.value;f=bd.component.lookup(k.entityId);null!=f.model.viewId&&"player"!=f.model.type?h=bd.component.lookup(f.model.viewId):f.isView&&(h=f);(f=null!=h?h.isInitialized||!bd.inPlayer&&
h.isKineticJSView?!0:!1:!0)&&bd.component.handleCommand(bd.component.lookup(k.entityId),k)}}else console.log("should send a message to sockets"),bd.gameProvider.addModelUpdateToQueue(a,b)};bd.model.getModelUpdatesToPropagate=function(a){for(var b=[],c=0;c<a.length;c++){var e=a[c];null!=e.shouldPropagate&&!e.shouldPropagate||"game"!=e.entityIds&&"local"==bd.model.entityLookup(e.entityIds[0]).shareMode||b.push(e)}return b};
bd.model.updateModelFromModelElement=function(a){if("game"==a.entityIds)switch(a.updateType){case "addEntity":var b=JSON.parse(a.value);bd.model.getCurrentGame()[a.property].push(b);bd.inPlayer||bd.isServer||!bd.preview.ctr.creatingInstance&&!bd.preview.ctr.creatingPreviewPlayer?bd.entityLookup[b.id]=b:bd.preview.ctr.previewEntityLookup[b.id]=b;break;case "deleteEntity":b=a.value;a=bd.model.getCurrentGame()[a.property];for(var c=0;c<a.length;c++)a[c].id==b&&a.splice(c,1)}else for(c=0;c<a.entityIds.length;c++)switch(b=
a.entityIds[c],a.updateType){case "push":bd.model.entityLookup(b)[a.property].push(a.value);break;case "dictionary":bd.model.entityLookup(b)[a.property][a.value.key]=a.value.value;break;case "change":bd.model.entityLookup(b)[a.property]=parseFloat(bd.model.entityLookup(b)[a.property])+parseFloat(a.value);break;case "set":bd.model.entityLookup(b)[a.property]=a.value;break;case "removeValue":var e=bd.model.entityLookup(b)[a.property].indexOf(a.value);-1!=e&&bd.model.entityLookup(b)[a.property].splice(e,
1);break;case "removeIndex":bd.model.entityLookup(b)[a.property].splice(a.value,1)}};bd.model.deleteUnusedAsset=function(a,b){var c=!1;console.log("costumes array"+a.costumes);for(var e=0;e<a.costumes.length;e++)console.log("costumes object"+a.costumes[e]),a.costumes[e].assetId==b&&(c=!0);if(!c)for(e=0;e<a.assets.length;e++)a.assets[e].id==b&&a.assets.splice(e,1)};
bd.model.addPieceToTarget=function(a,b){var c=null;null!=b&&(c=bd.model.getCurrentGame().targets[b].id);if(bd.entityLookup[a].targetId!=c){var e=bd.entityLookup[a].targetId;bd.entityLookup[a].targetId=c;if(null!=e)for(var f=0;f<bd.entityLookup[e].instanceIds.length;f++)if(bd.entityLookup[e].instanceIds[f]==a){bd.entityLookup[e].instanceIds.splice(f,1);break}null!=c&&bd.entityLookup[c].instanceIds.push(a)}};
bd.model.entityLookup=function(a){return bd.inPlayer||bd.isServer||!bd.preview.ctr.creatingInstance&&!bd.preview.ctr.creatingPreviewPlayer?bd.entityLookup[a]:bd.preview.ctr.previewEntityLookup[a]};bd.model.addEntityToLookup=function(a,b){bd.inPlayer||bd.isServer||!bd.preview.ctr.creatingInstance&&!bd.preview.ctr.creatingPreviewPlayer?bd.entityLookup[a]=b:bd.preview.ctr.previewEntityLookup[a]=b};
bd.model.populateEntityLookup=function(){for(var a in bd.component.typeNameToComponent){var b=bd.component.typeNameToComponent[a];if(b.constructor){bd.model.getCurrentGame()[b.componentProperties.listName]||(bd.model.getCurrentGame()[b.componentProperties.listName]=[]);for(var c=0;c<bd.model.getCurrentGame()[b.componentProperties.listName].length;c++)new b.constructor(bd.model.getCurrentGame()[b.componentProperties.listName][c])}}};
bd.model.startGame=function(a,b,c){console.log("in bd.model.startGame");if(bd.isServer)bd.model.sendMessageToGameSockets("serverGameUpdate",{method:"startGame",instanceId:a,userId:b,propagate:!1}),bd.gameProvider.startGame(a,b,c,bd.gameProvider,function(a,b){});else if(bd.inPlayer&&c&&!bd.isSinglePlayer&&!bd.player.ctr.inEditorPreview&&(console.log("sending clientGameUpdate"),bd.socket.emit("clientGameUpdate",{method:"startGame",instanceId:a,userId:b,propagate:!0})),!bd.inPlayer||c||!c&&b!=bd.model.getPlayerId()&&
!bd.player.ctr.inEditorPreview)bd.model.getCurrentGame().started=!0};bd.model.getCurrentViewId=function(){return bd.inPlayer?bd.entityLookup[bd.player.ctr.playerId].viewId:bd.editorSettings.currentViewId};bd.model.getStageIds=function(){for(var a,b,c=[],e=0;e<bd.component.viewTypes.length;e++){a=bd.component.viewTypes[e];a=bd.component.typeNameToComponent[a].componentProperties.listName;for(var f=0;f<bd.model.getCurrentGame()[a].length;f++)b=bd.model.getCurrentGame()[a][f],c.push(b.id)}return c};
bd.model.getPropertyList=function(a,b,c){var e=[];a=bd.component.getComponentByType(a);if(!a.propertyNameToObject||!a.getProperties)return e;for(var f=a.getProperties(),g,h=0,k;k=f[h];h++)a.propertyNameToObject[k.name]&&(g=a.propertyNameToObject[k.name],(!g.blockRead&&null!=g.blockRead||"read"!=b)&&(!g.blockWrite&&null!=g.blockWrite||"write"!=b)||c&&!g.isNumber||e.push([bd.model.getPropertyMessageName(k.name,"block"),"property:"+k.name]));return e};
bd.model.getPropertyMessageName=function(a,b){return bd.msg["PROPERTY_"+a]?bd.msg["PROPERTY_"+a]:"block"==b&&bd.msg["PROPERTY_"+a+"_BLOCK"]?bd.msg["PROPERTY_"+a+"_BLOCK"]:"editor"==b&&bd.msg["PROPERTY_"+a+"_EDITOR"]?bd.msg["PROPERTY_"+a+"_EDITOR"]:""};bd.model.getPlayerId=function(){return bd.inPlayer?bd.player.ctr.playerId:null};bd.model.getCurrentGameAssets=function(){for(var a=[],b=0;b<bd.component.assetTypes.length;b++)a=a.concat(bd.model.getEntityList(bd.component.assetTypes[b]));return a};
bd.model.getSoundAssetOptions=function(){for(var a=[],b=0,c;c=bd.model.getEntityList("sound")[0].assetSoundIds[b];b++)a.push([bd.model.entityLookup(c).assetLabel,"id:"+c]);0==a.length&&(a=[[" ",bd.blocks.ctr.emptyFieldBox]]);return a};bd.model.getAssetIdByIdentifier=function(a,b){for(var c=bd.model.getEntityList(a),e=bd.component.typeNameToComponent[a].componentProperties.identifierProperty,f=0;f<c.length;f++)if(c[f][e]==b)return c[f].id;return null};
bd.model.getEntityList=function(a){a=bd.component.typeNameToComponent[a].componentProperties.listName;return bd.model.getCurrentGame()[a]};bd.model.getGameInfo=function(){return bd.model.getEntityList(bd.component.gameInfo.componentProperties.type)[0]};bd.model.isMultiplayer=function(){return bd.model.getGameInfo().isMultiplayer};bd.model.isMultiplayerGame=function(){return bd.model.getGameInfo().isMultiplayerGame};bd.model.getSinglePlayerId=function(){return bd.model.getEntityList("player")[0].id};
bd.model.getInstanceType=function(a){return bd.component.parentNameToChildName[a]||a};bd.model.isInstance=function(a){a=bd.model.entityLookup(a);return null!=bd.component.childNameToParentName[a.type]};bd.model.getClassId=function(a){var b=bd.component.lookup(a);return bd.component.childNameToParentName[b.type]?b.model.parentId:a};
bd.model.getAllEvaluatorBlocks=function(){for(var a=bd.model.getEntityList("scriptPage"),b,c=[],e=0;e<a.length;e++){b=a[e];b=bd.util.convertToArray(b.scriptObject.xml.block);for(var f,g=0;g<b.length;g++)f=bd.model.getAllBlocksInGroup(b[g]),c=c.concat(f)}return c};
bd.model.getAllBlocksInGroup=function(a){if(!a)return[];var b;b=a.block?a.block:a;a=[b].concat(bd.model.getAllBlocksInGroup(b.next));var c=bd.util.convertToArray(b.value),c=c.concat(bd.util.convertToArray(b.statement));for(b=0;b<c.length;b++)a=a.concat(bd.model.getAllBlocksInGroup(c[b]));return a};
bd.model.sendMessageToGameSockets=function(a,b){console.log("data.instanceId: "+b.instanceId);console.log("length of gametousersockets: "+bd.gameToUserSockets[b.instanceId].length);for(var c=0;c<bd.gameToUserSockets[b.instanceId].length;c++)bd.gameToUserSockets[b.instanceId][c].emit(a,b)};
bd.model.setSpreadsheetList=function(a,b,c){function e(){f.getListData(a.spreadsheetTypes[g].spreadsheetKey,function(b){console.log(JSON.stringify(b));for(var f=0;f<a.spreadsheetTypes[g].traitDefIds.length;f++){var l=bd.entityLookup[a.spreadsheetTypes[g].traitDefIds[f]];b[l.name]&&(l.value=b[l.name].list)}g++;g==a.spreadsheetTypes.length?c(a):e()})}var f=require("../../../../../../node/gst").gss,g=0;a.spreadsheetTypes||(a.spreadsheetTypes=[]);0==a.spreadsheetTypes.length?c(a,b):e()};
bd.model.setTemplateArrayValues=function(a,b){for(var c=0;c<b.length;c++){var e=b[c];if("image"==e.type){var f=bd.entityLookup[e.entityId],g=f.assetId,e=new bd.model.Asset({url:e.value,internal:e.internal});f.assetId=e.id;bd.model.deleteUnusedAsset(a,g)}}};
bd.model.convertGameToInstance=function(a,b,c){bd.model.currentInstance=a;bd.model.getCurrentGame().initializingInstance=!0;bd.entityLookup={};bd.component.initializeComponents();bd.model.populateModels();bd.model.populateEntityLookup();bd.model.convertGameToInstanceAfterSpeadsheet(a,c)};
bd.model.convertGameToInstanceAfterSpeadsheet=function(a,b){bd.model.currentInstance=a;for(var c=[{idListName:"targetIds",listName:"targets",type:bd.model.Target},{idListName:"pieceInstanceIds",listName:"pieceInstances",type:bd.component.pieceInstance.constructor},{idListName:"labelInstanceIds",listName:"labelInstances",type:bd.component.labelInstance.constructor}],e=0;e<bd.model.getCurrentGame().gameViews.length;e++)if("player"==bd.model.getCurrentGame().gameViews[e].propType){new bd.model.GameViewInstance(bd.model.getCurrentGame().gameViews[e].id);
for(var f=0;f<c.length;f++)for(var g=bd.model.getCurrentGame().gameViews[e][c[f].idListName],h=0;h<g.length;h++){var k=new c[f].type(bd.entityLookup[g[h]].parentId),l=bd.util.createNewObject(g[h]);l.id=k.id;for(var k=bd.model.getCurrentGame()[c[f].listName],m=0;m<k.length;m++)k[m].id==l.id&&(k[m]=l)}}e=bd.model.getEntityList("assetRichText");f={};for(h=0;h<e.length;h++)for(m=e[h],k=m.id,m=bd.methodTag.richTextInput.getVariablesInText(m.richText),c=0;c<m.length;c++)g=m[c],f[g]||(f[g]=[]),f[g].push(k);
bd.model.getCurrentGame().gameInfos.richTextVariablesToAssets=f;k=bd.model.getEntityList("playerInstance").concat(bd.model.getEntityList("player"));if(0!=k.length)for(m=bd.model.entitiesWithPlayerInstances,e=0;e<m.length;e++)for(f=0;f<bd.model.getCurrentGame()[m[e].entityName].length;f++)if(c=bd.model.getCurrentGame()[m[e].entityName][f],("perPlayer"==c.shareMode||"local"==c.shareMode)&&null==c.playerId)for(h=0;h<k.length;h++)new m[e].entityObject(null,c.parentId,c,k[h].id);bd.model.sendUpdates();
for(e=0;e<bd.model.getCurrentGame().gridInstances.length;e++)null==bd.model.getCurrentGame().gridInstances[e].playerId&&"share"!=bd.model.getCurrentGame().gridInstances[e].shareMode||bd.component.lookup(bd.model.getCurrentGame().gridInstances[e].id).createTileObjects();for(e=0;e<bd.model.getCurrentGame().targets.length;e++)if(h=bd.model.getCurrentGame().targets[e],null==h.playerId)for(f=0;f<h.pieceInstanceIds.length;f++)if(k=bd.model.entityLookup(h.pieceInstanceIds[f]),k.entityPerPlayer&&null==k.playerId)if(h.entityPerPlayer)for(var n in k.playerIdsToChildInstanceIds)bd.model.addModelUpdateElement([h.playerIdsToChildInstanceIds[n]],
"push","pieceInstanceIds",k.playerIdsToChildInstanceIds[n],{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1}),bd.model.addModelUpdateElement([k.playerIdsToChildInstanceIds[n]],"set","targetId",h.playerIdsToChildInstanceIds[n],{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});else for(n in k.playerIdsToChildInstanceIds)bd.model.addModelUpdateElement([h.id],"push","pieceInstanceIds",k.playerIdsToChildInstanceIds[n],{updateUIForOrigin:!1,
updateModelForOrigin:!0,updateModelInEditor:!0,updateUIInEditor:!1});n=bd.model.getCurrentGame().tableInstances.concat(bd.model.getCurrentGame().tableGridInstances);for(e=0;e<n.length;e++)if(null==n[e].playerId)for(var q in n[e].playerIdsToChildInstanceIds){h=bd.component.lookup(n[e].playerIdsToChildInstanceIds[q]);k=h.id;m=n[e].editorRowData;c=[];for(l=0;l<m.length;l++){for(var p=!0,g=[],f=0;f<m[l].length;f++)""!=m[l][f]&&null!=m[l][f]&&"undefined"!=typeof m[l][f]?(p=!1,g.push({value:m[l][f]})):
g.push({value:""});p&&l==m.length-1||(f=new bd.component.tableRow.constructor(null,k,m[l]),c.push({id:f.id,data:g}))}h.model.playerRowData=c}bd.model.sendUpdates();q=[{listName:"gameInfos",childIdField:null},{listName:"pieces",childIdField:"instanceIds"},{listName:"physicsRectangles",childIdField:"instanceIds"},{listName:"players",childIdField:null},{listName:"paths",childIdField:"instanceIds"},{listName:"labels",childIdField:"instanceIds"},{listName:"textInputs",childIdField:"instanceIds"},{listName:"phaserPieces",
childIdField:"instanceIds"},{listName:"phaserPhysicsPieces",childIdField:"instanceIds"},{listName:"spreadsheetTypes",childIdField:null}];for(e=0;e<q.length;e++)for(k=bd.model.getCurrentGame()[q[e].listName],f=0;f<k.length;f++)for(n=[],n=null==q[e].childIdField?[k[f].id]:k[f][q[e].childIdField],h=0;h<n.length;h++)for(c=k[f].traitDefIds,m=0;m<c.length;m++)new bd.component.trait.constructor(null,c[m],n[h]);bd.model.sendUpdates();bd.model.getCurrentGame().initializingInstance=!1;b(bd.model.getCurrentGame())};
bd.model.getCurrentGame=function(){return bd.isServer||bd.inPlayer||bd.preview&&bd.preview.ctr&&(bd.preview.ctr.creatingInstance||bd.preview.ctr.creatingPreviewPlayer)?bd.model.currentInstance:bd.model.currentGame};bd.model.dispatchIncomingData=function(a){switch(a.method){case "startGame":bd.model.startGame(a.instanceId,a.userId,a.propagate);break;case "updateModel":bd.model.updateModel(a.modelUpdateArray,a.instanceId,a.propagate)}};bd.evaluator.ctr.blocks.direction={};
bd.evaluator.ctr.configs.direction={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];if(bd.model.entityLookup(b)){var c=bd.component.lookup(b);"local"==c.model.shareMode?bd.evaluator.ctr.returnHandler(c.getLocalDirection(),a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.model.entityLookup(b).direction,a.returnsEntity)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,
a.returnsEntity)}};
bd.evaluator.ctr.configs.phaser_set_change_angular_velocity={paramsInfo:[{name:"setOrChange",type:"field",fieldName:"SET_OR_CHANGE"},{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"velocity",type:"value",valueName:"VELOCITY"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.velocity,b=b.params.setOrChange.toLowerCase(),c=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c).localEntityIds,f=0;f<c.length;f++)"set"==b?bd.component.lookup(c[f]).localSetAngularVelocity(e):
bd.component.lookup(c[f]).localChangeAngularVelocity(e);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.phaser_change_angular_velocity={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"velocity",type:"value",valueName:"VELOCITY"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.velocity,b=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b.params.entityIdArray).localEntityIds,e=0;e<b.length;e++)bd.component.lookup(b[e]).localChangeAngularVelocity(c);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.point_toward_entity={paramsInfo:[{name:"entityIdArray1",type:"entity",fieldName:"ENTITY1"},{name:"entityIdArray2",type:"entity",fieldName:"ENTITY2"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray2[0],e=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b.params.entityIdArray1),b=e.propagatedEntityIds,e=e.localEntityIds,f=0;f<b.length;f++){var g=bd.evaluator.ctr.entityIdTextToAngle(b[f],c);bd.model.addModelUpdateElement([b[f]],
"set","direction",g,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1})}bd.model.sendUpdates();for(f=0;f<e.length;f++)g=bd.evaluator.ctr.entityIdTextToAngle(e[f],c),bd.component.lookup(e[f]).localDirection(g,"set");bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.change_direction={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"direction",type:"value",valueName:"DIRECTION"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.direction,e=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b.params.entityIdArray),b=e.localEntityIds;bd.model.addModelUpdateElement(e.propagatedEntityIds,"change","direction",c,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});
bd.model.sendUpdates();for(e=0;e<b.length;e++)bd.component.lookup(b[e]).localDirection(c,"change");bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.point_in_direction={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"direction",type:"value",valueName:"DIRECTION"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.direction,e=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b.params.entityIdArray),b=e.localEntityIds;bd.model.addModelUpdateElement(e.propagatedEntityIds,"set","direction",c,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});
bd.model.sendUpdates();for(e=0;e<b.length;e++)bd.component.lookup(b[e]).localDirection(c,"set");bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.get_angular_velocity={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray;bd.model.entityLookup(b[0])?bd.evaluator.ctr.returnHandler(bd.component.lookup(b[0]).localGetAngularVelocity(),a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity))}};bd.errorLog={};bd.errorLog.ctr={};var count=0;
bd.errorLog.ctr.printError=function(a,b){"undefined"==typeof b&&(b=[]);for(var c=0;c<b.length;c++){var e=a.split("%"+(c+1));e.splice(1,0,b[c]);a=e.join("")}c=window.parent.document.getElementById("playerConsoleTable");if(null!=c){0==count&&c.appendChild(document.createElement("tbody"+count));e=c.getElementsByTagName("tbody"+count)[0];if(50<=e.children.length&&(count+=1,c.appendChild(document.createElement("tbody"+count)),1<count)){var f=c.getElementsByTagName("tbody"+(count-2))[0];c.removeChild(f)}c=
e.appendChild(document.createElement("TR"));e=c.insertCell(0);f=goog.html.SafeHtml.htmlEscape(a);f=goog.html.SafeHtml.unwrap(f);e.innerHTML=f;c.scrollIntoView({block:"end",behavior:"smooth"})}};bd.evaluator.ctr.blocks.debug={};
bd.evaluator.ctr.configs.console_log={getParams:function(a){var b=[];b.push({name:"consoleText",type:"value",valueName:"VALUE"});a.mutation&&"true"==a.mutation._has_name&&b.push({name:"consoleTextName",type:"value",valueName:"NAME"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=String(b.params.consoleText);void 0!==b.params.consoleTextName?(b=b.params.consoleTextName,bd.errorLog.ctr.printError(bd.msg.DEBUG_PRINT_NAMED,[c,b])):bd.errorLog.ctr.printError(bd.msg.DEBUG_PRINT_UNNAMED,[c]);
bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.blocks.speech={};
bd.evaluator.ctr.configs.text_to_speech_language={paramsInfo:[{name:"language",type:"field",fieldName:"LANGUAGE"},{name:"text",type:"value",valueName:"TEXT"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.language,e=b.params.text;if(b.hasSpoken)b.hasSpoken=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next);else if(b.hasSpoken=!0,bd.player.ctr.isCordova){var f=function(){};a.mutation&&"1"==a.mutation._should_wait&&(f=function(a){return function(){bd.evaluator.ctr.stackIdsForNextTick.push(a)}}(bd.evaluator.ctr.getCurrentCallStack().id));TTS.speak({text:e,
locale:c},f,f);a.mutation&&"1"==a.mutation._should_wait?(bd.evaluator.ctr.currentCallStackId=null,bd.evaluator.ctr.continuePreviousStack()):(b.hasSpoken=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next))}else!bd.evaluator.ctr.isSpeaking&&"speechSynthesis"in window?(e=new SpeechSynthesisUtterance(e),e.lang=c,bd.evaluator.ctr.isSpeaking=!0,window.speechSynthesis.speak(e),a.mutation&&"1"==a.mutation._should_wait?(e.onend=function(a){return function(b){bd.evaluator.ctr.isSpeaking=!1;bd.evaluator.ctr.stackIdsForNextTick.push(a)}}(bd.evaluator.ctr.getCurrentCallStack().id),
bd.evaluator.ctr.currentCallStackId=null,bd.evaluator.ctr.continuePreviousStack()):(e.onend=function(a){bd.evaluator.ctr.isSpeaking=!1},b.hasSpoken=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next))):(b.hasSpoken=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next))}};bd.evaluator.ctr.blocks.movement={};
bd.evaluator.ctr.configs.move_to_x_y={getParams:function(a){var b=[];b.push({name:"entityIdArray",type:"entity",fieldName:"ENTITY"});a.mutation&&"true"==a.mutation._has_stage_field&&b.push({name:"layerIdArray",type:"entity",fieldName:"LAYER"});b.push({name:"xValue",type:"value",valueName:"X"});b.push({name:"yValue",type:"value",valueName:"Y"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.xValue,f=b.params.yValue,g=null;b.params.layerIdArray&&
(g=b.params.layerIdArray[0]);for(var b=0,h;h=c[b];b++)bd.component.lookup(h).moveToLayerXY(g,e,f);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.move_steps={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"steps",type:"value",valueName:"STEPS"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.steps,e=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b.params.entityIdArray),b=e.propagatedEntityIds,e=e.localEntityIds,f,g=0;g<b.length;g++){f=bd.component.lookup(b[g]);var h=f.getXOrY("x")+c*Math.cos(Math.PI/180*f.getDirection());f=f.getXOrY("y")+c*Math.sin(Math.PI/
180*f.getDirection());bd.model.addModelUpdateElement([b[g]],"set","x",h,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.addModelUpdateElement([b[g]],"set","y",f,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1})}bd.model.sendUpdates();for(g=0;g<e.length;g++)f=bd.component.lookup(e[g]),h=f.getXOrY("x")+c*Math.cos(Math.PI/180*f.getDirection()),f=f.getXOrY("y")+c*Math.sin(Math.PI/180*f.getDirection()),bd.component.lookup(e[g]).localMoveToXY(h,
f);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.set_x={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"val",type:"value",valueName:"VALUE"},{name:"xOrY",type:"field",fieldName:"XY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.val,e=b.params.xOrY,f=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b.params.entityIdArray),b=f.localEntityIds;bd.model.addModelUpdateElement(f.propagatedEntityIds,"set",e,c,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,
updateUIInEditor:!1});bd.model.sendUpdates();for(f=0;f<b.length;f++)bd.component.lookup(b[f]).localSetXY(e,c);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.set_change_x={paramsInfo:[{name:"setOrChange",type:"field",fieldName:"SET_OR_CHANGE"},{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"val",type:"value",valueName:"VALUE"},{name:"xOrY",type:"field",fieldName:"XY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.val,f=b.params.xOrY,b=b.params.setOrChange.toLowerCase(),g=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c),c=g.localEntityIds;bd.model.addModelUpdateElement(g.propagatedEntityIds,
b,f,e,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();for(g=0;g<c.length;g++)"set"==b?bd.component.lookup(c[g]).localSetXY(f,e):bd.component.lookup(c[g]).localChangeXY(f,e);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.xy_of_entity={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"xOrY",type:"field",fieldName:"XY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray[0];if(bd.util.containsPrefix(c,"pointer:")){var c=bd.phaser.ctr.entityTextToPointerObject(c),b=b.params.xOrY,e="nullObject";c&&(e="x"==b?c.clientX:c.clientY);bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}else bd.model.entityLookup(c)?(b=b.params.xOrY,e=bd.component.lookup(c),
"local"==e.model.shareMode?bd.evaluator.ctr.returnHandler(e.getLocalXY(b),a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.model.entityLookup(c)[b],a.returnsEntity)):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity))}};
bd.evaluator.ctr.configs.get_pass_through={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.model.entityLookup(b)?bd.evaluator.ctr.returnHandler(bd.model.entityLookup(b).passthrough,a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(!1,a.returnsEntity))}};
bd.evaluator.ctr.configs.get_can_move={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.evaluator.ctr.returnHandler(bd.model.entityLookup(b).movable,a.returnsEntity)}};
bd.evaluator.ctr.configs.can_be_dragged={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.model.entityLookup(b)?bd.evaluator.ctr.returnHandler(bd.entityLookup[b].draggable,a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(!1,a.returnsEntity))}};
bd.evaluator.ctr.configs.set_can_move={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"val",type:"value",valueName:"x"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","movable",b.params.val,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.set_pass_through={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"val",type:"value",valueName:"x"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","passthrough",b.params.val,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.phaser_set_change_speed={paramsInfo:[{name:"setOrChange",type:"field",fieldName:"SET_OR_CHANGE"},{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"speed",type:"value",valueName:"SPEED"},{name:"pointingOrMoving",type:"field",fieldName:"POINTING_OR_MOVING"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.speed,f=b.params.pointingOrMoving,b=b.params.setOrChange.toLowerCase(),c=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c).localEntityIds,
g=0;g<c.length;g++)bd.component.lookup(c[g]).localSetSpeed(b,e,f);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.phaser_set_change_speed_at_angle={paramsInfo:[{name:"setOrChange",type:"field",fieldName:"SET_OR_CHANGE"},{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"speed",type:"value",valueName:"SPEED"},{name:"angle",type:"value",valueName:"ANGLE"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.speed,f=b.params.angle,b=b.params.setOrChange.toLowerCase(),c=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c).localEntityIds,
g=0;g<c.length;g++)bd.component.lookup(c[g]).localSetSpeedAtAngle(b,e,f);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.set_drag={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"draggable",type:"value",valueName:"DRAG"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","draggable",b.params.draggable,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.phaser_set_change_velocity={paramsInfo:[{name:"setOrChange",type:"field",fieldName:"SET_OR_CHANGE"},{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"velocity",type:"value",valueName:"VELOCITY"},{name:"xOrY",type:"field",fieldName:"XY"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.xOrY,f=b.params.velocity,b=b.params.setOrChange.toLowerCase(),c=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c).localEntityIds,
g=0;g<c.length;g++)bd.component.lookup(c[g]).localSetXYSpeed(e,f,b);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.xy_speed={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"xOrY",type:"field",fieldName:"XY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,b=b.params.xOrY;bd.model.entityLookup(c[0])?bd.evaluator.ctr.returnHandler(bd.component.lookup(c[0]).localGetXYSpeed(b),a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity))}};
bd.evaluator.ctr.configs.get_speed={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray;bd.model.entityLookup(b[0])?bd.evaluator.ctr.returnHandler(bd.component.lookup(b[0]).localGetSpeed(),a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity))}};bd.evaluator.ctr.blocks.procedures={};
bd.evaluator.ctr.configs.procedures_call={getParams:function(a){for(var b=[],c=JSON.parse(a.mutation._parameter_objects),e=0,f;f=c[e];e++)b.push({name:f.name,type:"value",valueName:"CALL"+e});b.push({name:"callName",type:"field",fieldName:"PROCEDURE"});"true"==a.mutation._call_for_players?b.push({name:"callPlayer",type:"field",fieldName:"CALL_PLAYER"}):"block"==a.mutation._call_for_players&&b.push({name:"playerIdInput",type:"value",valueName:"PLAYER_INPUT"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),
c=bd.evaluator.ctr.getCurrentCallStack(),e=b.params.callName,f={};if(b.hasBeenEvaluated)b.hasBeenEvaluated=!1,"true"==a.mutation._should_return?bd.evaluator.ctr.returnHandler("undefined"===typeof b.returnValue?"nullObject":b.returnValue,a.returnsEntity):bd.evaluator.ctr.nextBlockInCallStack(a.next);else{b.hasBeenEvaluated=!0;for(var g=JSON.parse(a.mutation._parameter_objects),h=0;h<g.length;h++)bd.util.containsPrefix(g[h].type,"type")&&"value"==bd.util.removePrefix(g[h].type,"type")?f[g[h].name]=
{type:"value",value:b.params[g[h].name]}:f[g[h].name]=b.params[g[h].name];if(g=bd.evaluator.ctr.findMatchingTopLevelBlocks("procedures_def",[{titleName:"PROCEDURE",value:e}])[0]){if("thread"==a.mutation._call_type||null==a.mutation._call_type)a=new bd.stack.ctr.callStack,a.createStackObjectAndAddToStack(g,f),bd.evaluator.ctr.stackIdsForThisTick.splice(0,0,c.id),bd.evaluator.ctr.currentCallStackId=a.id;else if(h=!0,e=JSON.stringify({type:"procedure_call",name:e,context:f}),"true"==a.mutation._call_for_players?
("ALL_PLAYERS_NO_CALLER"==b.params.callPlayer&&(h=!1),"ALL_PLAYERS_NO_CALLER"!=b.params.callPlayer&&"ALL_PLAYERS"!=b.params.callPlayer||bd.racer.ctr.sendMessageToPlayers(e,!0),bd.util.containsPrefix(b.params.callPlayer,"id:")&&(h=bd.util.removePrefix(b.params.callPlayer,"id"),bd.player.ctr.playerId==h?h=!0:(bd.racer.ctr.sendMessageToPlayers(e,!1,h),h=!1))):"block"==a.mutation._call_for_players&&(h=b.params.playerIdInput,bd.player.ctr.playerId==h?h=!0:(bd.racer.ctr.sendMessageToPlayers(e,!1,h),h=!1)),
h)c.createStackObjectAndAddToStack(g,f);else{b.hasBeenEvaluated=!1;bd.evaluator.ctr.nextBlockInCallStack(a.next);return}bd.evaluator.ctr.evaluateStack()}else bd.evaluator.ctr.nextBlockInCallStack(a.next)}}};
bd.evaluator.ctr.configs.procedures_return={getParams:function(a){var b=[];1==a.mutation._returns_value&&b.push({name:"val",type:"value",valueName:"VALUE"});return b},evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject().params.val,c=bd.evaluator.ctr.getCurrentCallStack().stackArray,e=null,f=0;f<c.length;f++)if("procedures_def"==c[c.length-1-f].block._type){e=c.length-1-f+1;break}null!=e?(c.splice(e,c.length),c=c[c.length-2],void 0!=c&&("procedures_call"==c.block._type&&"statement"==
c.block.mutation._call_type&&"true"==c.block.mutation._should_return?1==a.mutation._returns_value&&(c.returnValue=null==b?"nullObject":b):(c.returnValue=bd.model.nullBlockString,"false"==c.block.mutation._should_return&&bd.errorLog.ctr.printError(bd.msg.ERROR_NO_RETURN))),bd.evaluator.ctr.evaluateStack()):(bd.errorLog.ctr.printError(bd.msg.ERROR_NOT_IN_PROCEDURE),bd.evaluator.ctr.nextBlockInCallStack(a.next))}};
bd.evaluator.ctr.blocks.procedures.callProcedureFromMessage=function(a,b){var c=bd.evaluator.ctr.findMatchingTopLevelBlocks("procedures_def",[{titleIndex:1,value:a}])[0];if(c){var e=new bd.stack.ctr.callStack;e.createStackObjectAndAddToStack(c,b);bd.evaluator.ctr.stackIdsForNextTick.push(e.id)}};bd.evaluator.ctr.configs.animation_call=bd.evaluator.ctr.configs.procedures_call;bd.evaluator.ctr.blocks.components={};
bd.evaluator.ctr.configs.clone_to_xy={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"layerIdArray",type:"entity",fieldName:"LAYER"},{name:"xValue",type:"value",valueName:"X"},{name:"yValue",type:"value",valueName:"Y"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=[],e=!1,f=b.params.entityIdArray[0],g=bd.model.entityLookup(f);if(g){if(null!=bd.model.entityParentNameToChildName[g.type]){var e=!0,h=bd.component.typeNameToComponent[bd.model.entityParentNameToChildName[g.type]].constructor;if("perPlayer"==
g.shareMode)for(var k=bd.evaluator.ctr.entityTitleToEntityIdArray("ENTITY_PLAYER",a),g=0;g<k.length;g++){var l=new h(null,f,null,k[g],k[g]);c.push(l.id)}else"local"==g.shareMode?(l=new h(null,f,null,bd.player.ctr.playerId,bd.player.ctr.playerId),c.push(l.id)):"share"==g.shareMode&&(l=new h(null,f,null,null,null),c.push(l.id))}if(!e)for(e=b.params.entityIdArray,g=0;g<e.length;g++)f=e[g],f=bd.model.entityLookup(f),h=bd.component.typeNameToComponent[f.type].constructor,l="perPlayer"==f.shareMode||"local"==
f.shareMode?new h(null,f.parentId,f,f.playerId,f.visibleToPlayerId):new h(null,f.parentId,f,null,null),c.push(l.id);var m;b.params.layerIdArray&&(m=b.params.layerIdArray[0]);for(g=0;f=c[g];g++)bd.component.lookup(f).moveToLayerXY(m,b.params.xValue,b.params.yValue);bd.model.addTraitsToEntities(c);bd.evaluator.ctr.whenEntityCreatedFromIdList(c)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.clone_to_xy_local={paramsInfo:[{name:"localClone",type:"field",fieldName:"CLONE_NAME"},{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"layerIdArray",type:"entity",fieldName:"LAYER"},{name:"xValue",type:"value",valueName:"X"},{name:"yValue",type:"value",valueName:"Y"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.evaluator.ctr.getCurrentCallStack();if(b.hasEvaluated)b.hasEvaluated=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next);else{var e=
[],f=!1,g=b.params.entityIdArray[0],h=bd.model.entityLookup(g);if(h){if(null!=bd.model.entityParentNameToChildName[h.type]){var f=!0,k=bd.component.typeNameToComponent[bd.model.entityParentNameToChildName[h.type]].constructor;if("perPlayer"==h.shareMode)for(var l=bd.evaluator.ctr.entityTitleToEntityIdArray("ENTITY_PLAYER",a),h=0;h<l.length;h++){var m=new k(null,g,null,l[h],l[h]);e.push(m.id)}else"local"==h.shareMode?(m=new k(null,g,null,bd.player.ctr.playerId,bd.player.ctr.playerId),e.push(m.id)):
"share"==h.shareMode&&(m=new k(null,g,null,null,null),e.push(m.id))}if(!f)for(f=b.params.entityIdArray,h=0;h<f.length;h++)g=f[h],m=bd.model.entityLookup(g),g=bd.component.typeNameToComponent[m.type].constructor,m="perPlayer"==m.shareMode||"local"==m.shareMode?new g(null,m.parentId,m,m.playerId,m.visibleToPlayerId):new g(null,m.parentId,m,null,null),e.push(m.id);var n;b.params.layerIdArray&&(n=b.params.layerIdArray[0]);for(h=0;g=e[h];h++)bd.component.lookup(g).moveToLayerXY(n,b.params.xValue,b.params.yValue);
bd.model.addTraitsToEntities(e);b.block.statement&&(b.context[b.params.localClone]=m.id,c.createStackObjectAndAddToStack(a.statement.block,{}));b.hasEvaluated=!0;bd.evaluator.ctr.whenEntityCreatedFromIdList(e);bd.evaluator.ctr.evaluateStack()}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.nextBlockInCallStack(a.next)}}};
bd.evaluator.ctr.configs.clone_to_xy_return={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"layerIdArray",type:"entity",fieldName:"LAYER"},{name:"xValue",type:"value",valueName:"X"},{name:"yValue",type:"value",valueName:"Y"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=[],e=!1,f=b.params.entityIdArray[0],g=bd.model.entityLookup(f);if(g){if(null!=bd.model.entityParentNameToChildName[g.type]){var e=!0,h=bd.component.typeNameToComponent[bd.model.entityParentNameToChildName[g.type]].constructor;
if("perPlayer"==g.shareMode)for(var k=bd.evaluator.ctr.entityTitleToEntityIdArray("ENTITY_PLAYER",a),g=0;g<k.length;g++){var l=new h(null,f,null,k[g],k[g]);c.push(l.id)}else"local"==g.shareMode?(l=new h(null,f,null,bd.player.ctr.playerId,bd.player.ctr.playerId),c.push(l.id)):"share"==g.shareMode&&(l=new h(null,f,null,null,null),c.push(l.id))}if(!e)for(e=b.params.entityIdArray,g=0;g<e.length;g++)f=e[g],f=bd.model.entityLookup(f),h=bd.component.typeNameToComponent[f.type].constructor,l="perPlayer"==
f.shareMode||"local"==f.shareMode?new h(null,f.parentId,f,f.playerId,f.visibleToPlayerId):new h(null,f.parentId,f,null,null),c.push(l.id);var m;b.params.layerIdArray&&(m=b.params.layerIdArray[0]);for(g=0;f=c[g];g++)bd.component.lookup(f).moveToLayerXY(m,b.params.xValue,b.params.yValue);bd.model.addTraitsToEntities(c);bd.evaluator.ctr.whenEntityCreatedFromIdList(c);bd.evaluator.ctr.returnHandler(c[0],a.returnsEntity)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(bd.model.nullBlockString,
a.returnsEntity)}};bd.evaluator.ctr.configs.all_instances_of={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray,b=bd.component.lookup(b[0]).model.instanceIds,c=[],e=0;e<b.length;e++)bd.model.entityLookup(b[e]).playerId!=bd.player.ctr.playerId&&"playerInstance"!=bd.model.entityLookup(b[e]).type||c.push(b[e]);bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.is_null={paramsInfo:[{name:"val",type:"value",valueName:"ENTITY"}],evalFunc:function(a){var b="nullObject"==bd.evaluator.ctr.getCurrentStackObject().params.val;bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};bd.evaluator.ctr.configs.null_block={evalFunc:function(a){bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.returnHandler("nullObject",a.returnsEntity)}};
bd.evaluator.ctr.configs.remove_from_game={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray,c;c=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(b);for(var b=c.propagatedEntityIds,e=c.localEntityIds,f=0;f<e.length;f++)c=bd.component.lookup(e[f]),c.removeDisplayObject(),c.deleteInstance(!0);bd.model.addModelUpdateElement(b,"command","deleteInstance",null,{updateUIForOrigin:!0,updateModelForOrigin:!1,
updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.configs.is_entity_in_game={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0],b=null!=bd.model.entityLookup(b);bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};bd.racer={};bd.racer.ctr={};bd.racer.ctr.sharedModel=null;bd.racer.ctr.playerUdidToPeerConnectionInfo={};bd.racer.ctr.peerObject=null;bd.racer.ctr.setupSharedModel=function(){if(null!=bd.instance.ctr.instanceCode){var a=document.getElementById("racerServer").innerHTML;bd.util.ajaxGet(a+"/getInstance/"+bd.instance.ctr.instanceCode,bd.racer.ctr.sharedModelBundleHandler)}else console.error("No instance code available before accessing shared model")};
bd.racer.ctr.sharedModelBundleHandler=function(a){a=JSON.parse(a);var b=RACER.createModel(a);bd.racer.ctr.sharedModel=b;bd.racer.ctr.setupPlayerInSharedModel();b.on("change","_page.room.variableNameToValue.*.value",function(a,b,f){bd.evaluator.ctr.variableChanged(a,f,!1)});b.on("change","_page.room.variableNameToValue.*",function(a,b,f){bd.evaluator.ctr.variableChanged(a,f,!1)});b.on("change","_page.room",function(a,e,f){console.log("changed!",arguments);b.get("_page.room");if(!f.$remote)return console.log("local")})};
bd.racer.ctr.setupPlayerInSharedModel=function(){bd.player.ctr.playerUdid=bd.racer.ctr.sharedModel.id();var a=document.getElementById("peerServerHost").innerHTML,b=new Peer({host:a});bd.racer.ctr.peerObject=b;b.on("open",function(a){var e={peerId:a};bd.player.ctr.playerPeerId=a;a=bd.racer.ctr.sharedModel;a.set("_page.room.playerUdidToModel."+bd.player.ctr.playerUdid,e);a.set("_page.room.playerIdStringToPlayerUdid.id:"+bd.player.ctr.playerId,bd.player.ctr.playerUdid);b.on("connection",function(a){var b=
JSON.parse(a.metadata).udid;bd.racer.ctr.playerUdidToPeerConnectionInfo[b]={connection:a};a.on("open",function(){a.on("data",function(a){bd.racer.ctr.handleReceivedPeerData(a)})});a.on("error",function(a){console.log("inside error")})})})};bd.racer.ctr.handleReceivedPeerData=function(a){console.log("Received "+a);a=JSON.parse(a);"procedure_call"==a.type&&bd.evaluator.ctr.blocks.procedures.callProcedureFromMessage(a.name,a.context)};
bd.racer.ctr.sendMessageToPeer=function(a,b){var c=bd.racer.ctr.playerUdidToPeerConnectionInfo[a];if(c)c&&c.isPending?c.pendingMessages.push(b):c&&c.connection&&c.connection.send(b);else if(c=bd.racer.ctr.sharedModel.get("_page.room.playerUdidToModel."+a+".peerId")){var e=bd.racer.ctr.peerObject,f=JSON.stringify({udid:bd.player.ctr.playerUdid}),g=e.connect(c,{metadata:f});bd.racer.ctr.playerUdidToPeerConnectionInfo[a]={connection:g,isPending:!0,pendingMessages:[b]};g.on("error",function(a){console.log("inside error")});
g.on("open",function(){var b=bd.racer.ctr.playerUdidToPeerConnectionInfo[a];b.isPending=!1;for(var c=0;c<b.pendingMessages.length;c++)g.send(b.pendingMessages[c]);g.on("data",function(a){bd.racer.ctr.handleReceivedPeerData(a)})})}};
bd.racer.ctr.sendMessageToPlayers=function(a,b,c){if(bd.player.ctr.inEditorPreview){var e=bd.model.getEntityList("playerInstance");if(b)for(b=0;b<e.length;b++)(c=window.parent.document.getElementById("iframeForPlayer"+e[b].id))&&e[b].id!=bd.player.ctr.playerId&&c.contentWindow.bd.racer.ctr.handleReceivedPeerData(a);else bd.player.ctr.playerId!=c&&(c=window.parent.document.getElementById("iframeForPlayer"+c))&&c.contentWindow.bd.racer.ctr.handleReceivedPeerData(a)}else if(e=bd.racer.ctr.sharedModel.get("_page.room.playerIdStringToPlayerUdid"),
b)for(var f in e)b=bd.util.removePrefix(f,"id"),b!=bd.player.ctr.playerId&&bd.racer.ctr.sendMessageToPeer(e["id:"+b],a);else bd.player.ctr.playerId!=c&&bd.racer.ctr.sendMessageToPeer(e["id:"+c],a)};bd.evaluator.ctr.blocks.grid={};bd.evaluator.ctr.configs.grid_get_tile_object={paramsInfo:[{name:"gridIdArray",type:"entity",fieldName:"GRID"},{name:"column",type:"value",valueName:"COL"},{name:"row",type:"value",valueName:"ROW"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.component.lookup(b.params.entityIdArray[0]);bd.evaluator.ctr.returnHandler(c.getTileByColumnRow(Math.floor(b.params.column)-1,Math.floor(b.params.row)-1).id,a.returnsEntity)}};
bd.evaluator.ctr.configs.grid_get_dimension={paramsInfo:[{name:"gridIdArray",type:"entity",fieldName:"GRID"},{name:"columnOrRow",type:"field",fieldName:"DIMENSION"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=bd.component.lookup(b.params.entityIdArray[0]);bd.evaluator.ctr.returnHandler({COLUMN:c.model.numColumns,ROW:c.model.numRows}[b.params.columnOrRow],a.returnsEntity)}};
bd.evaluator.ctr.configs.grid_get_entity_location={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"columnOrRow",type:"field",fieldName:"DIMENSION"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,b=b.params.columnOrRow,c=null===bd.component.lookup(c[0]).getCurrentColumnOrRow()[b]?"nullObject":bd.component.lookup(c[0]).getCurrentColumnOrRow()[b]+1;bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.grid_is_entity_on_grid={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"gridIdArray",type:"entity",fieldName:"GRID"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray[0],e=[];if("class"==bd.component.lookup(c).classOrInstance)for(var f=0;f<bd.component.lookup(c).model.instanceIds.length;f++)e.push(bd.component.lookup(bd.component.lookup(c).model.instanceIds[f]));else e.push(bd.component.lookup(c));b=bd.component.lookup(b.params.gridIdArray[0]);
c=!1;for(f=0;f<e.length;f++)e[f].getCurrentGrid()===b.model&&(c=!0);bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.grid_is_entity_at_location={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"gridIdArray",type:"entity",fieldName:"GRID"},{name:"column",type:"value",valueName:"COL"},{name:"row",type:"value",valueName:"ROW"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray[0],e=[];if("class"==bd.component.lookup(c).classOrInstance)for(var f=0;f<bd.component.lookup(c).model.instanceIds.length;f++)e.push(bd.component.lookup(bd.component.lookup(c).model.instanceIds[f]));
else e.push(bd.component.lookup(c));for(var c=bd.component.lookup(b.params.gridIdArray[0]),g=Math.floor(b.params.column)-1,b=Math.floor(b.params.row)-1,h=!1,f=0;f<e.length;f++){var k=e[f];k.getCurrentGrid()===c.model&&k.getCurrentColumnOrRow().COLUMN===g&&k.getCurrentColumnOrRow().ROW===b&&(h=!0)}bd.evaluator.ctr.returnHandler(h,a.returnsEntity)}};
bd.evaluator.ctr.configs.grid_move_by_col_row={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"direction",type:"field",fieldName:"DIRECTION"},{name:"absValue",type:"value",valueName:"NUM"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.direction,f=b.params.absValue,g={left:"x",right:"x",up:"y",down:"y"},b=0;b<c.length;b++){var h=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c),k=h.propagatedEntityIds,l=h.localEntityIds,
h=function(a){for(var b=0;b<a.length;b++){var c=bd.component.lookup(a[b]).getCurrentGrid();if(null!=c){var h=bd.component.lookup(a[b]),t=h.getCurrentColumnOrRow().COLUMN,h=h.getCurrentColumnOrRow().ROW;"left"===e&&f>t?f=t:"right"===e&&f>c.numColumns-t-1?f=c.numColumns-t-1:"up"===e&&f>h?f=h:"down"===e&&f>c.numRows-h-1&&(f=c.numRows-h-1);t=f*(c.tileWidth+c.horizontalMargin+(0===c.horizontalMargin?1:2)*c.borderThickness);c=f*(c.tileHeight+c.verticalMargin+(0===c.verticalMargin?1:2)*c.borderThickness);
c={left:-t,right:t,up:-c,down:c};a===k?(bd.model.addModelUpdateElement([a[b]],"change",g[e],c[e],{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates()):a===l&&bd.component.lookup(a[b]).localChangeXY(g[e],c[e])}}};h(k);h(l)}bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.grid_move_to_col_row={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"column",type:"value",valueName:"COL"},{name:"row",type:"value",valueName:"ROW"},{name:"gridIdArray",type:"entity",fieldName:"GRID"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=Math.floor(b.params.column)-1,f=Math.floor(b.params.row)-1,b=bd.component.lookup(b.params.gridIdArray[0]);e>=b.model.numColumns?e=b.model.numColumns-1:
0>e&&(e=0);f>=b.model.numRows?f=b.model.numRows-1:0>f&&(f=0);f=b.xOrYByColumnRow(e,f);e=f.X;f=f.Y;b=bd.evaluator.ctr.getLocalAndPropagatedEntityIds(c);c=b.propagatedEntityIds;b=b.localEntityIds;bd.model.addModelUpdateElement(c,"set","x",e,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.addModelUpdateElement(c,"set","y",f,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();for(c=0;c<b.length;c++)bd.component.lookup(b[c]).localMoveToXY(e,
f);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.blocks.traits={};
bd.evaluator.ctr.configs.set_trait={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"traitOrProperty",type:"field",fieldName:"TRAIT"},{name:"val",type:"value",valueName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=b.params.val,f=b.params.traitOrProperty,b="change_trait"==a._type?"change":"set";if(bd.util.containsPrefix(f,"property"))f=bd.util.removePrefix(f,"property"),bd.property.ctr.setOrChangePropertyValue(b,c,
f,e);else{for(var f=bd.util.removePrefix(f,"id"),g=[],h=0;h<c.length;h++)if(bd.model.entityLookup(c[h]))for(var k=bd.entityLookup[c[h]].traitIds,l=0;l<k.length;l++)if(bd.entityLookup[k[l]].traitDefId==f){g.push(k[l]);break}bd.model.addModelUpdateElement(g,b,"value",e,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates()}bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.configs.change_trait=bd.evaluator.ctr.configs.set_trait;
bd.evaluator.ctr.configs.trait_value={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"traitOrProperty",type:"field",fieldName:"TRAIT"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.traitOrProperty,b=b.params.entityIdArray[0];if(bd.model.entityLookup(b))if(bd.util.containsPrefix(c,"property"))c=bd.util.removePrefix(c,"property"),c=bd.property.ctr.getPropertyValue(b,c),bd.evaluator.ctr.returnHandler(c,a.returnsEntity);else{for(var c=bd.util.removePrefix(c,
"id"),b=bd.entityLookup[b].traitIds,e=-1,f=0;f<b.length;f++)if(bd.entityLookup[b[f]].traitDefId==c){e=bd.entityLookup[b[f]].value;break}bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(bd.model.nullBlockString,a.returnsEntity)}};bd.evaluator.ctr.blocks.variables={};bd.evaluator.ctr.configs.variables_init_global_type={paramsInfo:[{name:"variableName",type:"field",fieldName:"VAR"},{name:"val",type:"value",valueName:"VALUE"},{name:"typeString",type:"field",fieldName:"TYPE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.variableName,e=b.params.val,b="type:value"==b.params.typeString;bd.component.lookup(bd.model.getGameInfo().id).setGlobalVariable(c,e,b);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.variables_init={paramsInfo:[{name:"variableName",type:"variableName",valueName:"VAR"},{name:"val",type:"value",valueName:"VALUE"},{name:"sharedOrGlobal",type:"field",fieldName:"SHARED_OR_GLOBAL"},{name:"typeString",type:"field",fieldName:"TYPE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.variableName,e=b.params.val,f="type:value"==b.params.typeString;"SHARED"==b.params.sharedOrGlobal?bd.component.lookup(bd.model.getGameInfo().id).initializeSharedVariable(c.__text,
e,f):bd.component.lookup(bd.model.getGameInfo().id).setGlobalVariable(c.__text,e,f,!1,!0);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.configs.variables_set={paramsInfo:[{name:"variableName",type:"field",fieldName:"VAR"},{name:"val",type:"value",valueName:"VALUE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.setDefinedContextVariable(b.params.variableName,b.params.val);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.variables_change_by={paramsInfo:[{name:"variableName",type:"field",fieldName:"VAR"},{name:"val",type:"value",valueName:"VALUE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.evaluator.ctr.setDefinedContextVariable(b.params.variableName,b.params.val,null,null,!0);bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.controls_parameter={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR",evaluateName:!1}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray;bd.evaluator.ctr.returnHandler(b[0],a.returnsEntity)}};bd.evaluator.ctr.blocks.timer={};bd.evaluator.ctr.configs.get_timer_time={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.evaluator.ctr.returnHandler(bd.component.lookup(b).timerRead(),a.returnsEntity)}};
bd.evaluator.ctr.configs.is_activated={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.evaluator.ctr.returnHandler(bd.component.lookup(b).model.activated,a.returnsEntity)}};
bd.evaluator.ctr.configs.set_timer={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"timeNum",type:"value",valueName:"TIME_NUM"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.timeNum,b=b.params.entityIdArray,e=bd.component.lookup(b[0]);bd.model.addModelUpdateElement(b,"set","timeInput",c,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();e.timeOutShort();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.start_stop_timers={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"startOrStop",type:"field",fieldName:"START_OR_STOP"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.startOrStop,b=b.params.entityIdArray,e=b[0];bd.component.lookup(e);var e=bd.component.lookup(e),f=(new Date).getTime(),g=e.timerRead();if("START"==c&&!e.model.activated||"RESTART"==c){bd.model.addModelUpdateElement(b,"set","activated",!0,{updateUIForOrigin:!1,
updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.addModelUpdateElement(b,"set","startTime",f,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});if("RESTART"==c||"START"==c&&(!e.model.countDown&&g==e.model.timeInput||e.model.countDown&&0==g))c=0,e.model.countDown&&(c=e.model.timeInput),bd.model.addModelUpdateElement(b,"set","stopTime",c,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();
e.timeOutShort()}else"STOP"==c&&(bd.model.addModelUpdateElement(b,"set","activated",!1,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.addModelUpdateElement(b,"set","stopTime",g,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates());bd.evaluator.ctr.nextBlockInCallStack(a.next)}};bd.evaluator.ctr.blocks.looks={};
bd.evaluator.ctr.configs.next_costume={paramsInfo:[{name:"nextOrPrevious",type:"field",fieldName:"NEXT_OR_PREVIOUS"},{name:"entityIdArray",type:"entity",fieldName:"VAR"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=0;e<c.length;e++){for(var f=c[e],g=bd.component.lookup(f).getCostumeIds(),h=bd.entityLookup[f].costumeId,k=g[0],l=g[0],m=0;m<g.length;m++)g[m]==h&&(k=m==g.length-1?g[0]:g[m+1],l=0==m?g[g.length-1]:g[m-1]);bd.model.addModelUpdateElement([f],
"set","costumeId","PREVIOUS"==b.params.nextOrPrevious?l:k,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1})}bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.set_width_height={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"dimension",type:"field",fieldName:"DIMENSION"},{name:"val",type:"value",valueName:"x"}],readableName:"set width/height",evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.dimension,e=b.params.entityIdArray,b=b.params.val;0<=b?bd.model.addModelUpdateElement(e,"set",c,b,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}):
0>b&&bd.errorLog.ctr.printError(bd.msg.ERROR_INVALID_PARAMETER,[b.toString(),this.readableName]);bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.show_hide_pieces={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"hideOrShow",type:"field",fieldName:"MODE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,e=!0,e="show"==b.params.hideOrShow?!0:!1;bd.model.addModelUpdateElement(c,"set","visible",e,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.is_visible={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];bd.model.entityLookup(b)?bd.evaluator.ctr.returnHandler(bd.entityLookup[b].visible,a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(!1,a.returnsEntity))}};
bd.evaluator.ctr.configs.switch_costume={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"costumeId",type:"entity",fieldName:"VAR2"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();bd.model.addModelUpdateElement(b.params.entityIdArray,"set","costumeId",b.params.costumeId,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.set_costume_num={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"},{name:"costumeNum",type:"value",valueName:"COSTUME_NUM"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,b=b.params.costumeNum;if(0<b){for(var e=0;e<c.length;e++){var f=c[e];if(bd.model.entityLookup(f)){var g=bd.component.lookup(f).getCostumeIds();g.length>b-1&&bd.model.addModelUpdateElement([f],"set","costumeId",g[b-1],{updateUIForOrigin:!0,updateModelForOrigin:!0,
updateModelInEditor:!1,updateUIInEditor:!1})}}bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}}};
bd.evaluator.ctr.configs.flip_sprite={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"flipType",type:"field",fieldName:"FLIP_TYPE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray,b=b.params.flipType,e=!1,f="flipHorizontal";if("LEFT"==b||"UPSIDE_DOWN"==b)e=!0;if("NOT_UPSIDE_DOWN"==b||"UPSIDE_DOWN"==b)f="flipVertical";bd.model.addModelUpdateElement(c,"set",f,e,{updateUIForOrigin:!0,updateModelForOrigin:!0,updateModelInEditor:!1,
updateUIInEditor:!1});bd.model.sendUpdates();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.get_width_height={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"dimension",type:"field",fieldName:"DIMENSION"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.dimension,b=b.params.entityIdArray[0];bd.model.entityLookup(b)?bd.evaluator.ctr.returnHandler(bd.model.entityLookup(b)[c],a.returnsEntity):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity))}};
bd.evaluator.ctr.configs.costume_num={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"VAR"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.entityIdArray[0];if(bd.model.entityLookup(b)){for(var c=bd.entityLookup[b].costumeId,b=bd.component.lookup(b).getCostumeIds(),e=0,f=0;f<b.length;f++)if(c==b[f]){e=f+1;break}bd.evaluator.ctr.returnHandler(e,a.returnsEntity)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(1,
a.returnsEntity)}};bd.component.levelEditorClassRestrictionOnTab={constructor:function(a){this.model="undefined"==typeof a?null:a;goog.mixin(this,bd.component.levelEditorClassRestrictionOnTab.componentProperties);this.model=null!=a?a:{};bd.modelTag.applyTags(this,null==a);bd.methodTag.applyMethodTags(this)},componentProperties:{classOrInstance:"class",type:"levelEditorClassRestrictionOnTab",listName:"levelEditorClassRestrictionOnTabs",idName:"levelEditorClassRestrictionOnTabId",idListName:"levelEditorClassRestrictionOnTabIds",
namePrefix:"unused prefix...",tabName:"Level Editor Class Restriction On Tab",entityName:"Level Editor Class Restriction On Tab",modelTags:["entity"],methodTags:["entity"]}};bd.component.typeNameToComponent.levelEditorClassRestrictionOnTab=bd.component.levelEditorClassRestrictionOnTab;bd.evaluator.ctr.blocks.sensing={};bd.evaluator.ctr.configs.angle_from_to_entity={paramsInfo:[{name:"entityIdArray1",type:"entity",fieldName:"ENTITY1"},{name:"entityIdArray2",type:"entity",fieldName:"ENTITY2"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),b=bd.evaluator.ctr.entityIdTextToAngle(b.params.entityIdArray1[0],b.params.entityIdArray2[0]);bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};
bd.evaluator.ctr.configs.distance_from_to_entity={paramsInfo:[{name:"entityIdArray1",type:"entity",fieldName:"ENTITY1"},{name:"entityIdArray2",type:"entity",fieldName:"ENTITY2"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray1[0],b=b.params.entityIdArray2[0];if(bd.model.entityLookup(c)&&bd.model.entityLookup(b)){var c=bd.component.lookup(c),e=bd.component.lookup(b),b=e.getXOrY("y")-c.getXOrY("y"),c=e.getXOrY("x")-c.getXOrY("x");bd.evaluator.ctr.returnHandler(Math.sqrt(Math.pow(b,
2)+Math.pow(c,2)),a.returnsEntity)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity)}};
bd.evaluator.ctr.configs.distance_from_to_point={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"xValue",type:"value",valueName:"X"},{name:"yValue",type:"value",valueName:"Y"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray[0];if(bd.model.entityLookup(c)){var c=bd.component.lookup(c),e=b.params.xValue,b=b.params.yValue,b=c.getXOrY("y")-b,c=c.getXOrY("x")-e;bd.evaluator.ctr.returnHandler(Math.sqrt(Math.pow(b,2)+Math.pow(c,2)),
a.returnsEntity)}else bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(0,a.returnsEntity)}};bd.evaluator.ctr.configs.timer_value={evalFunc:function(a){var b=((new Date).getTime()-bd.evaluator.ctr.timerStart)/1E3;bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}};bd.evaluator.ctr.configs.reset_timer={evalFunc:function(a){bd.evaluator.ctr.timerStart=(new Date).getTime();bd.evaluator.ctr.nextBlockInCallStack(a.next)}};
bd.evaluator.ctr.configs.is_touching_phaser_physics={getParams:function(a){var b=[];b.push({name:"entityIdArray1",type:"entity",fieldName:"ENTITY1"});bd.evaluator.ctr.isEntityIdOfParentEntity("ENTITY2",a)?b.push({name:"entityIdArray2",type:"entityClass",fieldName:"ENTITY2"}):b.push({name:"entityIdArray2",type:"entity",fieldName:"ENTITY2"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray1,b=b.params.entityIdArray2,e=[];if(bd.evaluator.ctr.isEntityIdOfParentEntity("ENTITY2",
a))for(var f=0;f<b.length;f++)bd.model.entityLookup(b[f]).playerId==bd.player.ctr.playerId&&e.push(b[f]);else e=b;bd.evaluator.ctr.returnHandler(bd.component.lookup(c[0]).isTouching(e),a.returnsEntity)}};
bd.evaluator.ctr.configs.is_touching_edge={paramsInfo:[{name:"entityIdArray",type:"entity",fieldName:"ENTITY"},{name:"edge",type:"field",fieldName:"EDGE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray;bd.model.entityLookup(c[0])?(b=b.params.edge,bd.evaluator.ctr.returnHandler(bd.component.lookup(c[0]).isTouchingEdge(b),a.returnsEntity)):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(!1,a.returnsEntity))}};
bd.evaluator.ctr.configs.is_touching_phaser_physics_edge={getParams:function(a){var b=[];b.push({name:"entityIdArray1",type:"entity",fieldName:"ENTITY1"});b.push({name:"edge",type:"field",fieldName:"EDGE"});bd.evaluator.ctr.isEntityIdOfParentEntity("ENTITY2",a)?b.push({name:"entityIdArray2",type:"entityClass",fieldName:"ENTITY2"}):b.push({name:"entityIdArray2",type:"entity",fieldName:"ENTITY2"});return b},evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray1,
e=b.params.entityIdArray2,f=[],b=b.params.edge;if(bd.evaluator.ctr.isEntityIdOfParentEntity("ENTITY2",a))for(var g=0;g<e.length;g++)bd.model.entityLookup(e[g]).playerId==bd.player.ctr.playerId&&f.push(e[g]);else f=e;c=c[0];bd.model.entityLookup(c)?(f=bd.component.lookup(c).isTouchingPhaserPhysicsPieceEdge(f,b),bd.evaluator.ctr.returnHandler(f,a.returnsEntity)):(bd.errorLog.ctr.printError(bd.msg.ERROR_NONEXISTENT_ENTITY_NO_NAME),bd.evaluator.ctr.returnHandler(!1,a.returnsEntity))}};
bd.evaluator.ctr.configs.device_orientation={paramsInfo:[{name:"angleOrMagnitude",type:"field",fieldName:"MODE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.angleOrMagnitude;"ANGLE"==b?null==bd.deviceMotion.ctr.orientationAngle?bd.evaluator.ctr.returnHandler("nullObject",a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.orientationAngle,a.returnsEntity):"MAGNITUDE"==b?null==bd.deviceMotion.ctr.orientationMagnitude?bd.evaluator.ctr.returnHandler("nullObject",
a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.orientationMagnitude,a.returnsEntity):"ALPHA"==b?null==bd.deviceMotion.ctr.alpha?bd.evaluator.ctr.returnHandler("nullObject",a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.alpha,a.returnsEntity):"BETA"==b?null==bd.deviceMotion.ctr.beta?bd.evaluator.ctr.returnHandler("nullObject",a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.beta,a.returnsEntity):"GAMMA"==b?null==bd.deviceMotion.ctr.gamma?
bd.evaluator.ctr.returnHandler("nullObject",a.returnsEntity):bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.gamma,a.returnsEntity):"ACCELX"==b?bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.accelerationX,a.returnsEntity):"ACCELY"==b?bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.accelerationY,a.returnsEntity):"ACCELY"==b?bd.evaluator.ctr.returnHandler(bd.deviceMotion.ctr.accelerationZ,a.returnsEntity):bd.evaluator.ctr.returnHandler(0,a.returnsEntity)}};
bd.evaluator.ctr.configs.all_instances_touching_instance={paramsInfo:[{name:"entityIdArray1",type:"entityClass",fieldName:"VAR"},{name:"entityIdArray2",type:"entity",fieldName:"VAR1"},{name:"edge",type:"field",fieldName:"EDGE"}],evalFunc:function(a){for(var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray1,e=b.params.entityIdArray2,b=b.params.edge,f=[],g=0;g<c.length;g++)null!=bd.entityLookup[c[g]].playerId&&f.push(c[g]);for(var c=[],h=e[0],g=0;g<f.length;g++){var k=f[g];bd.component.lookup(k).isTouchingPhaserPhysicsPieceEdge(e,
b)&&h!=k&&c.push(k)}bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}};
bd.evaluator.ctr.configs.within_distance_of={paramsInfo:[{name:"entityIdArray1",type:"entityClass",fieldName:"VAR"},{name:"entityIdArray2",type:"entity",fieldName:"VAR1"},{name:"distance",type:"value",valueName:"DISTANCE"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject(),c=b.params.entityIdArray1,e=b.params.entityIdArray2,b=b.params.distance;if(0>b)bd.errorLog.ctr.printError("Invalid distance - must be positive"),bd.evaluator.ctr.returnHandler([],a.returnsEntity);else{for(var f=
[],g=0;g<c.length;g++)null!=bd.entityLookup[c[g]].playerId&&c[g]!=e[0]&&f.push(c[g]);c=[];e=e[0];for(g=0;g<f.length;g++){var h=f[g],k=bd.component.lookup(e),l=bd.component.lookup(h),m=k.getXOrY("y")-l.getXOrY("y"),k=k.getXOrY("x")-l.getXOrY("x");Math.sqrt(Math.pow(m,2)+Math.pow(k,2))<=Math.abs(b)&&c.push(h)}bd.evaluator.ctr.returnHandler(c,a.returnsEntity)}}};
bd.evaluator.ctr.configs.is_key_pressed={paramsInfo:[{name:"keyCode",type:"field",fieldName:"KEY_PRESSED"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.keyCode,c=bd.component.lookup(bd.model.getCurrentViewId());if(!c.isInitialized)bd.evaluator.ctr.returnHandler(!1,a.returnsEntity);else if("melonView"==c.type)c=c.getWindow(),null!=c.me?c.me.input.isKeyPressed("keyCode:"+b)?bd.evaluator.ctr.returnHandler(!0,a.returnsEntity):bd.evaluator.ctr.returnHandler(!1,a.returnsEntity):
bd.evaluator.ctr.returnHandler(!1,a.returnsEntity);else if("phaserView"==c.type){var e=c.getPhaserGameObject();c.getPhaserObject();b=e.input.keyboard.isDown(b);null==b&&(b=!1);bd.evaluator.ctr.returnHandler(b,a.returnsEntity)}}};
bd.evaluator.ctr.configs.is_custom_key_pressed={paramsInfo:[{name:"keyCode",type:"field",fieldName:"KEY"}],evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject().params.keyCode.charCodeAt(0),c=bd.component.lookup(bd.model.getCurrentViewId());if(!c.isInitialized)bd.evaluator.ctr.returnHandler(!1,a.returnsEntity);else if("melonView"==c.type)c=c.getWindow(),null!=c.me?c.me.input.isKeyPressed("keyCode:"+b)?bd.evaluator.ctr.returnHandler(!0,a.returnsEntity):bd.evaluator.ctr.returnHandler(!1,
a.returnsEntity):bd.evaluator.ctr.returnHandler(!1,a.returnsEntity);else if("phaserView"==c.type){var e=c.getPhaserGameObject();c.getPhaserObject();bd.evaluator.ctr.returnHandler(e.input.keyboard.isDown(b),a.returnsEntity)}}};bd.instance={};bd.instance.ctr={};bd.instance.ctr.instanceCode=null;bd.instance.ctr.playerUdidToPeerId={};bd.instance.ctr.createNewInstance=function(){bd.instance.ctr.hideInstanceSelection();var a=document.getElementById("gameId").innerHTML;bd.util.ajaxPost("/game/newInstance/","gameId="+a,bd.instance.ctr.createNewInstanceResponse)};bd.instance.ctr.createNewInstanceResponse=function(a){var b=JSON.parse(a);bd.instance.ctr.instanceCode=b.instanceCode;bd.player.bootstrap.loadGame(a)};
bd.instance.ctr.afterGameLoadInstanceSetup=function(){bd.instance.ctr.displayInstanceCode();bd.racer.ctr.setupSharedModel()};bd.instance.ctr.joinInstance=function(){bd.instance.ctr.hideInstanceSelection();var a=document.getElementById("instanceCodeInput").value,b=document.getElementById("gameId").innerHTML;bd.util.ajaxPost("/game/joinInstance/","gameId="+b+"&instanceCode="+a,bd.instance.ctr.joinInstanceResponse)};
bd.instance.ctr.joinInstanceResponse=function(a){var b=JSON.parse(a);b.error||(bd.instance.ctr.instanceCode=b.instanceCode,bd.player.bootstrap.loadGame(a))};bd.instance.ctr.displayInstanceCode=function(){if(!bd.player.ctr.isCordova){var a=document.getElementsByClassName("instanceCodeDisplayContainer")[0],b=a.getElementsByClassName("instanceCodeDisplay")[0],c=goog.html.SafeHtml.htmlEscape(bd.instance.ctr.instanceCode);b.innerHTML=goog.html.SafeHtml.unwrap(c);a.style.display="block"}};
bd.instance.ctr.hideInstanceSelection=function(){document.getElementById("viewFrameContainer").style.display="block";document.getElementById("instanceSelectionContainer").style.display="none"};jQuery(document).ready(function(){jQuery(".newInstanceButton").click(function(){bd.instance.ctr.createNewInstance()});jQuery(".joinInstanceButton").click(function(){bd.instance.ctr.joinInstance()})});bd.evaluator.ctr.blocks.events={};
bd.evaluator.ctr.startGame=function(){if(!bd.evaluator.ctr.gameStarted){bd.evaluator.ctr.addEventToEvaluate("variables_init",[],{});bd.evaluator.ctr.addEventToEvaluate("variables_init_global_type",[],{});bd.evaluator.ctr.addEventToEvaluate("game_start_statement",[],{});bd.evaluator.ctr.addEventToEvaluate("game_start",[],{});for(var a=bd.model.getEntityList("phaserPhysicsPieceInstance"),a=a.concat(bd.model.getEntityList("labelInstance")),b=0;b<a.length;b++)bd.evaluator.ctr.whenEntityCreated(a[b].id);bd.model.getCurrentGame().started=
!0;bd.evaluator.ctr.gameStarted=!0}};bd.evaluator.ctr.whenEntityCreatedFromIdList=function(a){for(var b=0;b<a.length;b++)bd.evaluator.ctr.whenEntityCreated(a[b])};bd.evaluator.ctr.whenEntityCreated=function(a){var b={"msg:VARIABLE_CREATED_OBJECT":a,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};a=[{titleName:"ENTITY",entityId:a}];bd.model.isMultiplayer()&&a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("when_entity_created",a,b)};
bd.evaluator.ctr.whenPlayerJoins=function(){if(bd.model.isMultiplayer()){var a=bd.model.entityLookup(bd.player.ctr.playerId).hasJoined,b={"msg:VARIABLE_PLAYER":bd.player.ctr.playerId},c=[{titleName:"PLAYER",entityId:bd.player.ctr.playerId}];a?c.push({titleIndex:1,value:"REJOIN"}):c.push({titleIndex:1,value:"JOIN"});bd.evaluator.ctr.addEventToEvaluate("when_player_join_statement",c,b);bd.evaluator.ctr.addEventToEvaluate("when_player_join",c,b);a||(bd.model.addModelUpdateElement([bd.player.ctr.playerId],
"set","hasJoined",!0,{updateUIForOrigin:!1,updateModelForOrigin:!0,updateModelInEditor:!1,updateUIInEditor:!1}),bd.model.sendUpdates())}};bd.evaluator.ctr.phaserPieceInstanceClicked=function(a){var b={"msg:VARIABLE_CLICKED_OBJECT":a,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};bd.model.entityLookup(a);a=[{titleName:"ENTITY",entityId:a}];bd.model.isMultiplayer()&&a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("entity_clicked_statement",a,b)};
bd.evaluator.ctr.keyPressed=function(a){var b={keypress:a,"msg:KEY_PRESSED":{type:"value",value:String.fromCharCode(a)},"msg:KEY_PRESSED_CODE":{type:"value",value:a},"msg:VARIABLE_PLAYER":bd.player.ctr.playerId},c=[{titleIndex:0,value:a}];bd.model.isMultiplayer()&&c.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});1>"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ".indexOf(String.fromCharCode(a))&&(b["msg:KEY_PRESSED"]="");bd.evaluator.ctr.addEventToEvaluate("key_pressed_statement",c,b);bd.evaluator.ctr.addEventToEvaluate("key_pressed_statement",
[{titleIndex:0,value:"any"}],b);bd.evaluator.ctr.addEventToEvaluate("key_pressed",c,b)};bd.evaluator.ctr.customKeyPressed=function(a){var b={keyPressed:a,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};a=[{titleIndex:0,value:a}];bd.model.isMultiplayer()&&a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("custom_key_pressed_statement",a,b);bd.evaluator.ctr.addEventToEvaluate("custom_key_pressed",a,b)};
bd.evaluator.ctr.variableChanged=function(a,b,c){null==b&&(b=bd.model.nullBlockString);b={"msg:VARIABLE_PREVIOUS_VALUE":b,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};var e=[{titleIndex:0,value:a},{titleIndex:1,value:"INITIALIZED_OR_CHANGED"}];a=c?[{titleIndex:0,value:a},{titleIndex:1,value:"INITIALIZED"}]:[{titleIndex:0,value:a},{titleIndex:1,value:"CHANGED"}];bd.model.isMultiplayer()&&(e.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId}),a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId}));
bd.evaluator.ctr.addEventToEvaluate("when_variable_changed",e,b);bd.evaluator.ctr.addEventToEvaluate("when_variable_changed",a,b)};
bd.evaluator.ctr.onPhaserPhysicsCollision=function(a,b){if(null!=bd.model.entityLookup(a)&&null!=bd.model.entityLookup(b)){var c={"msg:VARIABLE_COLLIDEE_1":a,"msg:VARIABLE_COLLIDEE_2":b,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId},e;e=[{titleName:"ENTITY1",entityId:a},{titleName:"ENTITY2",entityId:b}];bd.model.isMultiplayer()&&e.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("when_phaser_physics_collide_statement",e,c);bd.evaluator.ctr.addEventToEvaluate("when_phaser_physics_collide",
e,c)}};bd.evaluator.ctr.onEdgeCollision=function(a,b){if(null!=bd.model.entityLookup(a)){var c={"msg:VARIABLE_COLLIDEE":a,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId},e=[{titleName:"ENTITY",entityId:a},{titleIndex:1,value:b}];bd.model.isMultiplayer()&&e.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("when_collide_edge_statement",e,c);bd.evaluator.ctr.addEventToEvaluate("when_collide_edge",e,c)}};
bd.evaluator.ctr.onPointerEvent=function(a,b){var c={"msg:VARIABLE_POINTER":"pointer:"+a,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId},e=[{titleName:"POINTER",pointerId:a},{titleIndex:1,value:b}];bd.model.isMultiplayer()&&e.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("when_input_event_statement",e,c);bd.evaluator.ctr.addEventToEvaluate("when_input_event",e,c)};
bd.evaluator.ctr.finishedVideo=function(a){bd.evaluator.ctr.addEventToEvaluate("when_video_finished",[{titleName:"VIDEO",entityId:a}],{"msg:VARIABLE_WATCHED_VIDEO":a})};
bd.evaluator.ctr.whenPhaserPhysicsPlaced=function(a,b,c){b={"msg:VARIABLE_DROPPED_OBJECT":a,"msg:VARIABLE_START_X":{type:"value",value:b},"msg:VARIABLE_START_Y":{type:"value",value:c},"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};a=[{titleName:"ENTITY",entityId:a}];bd.model.isMultiplayer()&&a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("when_phaser_piece_dropped_statement",a,b);bd.evaluator.ctr.addEventToEvaluate("when_phaser_piece_dropped",a,b)};
bd.evaluator.ctr.beforeWhenDroppedOnGrid=function(a,b,c,e,f){if("BEFORE"===a)var g={"msg:VARIABLE_DROPPED_OBJECT":b,"msg:VARIABLE_PlACED_GRID":c,"msg:VARIABLE_TARGET_COLUMN":{type:"value",value:e},"msg:VARIABLE_TARGET_ROW":{type:"value",value:f},"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};else"WHEN"===a&&(g={"msg:VARIABLE_DROPPED_OBJECT":b,"msg:VARIABLE_PlACED_GRID":c,"msg:VARIABLE_PREVIOUS_COLUMN":{type:"value",value:e},"msg:VARIABLE_PREVIOUS_ROW":{type:"value",value:f},"msg:VARIABLE_PLAYER":bd.player.ctr.playerId});
a=[{titleIndex:0,value:a},{titleName:"ENTITY",entityId:b},{titleName:"GRID",entityId:c}];bd.model.isMultiplayer()&&a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("grid_event_entity_dropped",a,g)};
bd.evaluator.ctr.beforeWhenRemovedFromGrid=function(a,b,c,e,f){if("BEFORE"===a)var g={"msg:VARIABLE_REMOVED_OBJECT":b,"msg:VARIABLE_REMOVED_GRID":c,"msg:VARIABLE_TARGET_X":{type:"value",value:e},"msg:VARIABLE_TARGET_Y":{type:"value",value:f},"msg:VARIABLE_PLAYER":bd.player.ctr.playerId};else"WHEN"===a&&(g={"msg:VARIABLE_REMOVED_OBJECT":b,"msg:VARIABLE_REMOVED_GRID":c,"msg:VARIABLE_PREVIOUS_COLUMN":{type:"value",value:e},"msg:VARIABLE_PREVIOUS_ROW":{type:"value",value:f},"msg:VARIABLE_PLAYER":bd.player.ctr.playerId});
a=[{titleIndex:0,value:a},{titleName:"ENTITY",entityId:b},{titleName:"GRID",entityId:c}];bd.model.isMultiplayer()&&a.push({titleName:"PLAYER",entityId:bd.player.ctr.playerId});bd.evaluator.ctr.addEventToEvaluate("grid_event_entity_removed",a,g)};bd.evaluator.ctr.timeOutTriggered=function(a){bd.evaluator.ctr.addEventToEvaluate("when_timer_goes_off",[{titleName:"ENTITY",entityId:a}],{"msg:VARIABLE_TRIGGERED_TIMER":a,"msg:VARIABLE_PLAYER":bd.player.ctr.playerId})};
bd.evaluator.ctr.whenDeviceShaken=function(){bd.evaluator.ctr.addEventToEvaluate("when_device_shaken",[],{})};bd.evaluator.ctr.configs.EVENT_BLOCK={evalFunc:function(a){bd.evaluator.ctr.callStack=[];bd.evaluator.ctr.continuePreviousStack()}};
bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT={evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();b.hasEvaluated?(b.hasEvaluated=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next)):(b.hasEvaluated=!0,a.statement&&a.statement.block&&bd.evaluator.ctr.getCurrentCallStack().createStackObjectAndAddToStack(a.statement.block,{}),bd.evaluator.ctr.evaluateStack())}};
bd.evaluator.ctr.configs.when_phaser_physics_collide_statement={evalFunc:function(a){var b=bd.evaluator.ctr.getCurrentStackObject();if(b.hasEvaluated)b.hasEvaluated=!1,bd.evaluator.ctr.nextBlockInCallStack(a.next);else{var c=bd.evaluator.ctr.getStackObjectContextVariable("msg:VARIABLE_COLLIDEE_1"),e=bd.evaluator.ctr.getStackObjectContextVariable("msg:VARIABLE_COLLIDEE_2");bd.model.entityLookup(c)&&bd.model.entityLookup(e)?(b.hasEvaluated=!0,a.statement&&a.statement.block&&bd.evaluator.ctr.getCurrentCallStack().createStackObjectAndAddToStack(a.statement.block,
{}),bd.evaluator.ctr.evaluateStack()):bd.evaluator.ctr.nextBlockInCallStack(a.next)}}};bd.evaluator.ctr.onSwitchStageEvent=function(a){var b={};bd.evaluator.ctr.addEventToEvaluate("stage_switch_event",[{titleName:"STAGE",entityId:a}],b);bd.evaluator.ctr.addEventToEvaluate("stage_switch_event",[{titleName:"STAGE",value:"ANY"}],b)};bd.evaluator.ctr.configs.game_start_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.key_pressed_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;
bd.evaluator.ctr.configs.custom_key_pressed_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.piece_clicked=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.piece_dropped=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.piece_dropped_on_target=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_collide=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;
bd.evaluator.ctr.configs.entity_clicked_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_entity_created=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_phaser_piece_dropped_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.grid_event_entity_dropped=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.grid_event_entity_removed=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;
bd.evaluator.ctr.configs.when_collide_edge_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_input_event_statement=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.receive_message=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_timer_goes_off=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.procedures_def=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;
bd.evaluator.ctr.configs.when_device_shaken=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_variable_changed=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.stage_switch_event=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.when_video_finished=bd.evaluator.ctr.configs.EVENT_BLOCK_STATEMENT;bd.evaluator.ctr.configs.game_start=bd.evaluator.ctr.configs.EVENT_BLOCK;bd.evaluator.ctr.configs.key_pressed=bd.evaluator.ctr.configs.EVENT_BLOCK;
bd.evaluator.ctr.configs.custom_key_pressed=bd.evaluator.ctr.configs.EVENT_BLOCK;bd.evaluator.ctr.configs.entity_clicked=bd.evaluator.ctr.configs.EVENT_BLOCK;bd.evaluator.ctr.configs.when_phaser_piece_dropped=bd.evaluator.ctr.configs.EVENT_BLOCK;bd.evaluator.ctr.configs.when_phaser_physics_collide=bd.evaluator.ctr.configs.EVENT_BLOCK;bd.evaluator.ctr.configs.when_collide_edge=bd.evaluator.ctr.configs.EVENT_BLOCK;bd.evaluator.ctr.configs.when_input_event=bd.evaluator.ctr.configs.EVENT_BLOCK;
